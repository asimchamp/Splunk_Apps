<form>
  <label>Systems Overview</label>
  <fieldset autoRun="true" submitButton="false">
    <input type="time" searchWhenChanged="true">
      <default>
        <earliestTime>-7d@h</earliestTime>
        <latestTime>now</latestTime>
      </default>
    </input>
  </fieldset>
  <row>
    <chart>
      <title>System Crashes Over Time</title>
      <search><query>sourcetype=ziften:*  message_type=eventlogrecord eventidentifier=1003 OR eventidentifier=1001|timechart count as "System Crashes"</query></search>
      <earliestTime>$earliest$</earliestTime>
      <latestTime>$latest$</latestTime>
      <option name="charting.chart">line</option>
      <option name="charting.chart.nullValueMode">gaps</option>
      <option name="charting.chart.stackMode">default</option>
      <option name="charting.layout.splitSeries">0</option>
      <option name="charting.legend.placement">right</option>
      <option name="count">10</option>
      <option name="displayRowNumbers">true</option>
      <option name="charting.axisTitleX.visibility">visible</option>
      <option name="charting.axisTitleY.visibility">visible</option>
      <option name="charting.axisX.scale">linear</option>
      <option name="charting.axisY.scale">linear</option>
      <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
      <option name="charting.chart.style">shiny</option>
      <option name="charting.drilldown">all</option>
      <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
    </chart>
    <chart>
      <title>Boot Duration Over Time</title>
      <search><query>sourcetype=ziften:*  message_type=bootprofile boottime &lt; 3600000 AND boottime &gt; 0 AND logintime &lt; 3600000 AND logintime &gt; 0  |eval totalboot=(boottime + logintime) |eval totalboot = totalboot/60000 |timechart avg(totalboot) as avg max(totalboot) as max min(totalboot) as min</query></search>
      <earliestTime>$earliest$</earliestTime>
      <latestTime>$latest$</latestTime>
      <option name="charting.chart">line</option>
      <option name="charting.chart.nullValueMode">zero</option>
      <option name="charting.chart.stackMode">none</option>
      <option name="charting.layout.splitSeries">0</option>
      <option name="charting.legend.placement">right</option>
      <option name="count">10</option>
      <option name="displayRowNumbers">true</option>
      <option name="charting.axisTitleX.visibility">visible</option>
      <option name="charting.axisTitleY.visibility">visible</option>
      <option name="charting.axisX.scale">linear</option>
      <option name="charting.axisY.scale">linear</option>
      <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
      <option name="charting.chart.style">shiny</option>
      <option name="charting.drilldown">all</option>
      <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
    </chart>
  </row>
  <row>
    <chart>
      <title>Total Boots Per Day</title>
      <search><query>sourcetype=ziften:* message_type=bootprofile|timechart count as boots</query></search>
      <earliestTime>$earliest$</earliestTime>
      <latestTime>$latest$</latestTime>
      <option name="charting.chart">column</option>
      <option name="count">10</option>
      <option name="displayRowNumbers">true</option>
      <option name="charting.axisTitleX.visibility">visible</option>
      <option name="charting.axisTitleY.visibility">visible</option>
      <option name="charting.axisX.scale">linear</option>
      <option name="charting.axisY.scale">log</option>
      <option name="charting.chart.nullValueMode">gaps</option>
      <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
      <option name="charting.chart.stackMode">default</option>
      <option name="charting.chart.style">shiny</option>
      <option name="charting.drilldown">all</option>
      <option name="charting.layout.splitSeries">0</option>
      <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
      <option name="charting.legend.placement">right</option>
    </chart>
    <chart>
      <title>Top System Crashes</title>
      <search><query>sourcetype=ziften:*  message_type=eventlogrecord eventidentifier=1003 OR eventidentifier=1001|chart count as "System Crashes" by agentguid|lookup system_info agentguid|eval computername=if(isnull(computername), agentguid, computername)| sort -"System Crashes" |fields computername "System Crashes"|head 15</query></search>
      <earliestTime>$earliest$</earliestTime>
      <latestTime>$latest$</latestTime>
      <option name="charting.axisTitleX.visibility">visible</option>
      <option name="charting.axisTitleY.visibility">visible</option>
      <option name="charting.axisX.scale">linear</option>
      <option name="charting.axisY.scale">linear</option>
      <option name="charting.chart">bar</option>
      <option name="charting.chart.nullValueMode">gaps</option>
      <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
      <option name="charting.chart.stackMode">default</option>
      <option name="charting.chart.style">shiny</option>
      <option name="charting.drilldown">all</option>
      <option name="charting.layout.splitSeries">0</option>
      <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
      <option name="charting.legend.placement">right</option>
    </chart>
  </row>
  <row>
    <chart>
      <title>Enterprise Service Counts Per System</title>
      <search><query>sourcetype=ziften:*  message_type=services|streamstats dc(name) as totalservices by agentguid|timechart max(totalservices) as "Max" avg(totalservices) as "Avg" min(totalservices) as "Min"</query></search>
      <earliestTime>$earliest$</earliestTime>
      <latestTime>$latest$</latestTime>
      <option name="charting.chart">line</option>
      <option name="charting.chart.nullValueMode">zero</option>
      <option name="count">10</option>
      <option name="displayRowNumbers">true</option>
      <option name="charting.axisTitleX.visibility">visible</option>
      <option name="charting.axisTitleY.visibility">visible</option>
      <option name="charting.axisX.scale">linear</option>
      <option name="charting.axisY.scale">linear</option>
      <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
      <option name="charting.chart.stackMode">default</option>
      <option name="charting.chart.style">shiny</option>
      <option name="charting.drilldown">all</option>
      <option name="charting.layout.splitSeries">0</option>
      <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
      <option name="charting.legend.placement">right</option>
    </chart>
    <table>
      <title>Systems With Highest Service Counts</title>
      <search><query>sourcetype=ziften:* message_type=services|stats dc(imagefilepath) as "Installed Services" by agentguid|sort -"Installed Services"|lookup system_info agentguid|eval computername=if(isnull(computername), agentguid, computername)|fields computername "Installed Services"|head 15</query></search>
      <earliestTime>$earliest$</earliestTime>
      <latestTime>$latest$</latestTime>
      <option name="wrap">true</option>
      <option name="rowNumbers">false</option>
      <option name="dataOverlayMode">none</option>
      <option name="drilldown">row</option>
      <option name="count">10</option>
    </table>
  </row>
  <row>
    <chart>
      <title>Enterprise Process Counts Per System</title>
      <search><query>sourcetype=ziften:*  message_type=processinventory|streamstats dc(imagefilemd5) as totalprocs by agentguid|timechart max(totalprocs) as "Max Processes" avg(totalprocs) as "Avg Processes" min(totalprocs) as "Min Processes"</query></search>
      <earliestTime>$earliest$</earliestTime>
      <latestTime>$latest$</latestTime>
      <option name="charting.chart">line</option>
      <option name="charting.chart.nullValueMode">zero</option>
      <option name="count">10</option>
      <option name="displayRowNumbers">true</option>
      <option name="charting.axisTitleX.visibility">visible</option>
      <option name="charting.axisTitleY.visibility">visible</option>
      <option name="charting.axisX.scale">linear</option>
      <option name="charting.axisY.scale">linear</option>
      <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
      <option name="charting.chart.stackMode">default</option>
      <option name="charting.chart.style">shiny</option>
      <option name="charting.drilldown">all</option>
      <option name="charting.layout.splitSeries">0</option>
      <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
      <option name="charting.legend.placement">right</option>
    </chart>
    <table>
      <title>Systems With Most Processes</title>
      <search><query>sourcetype=ziften:* message_type=processinventory|stats dc(imagefilemd5) as "Installed Processes" by agentguid|sort -"Installed Processes"|lookup system_info agentguid|eval computername=if(isnull(computername), agentguid, computername)|fields computername "Installed Processes"|head 20</query></search>
      <earliestTime>$earliest$</earliestTime>
      <latestTime>$latest$</latestTime>
      <option name="wrap">true</option>
      <option name="rowNumbers">false</option>
      <option name="dataOverlayMode">none</option>
      <option name="drilldown">row</option>
      <option name="count">10</option>
    </table>
  </row>
</form>
