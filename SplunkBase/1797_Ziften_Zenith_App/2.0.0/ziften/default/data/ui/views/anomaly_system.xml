<form>
  <label>System Anomaly</label>
  <fieldset submitButton="false" autoRun="true">
    <input type="time">
      <label>Time</label>
      <default>
        <earliest>-24h@h</earliest>
        <latest>now</latest>
      </default>
    </input>
  </fieldset>
  <row>
    <panel>
      <title>Low Prev Autorun</title>
      <table>
        <search>
          <query>sourcetype=ziften:* message_type=autostarts  | stats latest(imagefilemd5) as md5, latest(entrypath) as entrypath by agentguid, imagefilepath | eval filename=replace(imagefilepath,".*\\\\","") | eval filepath=lower(replace(imagefilepath,".*:","")) | rex field=filepath mode=sed "s/^\\\\users\\\\[A-Za-z0-9\-\. ]*\\\\/\\\\users\\\\...\\\\/"  | eventstats dc(agentguid) as fp_systems by filepath | eventstats dc(agentguid) as md5_systems by md5 | where fp_systems &lt;= 10 AND md5_systems &lt;= 10 | sort 0 filename</query>
          <earliest>$earliest$</earliest>
          <latest>$latest$</latest>
          <sampleRatio>1</sampleRatio>
        </search>
        <option name="count">10</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">cell</option>
        <option name="percentagesRow">false</option>
        <option name="rowNumbers">false</option>
        <option name="totalsRow">false</option>
        <option name="wrap">false</option>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <title>High Prev Filepath Low Prev MD5</title>
      <table>
        <search>
          <query>sourcetype=ziften:* message_type=processinventory  | eval filepath=lower(replace(imagefilepath,".*:","")) | rex field=filepath mode=sed "s/^\\\\users\\\\[A-Za-z0-9\-\. ]*\\\\/\\\\users\\\\...\\\\/"  | eventstats dc(agentguid) as fp_systems by filepath | stats dc(agentguid) as md5_systems values(agentguid) as systems max(fp_systems) as fp_systems  latest(fileversion) as fileversion by filepath, imagefilemd5 | eventstats max(md5_systems) as max_md5_sys by filepath | eval rarity = md5_systems/fp_systems | where rarity &lt; 0.005 and 5*max_md5_sys &gt; fp_systems | sort 0 rarity, filepath | head 100</query>
          <earliest>$earliest$</earliest>
          <latest>$latest$</latest>
          <sampleRatio>1</sampleRatio>
        </search>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">cell</option>
        <option name="percentagesRow">false</option>
        <option name="rowNumbers">false</option>
        <option name="totalsRow">false</option>
        <option name="wrap">true</option>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <title>Low Prev Autorun</title>
      <table>
        <search>
          <query>sourcetype=ziften:* message_type=autostarts  | stats latest(imagefilemd5) as md5, latest(entrypath) as entrypath by agentguid, imagefilepath | eval filename=replace(imagefilepath,".*\\\\","") | eval filepath=lower(replace(imagefilepath,".*:","")) | rex field=filepath mode=sed "s/^\\\\users\\\\[A-Za-z0-9\-\. ]*\\\\/\\\\users\\\\...\\\\/"  | eventstats dc(agentguid) as fp_systems by filepath | eventstats dc(agentguid) as md5_systems by md5 | where fp_systems &lt;= 10 AND md5_systems &lt;= 10 | sort 0 filename</query>
          <earliest>$earliest$</earliest>
          <latest>$latest$</latest>
          <sampleRatio>1</sampleRatio>
        </search>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">cell</option>
        <option name="percentagesRow">false</option>
        <option name="rowNumbers">false</option>
        <option name="totalsRow">false</option>
        <option name="wrap">true</option>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <title>Low Prev Boot Executable</title>
      <table>
        <search>
          <query>sourcetype=ziften:* message_type=bootanalysis | stats latest(commandline) as commandline, latest(imagefilemd5) as md5 by agentguid, imagefilepath | eval filepath=lower(replace(imagefilepath,".*:","")) | rex field=filepath mode=sed "s/^\\\\users\\\\[A-Za-z0-9\-\. ]*\\\\/\\\\users\\\\...\\\\/"  | eval filename = replace(filepath,".*\\\\","") | eventstats dc(agentguid) as fp_systems by filepath | eventstats dc(agentguid) as md5_systems by md5 | where fp_systems &lt;= 10 AND md5_systems &lt;= 10 | sort 0 filename</query>
          <earliest>$earliest$</earliest>
          <latest>$latest$</latest>
          <sampleRatio>1</sampleRatio>
        </search>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">cell</option>
        <option name="percentagesRow">false</option>
        <option name="rowNumbers">false</option>
        <option name="totalsRow">false</option>
        <option name="wrap">true</option>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <title>Bug Check Event [BSOD]</title>
      <table>
        <search>
          <query>sourcetype=ziften:* message_type=eventlogrecord earliest = -30d  sourcename="BugCheck" | stats c(sourcename) as events latest(timestamp) by agentguid | sort 0 - events,agentguid</query>
          <earliest>0</earliest>
          <sampleRatio>1</sampleRatio>
        </search>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">cell</option>
        <option name="percentagesRow">false</option>
        <option name="rowNumbers">false</option>
        <option name="totalsRow">false</option>
        <option name="wrap">true</option>
      </table>
    </panel>
  </row>
</form>