[wel-33205-p0]
SOURCE_KEY = Message
REGEX = Audit event: (?<mssql_audit>.*)

[wel-33205-p1]
SOURCE_KEY = mssql_audit
DELIMS = "\n", ":"

[wel-33205-p2]
SOURCE_KEY = statement
REGEX = (?<sql_command>\w+)

[wel-33205-p3]
SOURCE_KEY = Message
REGEX = statement:-- network protocol: (?<src_protocol>.*?)\n

[wel-33205-p4]
SOURCE_KEY = Message
REGEX = statement:-- network protocol:.*<address>(?<src_ip>[^<]+)</address>

[wel-33205-p5]
SOURCE_KEY = Message
REGEX = statement:ALTER DATABASE \[[^\]]+\](?<action_signature>.*?)\n

[wel-33205-p6]
SOURCE_KEY = Message
REGEX = statement:CREATE DATABASE .*?\n.*\n (?<action_signature>ON .*?)\n

[wel-33205-p7]
SOURCE_KEY = Message
REGEX = server_instance_name:(?<ServerInstance>.*?)\n

[SQLInstanceInformation]
filename = SQLInstanceInformation.csv

[SQLUserInformation]
filename = SQLUserInformation.csv

[SQLDatabaseInformation]
filename = SQLDatabaseInformation.csv

[SQLHostInformation]
filename = SQLHostInformation.csv

[SQLLastLogin]
filename = SQLLastLogin.csv

[wel-mssql-instance-2008]
REGEX=(?ms)SourceName=MSSQL\$(?<db_instance>.*?)\n

[wel-mssql-instance-2012]
REGEX=(?ms)SourceName=(?<db_instance>[^$]*?)\n

[wel-mssql-srcip]
REGEX=(?ms)\[CLIENT:\s+(?<src_ip>[^\]]+)\]

[wel-mssql-833]
REGEX=(?ms)EventCode=833\s*\n.*Message=SQL Server has encountered (?<occurrences>\d+) occurrence\(s\) of (?<signature>I/O requests taking longer than \d+ seconds to complete) on file \[(?<filename>.*?)\] in database \[(?<db_name>.*?)\] \((?<db_id>\d+)\)

[wel-mssql-1101]
REGEX=(?ms)EventCode=1101\s*\n.*Message=Could not allocate a new page for database '(?<db_name>[^']+)' because of (?<signature>insufficient disk space in filegroup) '(?<db_filegroup>[^']+)'.

[wel-mssql-1105]
REGEX=(?ms)EventCode=1105\s*\n.*Message=Could not allocate space for object '[^']+'.'[^']+' in database '(?<db_name>[^']+)' because the '(?<db_filegroup>[^']+)' (?<signature>filegroup is full).

[wel-mssql-3421]
REGEX=(?ms)EventCode=3421\s*\n.*Message=(?<signature>Recovery completed for database (?<db_name>[^\s]+)) \(database ID (?<db_id>\d+)\) in (?<time_taken>\d+) second\(s\) \(analysis (?<time_analysis>\d+) ms, redo (?<time_redo>\d+) ms, undo (?<time_undo>\d+) ms\.

[wel-mssql-15457]
REGEX=(?ms)EventCode=15457\s*\n.*Message=Configuration option '(?<db_config_option>[^']+)' changed from (?<db_config_oldvalue>[^\s]+) to (?<db_config_newvalue>.*?).

[wel-mssql-17069]
REGEX=(?ms)EventCode=17069\s*\n.*Message=Microsoft SQL Server (?<server_release>\d+) - (?<server_version>[^\s]+) \((?<server_arch>[^\)]+)\).*\n\s*(?<db_edition>\w+) Edition: (?<server_licensing>[^\s]+) Licensing \(.*?\) on (?<os_version>Windows NT [\d\.]+) <.*?> \(Build (?<os_build>\d+)

[wel-mssql-17104]
REGEX=(?ms)EventCode=17104\s*\n.*Message=Server process ID is (?<pid>\d+)

[wel-mssql-17137]
REGEX=(?ms)EventCode=17137\s*\n.*Message=Starting up database '(?<db_name>[^']+)'.

[wel-mssql-17806]
REGEX=(?ms)EventCode=17806\s*\n.*Message=(?<signature>SSPI handshake failed) with error code (?<errorcode>0x[0-9a-f]+), state (?<state>[^\s]+) while establishing a connection with integrated security; the connection has been closed\. Reason: (?<reason>[^\.]+)\.

[wel-mssql-17890]
REGEX=(?ms)EventCode=17890\s*\n.*Message=(?<signature>A significant part of sql server process memory has been paged out)

[wel-mssql-18056]
REGEX=(?ms)EventCode=18056\s*\n.*Message=(?<signature>The client was unable to reuse a session)

[wel-mssql-18451]
REGEX=(?ms)EventCode=18451\s*\n.*Message=Login failed for user '(?<user>.*?)'\.\s+(?<reason>.*?)\.

[wel-mssql-18452]
REGEX=(?ms)EventCode=18452\s*\n.*Message=Login failed\. (?<reason>.*?)\.

[wel-mssql-18453-18454]
REGEX=(?ms)EventCode=(18453|18454)\s*\n.*Message=Login succeeded for user '(?<user>.*?)'\.\s+Connection made using (?<auth_type>.*?) authentication\.

[wel-mssql-18456]
REGEX=(?ms)EventCode=18456\s*\n.*Message=Login failed for user '(?<user>.*?)'\. Reason: (?<reason>Failed to open the explicitly specified database) '(?<db_name>.*?)'\.

[wel-mssql-26067]
REGEX=(?ms)EventCode=26067\s*\n.*Message=(?<signature>The SQL Server Network Interface library could not register the Service Principal Name)

[wel-mssql-33081]
REGEX=(?ms)EventCode=33081\s*\n.*Message=(?<signature>Failed to verify Authenticode signature on DLL)

[wel-mssql-33204]
REGEX=(?ms)EventCode=33204\s*\n.*Message=(?<signature>SQL Server Audit could not write to the security log)

[wel-mssql-33208]
REGEX=(?ms)EventCode=33208\s*\n.*Message=(?<signature>SQL Server Audit failed to access the security log)

[dm_audit_class_type]
filename = dm_audit_class_type_map.csv

[dm_audit_actions]
filename = dm_audit_actions.csv

[SQLBuilds]
filename = SQLBuilds.csv

[OSVersion]
filename = OSVersion.csv

