<form>
  <label>Authentication Overview</label>

  <fieldset autoRun="True" submitButton="false">
    <input type="time" searchWhenChanged="true">
      <default>
        <earliestTime>-24h</earliestTime>
        <latestTime>now</latestTime>
      </default>
    </input>
   <input type="dropdown" token="server">
      <label>ClearPass Server</label>
      <default>*</default>
      <choice value="*">All</choice>
      <populatingSearch fieldForValue="cphost" fieldForLabel="cphost">
        <![CDATA[eventtype=cppm | stats count by cphost]]>
      </populatingSearch>
    </input>
  </fieldset>

 <row>
    <single>
      <searchString> eventtype=cppm-authentication cphost=$server$ | stats count</searchString>
      <option name="underLabel">Total Auths</option>
    </single>
    <single>
      <searchString> eventtype=cppm-pass-authentication cphost=$server$ | stats count</searchString>
      <option name="underLabel">Total Successful Auths</option>
    </single>
    <single>
      <searchString> eventtype=cppm-pass-authentication cphost=$server$ | dedup user_name | stats count</searchString>
      <option name="underLabel">Total Users</option>
    </single>
    <single>
      <searchString> eventtype=cppm-pass-authentication cphost=$server$ | dedup mac_address | stats count</searchString>
      <option name="underLabel">Total Endpoints</option>
    </single>  
    <single>
      <searchString> eventtype=cppm-pass-authentication cphost=$server$ | dedup service_name | stats count</searchString>
      <option name="underLabel">Total Services</option>
    </single>
    <single>
      <searchString> eventtype=cppm-pass-authentication cphost=$server$ | dedup nas_ip | stats count</searchString>
      <option name="underLabel">NAS Used</option>
    </single>  
 </row>

  
  <row>
    <chart>
      <title>Incoming Auth Requests</title>
      <searchString>
       eventtype=cppm-authentication cphost=$server$ | timechart count 
      </searchString>
      <option name="charting.chart">area</option>
    </chart>

    <chart>
      <title>Auth Failures</title>
      <searchString>
       eventtype=cppm-fail-authentication cphost=$server$ | timechart count 
      </searchString>
    </chart>

    <chart>
      <title>Service Categorization</title>
      <searchString>
        eventtype="cppm-pass-authentication" service_name="*" cphost=$server$ |chart count by service_name
      </searchString>
      <option name="charting.chart">pie</option>
    </chart>
  </row>
   
  <row>
    <table>
      <title>Top 10 User Auths</title>
      <searchString>
       eventtype=cppm-pass-authentication cphost=$server$ | top limit=10 user_name
      </searchString>
    </table>

    <table>
      <title>Top 10 Services Used</title>
      <searchString>
       eventtype=cppm-pass-authentication cphost=$server$ | top limit=10 service_name 
      </searchString>
    </table>

    <table>
      <title>Top 10 Alerts Raised</title>
      <searchString>
       eventtype=cppm-alert cphost=$server$ | top limit=10 alert 
      </searchString>
    </table>

    <table>
      <title>Top 10 Incoming Client MAC</title>
      <searchString>
       eventtype=cppm-pass-authentication cphost=$server$ | top limit=10 mac_address 
      </searchString>
    </table>

    <table>
      <title>Top 10 IP Used</title>
      <searchString>
       eventtype=cppm-radius cphost=$server$ | top limit=10 ip_address 
      </searchString>
    </table>
  </row>

</form>

