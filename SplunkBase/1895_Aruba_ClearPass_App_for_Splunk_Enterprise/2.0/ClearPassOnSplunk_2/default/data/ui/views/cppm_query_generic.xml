<form>
  <label>Generic Query Dropdown</label>

  <fieldset autoRun="True" submitButton="true">
    <input type="time">
      <default>
        <earliestTime>-60m@m</earliestTime>
        <latestTime>now</latestTime>
      </default>
    </input>
   <input type="dropdown" token="server">
      <label>ClearPass Server</label>
      <default>*</default>
      <choice value="*">All</choice>
      <populatingSearch fieldForValue="cphost" fieldForLabel="cphost">
        <![CDATA[eventtype=cppm | stats count by cphost]]>
      </populatingSearch>
    </input>
   <input type="dropdown" token="user_name">
      <label>Username</label>
      <default>*</default>
      <choice value="*">All</choice>
      <populatingSearch fieldForValue="user_name" fieldForLabel="user_name">
        <![CDATA[eventtype=cppm | stats count by user_name]]>
      </populatingSearch>
    </input>
   <input type="dropdown" token="hostname">
      <label>Hostname</label>
      <default>*</default>
      <choice value="*">All</choice>
      <populatingSearch fieldForValue="hostname" fieldForLabel="hostname">
        <![CDATA[eventtype=cppm | stats count by hostname]]>
      </populatingSearch>
    </input>
   <input type="dropdown" token="mac_address">
      <label>MAC Address</label>
      <default>*</default>
      <choice value="-">All</choice>
      <populatingSearch fieldForValue="mac_address" fieldForLabel="mac_address">
        <![CDATA[eventtype=cppm | stats count by mac_address]]>
      </populatingSearch>
    </input>
   <input type="dropdown" token="ip_address">
      <label>IP Address</label>
      <default>*</default>
      <choice value="-">All</choice>
      <populatingSearch fieldForValue="ip_address" fieldForLabel="ip_address">
        <![CDATA[eventtype=cppm | stats count by ip_address]]>
      </populatingSearch>
    </input>
   <input type="dropdown" token="nas_port_type">
      <label>NAS Port Type</label>
      <default>*</default>
      <choice value="-">All</choice>
      <populatingSearch fieldForValue="nas_port_type" fieldForLabel="nas_port_type">
        <![CDATA[eventtype=cppm | stats count by nas_port_type]]>
      </populatingSearch>
    </input>

    <input type="text" token="sstring" searchWhenChanged="true">
      <label>Search String (roles="*Employee*"):</label>
      <default>*</default>
    </input>

  </fieldset>
  
  <row>
    <table>
      <title>Dashboard </title>
      <searchString>
        eventtype=cppm CPPM_Dashboard_Summary cphost=$server$ | fillnull value="NA" mac_address| search user_name=$user_name$ AND mac_address=$mac_address$ | table session_id, _time, user_name, service_name, nas_ip, nas_port,  mac_address, login_status, req_source, service_name, alerts_present, conn_status, error_code
      </searchString>
    </table>
  </row>
  <row>
    <table>
      <title>RADIUS Session</title>
      <searchString>
        eventtype=cppm-radius CPPM_RADIUS_Session cphost=$server$ user_name=$user_name$ end_host_id=$mac_address$ $sstring$ | table session_id, _time, user_name, end_host_id, service_name, nas_ip, nas_port, auth_method, auth_source, error_code, request_status
      </searchString>
    </table>
  </row>
  <row>
    <table>
      <title>RADIUS Accounting</title>
      <searchString>
        eventtype=cppm-radius CPPM_RADIUS_Accounting cphost=$server$ user_name=$user_name$ ip_address=$ip_address$ nas_port_type=$nas_port_type$ $sstring$ | table session_id, seq_num, acct_session_id, _time, user_name, hostname, ip_address, nas_ip, nas_port, nas_port_type, called_station_id, calling_station_id, acct_status_type, acct_session_time, acct_delay_time, acct_input_octets, acct_input_packets, acct_output_octets, acct_output_packets
      </searchString>
    </table>
  </row>
  <row>
    <table>
      <title>RADIUS Accounting Detail</title>
      <searchString>
        eventtype=cppm-radius CPPM_RADIUS_Accounting_Detail cphost=$server$ $sstring$ | table session_id, acct_session_id, type, id,  attr_name, attr_value
      </searchString>
    </table>
  </row>
  <row>
    <table>
      <title>Endpoint Profiles</title>
      <searchString>
        eventtype=cppm CPPM_Endpoint_Profile cphost=$server$ hostname=$hostname$ mac_address=$mac_address$ $sstring$ | table _time, hostname, mac_address, ip_address, mac_vendor, static_ip, added_at,  updated_at, fingerprint, device_name, device_family, device_category
      </searchString>
    </table>
  </row>
  <row>
    <table>
      <title>Generic Query Output</title>
      <searchString>
        eventtype=cppm cphost=$server$ $sstring$ 
      </searchString>
    </table>
  </row>

</form>

