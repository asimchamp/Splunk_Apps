<form>
  <label>Endpoint Profiles</label>

  <fieldset autoRun="True" submitButton="true">
    <input type="time" searchWhenChanged="false">
      <default>
        <earliestTime>-60m@m</earliestTime>
        <latestTime>now</latestTime>
      </default>
    </input>
   <input type="dropdown" token="server">
      <label>ClearPass Server</label>
      <default>*</default>
      <choice value="*">All</choice>
      <populatingSearch fieldForValue="cphost" fieldForLabel="cphost">
        <![CDATA[eventtype=cppm | stats count by cphost]]>
      </populatingSearch>
    </input>
   <input type="dropdown" token="hostname">
      <label>Hostname</label>
      <default>*</default>
      <choice value="*">All</choice>
      <populatingSearch fieldForValue="hostname" fieldForLabel="hostname">
        <![CDATA[eventtype=cppm | stats count by hostname]]>
      </populatingSearch>
    </input>

    <input type="text" token="sstring" searchWhenChanged="true">
      <label>Search String ("*Apple*"):</label>
      <default>*</default>
    </input>

  </fieldset>
  
  <row>
    <table>
      <title>Endpoint Profiles</title>
      <searchString>
        eventtype=cppm CPPM_Endpoint_Profile cphost=$server$ hostname="$hostname$" $sstring$ | table hostname,device_category, device_family, device_name, mac_vendor, mac_address, fingerprint, static_ip
      </searchString>
    </table>
  </row>

  <row>
    <map>
      <title>Endpoint Locations</title>
      <searchString>
        eventtype=cppm CPPM_Endpoint_Profile cphost=$server$ hostname="$hostname$" $sstring$ | iplocation ip_address | search lat="*"| geostats count by hostname
      </searchString>
    </map>
  </row>

</form>



