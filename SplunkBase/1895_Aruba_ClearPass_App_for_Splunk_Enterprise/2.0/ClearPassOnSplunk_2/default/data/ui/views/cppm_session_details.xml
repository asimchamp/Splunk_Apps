<form>
  <label>Session Details</label>

  <fieldset autoRun="True" submitButton="true">
    <input type="time" searchWhenChanged="false">
      <default>
        <earliestTime>-60m@m</earliestTime>
        <latestTime>now</latestTime>
      </default>
    </input>
   <input type="dropdown" token="server">
      <label>ClearPass Server</label>
      <default>*</default>
      <choice value="*">All</choice>
      <populatingSearch fieldForValue="cphost" fieldForLabel="cphost">
        <![CDATA[eventtype=cppm | stats count by cphost]]>
      </populatingSearch>
    </input>
   <input type="dropdown" token="user_name">
      <label>Username</label>
      <default>*</default>
      <choice value="*">All</choice>
      <populatingSearch fieldForValue="user_name" fieldForLabel="user_name">
        <![CDATA[eventtype=cppm | stats count by user_name]]>
      </populatingSearch>
    </input>
  </fieldset>
  
  <row>
    <single>
      <searchString>
		eventtype=cppm CPPM_RADIUS_Session cphost=$server$ user_name=$user_name$ |stats dc(session_id)      
      </searchString>
      <option name="underLabel">Sessions </option>
    </single>
    <single>
      <searchString>
        eventtype=cppm-radius CPPM_RADIUS_Accounting cphost=$server$ user_name=$user_name$ acct_status_type="Start"  | stats count
      </searchString>
      <option name="underLabel">Accounting Started</option>
    </single>
    <single>
      <searchString>
        eventtype=cppm-radius CPPM_RADIUS_Accounting cphost=$server$ user_name=$user_name$ acct_status_type="Stop"  | stats count
      </searchString>
      <option name="underLabel">Accounting Stopped</option>
    </single>
    <single>
      <searchString>
        eventtype=cppm-radius CPPM_RADIUS_Accounting cphost=$server$ user_name=$user_name$ acct_input_octets="*" | stats sum(acct_input_octets) as inpb |eval inpmb=round(inpb/(1024*1024))|fields inpmb
      </searchString>
      <option name="underLabel">Input Volume MB</option>
    </single>    <single>
      <searchString>
        eventtype=cppm-radius CPPM_RADIUS_Accounting cphost=$server$ user_name=$user_name$ acct_input_octets="*" | stats sum(acct_output_octets) as inpb |eval inpmb=round(inpb/(1024*1024))|fields inpmb
      </searchString>
      <option name="underLabel">Output Volume MB</option>
    </single>
  </row>
  <row>
    <table>
      <title>Session Locations</title>
      <searchString>
        eventtype=cppm-radius CPPM_RADIUS_Session cphost=$server$ user_name=$user_name$ | iplocation end_host_id | table _time, session_id, user_name, City, Region, Country, end_host_id, error_code_str 
      </searchString>
    </table>
  </row>
  <row>
    <table>
      <title>Session Policy Details</title>
      <searchString>
        eventtype=cppm-radius CPPM_RADIUS_Session cphost=$server$ user_name=$user_name$ | table session_id, _time, user_name, service_name, auth_method, auth_source, end_host_id, error_code_str 
      </searchString>
    </table>
  </row>
  <row>
    <table>
      <title>Session Start/Stop</title>
      <searchString>
        eventtype=cppm-radius CPPM_RADIUS_Accounting cphost=$server$ user_name=$user_name$ (acct_status_type="Start" OR acct_status_type="Stop") | sort by session_id |  table session_id, _time, user_name, ip_address, acct_status_type, nas_port_type
      </searchString>
    </table>
  </row>
  <row>
    <table>
      <title>Session Usage </title>
      <searchString>
        eventtype=cppm-radius CPPM_RADIUS_Accounting cphost=$server$ user_name=$user_name$ acct_input_octets="*" | sort by session_id | table session_id, _time, user_name, ip_address, acct_input_octets, acct_output_octets
      </searchString>
    </table>
  </row>

</form>

