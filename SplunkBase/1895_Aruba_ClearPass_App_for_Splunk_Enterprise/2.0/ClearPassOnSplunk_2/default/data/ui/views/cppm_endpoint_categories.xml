<form>
  <label>Endpoint Categories</label>

  <fieldset autoRun="True" submitButton="false">
    <input type="time" searchWhenChanged="true">
      <default>
        <earliestTime>-60m@m</earliestTime>
        <latestTime>now</latestTime>
      </default>
    </input>
   <input type="dropdown" token="server">
      <label>ClearPass Server</label>
      <default>*</default>
      <choice value="*">All</choice>
      <populatingSearch fieldForValue="cphost" fieldForLabel="cphost">
        <![CDATA[eventtype=cppm | stats count by cphost]]>
      </populatingSearch>
    </input>
   <input type="dropdown" token="category">
      <label>Category</label>
      <default>*</default>
      <choice value="*">All</choice>
      <populatingSearch fieldForValue="device_category" fieldForLabel="device_category">
        <![CDATA[eventtype=cppm-device-category | stats count by device_category]]>
      </populatingSearch>
    </input>
   <input type="dropdown" token="family">
      <label>Family</label>
      <default>*</default>
      <choice value="*">All</choice>
      <populatingSearch fieldForValue="device_family" fieldForLabel="device_family">
        <![CDATA[eventtype=cppm-device-category | stats count by device_family]]>
      </populatingSearch>
    </input>
  
    <input type="text" token="endpoint_match" searchWhenChanged="true">
      <label>UserAgent (Model,OS Version):</label>
      <default>*</default>
    </input>

  </fieldset>
  
  <row>
    <chart>
      <title>All Device Categories</title>
      <searchString>
        eventtype=cppm-device-category cphost=$server$ | chart count by device_category 
      </searchString>
      <option name="charting.chart">pie</option>
    </chart>

    <chart>
      <title>Device Family by selected Category</title>
      <searchString>
        eventtype=cppm-device-category cphost=$server$ device_category="$category$" | chart count by device_family
      </searchString>
      <option name="charting.chart">pie</option>
    </chart>

    <chart>
      <title>Device Vendor by MACs in selected Category </title>
      <searchString>
        eventtype=cppm-device-category cphost=$server$ mac_vendor="*" device_category="$category$" | dedup mac_address | chart count by mac_vendor
      </searchString>
      <option name="charting.chart">pie</option>
    </chart>
  </row>
  <row>
    <table>
      <title>Endpoints Matching Category/Family/UserAgent</title>
      <searchString>
	eventtype=cppm-device-category cphost=$server$ device_category="$category$" device_family="$family$" fingerprint="*$endpoint_match$*"| dedup mac_address | table hostname,device_name,device_family,device_category,ip_address, mac_vendor
      </searchString>
    </table>
  </row>

</form>

