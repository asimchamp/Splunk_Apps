<form>
  <label>Compare NAS Devices</label>

  <fieldset autoRun="True">
    <input type="time">
      <default>
        <earliestTime>-60m@m</earliestTime>
        <latestTime>now</latestTime>
      </default>
    </input>

    <input type="checkbox" token="nas_ips">
      <label>NAS Devices</label>
      <delimiter> OR </delimiter>
      <valuePrefix>nas_ip=</valuePrefix>
      <prefix>(</prefix>
      <suffix>)</suffix>
      <populatingSearch fieldForValue="nas_ip" fieldForLabel="nas_ip">
        <![CDATA[eventtype=cppm | stats count by nas_ip]]>
      </populatingSearch>
    </input>
  </fieldset>
  
  <row>
    <chart>
      <title>Logins by NAS Devices</title>
      <searchTemplate>eventtype=cppm-authentication $nas_ips$ | stats count by nas_ip</searchTemplate>
      <option name="charting.chart">pie</option>
    </chart>

    <chart>
      <title>Failures by NAS Device</title>
      <searchTemplate>eventtype=cppm-fail-authentication $nas_ips$ | stats count by nas_ip</searchTemplate>
      <option name="charting.chart">pie</option>
    </chart>

    <chart>
      <title>Protocol by NAS Device</title>
      <searchTemplate>eventtype=cppm-pass-authentication $nas_ips$ | eval host_req=req_source +" Auth on "+ nas_ip | stats count by host_req </searchTemplate>
      <option name="charting.chart">bar</option>
    </chart>

    <table>
      <title>Services by NAS Device</title>
      <searchTemplate>eventtype=cppm-radius $nas_ips$ | stats count by nas_ip,service_name </searchTemplate>
      <option name="charting.chart">bar</option>
    </table>

  </row>
  <row>
    <table>
      <title>Auth Source by NAS Device</title>
      <searchTemplate>eventtype=cppm-radius $nas_ips$ | stats count by nas_ip, auth_source</searchTemplate>
      <option name="charting.chart">pie</option>
    </table>

    <table>
      <title>Auth Method by NAS Device</title>
      <searchTemplate>eventtype=cppm-radius $nas_ips$ | stats count by nas_ip, auth_method</searchTemplate>
      <option name="charting.chart">pie</option>
    </table>

    <chart>
      <title>NAS Port Type  by NAS Devices</title>
      <searchTemplate>eventtype=cppm-radius $nas_ips$ | eval port_type_req=nas_port_type +":"+ nas_ip  | stats count by port_type_req</searchTemplate>
      <option name="charting.chart">pie</option>
    </chart>

    <chart>
      <title>Service Type by NAS Devices</title>
      <searchTemplate>eventtype=cppm-radius $nas_ips$ | eval service_type_req=service_type +":"+ nas_ip | stats count by service_type_req</searchTemplate>
      <option name="charting.chart">pie</option>
    </chart>

    </row>

    <row>

    <chart>
      <title>ClearPass Servers by NAS Devices</title>
      <searchTemplate>eventtype=cppm-pass-authentication $nas_ips$ | dedup cphost | stats count by nas_ip</searchTemplate>
      <option name="charting.chart">pie</option>
    </chart>

    <chart>
      <title>Unique MACs by NAS Device</title>
      <searchTemplate>eventtype=cppm-pass-authentication $nas_ips$ | dedup mac_address | stats count by nas_ip</searchTemplate>
      <option name="charting.chart">pie</option>
    </chart>

    <chart>
      <title>Unique Users by NAS Device</title>
      <searchTemplate>eventtype=cppm-pass-authentication $nas_ips$ | dedup user_name | stats count by nas_ip</searchTemplate>
      <option name="charting.chart">pie</option>
    </chart>

  </row>


</form>
