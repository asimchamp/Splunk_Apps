<?xml version='1.0' encoding='utf-8'?>
<form>
  <label>Application Dashboard</label>  
  <fieldset>
    <input type="dropdown" token="application">   
      	<label>Select Application</label>
   	<populatingSearch fieldForValue="app" fieldForLabel="app">
     		<![CDATA[sourcetype="DASP4" | stats values(application) AS "app"]]>
  	 </populatingSearch>
    </input>    
    <input type="time" />
  </fieldset>
  <row>
    <chart>      
      <title>Application Traffic</title>
      <searchTemplate>sourcetype="DASP4" application=$application$| timechart eval(((sum(bytes_sent)+sum(bytes_received))/1000)) AS "kB"</searchTemplate>
      <option name="charting.chart">area</option>
      <option name="charting.primaryAxisTitle.text">Time</option>  
	  <option name="charting.secondaryAxisTitle.text">kB</option>	  
      <option name="charting.legend.placement">none</option>
    </chart>
    <chart>      
      <title>Application Response Time</title>
      <searchTemplate>sourcetype="DASP4" application=$application$ AND (HTTP_method="GET" OR HTTP_method="POST") AND HTTP_response_code="200" | timechart avg(eval(HTTP_response_time/1000)) AS "Response Time"</searchTemplate>
      <option name="charting.chart">column</option>
      <option name="charting.primaryAxisTitle.text">Time</option>      
      <option name="charting.secondaryAxisTitle.text">ms</option>
      <option name="charting.legend.placement">none</option>
    </chart>
  </row>
  <row>
    <chart>      
      <title>500 Errors</title>
      <searchTemplate>sourcetype="DASP4" application=$application$ AND HTTP_response_code="5*" | timechart count</searchTemplate>
      <option name="charting.chart">column</option>
      <option name="charting.primaryAxisTitle.text">Time</option>      
      <option name="charting.legend.placement">none</option>
    </chart>
    <table>      
      <title>Top 404 Error Pages</title>
      <searchTemplate>sourcetype="DASP4" application=$application$ AND HTTP_response_code="404" | stats count as number by URL | sort 10 -number</searchTemplate>
    </table>
  </row>
  <row>
    <chart>      
      <title>Number of Attacks</title>
      <searchTemplate>sourcetype="DASP4" application=$application$ AND (HTTP_response_code="407" OR HTTP_response_code="413" OR HTTP_response_code="400" OR HTTP_response_code="403" OR HTTP_response_code="406"  OR HTTP_response_code="408"  OR HTTP_response_code="409"  OR HTTP_response_code="414"  OR HTTP_response_code="417") | timechart count</searchTemplate>
      <option name="charting.chart">column</option>
      <option name="charting.primaryAxisTitle.text">Time</option>      
      <option name="charting.legend.placement">none</option>
    </chart>
    <chart>      
      <title>Origin of Attacks</title>
      <searchTemplate>sourcetype="DASP4" application=$application$ AND alert_id=4* | fields source_ip | iplocation | stats count(source_ip) AS "# Attacks" by Country</searchTemplate>
      <option name="charting.chart">pie</option>      
    </chart>      
      
  </row>
</form>
