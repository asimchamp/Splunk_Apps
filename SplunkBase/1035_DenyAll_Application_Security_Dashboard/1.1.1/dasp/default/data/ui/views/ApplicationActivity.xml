<?xml version='1.0' encoding='utf-8'?>
<form>
  <label>Activity Metrics</label>

  <fieldset>
    <input type="dropdown" token="application">
      	<label>Select Application</label>
   	<populatingSearch fieldForValue="app" fieldForLabel="app">
     		<![CDATA[sourcetype="DASP4" | where isnotnull(applicationID) | stats values(application) AS "app"]]>
  	 </populatingSearch>
    </input>
    <input type="time" />
  </fieldset>
  <row>
    <chart>
		<title>Traffic</title>
		<searchTemplate>sourcetype="DASP4" application="$application$" | timechart eval(((sum(bytes_sent)+sum(bytes_received))/1000)) AS "kB"</searchTemplate>
		<option name="charting.chart">area</option>
		<option name="charting.primaryAxisTitle.text">Time</option>
		<option name="charting.secondaryAxisTitle.text">kB</option>
		<option name="charting.legend.placement">none</option>
    </chart>
  </row>
  <row>
    <table>
		<title>Top 10 URLs</title>
		<searchTemplate>sourcetype="DASP4" application="$application$" | stats count AS "Number of Hits" by URL | sort 10 "Number of Hits" desc</searchTemplate>
    </table>
	<chart>
		<title>Application response time</title>
		<searchTemplate>sourcetype="DASP4" application="$application$" AND (HTTP_method="GET" OR HTTP_method="POST") AND HTTP_response_code="200" | timechart avg(eval(HTTP_response_time/1000)) AS "Response Time"</searchTemplate>
		<option name="charting.chart">column</option>
		<option name="charting.primaryAxisTitle.text">Time</option>
		<option name="charting.secondaryAxisTitle.text">ms</option>
		<option name="charting.legend.placement">none</option>
    </chart>
	</row>
	<row>
    <chart>
      <title>Top 10 Browsers</title>
      <searchTemplate>sourcetype="DASP4" application="$application$" | stats count AS "Number of Hits" by user_agent | sort 10 "Number of Hits" desc</searchTemplate>
      <option name="charting.chart">pie</option>
      <option name="charting.legend.placement">none</option>
    </chart>
	<table>
		<title>Sources per Country</title>
		<searchTemplate>sourcetype="DASP4" application="$application$" | fields source_ip | iplocation | stats count(source_ip) AS "# Hits" by Country</searchTemplate>
    </table>
  </row>
</form>
