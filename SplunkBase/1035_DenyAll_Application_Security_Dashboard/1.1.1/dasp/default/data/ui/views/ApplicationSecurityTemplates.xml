<?xml version='1.0' encoding='utf-8'?>
<form>
  <label>Security Dashboard</label>  
    
<searchTemplate>sourcetype="DASP4" application="$application$" AND (HTTP_response_code="407" OR HTTP_response_code="413" OR HTTP_response_code="400" OR HTTP_response_code="403" OR HTTP_response_code="406"  OR HTTP_response_code="408"  OR HTTP_response_code="409"  OR HTTP_response_code="414"  OR HTTP_response_code="417") | field + *</searchTemplate>
  
  <fieldset>
    <input type="dropdown" token="application">   
      	<label>Select Application</label>
   	<populatingSearch fieldForValue="app" fieldForLabel="app">
     		<![CDATA[sourcetype="DASP4" | stats values(application) AS "app"]]>
  	 </populatingSearch>
    </input>    
    <input type="time" />
  </fieldset>
  <row>    
    <chart>      
		<title>Attacks</title>
		<searchPostProcess>timechart count by alert_id</searchPostProcess>
		<option name="charting.chart">line</option>
		<option name="charting.primaryAxisTitle.text">Time</option> 
		<option name="charting.secondaryAxisTitle.text"># of Attacks</option>	
		<option name="charting.legend.placement">none</option>
    </chart>
  </row>
  <row>
    <table>      
		<title>Top 10 Targeted URLs</title>      
		<searchPostProcess> stats count AS "Number of Attacks" by URL | sort 10 "Number of Attacks" desc</searchPostProcess>
    </table>
    <chart>      
      <title>Top 10 Sources</title>
      <searchPostProcess>stats count AS "Number of Attacks" by source_ip | sort 10 "Number of Attacks" desc | rename "source_ip" AS "Source"</searchPostProcess>
      <option name="charting.chart">bar</option>      
      <option name="charting.legend.placement">none</option>
    </chart>    
  </row>
</form>
