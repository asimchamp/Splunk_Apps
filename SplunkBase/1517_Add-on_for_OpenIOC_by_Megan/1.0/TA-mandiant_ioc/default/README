Mandiant IOC Data Technology Add-on
----------------------------------------
        Author: Megan Carney (megan.carney@selectcomfort.com) (with lots of help from Clint Locker.  Thanks Clint!)
        Version/Date: 04/24/2013 
        Source type(s): 
           ioc:dns
           ioc:dnsissue
           ioc:cookie
           ioc:cookieissue
           ioc:filedownload
           ioc:filedownloadissue
           ioc:formhistory
           ioc:formhistoryissue
           ioc:urlhistory
           ioc:urlhistoryissue
           ioc:disks
           ioc:disksissue
           ioc:driversmodule
           ioc:driversmoduleissue
           ioc:driverssig
           ioc:driverssigissue
           ioc:eventlog
           ioc:eventlogissue
           ioc:hivelist
           ioc:hivelistissue
           ioc:kernelhooks
           ioc:kernelhooksissue
           ioc:arp
           ioc:arpissue
           ioc:route
           ioc:routeissue
           ioc:ports
           ioc:portsissue
           ioc:prefetch
           ioc:prefetchissue
           ioc:process
           ioc:processissue
           ioc:services
           ioc:servicesissue
           ioc:system
           ioc:systemissue
           ioc:systemrestore
           ioc:systemrestoreissue
           ioc:tasks
           ioc:tasksissue
           ioc:users
           ioc:usersissue
           ioc:volumes
           ioc:volumesissue
           ioc:scriptingpers
           ioc:scriptingpersissue
           ioc:apifiles
           ioc:apifilesissue
           ioc:rawfiles
           ioc:rawfilesissue
           ioc:registry
           ioc:registryissue

        Input requirements: Data needs to be source typed according to the platform that generated the data, as described below
        Has index-time operations: true, this TA must be deployed on indexers
        Supported product(s):
           Anything that creates correctly formatted IOC data

Using this Technology Add-on:
----------------------------------------
        Configuration: Manual
        Ports for automatic configuration: None
        Scripted input setup: Not applicable

        I highly recommend consulting the included example for inputs.conf.  I found that using the crcSalt designation was necessary to keep the smaller XML from throwing errors during processing.

        The source type must be assigned according to the file that sourced the data.  As that would be a long list, a sample inputs.conf has been included.  Any sourcetype that ends with 'issue' corresponds to the file that records any problems found when collecting that data.  For example, issues.mir.cookiehistory.2249751c.xml will hold records of any problems found while collecting the cookie history data.

Adding new IOC file collections:
----------------------------------------

        You'll probably find new sources you want to add.   For most sources, copying the props.conf stanza for ioc:dns and changing 'DnsEntryItem' to whatever the top-level tag in your file is will work.

        The iocHID transform will pull out any key-value pair in the XML defined like so "<key>value</key>.

        However, be careful that your XML doesn't contain any keys that will conflict with the builtin fields in splunk, i.e. index, source, etc.  In those cases, you will need to pull out those values and rename them to something that doesn't conflict, as I have done with the ioc:eventlogs input.

Fun searches:
----------------------------------------

Hosts that may have multiple winlogon processes:
name=winlogon.exe sourcetype=ioc:process | eval host_source = host."_".source | chart count by host_source | search count >1

Possibly hollowed processes (will need confirmation):
sourcetype=ioc:process NOT path=* NOT name=System | eval host_source = host."_".source | fields host_source,name | fields - _*
