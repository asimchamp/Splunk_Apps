[mark_host_down(1)]
args = server_name
definition = earliest=-1s | head 1 | eval server_name="$server_name$" | makemv server_name | mvexpand server_name | table server_name | append [ inputcsv server_down ] | dedup server_name | outputcsv server_down
iseval = 0

[mark_host_up(1)]
args = server_name
definition = earliest=-1s | head 1 | eval server_name="$server_name$" | makemv server_name | mvexpand server_name | table server_name | append [ inputcsv server_down ] | stats count by server_name | eval server_name=case(count = 2,null() , count=1,server_name) | table server_name | outputcsv server_down
iseval = 0
