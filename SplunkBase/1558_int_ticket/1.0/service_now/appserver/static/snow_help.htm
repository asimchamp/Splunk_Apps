<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <meta content="text/html; charset=ISO-8859-1"
      http-equiv="Content-Type">
    <title>Splunk&gt; for Service Now</title>
  </head>
  <body>
    <table bgcolor="#ffffff" border="0" cellpadding="0" cellspacing="0">
      <tbody>
        <tr>
          <td valign="top"><font face="Arial" size="-1"><font size="+1"><b>splunk<font
                    color="#c0c0c0">&gt;&nbsp;</font></b></font><br>
            </font> </td>
          <td valign="top"><font face="Arial" size="-1"><img
src="data:image/png;base64,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"
                alt=""></font></td>
        </tr>
      </tbody>
    </table>
    <font face="Arial" size="-1"><br>
      Author:&nbsp;&nbsp;&nbsp;&nbsp; Ron Naken (ron@splunk.com)<br>
      Copyright (c) 2011 Splunk Inc.&nbsp; All rights reserved.<br>
      <br>
      Splunk for ServiceNow adds a new search command -- <b>SNow</b> --
      to bring the full power of Splunk to ServiceNow.&nbsp; Query,
      insert, and aggregate your ServiceNow data through real-time,
      search-time queries that make direct API calls to Service
      Now.&nbsp; Empower Splunk to search the CMDB to ensure that
      critical configuration changes have a corresponding, approved
      change request, and file tickets in response to alert-generated
      events.&nbsp; And because the CMDB data is injected right into the
      search stream, as if ServiceNow was another index within Splunk,
      it is not necessary to index the data that '<b>snow</b>'
      returns.&nbsp; If you would like to index the data, consider
      sending the output to '<b>collect</b>', or use '<b>outputcsv</b>'
      or '<b>outputlookup</b>' to output text to a monitored file.<br>
      <br>
    </font>
    <hr size="2" width="100%"><font face="Arial"><b>SYNTAX</b></font><font
      face="Arial"><font size="-1"><br>
      </font></font>
    <blockquote><font face="Arial" size="-1">snow
        instance=&lt;instance&gt; request=&lt;request&gt;
        action=&lt;action&gt; [args] [filter=&lt;filter&gt;]
        [usenull=t|f] [_field=&lt;field&gt;] ([field=value])+<br>
      </font></blockquote>
    <font face="Arial" size="-1"><b>instance</b> - specifies the
      ServiceNow instance to access.&nbsp; In the URI, this represents
      '&lt;instance&gt;.service-now.com/'.<br>
      <b>request</b> - specifies the request page to access.&nbsp; In
      the URI, this represents '.../&lt;request&gt;.do'.<u><b><br>
        </b></u><b>action</b> - specifies the operation to
      perform.&nbsp; valid options are query, insert, aggregate.<br>
      <b>filter</b> - add a filter to use when executing a query.&nbsp;
      Separate multiple filters with a ';' or use an encoded
      query.&nbsp; Please consult the ServiceNow Wiki for assistance
      with __encoded_query syntax.&nbsp; The following are examples of
      filter use:<br>
    </font>
    <blockquote><font face="Arial" size="-1">Return records where
        category=hardware AND active=1:</font><font face="Arial"><br>
        <font size="-1"> |snow instance=demo014 request=incident
          action=query filter="category=hardware;active=1"</font><br>
      </font></blockquote>
    <blockquote><font face="Arial" size="-1"> Return records where
        category=inquiry OR category=software:</font><font face="Arial"><br>
        <font size="-1"> |snow instance=demo014 request=incident
          action=query
          __encoded_query="category=inquiry^ORcategory=software"</font><br>
      </font></blockquote>
    <blockquote><font face="Arial" size="-1"> Return records where
        notify=1 AND made_sla=0:</font><font face="Arial"><br>
        <font size="-1"> |snow instance=demo014 request=incident
          action=query __encoded_query="notify=1^made_sla=0"</font><br>
      </font></blockquote>
    <font face="Arial" size="-1"> </font><font face="Arial" size="-1"><font
        size="-1"><b>usenull</b> - (t/f) determines whether null or
        empty fields are returned in the results.&nbsp; Setting this
        value to 't' returns all fields of a record, including emptry
        fields.&nbsp; Defaults to 'f'; empty fields will not be returned
        in the search results.<br>
      </font></font>
    <blockquote><font face="Arial" size="-1"><font size="-1">|snow
          instance=demo014 request=incident action=query usenull=t</font></font><font
        face="Arial"><br>
      </font></blockquote>
    <font face="Arial" size="-1"><font size="-1"> </font><b>_field</b>
      - this optional parameter names a field whose value is a
      semi-colon-separated list of commands to append, allowing search
      to define or add <br>
      &nbsp;&nbsp;&nbsp; commands to be issued.&nbsp; For instance:<br>
    </font>
    <blockquote><font face="Arial" size="-1">... | eval
        myfield="instance=demo014;filter=category=software" |snow
        request=incident _field=myfield action=query</font><font
        face="Arial"><br>
      </font></blockquote>
    <font face="Arial" size="-1"> </font>
    <blockquote><font face="Arial" size="-1">This would cause the
        following command to be issued:&nbsp; |snow request=incident
        instance=demo014 action=query filter=category=software</font><font
        face="Arial"><br>
      </font></blockquote>
    <font face="Arial" size="-1"> You may also use the following <u>SPECIAL</u>
      parameters.&nbsp; Please consult the ServiceNow Wiki for
      assistance with these directives: <br>
      <br>
      &nbsp;&nbsp;&nbsp; __order_by, __order_by_desc, __exclude_columns,
      __limit, __first_row, __last_row, __use_view, __encoded_query<br>
      <br>
      Examples of SPECIAL parameters:<br>
    </font>
    <blockquote><font face="Arial" size="-1">|snow instance=demo014
        request=change_request action=query
        __encoded_query=category=software^ORcategory=hardware
        __first_row=0 __last_row=2</font><font face="Arial"><br>
        <font size="-1"> |snow instance=demo014 request=change_request
          action=query
          __encoded_query=category=software^ORcategory=hardware
          __limit=10</font><br>
      </font></blockquote>
    <font face="Arial" size="-1"> </font>
    <hr size="2" width="100%"><font face="Arial"><b>ADDITIONAL EXAMPLES</b></font><font
      face="Arial" size="-1"></font>
    <blockquote><font face="Arial" size="-1">Query a table:</font><br>
      <font face="Arial" size="-1"> |snow instance=demo014 request=table
        action=query table=cmdb_ci_server_list</font><br>
    </blockquote>
    <blockquote><font face="Arial" size="-1">File (Insert) an incident:</font><br>
      <font face="Arial" size="-1"> |snow instance=demo014
        request=incident action=insert short_description="Sample
        description" work_notes="Filed by Splunk."</font><br>
    </blockquote>
    <font face="Arial" size="-1"> </font>
    <blockquote><font face="Arial" size="-1">Insert a record into a
        table:</font><font face="Arial" size="-1"><br>
        |snow instance=demo014 request=table action=insert
        table=cmdb_ci_server_list name="Splunk-powered Server"
        company="ACME Africa" manufacturer="3Com"</font><br>
    </blockquote>
    <blockquote><font face="Arial" size="-1">Tables can also be accessed
        using shorthand syntax:</font><br>
      <font face="Arial"><font size="-1"><font size="-1"> |snow
            instance=demo014 request=</font></font><font size="-1"><font
            size="-1"><font size="-1"><font size="-1">cmdb_ci_server_list</font></font>
            action=query</font></font></font><br>
    </blockquote>
    <hr size="2" width="100%"><font face="Arial"><b>NOTES</b></font><font
      face="Arial"><br>
      <br>
      <font size="-1">NOTE:&nbsp; ServiceNow will return a maximum of
        250 records for any query.&nbsp; Use &lt;filter&gt; to narrow
        your results. <br>
        NOTE:&nbsp; <u>Aggregate</u> functions require the <u>Aggregate









          Web Services</u> plug-in for ServiceNow.&nbsp; To activate
        this plug-in, use the following procedure:<br>
      </font></font>
    <ol>
      <li><font face="Arial" size="-1">In the ServiceNow portal,
          navigate to System Definition--&gt;Plugins</font></li>
      <li><font face="Arial" size="-1">Right-click Aggregate Web Service
          and Activate it.</font></li>
    </ol>
    <font face="Arial" size="-1">Aggregate searches can be used, as
      follows -- please check the ServiceNow Wiki for information on
      aggregate syntax:<br>
    </font>
    <blockquote><font face="Arial" size="-1">|snow instance=demo014
        request=change_request action=aggregate
aggregate="count=number;min=priority;group_by=category;having=count^*^&gt;^2"<br>
      </font></blockquote>
    <font face="Arial" size="-1"> NOTE:&nbsp; If you receive blank
      events, the ServiceNow account may not have the required
      permissions to perform the SOAP operation.&nbsp; These issues<br>
      &nbsp;&nbsp;&nbsp; often present empty recordsets rather than
      error messages.<br>
      <br>
    </font>
    <hr size="2" width="100%"><b><font face="Arial">USER ACCESS to SOAP</font></b><font
      face="Arial" size="-1"><br>
      <br>
      If 'strict security' is enabled for SOAP requests, the user
      account Splunk uses to access ServiceNow will require permission
      to perform SOAP<br>
      operations on table and field values.&nbsp; This setting, and its
      supporting documentation, can be found in the ServiceNow portal:<br>
      <br>
      &nbsp;&nbsp;&nbsp; System Security--&gt;High Security
      Settings--&gt;Enforce strict security on incoming SOAP requests.<br>
      <br>
    </font>
    <hr size="2" width="100%"><b><font face="Arial">ROLES</font></b><font
      face="Arial" size="-1"><br>
      <br>
      The user account used to access ServiceNow will also need to be
      added to the proper role.&nbsp; Respective SOAP operations may
      require the following<br>
      roles:&nbsp; soap, soap_query, soap_create, and soap_update.<br>
      <br>
    </font>
    <hr size="2" width="100%"><font face="Arial"><b>SECURITY</b></font><font
      face="Arial" size="-1"><br>
      <br>
      Username and password can be stored for each of your instances in
      /local/_passwd_.conf, allowing you to control access to the
      credentials through<br>
      file system permissions.&nbsp; The format of this file is as
      follows:<br>
    </font>
    <blockquote><font face="Arial" size="-1"> [myinstance]</font><br>
      <font face="Arial" size="-1"> username = &lt;username&gt;</font><br>
      <font face="Arial" size="-1"> password = &lt;password&gt;</font><br>
    </blockquote>
    <font face="Arial" size="-1"><font face="Arial" size="-1">A
        [default] stanza can be created to provide default credentials
        for use when no stanza is defined for an instance.&nbsp; </font>Username







      and password can also be passed through the search command, as in
      the following example:<br>
    </font>
    <blockquote><font face="Arial" size="-1">|snow instance=demo014
        request=incident action=query username=admin password=admin</font><br>
    </blockquote>
    <font face="Arial" size="-1"><br>
    </font>
    <hr size="2" width="100%"><b><font face="Arial">ALERTS</font></b><font
      face="Arial" size="-1"><br>
      <br>
      A sample alert script is provided as a working example to file a
      ticket as an alert action.&nbsp; The sample uses the "Work Notes"
      field of an incident to provide a link to the search
      results.&nbsp; This script can be found here:</font><br>
    <blockquote><font face="Arial" size="-1"><font face="Arial"
          size="-1">$SPLUNK_HOME/etc/apps/service_now/bin/scripts/snow_alert.sh</font></font><br>
    </blockquote>
    <br>
    <font face="Arial" size="-1"> </font>
    <blockquote> </blockquote>
    <blockquote> </blockquote>
  </body>
</html>
