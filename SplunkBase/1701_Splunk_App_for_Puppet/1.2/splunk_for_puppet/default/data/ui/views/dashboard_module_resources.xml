<form script="link_switcher.js, autodiscover.js, table_data_bar.js" stylesheet="table_data_bar.css, single_decorations.css">
  <label>Module / Resources</label>
  <description>The puppet module/resource activities</description>
    <fieldset autoRun="true" submitButton="false">
     <input type="dropdown" token="module" searchWhenChanged="true">
       <label>Select a Module:</label>
        <populatingSearch fieldForValue="Module" fieldForLabel="Module" earliest="$time1.earliest$" latest="$time1.latest$">
          <![CDATA[index=* puppet-agent ((daemon.notice OR daemon.info) main changed NOT "is changed") OR ((daemon.error OR daemon.warning) main) | rex field=_raw "(\]\/)(?<Module>[^\/\[]*)" | dedup Module]]>
        </populatingSearch>
      </input>
	  <input type="time" token="time1" searchWhenChanged="true">
        <label>Select a time:</label>
			<default>Today</default>
	  </input>
    </fieldset>
    <row grouping="4,5">
        <html>
            <h2>Puppet Message</h2>
            <div class="link-switcher" data-items="table9,table10,table11"></div>
        </html>
        <table id="table9">
            <title>error</title>
            <searchString>index="*" puppet-agent ((daemon.notice OR daemon.info) main changed NOT "is changed") OR ((daemon.error OR daemon.warning) main) | rex field=_raw "(\]\/)(?&lt;Module&gt;[^\/\[]*)" | rex field=_raw "\(\/.+\)\s(?&lt;Message&gt;[\w\s]+)" | rex field=_raw "\ID\s\d+\s\w+\.(?&lt;Level&gt;\w+)\]" | rex field=_raw "\/Stage\[main\]\/[^\/\[]*\/(?&lt;Resource&gt;[\/a-zA-Z\d\_\-\.\:\[\s]+\])" | where Module="$module$" | where Level="error" | table Message, Level</searchString>
			<earliestTime>$time1.earliest$</earliestTime>
			<latestTime>$time1.latest$</latestTime>
            <option name="wrap">true</option>
            <option name="rowNumbers">true</option>
            <option name="dataOverlayMode">none</option>
            <option name="drilldown">none</option>
            <option name="count">10</option>
        </table>
        <table id="table10">
            <title>warning</title>
            <searchString>index="*" puppet-agent ((daemon.notice OR daemon.info) main changed NOT "is changed") OR ((daemon.error OR daemon.warning) main) | rex field=_raw "(\]\/)(?&lt;Module&gt;[^\/\[]*)" | rex field=_raw "\(\/.+\)\s(?&lt;Message&gt;[\w\s]+)" | rex field=_raw "\ID\s\d+\s\w+\.(?&lt;Level&gt;\w+)\]" | rex field=_raw "\/Stage\[main\]\/[^\/\[]*\/(?&lt;Resource&gt;[\/a-zA-Z\d\_\-\.\:\[\s]+\])" | where Module="$module$" | where Level="warning" | table Message, Level</searchString>
			<earliestTime>$time1.earliest$</earliestTime>
			<latestTime>$time1.latest$</latestTime>
            <option name="wrap">true</option>
            <option name="rowNumbers">true</option>
            <option name="dataOverlayMode">none</option>
            <option name="drilldown">none</option>
            <option name="count">10</option>
        </table>
        <table id="table11">
            <title>notice</title>
            <searchString>index="*" puppet-agent ((daemon.notice OR daemon.info) main changed NOT "is changed") OR ((daemon.error OR daemon.warning) main) | rex field=_raw "(\]\/)(?&lt;Module&gt;[^\/\[]*)" | rex field=_raw "\(\/.+\)\s(?&lt;Message&gt;[\w\s]+)" | rex field=_raw "\ID\s\d+\s\w+\.(?&lt;Level&gt;\w+)\]" | rex field=_raw "\/Stage\[main\]\/[^\/\[]*\/(?&lt;Resource&gt;[\/a-zA-Z\d\_\-\.\:\[\s]+\])" | where Module="$module$" | where Level="notice" | table Message, Level</searchString>
			<earliestTime>$time1.earliest$</earliestTime>
			<latestTime>$time1.latest$</latestTime>
            <option name="wrap">true</option>
            <option name="rowNumbers">true</option>
            <option name="dataOverlayMode">none</option>
            <option name="drilldown">none</option>
            <option name="count">10</option>
        </table>
        <html>
            <h2>Puppet Resources Detail</h2>
            <div class="link-switcher" data-items="table6,table4,table5,table7"></div>
        </html>
        <table id="table6">
          <title>Failed</title>
            <searchString>index=* puppet-agent daemon.error main | rex field=_raw "(\]\/)(?&lt;Module&gt;[^\/\[]*)" | rex field=_raw "\/Stage\[main\]\/[^\/\[]*\/(?&lt;Resource&gt;[\/a-zA-Z\d\_\-\.\:\[\s]+\])" | where Module="$module$" | table host, Resource | rename host as "Puppet Agent"</searchString>
			<earliestTime>$time1.earliest$</earliestTime>
			<latestTime>$time1.latest$</latestTime>
            <option name="wrap">true</option>
            <option name="rowNumbers">true</option>
            <option name="dataOverlayMode">none</option>
            <option name="drilldown">none</option>
            <option name="count">10</option>
        </table>
        <table id="table4">
          <title>Skipped</title>
            <searchString>index=* puppet-agent daemon.warning main "Skipping because of failed dependencies" | rex field=_raw "(\]\/)(?&lt;Module&gt;[^\/\[]*)" | rex field=_raw "\/Stage\[main\]\/[^\/\[]*\/(?&lt;Resource&gt;[\/a-zA-Z\d\_\-\.\:\[\s]+\])" | where Module="$module$" | table host, Resource | rename host as "Puppet Agent"</searchString>
			<earliestTime>$time1.earliest$</earliestTime>
			<latestTime>$time1.latest$</latestTime>
            <option name="wrap">true</option>
            <option name="rowNumbers">true</option>
            <option name="dataOverlayMode">none</option>
            <option name="drilldown">none</option>
            <option name="count">10</option>
        </table>
        <table id="table5">
          <title>Applied</title>
            <searchString>index=* puppet-agent (daemon.notice OR daemon.info) main changed | rex field=_raw "(\]\/)(?&lt;Module&gt;[^\/\[]*)" | rex field=_raw "\/Stage\[main\]\/[^\/\[]*\/(?&lt;Resource&gt;[\/a-zA-Z\d\_\-\.\:\[\s]+\])" | where Module="$module$" | table host, Resource | rename host as "Puppet Agent"</searchString>
			<earliestTime>$time1.earliest$</earliestTime>
			<latestTime>$time1.latest$</latestTime>
            <option name="wrap">true</option>
            <option name="rowNumbers">true</option>
            <option name="dataOverlayMode">none</option>
            <option name="drilldown">none</option>
            <option name="count">10</option>
        </table>
        <table id="table7">
          <title>Restarted</title>
            <searchString>index=* puppet-agent (daemon.notice OR daemon.info) main "refresh of service" | rex field=_raw "(\]\/)(?&lt;Module&gt;[^\/\[]*)" | rex field=_raw "\/Stage\[main\]\/[^\/\[]*\/(?&lt;Resource&gt;[\/a-zA-Z\d\_\-\.\:\[\s]+\])" | where Module="$module$" | table host, Resource | rename host as "Puppet Agent"</searchString>
			<earliestTime>$time1.earliest$</earliestTime>
			<latestTime>$time1.latest$</latestTime>
            <option name="wrap">true</option>
            <option name="rowNumbers">true</option>
            <option name="dataOverlayMode">none</option>
            <option name="drilldown">none</option>
            <option name="count">10</option>
        </table>      
    </row>
    <row>
        <table id="table1">
          <title>Module's Error/Warning</title>
            <searchString>index="*" puppet-agent (daemon.error OR daemon.warning) main | rex field=_raw "(\]\/)(?&lt;Module&gt;[^\/\[]*)" | top limit=100 Module | rename count as "Resource"</searchString>
			<earliestTime>$time1.earliest$</earliestTime>
			<latestTime>$time1.latest$</latestTime>
            <option name="wrap">true</option>
            <option name="rowNumbers">true</option>
            <option name="dataOverlayMode">none</option>
            <option name="drilldown">none</option>
            <option name="count">10</option>
        </table>
        <table id="table2">
            <title>Module's Activity</title>
            <searchString>index="*" puppet-agent (daemon.notice OR daemon.info) main changed NOT "is changed" | rex field=_raw "(\]\/)(?&lt;Module&gt;[^\/\[]*)" | top limit=100 Module | rename count as "Resource"</searchString>
			<earliestTime>$time1.earliest$</earliestTime>
			<latestTime>$time1.latest$</latestTime>
            <option name="wrap">true</option>
            <option name="rowNumbers">true</option>
            <option name="dataOverlayMode">none</option>
            <option name="drilldown">none</option>
            <option name="count">10</option>
        </table>
		<table id="table8">
          <title>Puppet Resources</title>
            <searchString>index=* puppet-agent daemon.warning main "Skipping because of failed dependencies" | eval Resource="Skipped" | append [search index=* puppet-agent daemon.error main | eval Resource="Failed"] | append [search index=* puppet-agent (daemon.notice OR daemon.info) main "refresh of service" | eval Resource="Restarted"] | append [search index=* puppet-agent (daemon.notice OR daemon.info) main changed | eval Resource="Applied"] | top limit=100 Resource | rename count as "Total"</searchString>
			<earliestTime>$time1.earliest$</earliestTime>
			<latestTime>$time1.latest$</latestTime>
            <option name="wrap">true</option>
            <option name="rowNumbers">true</option>
            <option name="dataOverlayMode">none</option>
            <option name="drilldown">none</option>
            <option name="count">10</option>
        </table>
    </row>
</form>