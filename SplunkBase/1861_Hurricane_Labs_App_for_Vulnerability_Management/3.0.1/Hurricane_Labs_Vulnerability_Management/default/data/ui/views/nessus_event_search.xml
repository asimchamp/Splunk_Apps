<form script="checkbox_input.js, multi_value_token.js" stylesheet="multi_token.css">
  <label>Nessus Event Search</label>
  <searchTemplate>index="nessus" sourcetype="nessus*" Host="$_host$" Risk=$multiTokenQuery$ CVE="$_cve$" Name="*"</searchTemplate>
  <earliestTime>-30d</earliestTime>
  <latestTime>now</latestTime>
  <fieldset autoRun="true" submitButton="false">
    <input type="time" searchWhenChanged="true">
      <default>
        <earliestTime>-30d@d</earliestTime>
        <latestTime>now</latestTime>
      </default>
    </input>
    <input type="dropdown" token="_host" searchWhenChanged="true">
      <label>Host</label>
      <populatingSearch earliest="$earliest$" latest="$latest$" fieldForLabel="dest" fieldForValue="dest">sourcetype=nessus_vuln cve="$_cve$" | stats count by dest</populatingSearch>
      <default>*</default>
      <choice value="*">Any</choice>
    </input>
    <input type="dropdown" token="_cve" searchWhenChanged="true">
      <label>CVE</label>
      <populatingSearch earliest="$earliest$" latest="$latest$" fieldForLabel="cve" fieldForValue="cve">sourcetype=nessus_vuln cve=* dest="$_host$" | makemv delim="," cve | mvexpand cve | stats count by cve</populatingSearch>
      <default>*</default>
      <choice value="*">Any</choice>
    </input>
    <html>
      <label>Filter by Risk:</label>
      <div id="risk_event"/>
    </html>
  </fieldset>
  <row>
    <panel>
      <table>
        <title>Matching Events</title>
        <searchString>sourcetype=nessus_vuln dest="$_host$" vendor_severity=$multiTokenQuery$ | dedup dest,dest_port,signature_id| makemv delim="," cve | mvexpand cve | search cve="$_cve$" | mvcombine delim="," cve | eval dest_port=if(dest_port==0, "N/A", dest_port) | sort -severity_id dest | table dest,dest_port,vendor_severity,signature_id,signature,vendor_solution,cve | rename dest as Host,dest_port as Port,vendor_severity as Severity,signature_id as "Plugin ID",signature as Signature,vendor_solution as "Recommended Solution",cve as CVE</searchString>
        <earliestTime>$earliest$</earliestTime>
        <latestTime>$latest$</latestTime>
        <option name="charting.axisLabelsX.majorLabelStyle.overflowMode">ellipsisNone</option>
        <option name="charting.axisLabelsX.majorLabelStyle.rotation">0</option>
        <option name="charting.axisTitleX.visibility">visible</option>
        <option name="charting.axisTitleY.visibility">visible</option>
        <option name="charting.axisTitleY2.visibility">visible</option>
        <option name="charting.axisX.scale">linear</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.axisY2.enabled">false</option>
        <option name="charting.axisY2.scale">inherit</option>
        <option name="charting.chart">column</option>
        <option name="charting.chart.nullValueMode">gaps</option>
        <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
        <option name="charting.chart.stackMode">default</option>
        <option name="charting.chart.style">shiny</option>
        <option name="charting.drilldown">all</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
        <option name="charting.legend.placement">right</option>
        <option name="list.drilldown">full</option>
        <option name="list.wrap">1</option>
        <option name="maxLines">5</option>
        <option name="raw.drilldown">full</option>
        <option name="rowNumbers">false</option>
        <option name="table.drilldown">all</option>
        <option name="table.wrap">1</option>
        <option name="type">list</option>
        <option name="wrap">true</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">cell</option>
        <option name="count">10</option>
      </table>
    </panel>
  </row>
</form>