<view autoCancelInterval="90" isVisible="true" onunloadCancelJobs="true" template="dashboard.html" isSticky="False">
    <label>Edit Host metrics</label>
    <module name="AccountBar" layoutPanel="appHeader" />
    <module name="AppBar" layoutPanel="appHeader" />

<!--
  <module name="GenericFTR" layoutPanel="viewHeader">
      <param name="configLink">/app/extrahop_metrics/setup</param>
  </module>
  -->
    <module name="SideviewUtils" layoutPanel="appHeader" />
    <module name="Message" layoutPanel="messaging">
        <param name="filter">*</param>
        <param name="maxSize">2</param>
        <param name="clearOnJobDispatch">False</param>
    </module>
    <module name="URLLoader" layoutPanel="panel_row1_col1" autoRun="True">
        <module name="HTML">
            <param name="html">
                <![CDATA[ 
                        <table border=0 cellpadding=2>
    <tr><td><b>Node:</b></td>
        <td><b   id="oid" value="$oid$" ><font color="red">$name$</font></b></td></tr>
    <tr><td><b>Metric Type: </b></td>
    <td><b  id="metric_type" value="$mt$"><font color="red">$mt$</font></b></td></tr>
    <tr>
    <td><b>Device:</b></td>
    <td><b id="device" value="$device$" ><font color="red">$device$</font></b></td></tr></table>
                        
                        <br><br>
                                    <input type="checkbox" name="delete" id="delete_device_type">Delete this Device Type and associated metrics for this Node? <hr> ]]>
</param>
        </module>
        <module name="Search" group="Metric Types">
            <param name="search"><![CDATA[
            | inputlookup ehm_selected_metrics.csv
            | where (oid="$oid$" AND metric_type="$mt$" and device="$device$")
            | makemv delim="," metric
            | mvexpand metric
            | rex field=metric "(?<met>^.*):.*"
            | sort metric met a
            ]]>
            </param>
            <module name="Pulldown">
                <param name="size">10</param>
                <param name="template">$value$</param>
                <param name="separator">,</param>
                <param name="outerTemplate">"$value$"</param>
                <param name="name">Metrics</param>
                <param name="label">Current Metrics</param>
                <param name="searchFieldsToDisplay">
                    <list>
                        <param name="label">met</param>
                        <param name="value">metric</param>
                    </list>
                </param>
                <param name="staticFieldsToDisplay" />
            </module>
            <module name="HTML">
                <param name="html">
                    <![CDATA[ <img src="/static/app/extrahop_metrics/left_arrow.jpg" width="30" height="30"  class="left_arrow" onclick="addMetric();" > <br><br> 
<img src="/static/app/extrahop_metrics/right_arrow.jpg" width="30" height="30"  class="right_arrow" onclick="removeMetric();" > ]]>
</param>
            </module>
            <module name="Search" group="Metric Types" autoRun="False">
                <param name="search">
                    <![CDATA[
                    | inputlookup "$mt$_lookup.csv"
                    | where device="$device$"
                    | where NOT [| inputlookup ehm_selected_metrics.csv
                    | where (oid=$oid$ AND device="$device$")
                    | makemv delim="," metric
                    | mvexpand metric
                    | rex field=metric "(?<metric>^.*):.*"
                    | fields device,device_type,metric,type]
                    | eval mt=metric+":"+type
                    | sort metric mt a
                    ]]>
                </param>
                <module name="Pulldown">
                    <param name="size">10</param>
                    <param name="template">$value$</param>
                    <param name="separator">,</param>
                    <param name="outerTemplate">"$value$"</param>
                    <param name="name">Metrics</param>
                    <param name="label">Additional Metrics</param>
                    <param name="searchFieldsToDisplay">
                        <list>
                            <param name="label">metric</param>
                            <param name="value">mt</param>
                        </list>
                    </param>
                    <param name="staticFieldsToDisplay" />
                </module>
                <module name="HTML">
                    <param name="html">
                        <![CDATA[
                            <br><br>
                            <b>Selected metric(s) is/are:</b> <ul id="metrics_display">$Metrics_Display$</ul>
                            <input type="hidden" id="metrics" value="$Metrics$">
                            <input type="hidden" id="device" value="$Device Type$">
                            <input type="button" value="Update" class="myUpdateButton splButton-primary" onclick="updateHandler();">
						]]>
                    </param>
                </module>
            </module>
        </module>
    </module>
</view>
