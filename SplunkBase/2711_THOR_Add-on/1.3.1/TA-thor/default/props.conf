[thor]
TIME_PREFIX=^
MAX_TIMESTAMP_LOOKAHEAD=25
EXTRACT-name = NAME: (?P<name>[^ ]+)
EXTRACT-module = MODULE: (?P<module>[^ ]+)
EXTRACT-message = MESSAGE: (?P<message>.+?)(\s+[A-Z_]+:\s+|$)
EXTRACT-encrypted = ENCRYPTED: (?<encrypted>.*)
EXTRACT-info = MESSAGE: (?P<info>(Thor Version:|Spark Version:|Results:|Scan took|Spark scan finished) .*)
EXTRACT-mainreason = REASON_1: (?P<mainreason>.*?)( REASON|$)
EXTRACT-md5 = MD5: (?P<md5>[^ ]+)
EXTRACT-score = SCORE: (?P<score>[0-9]+)
EXTRACT-user = USER: (?P<user>.*?) [A-Z]{3,}:
EXTRACT-system_txt = \s(?P<system>[^\/\s:]+) [A-Z][a-z]+: MODULE:
EXTRACT-system = (?P<system>[^ ]+)\/(?P<system_ip>[^ ]+) (THOR|SPARK)[^\s]*:
EXTRACT-key = KEY: (?P<key>.*?) [A-Z]{3,}:
EXTRACT-value = VALUE: (?P<value>.*?) [A-Z]{3,}:
EXTRACT-level = (THOR|SPARK)[^\s]*: (?P<level>(Alert|Alarm|Warning|Notice|Info|Debug|Error)):
EXTRACT-file = FILE: (?P<file>.*?)(\s+[A-Z_]+:\s+|$)
EXTRACT-desription = DESC: (?P<description>.*?) [A-Z_]{3,}:
EXTRACT-pattern = PATTERN: (?P<pattern>.*?) [A-Z_]{3,}:
EXTRACT-date = DATE: (?P<date>.*?) [A-Z_]{3,}:
EXTRACT-entry = (EVENT|ENTRY): (?P<entry>.*)
EXTRACT-location = LOCATION: (?P<location>.*?) [A-Z]{3,}:
EXTRACT-command = COMMAND: (?P<command>.*?) [A-Z]{3,}:
EXTRACT-matching_strings = MATCHING_STRINGS:[\s]+(?P<matching_strings>S1: .*)
EXTRACT-rule = YARA Score Rule Match NAME: (?P<rule>.*?) [A-Z]{3,}:
EXTRACT-fields = (?<_KEY_1>[A-Z_0-9]+): (?<_VAL_1>.*?)(?= [A-Z_0-9]+:|$)
EXTRACT-event = ( THOR:| SPARK:| [0-9]{4}\-[0-9]{2}\-[0-9]{2} [0-9][0-9]:[0-9][0-9]:[0-9][0-9] [^\s]+) (?<event>.*)$
SHOULD_LINEMERGE = false
pulldown_type = true

FIELDALIAS-thor_score = score AS severity_id
FIELDALIAS-thor_message = message AS signature
FIELDALIAS-thor_module = module AS category
FIELDALIAS-thor_system1 = system AS dest
FIELDALIAS-thor_system2 = system AS dvc
FIELDALIAS-thor_rule = rule AS tag
FIELDALIAS-thor_uid = uid AS xref

LOOKUP-thor_level_to_severity = thor_severity_lookup level