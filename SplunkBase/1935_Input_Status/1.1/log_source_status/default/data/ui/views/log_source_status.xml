<form>
  <label>Log Sources</label>
  <description></description>
  <fieldset>
    <input type="checkbox" token="index" searchWhenChanged="true">
      <label>Index</label>
      <search>
        <query>| inputlookup statefile.csv | stats count by index</query>
      </search>
      <delimiter> OR </delimiter>
      <default>main</default>
      <fieldForLabel>index</fieldForLabel>
      <fieldForValue>index</fieldForValue>
      <prefix>(</prefix>
      <suffix>)</suffix>
      <valuePrefix>index="</valuePrefix>
      <valueSuffix>"</valueSuffix>
    </input>
    <input type="time" submitButton="false">
      <default>
        <earliestTime>-13h@h</earliestTime>
        <latestTime>now</latestTime>
      </default>
    </input>
  </fieldset>
  <row grouping="2,2">
    <single id="error_number_source">
      <title>Number of Errors - Source</title>
      <searchTemplate>| inputlookup statefile.csv | search $index$ Status=Error | stats dc(source) as unique | rangemap field=unique elevated=10-30 low=0-29 default=severe</searchTemplate>
    </single>
    <single id="most_recent_source">
      <title>Most Recent Error - Source</title>
      <searchTemplate>| inputlookup statefile.csv | search $index$ Status=Error | stats last(source) as last</searchTemplate>
    </single>
    <single id="error_number_host">
      <title>Number of Errors - Host</title>
      <searchTemplate>| inputlookup statefile.csv | search $index$ Status=Error | stats dc(host) as unique | rangemap field=unique elevated=10-30 low=0-29 default=severe</searchTemplate>
    </single>
    <single id="most_recent_host">
      <title>Most Recent Error - Host</title>
      <searchTemplate>| inputlookup statefile.csv | search $index$ Status=Error | stats last(host) as last</searchTemplate>
    </single>
  </row>
  <row>
    <panel id="current_device_state">
      <table>
	  <title>Log Source Status</title>
        <searchTemplate>| tstats max(_time) as _time, count where $index$ by host , source, index | inputlookup append=t statefile.csv | search $index$ | stats max(_time) as _time by host, source, index | eval Status=if(now()-43200&gt;_time, "Error", "Success") | sort Status, _time</searchTemplate>
        <option name="wrap">true</option>
        <option name="rowNumbers">false</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">cell</option>
        <option name="count">20</option>
      </table>
    </panel>
    <panel id="current_device_errors">
      <table>
	  <title>Non-Reporting Devices</title>
        <search>
          <query>| inputlookup statefile.csv | search $index$ | eval _time=strftime(_time, "%H:%M:%S, %Y-%m-%d") | rename _time AS "Last Event Time" | where (Status="Error")</query>
        </search>
        <option name="wrap">true</option>
        <option name="rowNumbers">false</option>
        <option name="dataOverlayMode">heatmap</option>
        <option name="drilldown">cell</option>
        <option name="count">20</option>
      </table>
    </panel>
  </row>
</form>