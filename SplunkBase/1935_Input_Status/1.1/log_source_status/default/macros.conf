
[device_state_update(1)]
args = indexes
definition = | tstats max(_time) as _time, count where index=$indexes$ by host,source | inputlookup append=t statefile.csv | stats max(_time) as _time by host, source | eval Status=if(now()-43200>_time, "Error", "Success") | sort Status, _time | outputlookup statefile.csv
iseval = 0


[device_state_alert(1)]
args = index
definition = | inputlookup statefile.csv | search index=$index$ | eval _time=strftime(_time, "%H:%M:%S, %Y-%m-%d") | rename _time AS "Last Event Time" | where (Status="Error")
iseval = 0
