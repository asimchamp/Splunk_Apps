### Barracuda - WAF Reports ###

[Traffic Over Wafs]
search = sourcetype="access" | eval bandwidth=round(bytes_sent/1024,2) | stats sum(bandwidth) BY unit_name| rename sum(bandwidth) AS "Bandwidth(in KB)"

[Attacks Over Wafs]
search = sourcetype="firewall" Attack_Description!=NULL |stats count by unit_name| rename count AS "# of Attacks"

[Errors Over Wafs]
search = sourcetype="access" HTTP_Status="404" OR HTTP_Status="500" OR HTTP_Status="503" |stats count BY unit_name| rename count AS "# of Errors"

[RBA Activity Over Wafs]
search = sourcetype="audit" (Transaction_Type = LOGIN OR Transaction_Type ="UNSUCCESSFUL_LOGIN") | eval success=if (Transaction_Type=="LOGIN",1,0)| eval fail=if(Transaction_Type=="UNSUCCESSFUL_LOGIN",1,0)| stats sum(success) as "# Successful Logins" sum(fail) as "# Unsuccessful Logins" by unit_name

[Audited Transaction Types]
search = sourcetype="audit" Transaction_Type !=NULL Transaction_Type != 0| stats count by unit_name| rename count AS "# of Transactions" 

### unitname from Logs ###

[AUDIT_search]
search = sourcetype="audit" Transaction_Type != NULL | chart count over unit_name

[WF_search]
search = sourcetype="firewall" | chart count over unit_name

[TR_search]
search = sourcetype="access" | chart count over unit_name

[NF_search]
#search = sourcetype="nw_firewall"|rex field=_raw ".*\s\d{2}:\d{2}:\d{2}\s(?<unit_name>\S+)\s\d{4}-\d{2}-\d{2}.*$" | chart count over unit_name
search = sourcetype="nw_firewall" | chart count over unit_name

[SYS_search]
search = sourcetype="system" | chart count over unit_name
