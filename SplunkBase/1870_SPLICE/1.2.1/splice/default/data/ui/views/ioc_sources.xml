<dashboard>
  <label>IOC Sources</label>
  <description>Splunk Indicators of Compromise Engine</description>
  <row>
    <panel>
      <table>
        <title>Alerts by IOC Source (last 30 days)</title>
        <searchString>index=ioc_search_results | rename ioc_source_stanza as "IOC Source" |top "IOC Source" percentfield=Percent countfield=Count| eval Percent=round(Percent,2)</searchString>
        <earliestTime>-30d@d</earliestTime>
        <latestTime>now</latestTime>
        <option name="wrap">true</option>
        <option name="rowNumbers">false</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">row</option>
        <option name="count">10</option>
      </table>
    </panel>
    <panel>
      <table>
        <title>Total Indicators by IOC Source (last 30 days)</title>
        <searchString>| iocfilter regex=".*"  ignorecase=True | eval stanza_name=replace(stanza_name, "^ioc://", "") | eval stanza_name=replace(stanza_name, "^taxii://", "") |  rename stanza_name as "IOC Source" |top "IOC Source" percentfield=Percent countfield=Count| eval Percent=round(Percent,2)</searchString>
        <earliestTime>-30d@d</earliestTime>
        <latestTime>now</latestTime>
        <option name="wrap">true</option>
        <option name="rowNumbers">false</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">row</option>
        <option name="count">10</option>
      </table>
    </panel>
  </row>
</dashboard>
