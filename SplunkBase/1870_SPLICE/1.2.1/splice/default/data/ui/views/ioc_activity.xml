<dashboard>
  <label>IOC Alerts</label>
  <description>Splunk Indicators of Compromise Engine</description>
  <row>
    <panel>
      <table>
        <title>Most Recent Matched Indicators (last 24 hours)</title>
        <searchString>index=ioc_search_results | eval "Time Detected"=strftime(_time, "%m/%d/%y %I:%M:%S.%3Q %p")  | rename indicator_id as "Indicator ID" indicator_value_type as "Indicator Type" orig_sourcetype as "Matching Sourcetype" indicator_raw_id as "(splice indicator id)"|table "Time Detected", "Indicator Type", "Matching Sourcetype","Indicator ID","(splice indicator id)"</searchString>
        <earliestTime>-24h@h</earliestTime>
        <latestTime>now</latestTime>
        <option name="wrap">true</option>
        <option name="rowNumbers">false</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">row</option>
        <option name="count">10</option>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <table>
        <title>Indicators with Multiple Matches (last 24 hours)</title>
        <searchString>index=ioc_search_results | eval indicator_id=if(indicator_id=="null", "None", indicator_id)| rename indicator_id as "Indicator ID" indicator_raw_id as "(splice indicator id)"|rename indicator_value_type as "Indicator Type"|stats count by "Indicator ID" "Indicator Type" "(splice indicator id)"| search count&gt;1 | sort -count | table "Indicator ID", "Indicator Type", "(splice indicator id)",  count</searchString>
        <earliestTime>-24h@h</earliestTime>
        <latestTime>now</latestTime>
        <option name="wrap">true</option>
        <option name="rowNumbers">false</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">row</option>
        <option name="count">10</option>
      </table>
    </panel>
  </row>
</dashboard>
