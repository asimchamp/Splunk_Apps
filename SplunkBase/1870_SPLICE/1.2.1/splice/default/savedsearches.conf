[ioc_default_search_ipv4-addr]
disabled = 0
userid = admin

description = default search ipv4-addr addresses in src_ip and dest_ip fields. Executed every hour plus 10 minutes on the last hour.
search = earliest=@h-1h latest=@h src_ip=* OR dest_ip=* | sort _time|iocsearch map="src_ip:ipv4-addr,dest_ip:ipv4-addr" | search ioc_indicators_count>0 | `parse_ioc_indicators_json`| rename _raw as raw_ | eval orig_event_time=_time | eval orig_event_time_formatted=strftime(_time, "%m/%d/%y %I:%M:%S.%3Q %p") | collect index=ioc_search_results addtime=false marker="marker=\"ioc_default_search_ipv4-addr\""

enableSched = 1
cron_schedule = 10 * * * *

counttype = number of events
relation = greater than 
quantity = 0

alert.track = 1
alert.digest_mode = False
alert.suppress = 0
action.email.inline = 1
action.rss = 1
auto_summarize.dispatch.earliest_time = -1d@h

[ioc_default_search_ipv6-addr]
disabled = 0
userid = admin

description = default search ipv6-addr addresses in src_ip and dest_ip fields. Executed every hour plus 10 minutes on the last hour.
search = earliest=@h-1h latest=@h src_ip=* OR dest_ip=* | sort _time|iocsearch map="src_ip:ipv6-addr,dest_ip:ipv6-addr" | search ioc_indicators_count>0 | `parse_ioc_indicators_json`| rename _raw as raw_ | eval orig_event_time=_time | eval orig_event_time_formatted=strftime(_time, "%m/%d/%y %I:%M:%S.%3Q %p") | collect index=ioc_search_results addtime=false marker="marker=\"ioc_default_search_ipv6-addr\""

enableSched = 1
cron_schedule = 10 * * * *

counttype = number of events
relation = greater than 
quantity = 0

alert.track = 1
alert.digest_mode = False
alert.suppress = 0
action.email.inline = 1
action.rss = 1
auto_summarize.dispatch.earliest_time = -1d@h

[ioc_default_search_url]
disabled = 0
userid = admin

description = default search URL in url field. Executed every hour plus 10 minutes on the last hour.
search = earliest=@h-1h latest=@h url=* | sort _time|iocsearch map="url:url" | search ioc_indicators_count>0 | `parse_ioc_indicators_json`| rename _raw as raw_ | eval orig_event_time=_time | eval orig_event_time_formatted=strftime(_time, "%m/%d/%y %I:%M:%S.%3Q %p") | collect index=ioc_search_results addtime=false marker="marker=\"ioc_default_search_url\""

enableSched = 1
cron_schedule = 10 * * * *

counttype = number of events
relation = greater than 
quantity = 0

alert.track = 1
alert.digest_mode = False
alert.suppress = 0
action.email.inline = 1
action.rss = 1
auto_summarize.dispatch.earliest_time = -1d@h

[ioc_default_search_domain]
disabled = 0
userid = admin

description = default search domain in domain field. Executed every hour plus 10 minutes on the last hour.
search = earliest=@h-1h latest=@h domain=* | sort _time |iocsearch map="domain:domain" | search ioc_indicators_count>0 | `parse_ioc_indicators_json`| rename _raw as raw_ | eval orig_event_time=_time | eval orig_event_time_formatted=strftime(_time, "%m/%d/%y %I:%M:%S.%3Q %p") | collect index=ioc_search_results addtime=false marker="marker=\"ioc_default_search_domain\""

enableSched = 1
cron_schedule = 10 * * * *

counttype = number of events
relation = greater than 
quantity = 0

alert.track = 1
alert.digest_mode = False
alert.suppress = 0
action.email.inline = 1
action.rss = 1
auto_summarize.dispatch.earliest_time = -1d@h

[ioc_default_search_filename]
disabled = 0
userid = admin

description = default search filename in file_name field. Executed every hour plus 10 minutes on the last hour.
search = earliest=@h-1h latest=@h file_name=* | sort _time|iocsearch map="file_name:filename" | search ioc_indicators_count>0 | `parse_ioc_indicators_json`| rename _raw as raw_ | eval orig_event_time=_time | eval orig_event_time_formatted=strftime(_time, "%m/%d/%y %I:%M:%S.%3Q %p") | collect index=ioc_search_results addtime=false marker="marker=\"ioc_default_search_filename\""

enableSched = 1
cron_schedule = 10 * * * *

counttype = number of events
relation = greater than 
quantity = 0

alert.track = 1
alert.digest_mode = False
alert.suppress = 0
action.email.inline = 1
action.rss = 1
auto_summarize.dispatch.earliest_time = -1d@h

[ioc_default_search_hash]
disabled = 0
userid = admin

description = default search file_hash in hash field. Executed every hour plus 10 minutes on the last hour.
search = earliest=@h-1h latest=@h file_hash=* | sort _time|iocsearch map="file_hash:hash" | search ioc_indicators_count>0 | `parse_ioc_indicators_json`| rename _raw as raw_ | eval orig_event_time=_time | eval orig_event_time_formatted=strftime(_time, "%m/%d/%y %I:%M:%S.%3Q %p") | collect index=ioc_search_results addtime=false marker="marker=\"ioc_default_search_hash\""

enableSched = 1
cron_schedule = 10 * * * *

counttype = number of events
relation = greater than 
quantity = 0

alert.track = 1
alert.digest_mode = False
alert.suppress = 0
action.email.inline = 1
action.rss = 1
auto_summarize.dispatch.earliest_time = -1d@h
