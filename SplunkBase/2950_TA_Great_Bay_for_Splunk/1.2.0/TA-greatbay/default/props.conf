## Uncomment the folloing lines if your data is already collected and the sourcetype is syslog
#[syslog]
#TRANSFORMS-set_greatbay_st = audit_override, beacon_override

[greatbay:audit]
NO_BINARY_CHECK = true
category = Custom
disabled = false
pulldown_type = true
EXTRACT-srcip = (Beacon|Great_Bay_)Audit: (?P<src_ip>\d+\.\d+\.\d+\.\d+)
EXTRACT-audit = ^(?:[^ \n]*\s+){5}(?P<vendor_mode>[r|w|x]) (?P<user>[^()]+)\((?P<user_id>\d+)\) (?P<action>[^ ]+) (?P<object>[^ ]+)(\s+(?P<object_attrs>.+))?
## If your Splunk is adding another timestamp header, use the following line:
#EXTRACT-audit = ^(?:[^ \n]*\s+){8}(?P<vendor_mode>[r|w|x]) (?P<user>[^()]+)\((?P<user_id>\d+)\) (?P<action>[^ ]+) (?P<object>[^ ]+)(\s+(?P<object_attrs>.+))?

LOOKUP-mode = mode vendor_mode  OUTPUT mode
TZ = UTC

[greatbay:beacon]
NO_BINARY_CHECK = true
SHOULD_LINEMERGE = false
category = Custom
pulldown_type = true
#TRANSFORMS-set_audit_st = audit_override, beacon_override
EXTRACT-beacon = ^\w+  ?\d+ \d\d:\d\d:\d\d (?P<dvc>\w+|) ?(beacon|Great_Bay)\[(?P<process_id>\d+)\]: (?P<beacon_type>.+?)(?P<duplicate_details>(#.+)*). Event Name: \[(?P<event_name>[^\]]+)] Switch/port: (?P<switch_ip_address>[^\s]+)\((?P<switch_port_index>.+)\) Profile: \((?P<current_profile>[^\)]+)\) MAC: \((?P<mac_address>[\w:-]+)\) Old Profile: \((?P<previous_profile>(\(null\)|[^\)]+))\) End node: (?P<endpoint_mac_address>[\w:-]+)\((?P<endpoint_ip_address>[\w\.]+)\) 
## If your Splunk is adding another timestamp header, use the following line:
#EXTRACT-beacon = ^(?:[^ \n]*\s+){4}\w+\s+\d+ \d\d:\d\d:\d\d (beacon|Great_Bay)\[(?P<process_id>\d+)\]: (?P<beacon_type>[^\.]+). Event Name: \[(?P<event_name>[^\]]+)] Switch/port: (?P<switch_ip_address>[\w\.]+)\((?P<switch_port_index>\d+)\) Profile: \((?P<current_profile>[^\)]+)\) MAC: \((?P<mac_address>[\w:]+)\) Old Profile: \((?P<previous_profile>.+)\) End node: (?P<endpoint_mac_address>[\w:]+)\((?P<endpoint_ip_address>[\w\.]+)\)
TZ = UTC
