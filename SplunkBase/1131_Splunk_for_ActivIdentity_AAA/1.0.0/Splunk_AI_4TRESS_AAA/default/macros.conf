########################
#
# Base Macros
#
########################

[ai_4tress_aaa]
definition = sourcetype="ai_4tress_aaa"

[ai_4tress_aaa_auth]
definition = sourcetype="ai_4tress_aaa_auth"

[ai_4tress_aaa_audit]
definition = sourcetype="ai_4tress_aaa_audit"

########################
#
# DataCube Macros
#
########################

[ActivIdentity-Authentication-DataCube]
definition =`ai_4tress_aaa_auth` | bin _time span=5m | fillnull server serverIP userID group nasIP info1 info2 status reason |stats count by server serverIP userID group nasIP info1 info2 status reason _time

[ActivIdentity-Audit-DataCube]
definition =`ai_4tress_aaa_audit` | bin _time span=5m | fillnull userID object object_name operation operation_detail parameter1 parameter2 parameter3 parameter4 | stats count by  userID object object_name operation operation_detail parameter1 parameter2 parameter3 parameter4 _time

########################
#
# AUTHENTICATION
#
########################

[AI-Authentication-DataCube-Status-Count-by-Time]
definition = search (status!=0 and status!="Status") | timechart count by status

[AI-Authentication-DataCube-Radius-Count-by-Time]
definition = search (serverIP!=0 and serverIP!="Server IP Address") | timechart count by serverIP

[AI-Authentication-DataCube-NASIP-Count-by-Time]
definition = search (nasIP!=0 and nasIP!="NAS IP Address") | timechart count by nasIP

[AI-Authentication-DataCube-Top-Radius-Server-Request]
definition = search (serverIP!=0 and serverIP!="Server IP Address") | stats count by serverIP

[AI-Authentication-DataCube-Top-UserID-Request]
definition = search (userID!="UserID") | stats count by userID

[AI-Authentication-DataCube-Top-Group-Request]
definition = search group!="Group" | stats count by group

[AI-Authentication-DataCube-Status-Request]
definition =  search (status!=0 and status!="Status") | stats count by status

[AI-Authentication-DataCube-Activity]
definition = search (userID!="UserID") | stats count by _time, server serverIP userID group nasIP info1 info2 status reason  | sort -_time

########################
#
# AUDIT
#
########################

[AI-Audit-DataCube-Operation-Detail-by-Time]
definition = search (operation_detail!=0 and operation_detail!="Operation detail") | timechart count by operation_detail

[AI-Audit-DataCube-Operation-by-Time]
definition = search (operation!=0 and operation!="Operation") | timechart count by operation

[AI-Audit-DataCube-User-by-Time]
definition = search userID!="UserID" | timechart count by userID

[AI-Audit-DataCube-Operation-by-Request]
definition = search  (operation!=0 and operation!="Operation") | stats count by operation

[AI-Audit-DataCube-Operation-Detail-by-Request]
definition = search  (operation_detail!=0 and operation_detail!="Operation detail") | stats count by operation_detail

[AI-Audit-DataCube-User-by-Request]
definition = search  userID!="UserID" | stats count by userID

[AI-Audit-DataCube-Activity]
definition = search (userID!="UserID") | stats count by _time, userID object object_name operation operation_detail parameter1 parameter2 parameter3 parameter4  | sort -_time

