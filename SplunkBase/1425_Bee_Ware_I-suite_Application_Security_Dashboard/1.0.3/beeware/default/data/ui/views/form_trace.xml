<?xml version='1.0' encoding='utf-8'?>
<form>
  <label>IP trace</label>
  	<searchTemplate>sourcetype=beeware AND (icx_src_ip = "$ip_trace$" OR users_src_ip = "$ip_trace$") | fields users_authresult users_username bw_ibox_name users_src_ip iam_target iam_result iam_username bw_log_source bw_log_class bw_eventlogs_class _time icx_src_ip icx_trap icx_target_url bw_tunnel_name</searchTemplate>    
    <fieldset autoRun="false">
        <input type="text" token="ip_trace">
            <label> enter an IP address or network address with cidr </label>
</input>

        <input type="time">
      <default>Last 4 hours</default>
    </input>
  </fieldset>

  <row>
    <table>
      <searchPostProcess> search bw_log_source != "Event Logs" bw_log_class=BLOCKED OR (bw_log_class="BLOCKED INTERNAL" AND bw_eventlogs_class!="HEADER*") | table _time icx_src_ip bw_tunnel_name icx_trap icx_target_url | rename  icx_src_ip as "source ip" bw_tunnel_name as tunnel icx_trap as "attack" icx_target_url as "target url"</searchPostProcess> 
        <option name="count">10</option>
      <title>attacks logs</title>
    </table>
  </row>

  <row>
    <table>
      <searchPostProcess> search bw_log_source != "Event Logs" bw_log_class = IAM | table _time icx_src_ip iam_target iam_result iam_username | rename iam_target as target iam_result as message iam_username as username icx_src_ip as "source ip"</searchPostProcess> 
        <option name="count">10</option>
      <title>IAM authentications logs</title>
    </table>
  </row>

  <row>
    <table>
      <searchPostProcess> search bw_eventlogs_class="USERS" | table _time users_src_ip bw_ibox_name users_username users_authresult </searchPostProcess> 
        <option name="count">10</option>
      <title>Management authentications logs</title>
    </table>
  </row>


</form>