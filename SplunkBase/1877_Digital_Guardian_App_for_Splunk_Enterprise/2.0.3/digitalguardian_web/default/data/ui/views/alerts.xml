<form script="summary_alerts.js, tagmanager.js" stylesheet="custom.css, tagmanager.css, dashboard.css">
  <label>Alerts Overview</label>
  <fieldset submitButton="false" autoRun="true">
    <input type="text" token="wildcard" searchWhenChanged="true">
      <label>Wildcard Search</label>
      <default>*</default>
      <prefix>*</prefix>
      <suffix>*</suffix>
      <initialValue>*</initialValue>
    </input>
    <input type="time" id="timerange" token="time" searchWhenChanged="true">
      <label>Time Range</label>
      <default>
        <earliest>-7d@d</earliest>
        <latest>now</latest>
      </default>
    </input>
  </fieldset>
  <search id="baseAlertSearch">
   <query>index=`index_macro` sourcetype=`alerts_sourcetype` $wildcard$ | fields * </query>
   <earliest>$time.earliest$</earliest>
   <latest>$time.latest$</latest>
  </search>
  <row>
      <panel>
        <html>
          <div class="panel-body">
              <div class="filter_tags" style="float:left">
                  <h6>Filter Criteria:</h6>
                  <input id="filter_tags_input" type="text"/>
              </div>
          </div>
        </html>
      </panel>
  </row>
  <row>
    <panel>
      <chart id="alerts_by_day">
        <title>Alerts By Day</title>
        <search base="baseAlertSearch">
          <query> bucket _time span=1h  | stats dc(Alert_ID) as Alert count(Alert_ID) as Details by _time Severity Rule Application Operation Computer_Name User_Name Policy | timechart sum(Alert) as count by Severity</query>
            <earliest>$time.earliest$</earliest>
            <latest>$time.latest$</latest>
        </search>
        <option name="charting.chart">line</option>
        <option name="charting.axisTitleX.text">Time</option>
      </chart>
    </panel>
  </row>
  <row>
    <panel>
      <table id="top_10_operations">
        <title>Top Operations</title>
        <search base="baseAlertSearch">
          <query> search $filter$ | search $exclude$ | bucket _time span=1h  | stats dc(Alert_ID) as Alert count(Alert_ID) as Details by _time Severity Rule Application Operation Computer_Name User_Name Policy | stats sum(Alert) as Alerts sum(Details) as "Alert Details" by Operation | sort - "Alert Details" | head 10</query>
        </search>
      </table>
    </panel>
    <panel>
      <table id="top_10_applications">
        <title>Top Applications</title>
        <search base="baseAlertSearch">
          <query> search $filter$ | search $exclude$ | stats sum(Alert) as Alerts sum(Details) as "Alert Details" by Application | sort - "Alert Details" | head 10</query>
        </search>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <table id="top_10_computers">
        <title>Top Computers</title>
        <search base="baseAlertSearch">
          <query> search $filter$ | search $exclude$ | stats sum(Alert) as Alerts sum(Details) as "Alert Details" by Computer_Name | sort - "Alert Details" | head 10</query>
        </search>
      </table>
    </panel>
    <panel>
      <table id="top_10_users">
        <title>Top Users</title>
        <search base="baseAlertSearch">
          <query> search $filter$ | search $exclude$ | stats sum(Alert) as Alerts sum(Details) as "Alert Details" by User_Name | sort - "Alert Details" | head 10</query>
        </search>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <table id="top_10_rules">
        <title>Top Rules</title>
        <search base="baseAlertSearch">
          <query> search $filter$ | search $exclude$ | stats sum(Alert) as Alerts sum(Details) as "Alert Details" by Rule | sort - "Alert Details" | head 10</query>
        </search>
      </table>
    </panel>
    <panel>
      <table id="top_10_policies">
        <title>Top Policies</title>
        <search base="baseAlertSearch">
          <query> search $filter$ | search $exclude$ | stats sum(Alert) as Alerts sum(Details) as "Alert Details" by Policy | sort - "Alert Details" | head 10</query>
        </search>
      </table>
    </panel>
  </row>
</form>
