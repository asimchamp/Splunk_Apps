<form script="summary_events.js, tagmanager.js" stylesheet="custom.css, tagmanager.css, dashboard.css">
  <label>Events Overview</label>
  <fieldset submitButton="false" autoRun="true">
    <input type="text" token="wildcard" searchWhenChanged="true">
      <label>Wildcard Search</label>
      <default>*</default>
      <prefix>*</prefix>
      <suffix>*</suffix>
      <initialValue>*</initialValue>
    </input>
    <input type="radio" token="rules" searchWhenChanged="true">
      <label>Was Rule Violation?</label>
      <choice value="True">Yes</choice>
      <choice value="False">No</choice>
      <choice value="*">Both</choice>
      <default>*</default>
      <initialValue>*</initialValue>
      <prefix>"</prefix>
      <suffix>"</suffix>
    </input>
    <input type="radio" token="classified" searchWhenChanged="true">
      <label>Was Classified?</label>
      <choice value="True">Yes</choice>
      <choice value="False">No</choice>
      <choice value="*">Both</choice>
      <default>*</default>
      <prefix>"</prefix>
      <initialValue>*</initialValue>
      <suffix>"</suffix>
    </input>
    <input type="time" id="timerange" token="time" searchWhenChanged="true">
      <label>Time Range</label>
      <default>
        <earliest>-7d@d</earliest>
        <latest>now</latest>
      </default>
    </input>
  </fieldset>
  <search id="baseEventSearch">
   <query> index=`index_macro` sourcetype=`events_sourcetype` $wildcard$ $filter$ $exclude$ | bucket _time span=1h | stats dc(Event_ID) as count by _time Computer_Name User_Name Application Operation Was_Classified Was_Rule_Violation Source_Directory Destination_Directory Source_File_Extension Computer_Type</query>
   <earliest>$time.earliest$</earliest>
   <latest>$time.latest$</latest>
  </search>
  <search id="baseFileSearch">
   <query> index=`index_macro` sourcetype=`events_sourcetype` NOT Source_File_Extension="" $wildcard$ $filter$ $exclude$ | stats dc(Event_ID) as Count sum(Detail_File_Size) as Size by Source_File_Extension Was_Classified Was_Rule_Violation Computer_Name User_Name Application Operation Source_Directory Destination_Directory | eval Size=Size/1024/1024</query>
   <earliest>$time.earliest$</earliest>
   <latest>$time.latest$</latest>
  </search>
  <row>
    <panel>
      <html>
        <div class="panel-body">
            <div class="filter_tags" style="float:left">
                <h6>Filter Criteria:</h6>
                <input id="filter_tags_input" type="text"/>
            </div>
        </div>
      </html>
    </panel>
  </row>
  <row>
    <panel>
      <chart id="events_by_hour_day">
        <title>Events by Hour/Day</title>
        <search base="baseEventSearch">
          <query>search Was_Classified=$classified$ | search Was_Rule_Violation=$rules$ | search  $filter$ | search $exclude$ | timechart sum(count) as count by Computer_Type</query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="charting.chart">line</option>
        <option name="charting.axisTitleX.text">Time</option>
      </chart>
    </panel>
  </row>
  <row>
    <panel>
      <chart id="top_10_computers">
        <title>Top 10 Computers</title>
        <search base="baseEventSearch">
          <query>search Was_Classified=$classified$ | search Was_Rule_Violation=$rules$ | search $filter$ | search $exclude$ |stats sum(count) as count by Computer_Name | sort - count | head 10</query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="charting.chart">bar</option>
      </chart>
    </panel>
    <panel>
      <chart id="top_10_users">
        <title>Top 10 Users</title>
        <search base="baseEventSearch">
          <query>search Was_Classified=$classified$ | search Was_Rule_Violation=$rules$ | search $filter$ | search $exclude$ |stats sum(count) as count by User_Name | sort - count | head 10</query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="charting.chart">bar</option>
      </chart>
    </panel>
  </row>
  <row>
    <panel>
      <chart id="top_10_applications">
        <title>Top 10 Applications</title>
        <search base="baseEventSearch">
          <query>search Was_Classified=$classified$ | search Was_Rule_Violation=$rules$ | search $filter$ | search $exclude$ |stats sum(count) as count by Application | sort - count | head 10</query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
          <option name="charting.chart">bar</option>
        </search>
      </chart>
    </panel>
    <panel>
      <chart id="top_10_operations">
        <title>Top 10 Operations</title>
        <search base="baseEventSearch">
          <query>search Was_Classified=$classified$ | search Was_Rule_Violation=$rules$ | search $filter$ | search $exclude$ |stats sum(count) as count by Operation | sort - count | head 10</query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="charting.chart">bar</option>
      </chart>
    </panel>
  </row>
  <row>
    <panel>
      <chart id="top_10_source_directories">
        <title>Top 10 Source Directories</title>
        <search base="baseEventSearch">
          <query>search Was_Classified=$classified$ | search Was_Rule_Violation=$rules$ | search $filter$ | search $exclude$ |stats sum(count) as count by Source_Directory | sort - count | head 10</query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="charting.chart">bar</option>
      </chart>
    </panel>
    <panel>
      <chart id="top_10_destination_directories">
        <title>Top 10 Destination Directories</title>
        <search base="baseEventSearch">
          <query>search Was_Classified=$classified$ | search Was_Rule_Violation=$rules$ | search $filter$ | search $exclude$ |stats sum(count) as count by Destination_Directory | sort - count | head 10</query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="charting.chart">bar</option>
      </chart>
    </panel>
  </row>
  <row>
    <panel>
      <chart id="top_10_extensions_count">
        <title>Top 10 Extensions by Count</title>
        <search base="baseFileSearch">
          <query>search Was_Classified=$classified$ | search Was_Rule_Violation=$rules$ | search $filter$ | search $exclude$ | stats sum(Count) as Count sum(Size) as Size by Source_File_Extension | sort - Size | head 10</query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="charting.chart">column</option>
      </chart>
    </panel>
    <panel>
      <chart id="top_10_extensions_size">
        <title>Top 10 Extensions by Size</title>
        <search base="baseFileSearch">
          <query>search Was_Classified=$classified$ | search Was_Rule_Violation=$rules$ | search $filter$ | search $exclude$ | stats sum(Count) as Count sum(Size) as Size by Source_File_Extension | sort - Count | head 10</query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
      </chart>
      <option name="charting.chart">column</option>
    </panel>
  </row>
</form>
