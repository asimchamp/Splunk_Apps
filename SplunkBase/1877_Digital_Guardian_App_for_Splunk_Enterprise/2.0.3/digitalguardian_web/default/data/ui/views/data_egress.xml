<form script="summary_data_egress.js, tagmanager.js" stylesheet="custom.css, tagmanager.css, dashboard.css">
  <label>Data Egress Overview</label>
  <fieldset submitButton="false" autoRun="true">
    <input type="text" token="wildcard" searchWhenChanged="true">
      <label>Wildcard Search</label>
      <default>*</default>
      <prefix>*</prefix>
      <suffix>*</suffix>
      <initialValue>*</initialValue>
    </input>
    <input type="radio" token="rules" searchWhenChanged="true">
      <label>Was Rule Violation?</label>
      <choice value="True">Yes</choice>
      <choice value="False">No</choice>
      <choice value="*">Both</choice>
      <default>*</default>
      <initialValue>*</initialValue>
    </input>
    <input type="radio" token="classified" searchWhenChanged="true">
      <label>Was Classified?</label>
      <choice value="True">Yes</choice>
      <choice value="False">No</choice>
      <choice value="*">Both</choice>
      <default>*</default>
      <prefix>"</prefix>
      <suffix>"</suffix>
      <initialValue>*</initialValue>
    </input>
    <input type="time" id="timerange" token="time" searchWhenChanged="true">
      <label>Time Range</label>
      <default>
        <earliest>-7d@d</earliest>
        <latest>now</latest>
      </default>
    </input>
  </fieldset>
  <search id="baseEventSearch">
   <query> index=`index_macro` sourcetype=`events_sourcetype` eventtype="egress_*" $wildcard$ | stats dc(Event_ID) as events count by eventtype User_Name Computer_Name Application Was_Classified Was_Rule_Violation | search eventtype="egress_*" | eval Channel = mvindex(split(eventtype,"_"),1)</query>
   <earliest>$time.earliest$</earliest>
   <latest>$time.latest$</latest>
  </search>
  <row>
      <panel>
        <html>
          <div class="panel-body">
              <div class="filter_tags" style="float:left">
                  <h6>Filter Criteria:</h6>
                  <input id="filter_tags_input" type="text"/>
              </div>
          </div>
        </html>
      </panel>
    </row>
    <row>
      <panel>
        <chart id="data_egress_by_channel">
          <title>Data Egress By Channel</title>
          <search base="baseEventSearch">
            <query> search $filter$ | search Was_Classified=$classified$ | search Was_Rule_Violation=$rules$ | search $exclude$ | stats sum(events) as Events sum(count) as "Event Details" by Channel</query>
            <earliest>$time.earliest$</earliest>
            <latest>$time.latest$</latest>
          </search>
          <option name="charting.chart">bar</option>
        </chart>
      </panel>
    </row>
    <row>
      <panel>
        <table id="top_10_users">
          <title>Top Users</title>
          <search base="baseEventSearch">
            <query>search $filter$ | search Was_Classified=$classified$ | search Was_Rule_Violation=$rules$ | search $exclude$ | stats sum(events) as Events sum(count) as "Event Details" by  User_Name | head 10 | sort - Events</query>
            <earliest>$time.earliest$</earliest>
            <latest>$time.latest$</latest>
          </search>
        </table>
      </panel>
      <panel>
        <table id="top_10_computers">
          <title>Top Machines</title>
          <search base="baseEventSearch">
            <query>search $filter$ | search Was_Classified=$classified$ | search Was_Rule_Violation=$rules$ | search $exclude$ | stats sum(events) as Events sum(count) as "Event Details" by   Computer_Name | head 10 | sort - Events</query>
            <earliest>$time.earliest$</earliest>
            <latest>$time.latest$</latest>
          </search>
        </table>
      </panel>
      <panel>
        <table id="top_10_applications">
          <title>Top Applications</title>
          <search base="baseEventSearch">
            <query>search Was_Classified=$classified$ | search Was_Rule_Violation=$rules$ | search $filter$ | search $exclude$ | stats sum(events) as Events sum(count) as "Event Details" by Application | head 10 | sort - Events</query>
            <earliest>$time.earliest$</earliest>
            <latest>$time.latest$</latest>
          </search>
        </table>
      </panel>
    </row>
  </form>
