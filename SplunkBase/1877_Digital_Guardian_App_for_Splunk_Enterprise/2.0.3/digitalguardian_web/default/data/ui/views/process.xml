<form script="summary_process.js, tagmanager.js" stylesheet="custom_process.css, tagmanager.css, dashboard.css">
  <label>Process Overview</label>
  <fieldset submitButton="false" autoRun="true">
    <input type="text" token="wildcard" searchWhenChanged="true">
      <label>Wildcard Search</label>
      <default>*</default>
      <prefix>*</prefix>
      <suffix>*</suffix>
      <initialValue>*</initialValue>
    </input>
    <input type="time" id="timerange" token="time" searchWhenChanged="true">
      <label>Time Range</label>
      <default>
        <earliest>-7d@d</earliest>
        <latest>now</latest>
      </default>
    </input>
  </fieldset>
  <search id="baseProcessSearch">
   <query>index=`index_macro` sourcetype=`process_sourcetype` $wildcard$ | stats count by Application MD5_Hash Application_Directory Company_Name Product_Name Product_Version</query>
   <earliest>$time.earliest$</earliest>
   <latest>$time.latest$</latest>
  </search>
  <search id="baseOffHours">
   <query><![CDATA[index=`index_macro` sourcetype=`process_sourcetype` (date_hour < 8 OR date_hour >= 18) $wildcard$ | fields * ]]> </query>
   <earliest>$time.earliest$</earliest>
   <latest>$time.latest$</latest>
  </search>
    <row>
        <panel>
          <html>
            <div class="panel-body">
                <div class="filter_tags" style="float:left">
                    <h6>Filter Criteria:</h6>
                    <input id="filter_tags_input" type="text"/>
                </div>
            </div>
          </html>
        </panel>
    </row>
  <row>
    <panel>
      <chart id="top_10_applications">
        <title>Top 10 Applications</title>
        <search base="baseProcessSearch">
          <query>search $filter$ | search $exclude$ | stats sum(count) as count by Application | sort - count | head 10</query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="charting.chart">bar</option>
      </chart>
    </panel>
    <panel>
      <chart id="rare_10_applications">
        <title>Rarest 10 Applications</title>
        <search base="baseProcessSearch">
          <query>search $filter$ | search $exclude$ | stats sum(count) as count by Application | sort count | head 10</query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="charting.chart">bar</option>
      </chart>
    </panel>
  </row>
  <row>
    <panel>
      <table id="suspicious_applications">
      <title>Suspicious Applications</title>
        <search base="baseProcessSearch">
          <query> search $filter$ | search $exclude$ | search Computer_Type=Windows AND Product_Name="" OR Company_Name="" OR Product_Version="" NOT Application_Directory = "/*" | stats count by Application Product_Name Product_Version</query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
          </search>
      </table>
    </panel>
    <panel>
      <table id="off_hours_applications">
        <title>Off Hours Applications</title>
        <search base="baseOffHours">
          <query> search $filter$ | search $exclude$ | stats count by Application</query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
      </table>
    </panel>
    <panel>
      <table id="md5_reuse">
        <title>MD5 Reuses</title>
        <search base="baseProcessSearch">
          <query> search $filter$ | search $exclude$ | stats count by MD5_Checksum Application| stats sum(count) as Applications by MD5_Checksum | search count > 1 | sort - count</query>
            <earliest>$time.earliest$</earliest>
            <latest>$time.latest$</latest>
        </search>
      </table>
    </panel>
  </row>
</form>
