<form version="1.1" showsource="False" stylesheet="acnvm.css,css/common.css">
  <label>Destination Addresses View  (Trust/Network)</label>
  <init>
    <set token="dh_tok"></set>
    <set token="user_tok"></set>
    <set token="pn_tok"></set>
    <set token="ph_tok"></set>
  </init>
  <search>
    <query>| makeresults
     </query>
    <done>
      <eval token="ifdata_earliest_time_tok">$time.earliest_epoch$ - (86400*14)</eval>
    </done>
    <earliest>$time.earliest$</earliest>
    <latest>$time.latest$</latest>
  </search>
  <search id="baseSearch">
    <query>
     `nvm_flowdata_index` $dh_tok$ $user_tok$ $pn_tok$ $ph_tok$ NOT pap=* OR (pap!=Administrator AND pap!=LOCAL AND pap!=SYSTEM AND pap!=_netbios AND pap!=NETWORK AND pap!=linuxuid_0 AND pap!=softwareupdate AND pap!=nobody AND pap!=_mdnsreponder AND pap!=_lp AND pap!=_locationd AND pap!=root pap!=UpdateUser) | eval dh = if(dh="Unknown", da, dh) | table _time, udid, da,dp, pn, ppn, dh, pr,transport, user, sa,sp, iid,pr, ibc,obc  | join udid, iid [ | inputlookup ifdata where (_time > $ifdata_earliest_time_tok$) | search ist=$ist_tok$  ] | join udid [| inputlookup unique_endpoints | search vsn="*"] | fields vsn, iid,udid, osn,osv, ose, sm, _time, udid, da,dp, pn, ppn, dh, transport, user, sa,sp, iid, it,ibc,obc,pr | eval IPDNS=if(da6!="",dh." - "."(".substr(da6,1,4).":".substr(da6,5,4).":".substr(da6,9,4).":".substr(da6,13,4).":".substr(da6,17,4).":".substr(da6,21,4).":".substr(da6,25,4).":".substr(da6,29,4).")", dh. " - "."(".da.")")
    </query>
    <earliest>$time.earliest$</earliest>
    <latest>$time.latest$</latest>
  </search>
  <fieldset submitButton="true">
    <input type="time" token="time">
      <label>Time</label>
      <default>
        <earliest>-7d@d</earliest>
        <latest>now</latest>
      </default>
      <change>
        <eval token="time.earliest_epoch">if(isnum('earliest'),'earliest',relative_time(now(),'earliest')</eval>
        <eval token="time.latest_epoch">if(isnum('latest'),'latest',relative_time(now(),'latest')</eval>
      </change>
    </input>
    <input type="dropdown" token="ist_tok">
      <label>Trust State</label>
      <default>*</default>
      <!-- Each value will be surrounded by the valuePrefix and valueSuffix -->
      <!-- All the values and their valuePrefix and valueSuffix will be concatenated together with the delimiter between them -->
      <choice value="*">ALL</choice>
      <choice value="Trusted">Trusted</choice>
      <choice value="Untrusted">Untrusted</choice>
    </input>
    <input type="multiselect" token="it_tok">
      <label>Network Type</label>
      <default>*</default>
      <!-- Each value will be surrounded by the valuePrefix and valueSuffix -->
      <valuePrefix>it="</valuePrefix>
      <valueSuffix>"</valueSuffix>
      <!-- All the values and their valuePrefix and valueSuffix will be concatenated together with the delimiter between them -->
      <delimiter> OR </delimiter>
      <choice value="*">ALL</choice>
      <choice value="1">Wired</choice>
      <choice value="2">Wireless (802.11)</choice>
      <choice value="3">Bluetooth</choice>
      <choice value="4">Token Ring</choice>
      <choice value="5">ATM (Slip)</choice>
      <choice value="6">PPP</choice>
      <choice value="8">VPN</choice>
      <choice value="9">Loopback</choice>
      <choice value="10">NFC</choice>
      <choice value="11">Cellular</choice>
      <choice value="15">Unknown</choice>
      <initialValue>*</initialValue>
    </input>
    <input type="multiselect" token="vsn_tok">
      <label>Device(s)</label>
      <default>*</default>
      <!-- Each value will be surrounded by the valuePrefix and valueSuffix -->
      <valuePrefix>vsn="</valuePrefix>
      <valueSuffix>"</valueSuffix>
      <!-- All the values and their valuePrefix and valueSuffix will be concatenated together with the delimiter between them -->
      <delimiter> OR </delimiter>
      <choice value="*">ALL</choice>
      <fieldForLabel>vsn</fieldForLabel>
      <fieldForValue>vsn</fieldForValue>
      <search>
        <query>| inputlookup unique_endpoints | stats count by vsn</query>
        <earliest>0</earliest>
      </search>
    </input>
    <input type="multiselect" token="pn_tok">
      <label>Process(es)</label>
      <!-- Each value will be surrounded by the valuePrefix and valueSuffix -->
      <valuePrefix>pn="</valuePrefix>
      <valueSuffix>"</valueSuffix>
      <!-- All the values and their valuePrefix and valueSuffix will be concatenated together with the delimiter between them -->
      <delimiter> OR </delimiter>
      <choice value="*">ALL</choice>
      <fieldForLabel>pn</fieldForLabel>
      <fieldForValue>pn</fieldForValue>
      <search>
        <query>| inputlookup unique_processes | stats count by pn</query>
        <earliest>0</earliest>
      </search>
    </input>
    <input type="multiselect" token="user_tok">
      <label>Users</label>
      <!-- Each value will be surrounded by the valuePrefix and valueSuffix -->
      <valuePrefix>user="</valuePrefix>
      <valueSuffix>"</valueSuffix>
      <!-- All the values and their valuePrefix and valueSuffix will be concatenated together with the delimiter between them -->
      <delimiter> OR </delimiter>
      <choice value="*">ALL</choice>
      <fieldForLabel>user</fieldForLabel>
      <fieldForValue>user</fieldForValue>
      <search>
        <query>`nvm_flowdata_index` ph!="" | stats count by user</query>
        <earliest>0</earliest>
      </search>
    </input>
    <input type="text" token="ph_tok" searchWhenChanged="false">
      <label>Process Hash</label>
    </input>
    <input type="text" token="dh_tok" searchWhenChanged="false">
      <label>Destination</label>
      <prefix>dh="</prefix>
      <suffix>"</suffix>
    </input>
  </fieldset>
  <row>
    <panel depends="$FilterIP$" id="nvmDestAddrs">
      <title>Click destination entry to obtain more information.</title>
      <table>
        <search base="baseSearch" id="initialBaseSearch">
          <query>| search da="$FilterIP$" | eval destination = if(da6 != "", substr(da6,1,4).":".substr(da6,5,4).":".substr(da6,9,4).":".substr(da6,13,4).":".substr(da6,17,4).":".substr(da6,21,4).":".substr(da6,25,4).":".substr(da6,29,4), da) | stats count by dh, destination | rename dh as "Destination Domain", destination as "Destination Address" | fields - count</query>
        </search>
        <option name="wrap">true</option>
        <option name="rowNumbers">true</option>
        <option name="dataOverlayMode">none</option>
        <option name="count">10</option>
        <option name="drilldown">row</option>
        <drilldown target="_blank">
          <condition field="Destination Domain">\<link>/app/CiscoNVM/address_info?targetDomain=$row.Destination Domain$</link>
          </condition>
          <condition field="Destination Address">
            <link>/app/CiscoNVM/address_info?targetAddr=$row.Destination Address$</link>
          </condition>
        </drilldown>
      </table>
    </panel>
  </row>
  <row>
    <panel id="nvmHeaderInstruct">
      <title>Select pie slice to obtain more information on each destination</title>
    </panel>
  </row>
  <row>
    <panel>
      <title>Top TCP Destination Domains by Flow Count</title>
      <input type="checkbox" token="include_tcp_dns_for_total_flows" searchWhenChanged="True">
        <label></label>
        <choice value="0000">Include unresolved DNS</choice>
        <default>Unknown</default>
      </input>
      <chart>
        <search base="baseSearch" id="top_tcp_dest_domain_flows">
          <query>| search pr=6 dh!="$include_tcp_dns_for_total_flows$"
 | eval IPDNS=if(da6!="",dh." - "."(".substr(da6,1,4).":".substr(da6,5,4).":".substr(da6,9,4).":".substr(da6,13,4).":".substr(da6,17,4).":".substr(da6,21,4).":".substr(da6,25,4).":".substr(da6,29,4).")", dh. " - "."(".da.")") | top IPDNS limit=15</query>
        </search>
        <drilldown>
          <eval token="FilterIP">trim(mvindex(split('click.value', " - "), 1), "()")</eval>
        </drilldown>
        <option name="charting.drilldown">all</option>
        <option name="charting.axisTitleX.visibility">visible</option>
        <option name="charting.axisTitleY.visibility">visible</option>
        <option name="charting.axisX.scale">linear</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.chart">pie</option>
        <option name="charting.chart.nullValueMode">gaps</option>
        <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
        <option name="charting.chart.stackMode">default</option>
        <option name="charting.chart.style">shiny</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
        <option name="charting.legend.placement">right</option>
      </chart>
    </panel>
    <panel>
      <title>Top TCP Destination Domains by In-Bytes</title>
      <input type="checkbox" token="include_tcp_dns_for_total_inbytes" searchWhenChanged="True">
        <label></label>
        <choice value="0000">Include unresolved DNS</choice>
        <default>Unknown</default>
      </input>
      <chart>
        <search base="baseSearch" id="top_tcp_dest_domains_in">
          <query>| search pr=6 dh!="$include_tcp_dns_for_total_inbytes$" ibc &gt; 0
| eval IPDNS=if(da6!="",dh." - "."(".substr(da6,1,4).":".substr(da6,5,4).":".substr(da6,9,4).":".substr(da6,13,4).":".substr(da6,17,4).":".substr(da6,21,4).":".substr(da6,25,4).":".substr(da6,29,4).")", dh. " - "."(".da.")") | stats sum(ibc) by IPDNS | rename sum(ibc) as in_bytes | sort in_bytes desc | head 15</query>
        </search>
        <drilldown>
          <eval token="FilterIP">trim(mvindex(split('click.value', " - "), 1), "()")</eval>
        </drilldown>
        <option name="charting.axisTitleX.visibility">visible</option>
        <option name="charting.axisTitleY.visibility">visible</option>
        <option name="charting.axisX.scale">linear</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.chart">pie</option>
        <option name="charting.chart.nullValueMode">gaps</option>
        <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
        <option name="charting.chart.stackMode">default</option>
        <option name="charting.chart.style">shiny</option>
        <option name="charting.drilldown">all</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
        <option name="charting.legend.placement">right</option>
      </chart>
    </panel>
    <panel>
      <title>Top TCP Destination Domains by Out-Bytes</title>
      <input type="checkbox" token="include_tcp_dns_for_total_outbytes" searchWhenChanged="True">
        <label></label>
        <choice value="0000">Include unresolved DNS</choice>
        <default>Unknown</default>
      </input>
      <chart>
        <search base="baseSearch" id="tcp_dest_domains_out2">
          <query>|  search pr=6 dh!="$include_tcp_dns_for_total_outbytes$" obc &gt; 0 | eval IPDNS=if(da6!="",dh." - "."(".substr(da6,1,4).":".substr(da6,5,4).":".substr(da6,9,4).":".substr(da6,13,4).":".substr(da6,17,4).":".substr(da6,21,4).":".substr(da6,25,4).":".substr(da6,29,4).")", dh. " - "."(".da.")") | stats sum(obc) by IPDNS | rename sum(obc) as out_bytes | sort out_bytes desc | head 15</query>
        </search>
        <option name="charting.axisLabelsX.majorLabelStyle.overflowMode">ellipsisNone</option>
        <option name="charting.axisLabelsX.majorLabelStyle.rotation">0</option>
        <option name="charting.axisTitleX.visibility">visible</option>
        <option name="charting.axisTitleY.visibility">visible</option>
        <option name="charting.axisTitleY2.visibility">visible</option>
        <option name="charting.axisX.scale">linear</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.axisY2.enabled">0</option>
        <option name="charting.axisY2.scale">inherit</option>
        <option name="charting.chart">pie</option>
        <option name="charting.chart.bubbleMaximumSize">50</option>
        <option name="charting.chart.bubbleMinimumSize">10</option>
        <option name="charting.chart.bubbleSizeBy">area</option>
        <option name="charting.chart.nullValueMode">gaps</option>
        <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
        <option name="charting.chart.stackMode">default</option>
        <option name="charting.chart.style">shiny</option>
        <option name="charting.drilldown">all</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
        <option name="charting.legend.placement">right</option>
        <option name="refresh.display">progressbar</option>
        <drilldown>
          <eval token="FilterIP">trim(mvindex(split('click.value', " - "), 1), "()")</eval>
        </drilldown>
      </chart>
    </panel>
  </row>
  <row>
    <panel>
      <title>Top UDP Destination Domains by Flow Count</title>
      <input type="checkbox" token="include_udp_dns_for_total_flows" searchWhenChanged="True">
        <label></label>
        <choice value="0000">Include unresolved DNS</choice>
        <default>Unknown</default>
      </input>
      <chart>
        <search base="baseSearch" id="tcp_dest_domains_out">
          <query>| search dh!="$include_udp_dns_for_total_flows$" pr=17 | eval IPDNS=if(da6!="",dh." - "."(".substr(da6,1,4).":".substr(da6,5,4).":".substr(da6,9,4).":".substr(da6,13,4).":".substr(da6,17,4).":".substr(da6,21,4).":".substr(da6,25,4).":".substr(da6,29,4).")", dh. " - "."(".da.")") | top IPDNS limit=15</query>
        </search>
        <option name="charting.axisTitleX.visibility">visible</option>
        <option name="charting.axisTitleY.visibility">visible</option>
        <option name="charting.axisX.scale">linear</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.chart">pie</option>
        <option name="charting.chart.nullValueMode">gaps</option>
        <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
        <option name="charting.chart.stackMode">default</option>
        <option name="charting.chart.style">shiny</option>
        <option name="charting.drilldown">all</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
        <option name="charting.legend.placement">right</option>
        <option name="refresh.display">progressbar</option>
        <drilldown>
          <eval token="FilterIP">trim(mvindex(split('click.value', " - "), 1), "()")</eval>
        </drilldown>
      </chart>
    </panel>
    <panel>
      <title>Top UDP Destination Domains by In-Bytes</title>
      <input type="checkbox" token="include_udp_dns_for_total_inbytes" searchWhenChanged="True">
        <label></label>
        <choice value="0000">Include unresolved DNS</choice>
        <default>Unknown</default>
      </input>
      <chart>
        <search base="baseSearch" id="tcp_dest_domains_in_2">
          <query>| search pr=17 dh!="$include_udp_dns_for_total_inbytes$" ibc &gt; 0 | eval IPDNS=if(da6!="",dh." - "."(".substr(da6,1,4).":".substr(da6,5,4).":".substr(da6,9,4).":".substr(da6,13,4).":".substr(da6,17,4).":".substr(da6,21,4).":".substr(da6,25,4).":".substr(da6,29,4).")", dh. " - "."(".da.")") | stats sum(ibc) by IPDNS | rename sum(ibc) as in_bytes | sort in_bytes desc | head 15</query>
        </search>
        <option name="charting.axisTitleX.visibility">visible</option>
        <option name="charting.axisTitleY.visibility">visible</option>
        <option name="charting.axisX.scale">linear</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.chart">pie</option>
        <option name="charting.chart.nullValueMode">gaps</option>
        <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
        <option name="charting.chart.stackMode">default</option>
        <option name="charting.chart.style">shiny</option>
        <option name="charting.drilldown">all</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
        <option name="charting.legend.placement">right</option>
        <option name="refresh.display">progressbar</option>
        <drilldown>
          <eval token="FilterIP">trim(mvindex(split('click.value', " - "), 1), "()")</eval>
        </drilldown>
      </chart>
    </panel>
    <panel>
      <title>Top UDP Destination Domains by Out-Bytes</title>
      <input type="checkbox" token="include_udp_dns_for_total_outbytes" searchWhenChanged="True">
        <label></label>
        <choice value="0000">Include unresolved DNS</choice>
        <default>Unknown</default>
      </input>
      <chart>
        <search base="baseSearch" id="udp_dest_domains_out">
          <query>| search dh!="$include_udp_dns_for_total_outbytes$" pr=17 obc &gt; 0 | eval IPDNS=if(da6!="",dh." - "."(".substr(da6,1,4).":".substr(da6,5,4).":".substr(da6,9,4).":".substr(da6,13,4).":".substr(da6,17,4).":".substr(da6,21,4).":".substr(da6,25,4).":".substr(da6,29,4).")", dh. " - "."(".da.")") | stats sum(obc) by IPDNS | rename sum(obc) as out_bytes | sort out_bytes desc | head 15</query>
        </search>
        <option name="charting.axisLabelsX.majorLabelStyle.overflowMode">ellipsisNone</option>
        <option name="charting.axisLabelsX.majorLabelStyle.rotation">0</option>
        <option name="charting.axisTitleX.visibility">visible</option>
        <option name="charting.axisTitleY.visibility">visible</option>
        <option name="charting.axisTitleY2.visibility">visible</option>
        <option name="charting.axisX.scale">linear</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.axisY2.enabled">0</option>
        <option name="charting.axisY2.scale">inherit</option>
        <option name="charting.chart">pie</option>
        <option name="charting.chart.bubbleMaximumSize">50</option>
        <option name="charting.chart.bubbleMinimumSize">10</option>
        <option name="charting.chart.bubbleSizeBy">area</option>
        <option name="charting.chart.nullValueMode">gaps</option>
        <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
        <option name="charting.chart.stackMode">default</option>
        <option name="charting.chart.style">shiny</option>
        <option name="charting.drilldown">all</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
        <option name="charting.legend.placement">right</option>
        <option name="refresh.display">progressbar</option>
        <drilldown>
          <eval token="FilterIP">trim(mvindex(split('click.value', " - "), 1), "()")</eval>
        </drilldown>
      </chart>
    </panel>
  </row>
  <row>
    <panel>
      <title>Top Destination IPv4 Addresses by Flow Count</title>
      <chart>
        <search base="baseSearch" id="tcp_dest_addr_flow_out">
          <query>| top da limit=15</query>
        </search>
        <drilldown>
          <eval token="FilterIP">trim(mvindex(split('click.value', " - "), 1), "()")</eval>
        </drilldown>
        <option name="charting.axisTitleX.visibility">visible</option>
        <option name="charting.axisTitleY.visibility">visible</option>
        <option name="charting.axisX.scale">linear</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.chart">pie</option>
        <option name="charting.chart.nullValueMode">gaps</option>
        <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
        <option name="charting.chart.stackMode">default</option>
        <option name="charting.chart.style">shiny</option>
        <option name="charting.drilldown">all</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
        <option name="charting.legend.placement">right</option>
      </chart>
    </panel>
    <panel>
      <title>Top Destination IPv4 Addresses by In-Bytes</title>
      <chart>
        <search base="baseSearch" id="tcp_dest_addr_in">
          <query>| search ibc &gt; 0 | stats sum(ibc) by da | rename sum(ibc) as in_bytes | sort in_bytes desc | head 15</query>
        </search>
        <option name="charting.axisTitleX.visibility">visible</option>
        <option name="charting.axisTitleY.visibility">visible</option>
        <option name="charting.axisX.scale">linear</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.chart">pie</option>
        <option name="charting.chart.nullValueMode">gaps</option>
        <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
        <option name="charting.chart.stackMode">default</option>
        <option name="charting.chart.style">shiny</option>
        <option name="charting.drilldown">all</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
        <option name="charting.legend.placement">right</option>
        <option name="refresh.display">progressbar</option>
        <drilldown>
          <eval token="FilterIP">trim(mvindex(split('click.value', " - "), 1), "()")</eval>
        </drilldown>
      </chart>
    </panel>
    <panel>
      <title>Top Destination IPv4 Addresses by Out-Bytes</title>
      <chart>
        <search base="baseSearch" id="tcp_dest_addr_out2">
          <query>| search obc &gt; 0 | stats sum(obc) by da | rename sum(obc) as out_bytes | sort out_bytes desc | head 15</query>
        </search>
        <option name="charting.axisLabelsX.majorLabelStyle.overflowMode">ellipsisNone</option>
        <option name="charting.axisLabelsX.majorLabelStyle.rotation">0</option>
        <option name="charting.axisTitleX.visibility">visible</option>
        <option name="charting.axisTitleY.visibility">visible</option>
        <option name="charting.axisTitleY2.visibility">visible</option>
        <option name="charting.axisX.scale">linear</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.axisY2.enabled">0</option>
        <option name="charting.axisY2.scale">inherit</option>
        <option name="charting.chart">pie</option>
        <option name="charting.chart.bubbleMaximumSize">50</option>
        <option name="charting.chart.bubbleMinimumSize">10</option>
        <option name="charting.chart.bubbleSizeBy">area</option>
        <option name="charting.chart.nullValueMode">gaps</option>
        <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
        <option name="charting.chart.stackMode">default</option>
        <option name="charting.chart.style">shiny</option>
        <option name="charting.drilldown">all</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
        <option name="charting.legend.placement">right</option>
        <option name="refresh.display">progressbar</option>
        <drilldown>
          <eval token="FilterIP">trim(mvindex(split('click.value', " - "), 1), "()")</eval>
        </drilldown>
      </chart>
    </panel>
  </row>
  <row>
    <panel>
      <title>Top Destination IPv6 Addresses by Flow Count</title>
      <chart>
        <search base="baseSearch" id="tcp_dest_domains_out3">
          <query>| eval da6_mod=substr(da6,1,4).":".substr(da6,5,4).":".substr(da6,9,4).":".substr(da6,13,4).":".substr(da6,17,4).":".substr(da6,21,4).":".substr(da6,25,4).":".substr(da6,29,4) | top da6_mod limit=15</query>
        </search>
        <option name="charting.axisTitleX.visibility">visible</option>
        <option name="charting.axisTitleY.visibility">visible</option>
        <option name="charting.axisX.scale">linear</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.chart">pie</option>
        <option name="charting.chart.nullValueMode">gaps</option>
        <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
        <option name="charting.chart.stackMode">default</option>
        <option name="charting.chart.style">shiny</option>
        <option name="charting.drilldown">all</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
        <option name="charting.legend.placement">right</option>
        <option name="refresh.display">progressbar</option>
        <drilldown>
          <eval token="FilterIP">trim(mvindex(split('click.value', " - "), 1), "()")</eval>
        </drilldown>
      </chart>
    </panel>
    <panel>
      <title>Top Destination IPv6 Addresses by In-Bytes</title>
      <chart>
        <search base="baseSearch" id="tcp_dest_domains_in">
          <query>| search ibc &gt; 0 | eval da6_mod=substr(da6,1,4).":".substr(da6,5,4).":".substr(da6,9,4).":".substr(da6,13,4).":".substr(da6,17,4).":".substr(da6,21,4).":".substr(da6,25,4).":".substr(da6,29,4) | stats sum(ibc) by da6_mod | rename sum(ibc) as in_bytes | sort in_bytes desc | head 15</query>
        </search>
        <option name="charting.axisTitleX.visibility">visible</option>
        <option name="charting.axisTitleY.visibility">visible</option>
        <option name="charting.axisX.scale">linear</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.chart">pie</option>
        <option name="charting.chart.nullValueMode">gaps</option>
        <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
        <option name="charting.chart.stackMode">default</option>
        <option name="charting.chart.style">shiny</option>
        <option name="charting.drilldown">all</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
        <option name="charting.legend.placement">right</option>
        <option name="refresh.display">progressbar</option>
        <drilldown>
          <eval token="FilterIP">trim(mvindex(split('click.value', " - "), 1), "()")</eval>
        </drilldown>
      </chart>
    </panel>
    <panel>
      <title>Top Destination IPv6 Addresses by Out-Bytes</title>
      <chart>
        <search base="baseSearch" id="tcp_dest_addr_out">
          <query>| search obc &gt; 0 | eval da6_mod=substr(da6,1,4).":".substr(da6,5,4).":".substr(da6,9,4).":".substr(da6,13,4).":".substr(da6,17,4).":".substr(da6,21,4).":".substr(da6,25,4).":".substr(da6,29,4) | stats sum(obc) by da6_mod | rename sum(obc) as out_bytes | sort out_bytes desc | head 15</query>
        </search>
        <option name="charting.axisLabelsX.majorLabelStyle.overflowMode">ellipsisNone</option>
        <option name="charting.axisLabelsX.majorLabelStyle.rotation">0</option>
        <option name="charting.axisTitleX.visibility">visible</option>
        <option name="charting.axisTitleY.visibility">visible</option>
        <option name="charting.axisTitleY2.visibility">visible</option>
        <option name="charting.axisX.scale">linear</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.axisY2.enabled">0</option>
        <option name="charting.axisY2.scale">inherit</option>
        <option name="charting.chart">pie</option>
        <option name="charting.chart.bubbleMaximumSize">50</option>
        <option name="charting.chart.bubbleMinimumSize">10</option>
        <option name="charting.chart.bubbleSizeBy">area</option>
        <option name="charting.chart.nullValueMode">gaps</option>
        <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
        <option name="charting.chart.stackMode">default</option>
        <option name="charting.chart.style">shiny</option>
        <option name="charting.drilldown">all</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
        <option name="charting.legend.placement">right</option>
        <option name="refresh.display">progressbar</option>
        <drilldown>
          <eval token="FilterIP">trim(mvindex(split('click.value', " - "), 1), "()")</eval>
        </drilldown>
      </chart>
    </panel>
  </row>
</form>
