<form>
  <label>User - Weekend Pattern</label>
  <fieldset submitButton="false" autoRun="true">
    <input type="time" token="baseline" searchWhenChanged="true">
      <label>Select Baseline Envelop:</label>
      <default>
        <earliest>-30d@d</earliest>
        <latest>now</latest>
      </default>
    </input>
    <input type="time" token="analysis" searchWhenChanged="true">
      <label>Select Analysis Period:</label>
      <default>
        <earliest>-7d@h</earliest>
        <latest>now</latest>
      </default>
    </input>
  </fieldset>
  <row>
    <panel>
      <html>
      <div> <div style="color:#311b92">
            <b>Obtain Insights on User Behaviour based on his Previous Usage Patterns.</b>
          </div>
      Select the Baseline Time Period to generate an Envelop for the User which determines his normal weekend working pattern. 
        Thereby, select the Analysis Time Period to search actual data for User Behaviour Anomalies.  
      </div>
    </html>
    </panel>
  </row>
  <row>
    <panel>
      <title>Suspicious Activity - Weekend</title>
      <chart>
        <search>
          <query>index=orgsecure sourcetype="orgsecure:logon" action=Logon (date_wday="saturday" OR date_wday="sunday")  earliest=$analysis.earliest$ latest=$analysis.latest$ | bucket _time span=1w as week | stats count by week user | eval week=strftime(week,"%Y/%m/%d") | eventstats avg(count) as AvgWeeklyCount by user| join user  [search index=orgsecure sourcetype="orgsecure:logon" action=Logon (date_wday="saturday" OR date_wday="sunday")  earliest=$baseline.earliest$ latest=$baseline.latest$  | bucket _time span=1w as week2 | stats count As LastWeekCount by week2 user | eval week2=strftime(week2,"%Y/%m/%d") ] | where LastWeekCount &gt; AvgWeeklyCount + 1 | table user  AvgWeeklyCount LastWeekCount  | rename AvgWeeklyCount AS "Avg Weekly Count" | rename LastWeekCount AS "This Week Count"</query>
          <earliest>0</earliest>
          <latest></latest>
        </search>
        <option name="wrap">true</option>
        <option name="rowNumbers">false</option>
        <option name="dataOverlayMode">none</option>
        <option name="count">10</option>
        <option name="charting.axisLabelsX.majorLabelStyle.overflowMode">ellipsisNone</option>
        <option name="charting.axisLabelsX.majorLabelStyle.rotation">0</option>
        <option name="charting.axisTitleX.visibility">visible</option>
        <option name="charting.axisTitleY.visibility">visible</option>
        <option name="charting.axisTitleY2.visibility">visible</option>
        <option name="charting.axisX.scale">linear</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.axisY2.enabled">false</option>
        <option name="charting.axisY2.scale">inherit</option>
        <option name="charting.chart">column</option>
        <option name="charting.chart.bubbleMaximumSize">50</option>
        <option name="charting.chart.bubbleMinimumSize">10</option>
        <option name="charting.chart.bubbleSizeBy">area</option>
        <option name="charting.chart.nullValueMode">gaps</option>
        <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
        <option name="charting.chart.stackMode">default</option>
        <option name="charting.chart.style">shiny</option>
        <option name="charting.drilldown">none</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
        <option name="charting.legend.placement">bottom</option>
      </chart>
    </panel>
    <panel>
      <title>Suspicious Activity - Weekend</title>
      <table>
        <search>
          <query>index=orgsecure sourcetype="orgsecure:logon" action=Logon (date_wday="saturday" OR date_wday="sunday")  earliest=$analysis.earliest$ latest=$analysis.latest$ | bucket _time span=1w as week | stats count by week user | eval week=strftime(week,"%Y/%m/%d") | eventstats avg(count) as AvgWeeklyCount by user| join user  [search index=orgsecure sourcetype="orgsecure:logon" action=Logon (date_wday="saturday" OR date_wday="sunday")  earliest=$baseline.earliest$ latest=$baseline.latest$  | bucket _time span=1w as week2 | stats count As LastWeekCount by week2 user | eval week2=strftime(week2,"%Y/%m/%d") ] | where LastWeekCount &gt; AvgWeeklyCount + 1 | table user week   AvgWeeklyCount LastWeekCount  | rename AvgWeeklyCount AS "Avg Weekly Count" | rename LastWeekCount AS "This Week Count" week AS "Suspicious Week"</query>
          <earliest>0</earliest>
          <latest></latest>
        </search>
        <option name="wrap">true</option>
        <option name="rowNumbers">false</option>
        <option name="dataOverlayMode">none</option>
        <option name="count">10</option>
        <option name="charting.axisLabelsX.majorLabelStyle.overflowMode">ellipsisNone</option>
        <option name="charting.axisLabelsX.majorLabelStyle.rotation">0</option>
        <option name="charting.axisTitleX.visibility">visible</option>
        <option name="charting.axisTitleY.visibility">visible</option>
        <option name="charting.axisTitleY2.visibility">visible</option>
        <option name="charting.axisX.scale">linear</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.axisY2.enabled">false</option>
        <option name="charting.axisY2.scale">inherit</option>
        <option name="charting.chart">column</option>
        <option name="charting.chart.bubbleMaximumSize">50</option>
        <option name="charting.chart.bubbleMinimumSize">10</option>
        <option name="charting.chart.bubbleSizeBy">area</option>
        <option name="charting.chart.nullValueMode">gaps</option>
        <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
        <option name="charting.chart.stackMode">default</option>
        <option name="charting.chart.style">shiny</option>
        <option name="charting.drilldown">all</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
        <option name="charting.legend.placement">right</option>
        <option name="drilldown">cell</option>
      </table>
    </panel>
  </row>
</form>