<form>
  <label>Assets - Abnormal Removable Media Usage</label>
  <fieldset submitButton="false" autoRun="true">
    <input type="time" token="baseline" searchWhenChanged="true">
      <label>Select Baseline Envelop:</label>
      <default>
        <earliest>-30d@d</earliest>
        <latest>now</latest>
      </default>
    </input>
    <input type="time" token="analysis" searchWhenChanged="true">
      <label>Select Analysis Period:</label>
      <default>
        <earliest>-7d@h</earliest>
        <latest>now</latest>
      </default>
    </input>
  </fieldset>
  <row>
    <panel>
      <html>
      <div> <div style="color:#311b92">
            <b>Obtain Insights on User Behaviour based on his Previous Usage Patterns.</b>
          </div>
      Select the Baseline Time Period to generate an Envelop for the User which determines his normal usage pattern of Removable Media Access. 
        Thereby, select the Analysis Time Period to search actual data for User Behaviour Anomalies.  
      </div>
    </html>
    </panel>
  </row>
  <row>
    <panel>
      <title>Suspicious Removable Media Activity</title>
      <chart>
        <search>
          <query>index=orgsecure sourcetype="orgsecure:file" action="File Write" to_removable_media=True earliest=$analysis.earliest$ latest=$analysis.latest$ | bucket _time span=1d as day  | stats count(date) AS CurrentCountOfTransaction by user day  | table user day  CurrentCountOfTransaction | eventstats avg(CurrentCountOfTransaction) AS CurrentAverageOfTransaction by user | eval day=strftime(day,"%Y/%m/%d") | join user  [search index=orgsecure sourcetype="orgsecure:file" action="File Write" to_removable_media=True earliest=$baseline.earliest$ latest=$baseline.latest$ | bucket _time span=1d as day2  | stats count(date) AS AverageCountOfTransaction by user day2  | table user day2 AverageCountOfTransaction | eventstats avg(AverageCountOfTransaction) AS BaseLineAverageOfTransaction by user | eval day2=strftime(day2,"%Y/%m/%d") ] | where CurrentAverageOfTransaction &gt; BaseLineAverageOfTransaction   + 0.5 | table user day CurrentAverageOfTransaction  BaseLineAverageOfTransaction | rename CurrentAverageOfTransaction AS "Anomal Copy To Media Events" BaseLineAverageOfTransaction AS "Base Line Count of Copy to Media Events" |  stats count(day) AS "Suspicious Events" by user | sort -"Suspicious Events"</query>
          <earliest>0</earliest>
        </search>
        <option name="wrap">true</option>
        <option name="rowNumbers">false</option>
        <option name="dataOverlayMode">none</option>
        <option name="count">10</option>
        <option name="charting.axisLabelsX.majorLabelStyle.overflowMode">ellipsisNone</option>
        <option name="charting.axisLabelsX.majorLabelStyle.rotation">0</option>
        <option name="charting.axisTitleX.visibility">visible</option>
        <option name="charting.axisTitleY.visibility">visible</option>
        <option name="charting.axisTitleY2.visibility">visible</option>
        <option name="charting.axisX.scale">linear</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.axisY2.enabled">false</option>
        <option name="charting.axisY2.scale">inherit</option>
        <option name="charting.chart">column</option>
        <option name="charting.chart.bubbleMaximumSize">50</option>
        <option name="charting.chart.bubbleMinimumSize">10</option>
        <option name="charting.chart.bubbleSizeBy">area</option>
        <option name="charting.chart.nullValueMode">gaps</option>
        <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
        <option name="charting.chart.stackMode">default</option>
        <option name="charting.chart.style">shiny</option>
        <option name="charting.drilldown">all</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
        <option name="charting.legend.placement">bottom</option>
      </chart>
    </panel>
    <panel>
      <title>Suspicious Removable Media Activity</title>
      <table>
        <search>
          <query>index=orgsecure sourcetype="orgsecure:file" action="File Write" to_removable_media=True earliest=$analysis.earliest$ latest=$analysis.latest$ | bucket _time span=1d as day  | stats count(date) AS CurrentCountOfTransaction by user day  | table user day  CurrentCountOfTransaction | eventstats avg(CurrentCountOfTransaction) AS CurrentAverageOfTransaction by user | eval day=strftime(day,"%Y/%m/%d") | join user  [search index=orgsecure sourcetype="orgsecure:file" action="File Write" to_removable_media=True earliest=$baseline.earliest$ latest=$baseline.latest$ | bucket _time span=1d as day2  | stats count(date) AS AverageCountOfTransaction by user day2  | table user day2 AverageCountOfTransaction | eventstats avg(AverageCountOfTransaction) AS BaseLineAverageOfTransaction by user | eval day2=strftime(day2,"%Y/%m/%d") ] | where CurrentAverageOfTransaction &gt; BaseLineAverageOfTransaction   + 0.5 | table user day CurrentAverageOfTransaction  BaseLineAverageOfTransaction | rename CurrentAverageOfTransaction AS "Anomal Copy To Media Events" BaseLineAverageOfTransaction AS "Base Line Count of Copy to Media Events" |  stats count(day) AS "Suspicious Events" by user | sort -"Suspicious Events"</query>
          <earliest>0</earliest>
          <latest></latest>
        </search>
        <option name="wrap">true</option>
        <option name="rowNumbers">false</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">cell</option>
        <option name="count">10</option>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <table>
        <title>Suspicious Removable Media Activity - Details</title>
        <search>
          <query>index=orgsecure sourcetype="orgsecure:file" action="File Write" to_removable_media=True earliest=$analysis.earliest$ latest=$analysis.latest$ | bucket _time span=1d as day  | stats count(date) AS CurrentCountOfTransaction by user day  | table user day  CurrentCountOfTransaction | eventstats avg(CurrentCountOfTransaction) AS CurrentAverageOfTransaction by user | eval day=strftime(day,"%Y/%m/%d") | join user  [search index=orgsecure sourcetype="orgsecure:file" action="File Write" to_removable_media=True earliest=$baseline.earliest$ latest=$baseline.latest$ | bucket _time span=1d as day2  | stats count(date) AS AverageCountOfTransaction by user day2  | table user day2 AverageCountOfTransaction | eventstats avg(AverageCountOfTransaction) AS BaseLineAverageOfTransaction by user | eval day2=strftime(day2,"%Y/%m/%d") ] | where CurrentAverageOfTransaction &gt; BaseLineAverageOfTransaction   + 0.5 | table user day CurrentCountOfTransaction  BaseLineAverageOfTransaction | rename CurrentCountOfTransaction  AS "Anomal Copy To Media Events" BaseLineAverageOfTransaction AS "Base Line Count of Copy to Media Events"</query>
          <earliest>0</earliest>
          <latest></latest>
        </search>
        <option name="wrap">true</option>
        <option name="rowNumbers">false</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">cell</option>
        <option name="count">10</option>
      </table>
    </panel>
  </row>
</form>