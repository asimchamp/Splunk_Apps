<form>
  <label>User - Usage Pattern</label>
  <fieldset submitButton="false" autoRun="true">
    <input type="time" token="baseline" searchWhenChanged="true">
      <label>Select Baseline Envelop:</label>
      <default>
        <earliest>-30d@d</earliest>
        <latest>now</latest>
      </default>
    </input>
    <input type="time" token="analysis" searchWhenChanged="true">
      <label>Select Analysis Period:</label>
      <default>
        <earliest>-7d@h</earliest>
        <latest>now</latest>
      </default>
    </input>
  </fieldset>
  <row>
    <panel>
      <html>
      <div> <div style="color:#311b92">
            <b>Obtain Insights on User Behaviour based on his Previous Usage Patterns.</b>
          </div>
      Select the Baseline Time Period to generate an Envelop for the User which determines his normal usage pattern. 
        Thereby, select the Analysis Time Period to search actual data for User Behaviour Anomalies.  
      </div>
    </html>
    </panel>
  </row>
  <row>
    <panel>
      <title>Suspicious Activity - After Hours</title>
      <chart>
        <search>
          <query>index=orgsecure sourcetype="orgsecure:logon" action=Logon earliest=$analysis.earliest$ latest=$analysis.latest$ | bucket _time span=1d as day  | stats earliest(date_hour) as FirstLoginOfDay latest(date_hour) as LastLoginOfDay    by user day   | table user day  FirstLoginOfDay LastLoginOfDay | eventstats avg(FirstLoginOfDay) as AvgFirstLoginOfDay by user | eval day=strftime(day,"%Y/%m/%d %H:%M:%S") |join user [search index=orgsecure   sourcetype="orgsecure:logon" action=Logoff earliest=$baseline.earliest$ latest=$baseline.latest$ | bucket _time span=1d as day2  | stats latest(date_hour) as LastLogOffOfTheDay    by user day2  | table user day2   LastLogOffOfTheDay | eventstats avg(LastLogOffOfTheDay) as AvgLastLogOffOfTheDay by user  | eval day2=strftime(day2,"%Y/%m/%d %H:%M:%S") ] | where  LastLoginOfDay &gt; AvgLastLogOffOfTheDay + 1 | stats avg(LastLoginOfDay) As "Suspicious Login" avg(AvgLastLogOffOfTheDay)  As "Avg - Daily Last Logoff"  by user day  |  stats count(user) As "Count of Anomal Login" by user | rename user as "User" | sort -"Count of Anomal Login"</query>
          <earliest>0</earliest>
          <latest></latest>
        </search>
        <option name="wrap">true</option>
        <option name="rowNumbers">false</option>
        <option name="dataOverlayMode">none</option>
        <option name="count">10</option>
        <option name="charting.axisLabelsX.majorLabelStyle.overflowMode">ellipsisNone</option>
        <option name="charting.axisLabelsX.majorLabelStyle.rotation">0</option>
        <option name="charting.axisTitleX.visibility">visible</option>
        <option name="charting.axisTitleY.visibility">visible</option>
        <option name="charting.axisTitleY2.visibility">visible</option>
        <option name="charting.axisX.scale">linear</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.axisY2.enabled">false</option>
        <option name="charting.axisY2.scale">inherit</option>
        <option name="charting.chart">column</option>
        <option name="charting.chart.bubbleMaximumSize">50</option>
        <option name="charting.chart.bubbleMinimumSize">10</option>
        <option name="charting.chart.bubbleSizeBy">area</option>
        <option name="charting.chart.nullValueMode">gaps</option>
        <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
        <option name="charting.chart.stackMode">default</option>
        <option name="charting.chart.style">shiny</option>
        <option name="charting.drilldown">all</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
        <option name="charting.legend.placement">bottom</option>
        <option name="charting.axisLabelsY.majorUnit">1</option>
        <option name="charting.axisY.maximumNumber">24</option>
        <option name="charting.axisY.minimumNumber">0</option>
      </chart>
    </panel>
    <panel>
      <title>Suspicious Activity - After Hours</title>
      <table>
        <search>
          <query>index=orgsecure sourcetype="orgsecure:logon" action=Logon earliest=$analysis.earliest$ latest=$analysis.latest$ | bucket _time span=1d as day  | stats earliest(date_hour) as FirstLoginOfDay latest(date_hour) as LastLoginOfDay    by user day   | table user day  FirstLoginOfDay LastLoginOfDay | eventstats avg(FirstLoginOfDay) as AvgFirstLoginOfDay by user | eval day=strftime(day,"%Y/%m/%d %H:%M:%S") |join user [search index=orgsecure   sourcetype="orgsecure:logon" action=Logoff earliest=$baseline.earliest$ latest=$baseline.latest$ | bucket _time span=1d as day2  | stats latest(date_hour) as LastLogOffOfTheDay    by user day2  | table user day2   LastLogOffOfTheDay | eventstats avg(LastLogOffOfTheDay) as AvgLastLogOffOfTheDay by user  | eval day2=strftime(day2,"%Y/%m/%d %H:%M:%S") ] | where  LastLoginOfDay &gt; AvgLastLogOffOfTheDay + 1 | stats avg(LastLoginOfDay) As "Suspicious Login" avg(AvgLastLogOffOfTheDay)  As "Avg - Daily Last Logoff"  by user day  |  stats count(user) As "Count of Anomal Login" by user | rename user as "User" | sort -"Count of Anomal Login"</query>
          <earliest>0</earliest>
          <latest></latest>
        </search>
        <option name="wrap">true</option>
        <option name="rowNumbers">false</option>
        <option name="dataOverlayMode">none</option>
        <option name="charting.axisLabelsX.majorLabelStyle.overflowMode">ellipsisNone</option>
        <option name="charting.axisLabelsX.majorLabelStyle.rotation">0</option>
        <option name="charting.axisTitleX.visibility">visible</option>
        <option name="charting.axisTitleY.visibility">visible</option>
        <option name="charting.axisTitleY2.visibility">visible</option>
        <option name="charting.axisX.scale">linear</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.axisY2.enabled">false</option>
        <option name="charting.axisY2.scale">inherit</option>
        <option name="charting.chart">column</option>
        <option name="charting.chart.bubbleMaximumSize">50</option>
        <option name="charting.chart.bubbleMinimumSize">10</option>
        <option name="charting.chart.bubbleSizeBy">area</option>
        <option name="charting.chart.nullValueMode">gaps</option>
        <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
        <option name="charting.chart.stackMode">default</option>
        <option name="charting.chart.style">shiny</option>
        <option name="charting.drilldown">all</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
        <option name="charting.legend.placement">right</option>
        <option name="drilldown">cell</option>
        <option name="count">10</option>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <title>Suspicious Activity - After Hours</title>
      <table>
        <search>
          <query>index=orgsecure sourcetype="orgsecure:logon" action=Logon earliest=$analysis.earliest$ latest=$analysis.latest$ | bucket _time span=1d as day  | stats earliest(date_hour) as FirstLoginOfDay latest(date_hour) as LastLoginOfDay    by user day   | table user day  FirstLoginOfDay LastLoginOfDay | eventstats avg(FirstLoginOfDay) as AvgFirstLoginOfDay by user | eval day=strftime(day,"%Y/%m/%d %H:%M:%S") |join user [search index=orgsecure   sourcetype="orgsecure:logon" action=Logoff earliest=$baseline.earliest$ latest=$baseline.latest$ | bucket _time span=1d as day2  | stats latest(date_hour) as LastLogOffOfTheDay    by user day2  | table user day2   LastLogOffOfTheDay | eventstats avg(LastLogOffOfTheDay) as AvgLastLogOffOfTheDay by user  | eval day2=strftime(day2,"%Y/%m/%d %H:%M:%S") ] | where  LastLoginOfDay &gt; AvgLastLogOffOfTheDay + 1 | stats avg(LastLoginOfDay) As "Suspicious Login" avg(AvgLastLogOffOfTheDay)  As "Avg - Daily Last Logoff"  by user day  | rename user as "User" | rename day as "Recorded On"</query>
          <earliest>0</earliest>
          <latest></latest>
        </search>
        <option name="wrap">true</option>
        <option name="rowNumbers">false</option>
        <option name="dataOverlayMode">none</option>
        <option name="charting.axisLabelsX.majorLabelStyle.overflowMode">ellipsisNone</option>
        <option name="charting.axisLabelsX.majorLabelStyle.rotation">0</option>
        <option name="charting.axisTitleX.visibility">visible</option>
        <option name="charting.axisTitleY.visibility">visible</option>
        <option name="charting.axisTitleY2.visibility">visible</option>
        <option name="charting.axisX.scale">linear</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.axisY2.enabled">false</option>
        <option name="charting.axisY2.scale">inherit</option>
        <option name="charting.chart">column</option>
        <option name="charting.chart.bubbleMaximumSize">50</option>
        <option name="charting.chart.bubbleMinimumSize">10</option>
        <option name="charting.chart.bubbleSizeBy">area</option>
        <option name="charting.chart.nullValueMode">gaps</option>
        <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
        <option name="charting.chart.stackMode">default</option>
        <option name="charting.chart.style">shiny</option>
        <option name="charting.drilldown">all</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
        <option name="charting.legend.placement">right</option>
        <option name="drilldown">cell</option>
        <option name="count">10</option>
      </table>
    </panel>
  </row>
</form>