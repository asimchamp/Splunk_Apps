#!/bin/sh


#################### DO NOT EDIT THIS SECTION ####################
# Use nawk on solaris
AWK=nawk

SCRIPTPATH=`dirname $0`

DEBUGLOG=$SCRIPTPATH/debug.log

. $SCRIPTPATH/time.sh

_yesterday
split_date $_YESTERDAY
YESTERDAYYEAR=$SD_YEAR
YESTERDAYMON=$SD2_MONTH
YESTERDAYDAY=$SD2_DAY

_yesterday $_YESTERDAY
split_date $_YESTERDAY
DAYBEFOREYEAR=$SD_YEAR
DAYBEFOREMON=$SD2_MONTH
DAYBEFOREDAY=$SD2_DAY


# GET CURRENT HOST WITHOUT DOMAIN
CURRENTHOST=`hostname | sed 's/\([a-zA-Z_-]*\).*/\1/'`

##################### END OF DO NOT EDIT SECTION ##################


#################### CUSTOM CONFIGURATION SECTION #################


################################################################
# CONFIGURATION ITEMS FOR MAIN SAR EXTRACTION SCRIPT (s2s.sh)  #
# AND ALSO BACKFILL SAR EXTRACTION SCRIPT (s2s-backfill.sh)    #
################################################################

# BEGINNING OF SAR FILENAME
# USUALLY DO NOT NEED TO CHANGE THIS
# DEFAULT: SARFILEROOT=sar
SARFILEROOT=sar

#
# BUILDING OF COMPLETE SAR FILENAMES (i.e. sar07, sar31) #
#

# YESTERDAYFILE - CURRENT SAR FILE TO BE TRANSLATED FOR INDEXING INTO SPLUNK
# DEFAULT: YESTERDAYFILE=$SARFILEROOT$YESTERDAYDAY
# USING DEFAULTS, IF TODAY IS THE 25TH DAY OF THE MONTH, THEN THE FILE WOULD DEFAULT TO sar24

YESTERDAYFILE=$SARFILEROOT$YESTERDAYDAY

# DAYBEFOREFILE - SAR FILE FROM PREVIOUS DAY'S INDEXING - TO BE DELETED FROM SARTEMP DIRECTORY
# DEFAULT: DAYBEFOREFILE=$SARFILEROOT$DAYBEFOREDAY
# USING DEFAULTS, IF TODAY IS THE 25TH DAY OF THE MONTH, THEN THE FILE WOULD DEFAULT TO sar23

DAYBEFOREFILE=$SARFILEROOT$DAYBEFOREDAY

# SAR FILE NAMES
# MUST BE SET TO CURRENTFILENAME AND TODELFILENAME

# 'SAR FILE TO INDEX' FILE NAME: DEFAULTS TO YESTERDAYS SAR FILE
# DEFAULT: CURRENTFILENAME=$YESTERDAYFILE

CURRENTFILENAME=$YESTERDAYFILE

# 'SAR FILE TO DELETE' FILE NAME: DEFAULTS TO DAY BEFORE YESTERDAY SAR FILE
# DEFAULT: TODELFILENAME=$DAYBEFOREFILE

TODELFILENAME=$DAYBEFOREFILE

#
# STATIC PATH TO SAR FILES
#

# IF DYNAMIC DIRECTORIES ARE USED FOR PLACEMENT OF SAR FILES, THIS IS THE COMMOM (STATIC) ROOT BEFORE DYNAMIC DIRECTORIES BEGIN
#
# IF DYNAMIC DIRECTORIES ARE NOT USED FOR PLACEMENT OF SAR FILES, THIS IS THE STATIC PATH TO THE SAR FILES
#
# PATH MUST END IN /
# NO WHITESPACES ALLOWED IN PATHNAME
# DEFAULT: COMMONFILEROOT=/var/adm/sa/

COMMONFILEROOT=/var/adm/sa/

#
# FINAL PATH TO SAR FILES
#

# IF DYNAMIC DIRECTORIES ARE USED, THIS BUILDS THE FINAL PATH TO SAR FILES
# DYNAMIC DIRECTORIES EXAMPLE BELOW SHOW A PATH TO $COMMONFILEROOT$YESTERDAYYEAR"."$YESTERDAYMON"/"$CURRENTHOST"/"
# WHICH WOULD TRANSLATE TO SOMETHING LIKE /var/sysinfo/sar/servers/2014.08/somehost/
#
# IF DYNAMIC DIRECTORIES ARE NOT USED, KEEP THE DEFAULT WHICH JUST POINTS TO THE COMMONFILEROOT STATIC SETTING FROM ABOVE
#
# PATH MUST END IN /
# NO WHITESPACES ALLOWED IN PATHNAME
# DEFAULT: CURRENTFILELOCATION=$COMMONFILEROOT

CURRENTFILELOCATION=$COMMONFILEROOT
#CURRENTFILELOCATION=$COMMONFILEROOT$YESTERDAYYEAR"."$YESTERDAYMON"/"$CURRENTHOST"/"

# SARCURRENTFILE - COMPLETE PATH AND FILENAME TO SAR FILE
# DEFAULT: $CURRENTFILELOCATION$CURRENTFILENAME
SARCURRENTFILE=$CURRENTFILELOCATION$CURRENTFILENAME

############################################################################
# CONFIGURATION ITEMS FOR BACKFILL SAR EXTRACTION SCRIPT (s2s-backfill.sh) #
############################################################################

# EARLIEST NUMBER OF DAYS BEHIND CURRENT DAY TO RETRIEVE HISTORICAL SARS
# DEFAULT: EARLIESTDAYSAGO=-31
EARLIESTDAYSAGO=-31

# LATEST NUMBER OF DAYS BEHIND CURRENT DAY TO RETRIEVE HISTORICAL SARS
# DEFAULT: LATESTDAYSAGO=-1
LATESTDAYSAGO=-1

# EARLIEST DATE TO RETRIEVE HISTORICAL SARS
# IF BLANK, DEFAULTS TO EARLIESTDAYSAGO PARAMETER
# IF VALUE, OVERRIDES EARLIESTDAYSAGO AND EARLIESTDATE IS USED INSTEAD
# FORMAT: YYYY-MM-DD
# DEFAULT: EARLIESTDATE=<NO DATE>

EARLIESTDATE=

#LATEST DATE TO RETRIEVE HISTORICAL SARS
# IF BLANK, DEFAULTS TO LATESTTDAYSAGO PARAMETER
# IF VALUE, OVERRIDES LATESTDAYSAGO AND LATESTDATE IS USED INSTEAD
# FORMAT: YYYY-MM-DD
# DEFAULT: LATESTDATE=<NO DATE>

LATESTDATE=

### FINAL CONFIGURATION FOR BACKFILL SCRIPT: MAKE A BACKUP OF s2s-removal.sh, and open to edit
### GO TO SECTION CALLED "EDIT THIS SECTION - CURRENTFILE"
### EDIT CURRENTFILE TO MATCH CURRENTFILELOCATION (FROM ABOVE), ALONG WITH SARFILE NAME


#########################################################################
# CONFIGURATION ITEMS FOR SAR TEMP DIRS REMOVAL SCRIPT (s2s-removal.sh) #
#########################################################################

# TO REMOVE SAR_TEMP FILES AND DIRECTORY, SET TEMP_REMOVAL=1
# SAR-TEMP REMOVAL SHOULD ONLY BE NECESSARY IF YOU ARE COMPLETELY REMOVING THE TA FROM THE FORWARDER
# DEFAULT: TEMP_REMOVAL=0
TEMP_REMOVAL=0

# TO REMOVE SAR-BACKFILL FILES AND DIRECTORY, SET BACKFILL_REMOVAL=1
# DEFAULT: BACKFILL_REMOVAL=0
BACKFILL_REMOVAL=0
 