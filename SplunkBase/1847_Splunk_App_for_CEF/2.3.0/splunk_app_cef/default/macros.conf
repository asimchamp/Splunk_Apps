
## CEF Severity
[get_cef_severity_userdefined(1)]
args       = cef_value
definition = case(match("$cef_value$", "[1-9]|10"),"$cef_value$","$cef_value$"="informational",1,"$cef_value$"="low",3,"$cef_value$"="medium",5,"$cef_value$"="high",7,"$cef_value$"="critical",9,1=1,5)

[get_cef_severity_fieldmap(1)]
args       = splunk_key
definition = case(isint('$splunk_key$') AND '$splunk_key$'>=0 AND '$splunk_key$'<=10,'$splunk_key$','$splunk_key$'="informational",1,'$splunk_key$'="low",3,'$splunk_key$'="medium",5,'$splunk_key$'="high",7,'$splunk_key$'="critical",9,1=1,5)

## Legacy
[get_cef_severity(1)]
args       = splunk_key
definition = case(isint('$splunk_key$') AND '$splunk_key$'>=0 AND '$splunk_key$'<=10,'$splunk_key$','$splunk_key$'="informational",1,'$splunk_key$'="low",3,'$splunk_key$'="medium",5,'$splunk_key$'="high",7,'$splunk_key$'="critical",9,1=1,5)

## CEF Subjects
[get_cef_ip(2)]
args       = splunk_key,cef_key
definition = case(isnotnull('$splunk_key$_ip'),"$cef_key$=".'$splunk_key$_ip'." ",match('$splunk_key$',"^(\d{1,3}\.){3}\d{1,3}$"),"$cef_key$=".'$splunk_key$'." ",1=1,"")

[get_cef_mac(2)]
args       = splunk_key,cef_key
definition = case(isnotnull('$splunk_key$_mac'),"$cef_key$=".'$splunk_key$_mac'." ",match('$splunk_key$',"^(([0-9A-Fa-f]{2}:){5}[0-9A-Fa-f]{2}|([0-9A-Fa-f]{2}-){5}[0-9A-Fa-f]{2}|([0-9A-Fa-f]{4}\.){2}[0-9A-Fa-f]{4})$"),"$cef_key$=".'$splunk_key$'." ",1=1,"")

[get_cef_host(2)]
args       = splunk_key,cef_key
definition = case(isnotnull('$splunk_key$_dns'),"$cef_key$=".'$splunk_key$_dns'." ",isnotnull('$splunk_key$_nt_host'),"$cef_key$=".'$splunk_key$_nt_host'." ",match('$splunk_key$',"^(\d{1,3}\.){3}\d{1,3}$"),"",match('$splunk_key$',"^(([0-9A-Fa-f]{2}:){5}[0-9A-Fa-f]{2}|([0-9A-Fa-f]{2}-){5}[0-9A-Fa-f]{2}|([0-9A-Fa-f]{4}\.){2}[0-9A-Fa-f]{4})$"),"",isnotnull('$splunk_key$'),"$cef_key$=".'$splunk_key$'." ",1=1,"")