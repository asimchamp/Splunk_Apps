[APICFabricLookup]
action.email.inline = 1
alert.digest_mode = True
alert.suppress = 0
alert.track = 0
auto_summarize.dispatch.earliest_time = -1d@h
cron_schedule = */5 * * * *
dispatch.earliest_time = -1h
dispatch.latest_time = now
enableSched = 1
run_on_startup = true
search = | tstats latest(apic.rn) from datamodel=Health where apic.component=fabricNode groupby apic.name,apic.id,apic.dn,apic.apic_host | rename apic.dn AS dn,apic.name AS name, apic.id AS id, apic.apic_host AS apic_host | where dn LIKE "%/health" | table apic_host,id,name | inputlookup append=T APICNodeTable | dedup apic_host, id, name | outputlookup APICNodeLookup.csv
disabled = 0

[APICCEPLookup]
action.email.inline = 1
alert.digest_mode = True
alert.suppress = 0
alert.track = 0
auto_summarize.dispatch.earliest_time = -4h@m
cron_schedule = */5 * * * *
dispatch.earliest_time = -8h
dispatch.latest_time = now
enableSched = 1
run_on_startup = true
search = | tstats latest(classInfo.End_Point.EPG) AS EPG latest(classInfo.encap) AS VLAN latest(classInfo.dn) AS dn from datamodel=Systems where classInfo.component=fvCEp groupby    classInfo.mac,classInfo.apic_host | dedup classInfo.mac | rename classInfo.mac AS mac_addr, classInfo.apic_host AS apic_host |  join type=inner max=0 mac_addr [  search eventtype=cisco_apic_class component=fvRsVm  | rex field=dn "cep-(?<mac_addr>[A-F a-f 0-9 : ]+)" | dedup tDn |stats latest(tDn) AS tDn by mac_addr ] | table mac_addr,tDn,VLAN,EPG,dn,apic_host | join type=inner max=0 tDn [|tstats latest(classInfo.dn) AS "tDn" latest(classInfo.VM.vmID) AS vmID latest(classInfo.state) AS state from datamodel=Systems WHERE classInfo.component=compVm groupby classInfo.name,classInfo.apic_host | rename classInfo.name AS name, classInfo.apic_host AS apic_host | table name,state,tDn,vmID,apic_host ] | join type=inner max=0 mac_addr [ | tstats latest(classInfo.tDn) AS tDn from datamodel=Systems WHERE classInfo.component=fvRsHyper groupby classInfo.HV_Relation.mac_addr,classInfo.apic_host | rename classInfo.HV_Relation.mac_addr AS mac_addr, classInfo.apic_host AS apic_host]| table dn,name,state,mac_addr,tDn,VLAN,EPG,vmID,apic_host | join type=inner max=0 tDn [ |tstats latest(classInfo.HV.controller) AS controller latest(classInfo.HV.domainController) AS "domain-controller"  latest(classInfo.name) AS "ESX-Host" latest(classInfo.oid) AS "hostID" from datamodel=Systems WHERE classInfo.component=compHV groupby classInfo.dn, classInfo.apic_host | rename classInfo.dn AS tDn, classInfo.apic_host AS apic_host | table dn,name,state,mac,VLAN,ESX-Host,tDn,controller,EPG,vmID,hostID,domain-controller,apic_host] | join type=inner max=0 controller [ | tstats  latest(classInfo.hostOrIp) AS vCenter from datamodel=Systems WHERE classInfo.component=vmmCtrlrP groupby classInfo.name,classInfo.apic_host | rename classInfo.name AS controller, classInfo.apic_host AS apic_host | table controller,vCenter,apic_host]  |  join type=inner max=0 EPG  [ | tstats latest(apic.twScore) AS "EPG-Health" from datamodel=Health WHERE apic.component=fvEPg groupby apic.name, apic.apic_host | rename apic.name AS EPG, apic.apic_host AS apic_host | table "EPG-Health",EPG,apic_host ] | table dn,EPG,EPG-Health,name,vmID,state,mac_addr,ESX-Host,hostID,VLAN,vCenter,domain-controller,apic_host | join type=inner max=0 mac_addr [ | tstats latest(classInfo.CEP_Paths.path) AS path latest(classInfo.CEP_Paths.node) AS node latest(classInfo.CEP_Paths.mac_addr) AS mac_addr from datamodel=Systems WHERE classInfo.component=fvRsCEpToPathEp groupby classInfo.dn, classInfo.apic_host | rename classInfo.apic_host AS apic_host | strcat "Node-" node "/" path Interface | table mac_addr,Interface, apic_host] | dedup dn | table dn,EPG,EPG-Health,name,vmID,state,mac_addr,ESX-Host,hostID,VLAN,vCenter,domain-controller,Interface,apic_host | rename  name AS "VirtualMachine" mac_addr AS "Network_Adapter" | inputlookup append=T APICCEPLookup | dedup dn | outputlookup APICVMLookup.csv
disabled = 0

[MSO Sites Lookups]
action.email.inline = 1
alert.digest_mode = True
alert.suppress = 0
alert.track = 0
auto_summarize.dispatch.earliest_time = -1d@h
cron_schedule = */5 * * * *
dispatch.earliest_time = -1h
dispatch.latest_time = now
enableSched = 1
run_on_startup = true
disabled = 0
search = sourcetype="cisco:mso" "mso_api_endpoint=sitehealth" | mvexpand urls | dedup urls | rex field=urls "https:\/\/(?<apic_host>.*)" | table mso_host, apic_host | join max=0 apic_host [| search eventtype="cisco_apic_*" component=credentials | fields apic_host | dedup apic_host] | table mso_host, apic_host | outputlookup append=t mso_site_details

[ACI Monitoring Threshold: Tenant Exceeds Warning Threshold Limit]
action.email = 1
action.email.include.search = 1
action.email.include.trigger = 1
action.email.include.trigger_time = 1
action.email.inline = 1
action.email.priority = 2
action.email.sendresults = 1
action.email.useNSSubject = 1
alert.suppress = 0
alert.track = 1
counttype = number of events
cron_schedule = 0 * * * *
description = The number of Tenant count Exceeds the Warning Threshold Limit
dispatch.earliest_time = -1h
dispatch.latest_time = now
display.general.type = statistics
display.page.search.tab = statistics
enableSched = 1
quantity = 0
relation = greater than
request.ui_dispatch_app = cisco-app-ACI
request.ui_dispatch_view = search
search = eventtype=cisco_apic_health (component=fvTenant) | stats dc(name) AS Count by apic_host | JOIN [ inputlookup tenantThreshold.csv | stats values(warningThreshold) AS WarningThr, values(criticalThreshold) AS CriticalThr, values(maxThreshold) AS MaxThr] | where Count >= WarningThr AND Count < CriticalThr | table apic_host, Count, WarningThr, CriticalThr, MaxThr | rename Count AS "No. of Tenants" | rename WarningThr AS "Warning Threshold" | rename CriticalThr AS "Critical Threshold" | rename MaxThr AS "Max Threshold" | rename apic_host AS APIC


[ACI Monitoring Threshold: Tenant Exceeds Critical Threshold Limit]
action.email = 1
action.email.include.search = 1
action.email.include.trigger = 1
action.email.include.trigger_time = 1
action.email.inline = 1
action.email.priority = 1
action.email.sendresults = 1
action.email.useNSSubject = 1
alert.severity = 4
alert.suppress = 0
alert.track = 1
counttype = number of events
cron_schedule = 0 * * * *
description = The number of Tenant count Exceeds the Critical Threshold Limit
dispatch.earliest_time = -1h
dispatch.latest_time = now
display.general.type = statistics
display.page.search.tab = statistics
enableSched = 1
quantity = 0
relation = greater than
request.ui_dispatch_app = cisco-app-ACI
request.ui_dispatch_view = search
search = eventtype=cisco_apic_health (component=fvTenant) | stats dc(name) AS Count by apic_host | JOIN [ inputlookup tenantThreshold.csv | stats values(warningThreshold) AS WarningThr, values(criticalThreshold) AS CriticalThr, values(maxThreshold) AS MaxThr] | where Count >= CriticalThr AND Count < MaxThr | table apic_host, Count, WarningThr, CriticalThr, MaxThr | rename Count AS "No. of Tenants" | rename WarningThr AS "Warning Threshold" | rename CriticalThr AS "Critical Threshold" | rename MaxThr AS "Max Threshold" | rename apic_host AS APIC


[ACI Monitoring Threshold: Tenant Exceeds Max Threshold Limit]
action.email = 1
action.email.include.search = 1
action.email.include.trigger = 1
action.email.include.trigger_time = 1
action.email.inline = 1
action.email.priority = 1
action.email.sendresults = 1
action.email.useNSSubject = 1
alert.severity = 5
alert.suppress = 0
alert.track = 1
counttype = number of events
cron_schedule = 0 * * * *
description = The number of Tenant count Exceeds the Max Threshold Limit
dispatch.earliest_time = -1h
dispatch.latest_time = now
display.general.type = statistics
display.page.search.tab = statistics
enableSched = 1
quantity = 0
relation = greater than
request.ui_dispatch_app = cisco-app-ACI
request.ui_dispatch_view = search
search = eventtype=cisco_apic_health (component=fvTenant) | stats dc(name) AS Count by apic_host | JOIN [ inputlookup tenantThreshold.csv | stats values(warningThreshold) AS WarningThr, values(criticalThreshold) AS CriticalThr, values(maxThreshold) AS MaxThr] | where Count >= MaxThr | table apic_host, Count, WarningThr, CriticalThr, MaxThr | rename Count AS "No. of Tenants" | rename WarningThr AS "Warning Threshold" | rename CriticalThr AS "Critical Threshold" | rename MaxThr AS "Max Threshold" | rename apic_host AS APIC


[ACI Monitoring Threshold: EPG Exceeds Warning Threshold Limit]
action.email = 1
action.email.include.search = 1
action.email.include.trigger = 1
action.email.include.trigger_time = 1
action.email.inline = 1
action.email.priority = 2
action.email.sendresults = 1
action.email.useNSSubject = 1
alert.suppress = 0
alert.track = 1
counttype = number of events
cron_schedule = 0 * * * *
description = The number of EPG count Exceeds the Warning Threshold Limit
dispatch.earliest_time = -1h
dispatch.latest_time = now
display.general.type = statistics
display.page.search.tab = statistics
enableSched = 1
quantity = 0
relation = greater than
request.ui_dispatch_app = cisco-app-ACI
request.ui_dispatch_view = search
search = eventtype=cisco_apic_health component=fvAEPg dn="*/health" | stats dc(name) by dn, apic_host | stats count(dc(name)) AS Count by apic_host | JOIN [ inputlookup epgThreshold.csv | stats values(warningThreshold) AS WarningThr, values(criticalThreshold) AS CriticalThr, values(maxThreshold) AS MaxThr] | where Count >= WarningThr AND Count < CriticalThr | table apic_host, Count, WarningThr, CriticalThr, MaxThr | rename Count AS "No. of EPG's" | rename WarningThr AS "Warning Threshold" | rename CriticalThr AS "Critical Threshold" | rename MaxThr AS "Max Threshold" | rename apic_host AS APIC


[ACI Monitoring Threshold: EPG Exceeds Critical Threshold Limit]
action.email = 1
action.email.include.search = 1
action.email.include.trigger = 1
action.email.include.trigger_time = 1
action.email.inline = 1
action.email.priority = 1
action.email.sendresults = 1
action.email.useNSSubject = 1
alert.severity = 4
alert.suppress = 0
alert.track = 1
counttype = number of events
cron_schedule = 0 * * * *
description = The number of EPG count Exceeds the Critical Threshold Limit
dispatch.earliest_time = -1h
dispatch.latest_time = now
display.general.type = statistics
display.page.search.tab = statistics
enableSched = 1
quantity = 0
relation = greater than
request.ui_dispatch_app = cisco-app-ACI
request.ui_dispatch_view = search
search = eventtype=cisco_apic_health component=fvAEPg dn="*/health" | stats dc(name) by dn, apic_host | stats count(dc(name)) AS Count by apic_host | JOIN [ inputlookup epgThreshold.csv | stats values(warningThreshold) AS WarningThr, values(criticalThreshold) AS CriticalThr, values(maxThreshold) AS MaxThr] | where Count >= CriticalThr AND Count < MaxThr | table apic_host, Count, WarningThr, CriticalThr, MaxThr | rename Count AS "No. of EPG's" | rename WarningThr AS "Warning Threshold" | rename CriticalThr AS "Critical Threshold" | rename MaxThr AS "Max Threshold" | rename apic_host AS APIC


[ACI Monitoring Threshold: EPG Exceeds Max Threshold Limit]
action.email = 1
action.email.include.search = 1
action.email.include.trigger = 1
action.email.include.trigger_time = 1
action.email.inline = 1
action.email.priority = 1
action.email.sendresults = 1
action.email.useNSSubject = 1
alert.severity = 5
alert.suppress = 0
alert.track = 1
counttype = number of events
cron_schedule = 0 * * * *
description = The number of EPG count Exceeds the Max Threshold Limit
dispatch.earliest_time = -1h
dispatch.latest_time = now
display.general.type = statistics
display.page.search.tab = statistics
enableSched = 1
quantity = 0
relation = greater than
request.ui_dispatch_app = cisco-app-ACI
request.ui_dispatch_view = search
search = eventtype=cisco_apic_health component=fvAEPg dn="*/health" | stats dc(name) by dn, apic_host | stats count(dc(name)) AS Count by apic_host | JOIN [ inputlookup epgThreshold.csv | stats values(warningThreshold) AS WarningThr, values(criticalThreshold) AS CriticalThr, values(maxThreshold) AS MaxThr] | where Count >= MaxThr | table apic_host, Count, WarningThr, CriticalThr, MaxThr | rename Count AS "No. of EPG's" | rename WarningThr AS "Warning Threshold" | rename CriticalThr AS "Critical Threshold" | rename MaxThr AS "Max Threshold" | rename apic_host AS APIC


[ACI Monitoring Threshold: Contracts Exceeds Warning Threshold Limit]
action.email = 1
action.email.include.search = 1
action.email.include.trigger = 1
action.email.include.trigger_time = 1
action.email.inline = 1
action.email.priority = 2
action.email.sendresults = 1
action.email.useNSSubject = 1
alert.suppress = 0
alert.track = 1
counttype = number of events
cron_schedule = 0 * * * *
description = The number of Contracts count Exceeds the Warning Threshold Limit
dispatch.earliest_time = -1h
dispatch.latest_time = now
display.general.type = statistics
display.page.search.tab = statistics
enableSched = 1
quantity = 0
relation = greater than
request.ui_dispatch_app = cisco-app-ACI
request.ui_dispatch_view = search
search = eventtype=cisco_apic_health component=vzBrCP | stats dc(name) by dn, apic_host | stats count(dc(name)) AS Count by apic_host | JOIN [ inputlookup contractsThreshold.csv | stats values(warningThreshold) AS WarningThr, values(criticalThreshold) AS CriticalThr, values(maxThreshold) AS MaxThr] | where Count >= WarningThr AND Count < CriticalThr | table apic_host, Count, WarningThr, CriticalThr, MaxThr | rename Count AS "No. of Contracts" | rename WarningThr AS "Warning Threshold" | rename CriticalThr AS "Critical Threshold" | rename MaxThr AS "Max Threshold" | rename apic_host AS APIC


[ACI Monitoring Threshold: Contracts Exceeds Critical Threshold Limit]
action.email = 1
action.email.include.search = 1
action.email.include.trigger = 1
action.email.include.trigger_time = 1
action.email.inline = 1
action.email.priority = 1
action.email.sendresults = 1
action.email.useNSSubject = 1
alert.severity = 4
alert.suppress = 0
alert.track = 1
counttype = number of events
cron_schedule = 0 * * * *
description = The number of Contracts count Exceeds the Critical Threshold Limit
dispatch.earliest_time = -1h
dispatch.latest_time = now
display.general.type = statistics
display.page.search.tab = statistics
enableSched = 1
quantity = 0
relation = greater than
request.ui_dispatch_app = cisco-app-ACI
request.ui_dispatch_view = search
search = eventtype=cisco_apic_health component=vzBrCP | stats dc(name) by dn, apic_host | stats count(dc(name)) AS Count by apic_host | JOIN [ inputlookup contractsThreshold.csv | stats values(warningThreshold) AS WarningThr, values(criticalThreshold) AS CriticalThr, values(maxThreshold) AS MaxThr] | where Count >= CriticalThr AND Count < MaxThr | table apic_host, Count, WarningThr, CriticalThr, MaxThr | rename Count AS "No. of Contracts" | rename WarningThr AS "Warning Threshold" | rename CriticalThr AS "Critical Threshold" | rename MaxThr AS "Max Threshold" | rename apic_host AS APIC


[ACI Monitoring Threshold: Contracts Exceeds Max Threshold Limit]
action.email = 1
action.email.include.search = 1
action.email.include.trigger = 1
action.email.include.trigger_time = 1
action.email.inline = 1
action.email.priority = 1
action.email.sendresults = 1
action.email.useNSSubject = 1
alert.severity = 5
alert.suppress = 0
alert.track = 1
counttype = number of events
cron_schedule = 0 * * * *
description = The number of Contract count Exceeds the Max Threshold Limit
dispatch.earliest_time = -1h
dispatch.latest_time = now
display.general.type = statistics
display.page.search.tab = statistics
enableSched = 1
quantity = 0
relation = greater than
request.ui_dispatch_app = cisco-app-ACI
request.ui_dispatch_view = search
search = eventtype=cisco_apic_health component=vzBrCP | stats dc(name) by dn, apic_host | stats count(dc(name)) AS Count by apic_host | JOIN [ inputlookup contractsThreshold.csv | stats values(warningThreshold) AS WarningThr, values(criticalThreshold) AS CriticalThr, values(maxThreshold) AS MaxThr] | where Count >= MaxThr | table apic_host, Count, WarningThr, CriticalThr, MaxThr | rename Count AS "No. of Contracts" | rename WarningThr AS "Warning Threshold" | rename CriticalThr AS "Critical Threshold" | rename MaxThr AS "Max Threshold" | rename apic_host AS APIC


[ACI Monitoring Threshold: Filters Exceeds Warning Threshold Limit]
action.email = 1
action.email.include.search = 1
action.email.include.trigger = 1
action.email.include.trigger_time = 1
action.email.inline = 1
action.email.priority = 2
action.email.sendresults = 1
action.email.useNSSubject = 1
alert.suppress = 0
alert.track = 1
counttype = number of events
cron_schedule = 0 * * * *
description = The number of Filters count Exceeds the Warning Threshold Limit
dispatch.earliest_time = -1h
dispatch.latest_time = now
display.general.type = statistics
display.page.search.tab = statistics
enableSched = 1
quantity = 0
relation = greater than
request.ui_dispatch_app = cisco-app-ACI
request.ui_dispatch_view = search
search = eventtype=cisco_apic_health component=vzFilter | stats dc(name) by dn, apic_host | stats count(dc(name)) AS Count by apic_host | JOIN [ inputlookup filtersThreshold.csv | stats values(warningThreshold) AS WarningThr, values(criticalThreshold) AS CriticalThr, values(maxThreshold) AS MaxThr] | where Count >= WarningThr AND Count < CriticalThr | table apic_host, Count, WarningThr, CriticalThr, MaxThr | rename Count AS "No. of Filters" | rename WarningThr AS "Warning Threshold" | rename CriticalThr AS "Critical Threshold" | rename MaxThr AS "Max Threshold" | rename apic_host AS APIC


[ACI Monitoring Threshold: Filters Exceeds Critical Threshold Limit]
action.email = 1
action.email.include.search = 1
action.email.include.trigger = 1
action.email.include.trigger_time = 1
action.email.inline = 1
action.email.priority = 1
action.email.sendresults = 1
action.email.useNSSubject = 1
alert.severity = 4
alert.suppress = 0
alert.track = 1
counttype = number of events
cron_schedule = 0 * * * *
description = The number of Filters count Exceeds the Critical Threshold Limit
dispatch.earliest_time = -1h
dispatch.latest_time = now
display.general.type = statistics
display.page.search.tab = statistics
enableSched = 1
quantity = 0
relation = greater than
request.ui_dispatch_app = cisco-app-ACI
request.ui_dispatch_view = search
search = eventtype=cisco_apic_health component=vzFilter | stats dc(name) by dn, apic_host | stats count(dc(name)) AS Count by apic_host | JOIN [ inputlookup filtersThreshold.csv | stats values(warningThreshold) AS WarningThr, values(criticalThreshold) AS CriticalThr, values(maxThreshold) AS MaxThr] | where Count >= CriticalThr AND Count < MaxThr | table apic_host, Count, WarningThr, CriticalThr, MaxThr | rename Count AS "No. of Filters" | rename WarningThr AS "Warning Threshold" | rename CriticalThr AS "Critical Threshold" | rename MaxThr AS "Max Threshold" | rename apic_host AS APIC


[ACI Monitoring Threshold: Filters Exceeds Max Threshold Limit]
action.email = 1
action.email.include.search = 1
action.email.include.trigger = 1
action.email.include.trigger_time = 1
action.email.inline = 1
action.email.priority = 1
action.email.sendresults = 1
action.email.useNSSubject = 1
alert.severity = 5
alert.suppress = 0
alert.track = 1
counttype = number of events
cron_schedule = 0 * * * *
description = The number of Filters count Exceeds the Max Threshold Limit
dispatch.earliest_time = -1h
dispatch.latest_time = now
display.general.type = statistics
display.page.search.tab = statistics
enableSched = 1
quantity = 0
relation = greater than
request.ui_dispatch_app = cisco-app-ACI
request.ui_dispatch_view = search
search = eventtype=cisco_apic_health component=vzFilter | stats dc(name) by dn, apic_host | stats count(dc(name)) AS Count by apic_host | JOIN [ inputlookup filtersThreshold.csv | stats values(warningThreshold) AS WarningThr, values(criticalThreshold) AS CriticalThr, values(maxThreshold) AS MaxThr] | where Count >= MaxThr | table apic_host, Count, WarningThr, CriticalThr, MaxThr | rename Count AS "No. of Filters" | rename WarningThr AS "Warning Threshold" | rename CriticalThr AS "Critical Threshold" | rename MaxThr AS "Max Threshold" | rename apic_host AS APIC


[ACI Monitoring Threshold: BD Exceeds Warning Threshold Limit]
action.email = 1
action.email.include.search = 1
action.email.include.trigger = 1
action.email.include.trigger_time = 1
action.email.inline = 1
action.email.priority = 2
action.email.sendresults = 1
action.email.useNSSubject = 1
alert.suppress = 0
alert.track = 1
counttype = number of events
cron_schedule = 0 * * * *
description = The number of Bridge Domain count Exceeds the Warning Threshold Limit
dispatch.earliest_time = -1h
dispatch.latest_time = now
display.general.type = statistics
display.page.search.tab = statistics
enableSched = 1
quantity = 0
relation = greater than
request.ui_dispatch_app = cisco-app-ACI
request.ui_dispatch_view = search
search = eventtype=cisco_apic_health component=fvBD dn="*/health" | stats dc(name) by dn, apic_host | stats count(dc(name)) AS Count by apic_host | JOIN [ inputlookup bdThreshold.csv | stats values(warningThreshold) AS WarningThr, values(criticalThreshold) AS CriticalThr, values(maxThreshold) AS MaxThr] | where Count >= WarningThr AND Count < CriticalThr | table apic_host, Count, WarningThr, CriticalThr, MaxThr | rename Count AS "No. of Bridge Domain" | rename WarningThr AS "Warning Threshold" | rename CriticalThr AS "Critical Threshold" | rename MaxThr AS "Max Threshold" | rename apic_host AS APIC


[ACI Monitoring Threshold: BD Exceeds Critical Threshold Limit]
action.email = 1
action.email.include.search = 1
action.email.include.trigger = 1
action.email.include.trigger_time = 1
action.email.inline = 1
action.email.priority = 1
action.email.sendresults = 1
action.email.useNSSubject = 1
alert.severity = 4
alert.suppress = 0
alert.track = 1
counttype = number of events
cron_schedule = 0 * * * *
description = The number of Bridge Domain count Exceeds the Critical Threshold Limit
dispatch.earliest_time = -1h
dispatch.latest_time = now
display.general.type = statistics
display.page.search.tab = statistics
enableSched = 1
quantity = 0
relation = greater than
request.ui_dispatch_app = cisco-app-ACI
request.ui_dispatch_view = search
search = eventtype=cisco_apic_health component=fvBD dn="*/health" | stats dc(name) by dn, apic_host | stats count(dc(name)) AS Count by apic_host | JOIN [ inputlookup bdThreshold.csv | stats values(warningThreshold) AS WarningThr, values(criticalThreshold) AS CriticalThr, values(maxThreshold) AS MaxThr] | where Count >= CriticalThr AND Count < MaxThr | table apic_host, Count, WarningThr, CriticalThr, MaxThr | rename Count AS "No. of Bridge Domain" | rename WarningThr AS "Warning Threshold" | rename CriticalThr AS "Critical Threshold" | rename MaxThr AS "Max Threshold" | rename apic_host AS APIC


[ACI Monitoring Threshold: BD Exceeds Max Threshold Limit]
action.email = 1
action.email.include.search = 1
action.email.include.trigger = 1
action.email.include.trigger_time = 1
action.email.inline = 1
action.email.priority = 1
action.email.sendresults = 1
action.email.useNSSubject = 1
alert.severity = 5
alert.suppress = 0
alert.track = 1
counttype = number of events
cron_schedule = 0 * * * *
description = The number of Bridge Domain count Exceeds the Max Threshold Limit
dispatch.earliest_time = -1h
dispatch.latest_time = now
display.general.type = statistics
display.page.search.tab = statistics
enableSched = 1
quantity = 0
relation = greater than
request.ui_dispatch_app = cisco-app-ACI
request.ui_dispatch_view = search
search = eventtype=cisco_apic_health component=fvBD dn="*/health" | stats dc(name) by dn, apic_host | stats count(dc(name)) AS Count by apic_host | JOIN [ inputlookup bdThreshold.csv | stats values(warningThreshold) AS WarningThr, values(criticalThreshold) AS CriticalThr, values(maxThreshold) AS MaxThr] | where Count >= MaxThr | table apic_host, Count, WarningThr, CriticalThr, MaxThr | rename Count AS "No. of Bridge Domain" | rename WarningThr AS "Warning Threshold" | rename CriticalThr AS "Critical Threshold" | rename MaxThr AS "Max Threshold" | rename apic_host AS APIC


[ACI Monitoring Threshold: L3Out Networks Exceeds Warning Threshold Limit]
action.email = 1
action.email.include.search = 1
action.email.include.trigger = 1
action.email.include.trigger_time = 1
action.email.inline = 1
action.email.priority = 2
action.email.sendresults = 1
action.email.useNSSubject = 1
alert.suppress = 0
alert.track = 1
counttype = number of events
cron_schedule = 0 * * * *
description = The number of L3Out Networks count Exceeds the Warning Threshold Limit
dispatch.earliest_time = -1h
dispatch.latest_time = now
display.general.type = statistics
display.page.search.tab = statistics
enableSched = 1
quantity = 0
relation = greater than
request.ui_dispatch_app = cisco-app-ACI
request.ui_dispatch_view = search
search = eventtype=cisco_apic_health component=l3extOut | stats dc(name) by dn, apic_host | stats count(dc(name)) AS Count by apic_host | JOIN [ inputlookup l3outnetworksThreshold.csv | stats values(warningThreshold) AS WarningThr, values(criticalThreshold) AS CriticalThr, values(maxThreshold) AS MaxThr] | where Count >= WarningThr AND Count < CriticalThr | table apic_host, Count, WarningThr, CriticalThr, MaxThr | rename Count AS "No. of L3Out Networks" | rename WarningThr AS "Warning Threshold" | rename CriticalThr AS "Critical Threshold" | rename MaxThr AS "Max Threshold" | rename apic_host AS APIC


[ACI Monitoring Threshold: L3Out Networks Exceeds Critical Threshold Limit]
action.email = 1
action.email.include.search = 1
action.email.include.trigger = 1
action.email.include.trigger_time = 1
action.email.inline = 1
action.email.priority = 1
action.email.sendresults = 1
action.email.useNSSubject = 1
alert.severity = 4
alert.suppress = 0
alert.track = 1
counttype = number of events
cron_schedule = 0 * * * *
description = The number of L3Out Networks count Exceeds the Critical Threshold Limit
dispatch.earliest_time = -1h
dispatch.latest_time = now
display.general.type = statistics
display.page.search.tab = statistics
enableSched = 1
quantity = 0
relation = greater than
request.ui_dispatch_app = cisco-app-ACI
request.ui_dispatch_view = search
search = eventtype=cisco_apic_health component=l3extOut | stats dc(name) by dn, apic_host | stats count(dc(name)) AS Count by apic_host | JOIN [ inputlookup l3outnetworksThreshold.csv | stats values(warningThreshold) AS WarningThr, values(criticalThreshold) AS CriticalThr, values(maxThreshold) AS MaxThr] | where Count >= CriticalThr AND Count < MaxThr | table apic_host, Count, WarningThr, CriticalThr, MaxThr | rename Count AS "No. of L3Out Networks" | rename WarningThr AS "Warning Threshold" | rename CriticalThr AS "Critical Threshold" | rename MaxThr AS "Max Threshold" | rename apic_host AS APIC


[ACI Monitoring Threshold: L3Out Networks Exceeds Max Threshold Limit]
action.email = 1
action.email.include.search = 1
action.email.include.trigger = 1
action.email.include.trigger_time = 1
action.email.inline = 1
action.email.priority = 1
action.email.sendresults = 1
action.email.useNSSubject = 1
alert.severity = 5
alert.suppress = 0
alert.track = 1
counttype = number of events
cron_schedule = 0 * * * *
description = The number of L3Out Networks count Exceeds the Max Threshold Limit
dispatch.earliest_time = -1h
dispatch.latest_time = now
display.general.type = statistics
display.page.search.tab = statistics
enableSched = 1
quantity = 0
relation = greater than
request.ui_dispatch_app = cisco-app-ACI
request.ui_dispatch_view = search
search = eventtype=cisco_apic_health component=l3extOut | stats dc(name) by dn, apic_host | stats count(dc(name)) AS Count by apic_host | JOIN [ inputlookup l3outnetworksThreshold.csv | stats values(warningThreshold) AS WarningThr, values(criticalThreshold) AS CriticalThr, values(maxThreshold) AS MaxThr] | where Count >= MaxThr | table apic_host, Count, WarningThr, CriticalThr, MaxThr | rename Count AS "No. of L3Out Networks" | rename WarningThr AS "Warning Threshold" | rename CriticalThr AS "Critical Threshold" | rename MaxThr AS "Max Threshold" | rename apic_host AS APIC


[ACI Monitoring Threshold: TCAM Percentage Utilized Exceeds Warning Threshold Limit]
action.email = 1
action.email.include.search = 1
action.email.include.trigger = 1
action.email.include.trigger_time = 1
action.email.inline = 1
action.email.priority = 2
action.email.sendresults = 1
action.email.useNSSubject = 1
alert.suppress = 0
alert.track = 1
counttype = number of events
cron_schedule = 0 * * * *
description = The TCAM Percentage Utilized Exceeds the Warning Threshold Limit
dispatch.earliest_time = -1h
dispatch.latest_time = now
display.general.type = statistics
display.page.search.tab = statistics
enableSched = 1
quantity = 0
relation = greater than
request.ui_dispatch_app = cisco-app-ACI
request.ui_dispatch_view = search
search = | `apic-fabric-overview` |  search component="eqptcapacityPolEntry5min" | stats avg(normalizedLast) AS avg_normalizedLast by node, apic_host | eval avg_normalizedLast=round(avg_normalizedLast,2) | table node, avg_normalizedLast, apic_host | join [ inputlookup tcamThreshold.csv | stats values(warningThreshold) AS WarningThr, values(criticalThreshold) AS CriticalThr] | where  avg_normalizedLast >= WarningThr AND avg_normalizedLast < CriticalThr | table apic_host, node, avg_normalizedLast, WarningThr, CriticalThr | rename avg_normalizedLast AS "TCAM Percentage" | rename WarningThr AS "Warning Threshold" | rename CriticalThr AS "Critical Threshold" | rename apic_host AS APIC | rename node AS Nodename


[ACI Monitoring Threshold: TCAM Percentage Utilized Exceeds Critical Threshold Limit]
action.email = 1
action.email.include.search = 1
action.email.include.trigger = 1
action.email.include.trigger_time = 1
action.email.inline = 1
action.email.priority = 1
action.email.sendresults = 1
action.email.useNSSubject = 1
alert.severity = 4
alert.suppress = 0
alert.track = 1
counttype = number of events
cron_schedule = 0 * * * *
description = The TCAM Percentage Utilized Exceeds the Critical Threshold Limit
dispatch.earliest_time = -1h
dispatch.latest_time = now
display.general.type = statistics
display.page.search.tab = statistics
enableSched = 1
quantity = 0
relation = greater than
request.ui_dispatch_app = cisco-app-ACI
request.ui_dispatch_view = search
search = | `apic-fabric-overview` |  search component="eqptcapacityPolEntry5min" | stats avg(normalizedLast) AS avg_normalizedLast by node, apic_host | eval avg_normalizedLast=round(avg_normalizedLast,2) | table node, avg_normalizedLast, apic_host | join [ inputlookup tcamThreshold.csv | stats values(warningThreshold) AS WarningThr, values(criticalThreshold) AS CriticalThr] | where  avg_normalizedLast >= CriticalThr | table apic_host, node, avg_normalizedLast, WarningThr, CriticalThr | rename avg_normalizedLast AS "TCAM Percentage" | rename WarningThr AS "Warning Threshold" | rename CriticalThr AS "Critical Threshold" | rename apic_host AS APIC | rename node AS Nodename


[ACI Monitoring Threshold: Egress Port Utilization for Leafs/Spines Exceeds Warning Threshold Limit]
action.email = 1
action.email.include.search = 1
action.email.include.trigger = 1
action.email.include.trigger_time = 1
action.email.inline = 1
action.email.priority = 2
action.email.sendresults = 1
action.email.useNSSubject = 1
alert.suppress = 0
alert.track = 1
counttype = number of events
cron_schedule = 0 * * * *
description = The Egress Port Utilization Exceeds the Warning Threshold Limit
dispatch.earliest_time = -1h
dispatch.latest_time = now
display.general.type = statistics
display.page.search.tab = statistics
enableSched = 1
quantity = 0
relation = greater than
request.ui_dispatch_app = cisco-app-ACI
request.ui_dispatch_view = search
search = eventtype=cisco_apic_stats component=eqptEgrTotal5min OR component=eqptEgrTotal15min | rex field=dn "node-(?<nodeID>\d+)\/sys\/phys-\[(?<Interface>.*?)\]" | stats avg(bytesRate), avg(utilLast) by Interface, nodeID, apic_host | rename avg(bytesRate) AS avg_bytesRate, avg(utilLast) AS avg_utilLast | eval avg_bytesRate=round(avg_bytesRate,2), avg_utilLast=round(avg_utilLast,2) | table apic_host, nodeID, avg_bytesRate, avg_utilLast, Interface | JOIN apic_host nodeID [ | `apic-fabric-overview` | search component=fabricNode Role=leaf OR Role=spine AND id>16 | table apic_host, name, Role, nodeID] | join [ inputlookup portutilThreshold.csv | stats values(warningThreshold) AS WarningThr, values(criticalThreshold) AS CriticalThr] | where avg_utilLast >= WarningThr AND avg_utilLast < CriticalThr | table apic_host, name, nodeID, Role, Interface, avg_bytesRate, avg_utilLast, WarningThr, CriticalThr | SORT apic_host, role, name | rename avg_bytesRate AS "Total egress bytes rate", avg_utilLast AS "Egress port utilization", name AS "Node Name", WarningThr AS "Warning Threshold", CriticalThr AS "Critical Threshold", apic_host AS APIC


[ACI Monitoring Threshold: Egress Port Utilization for Leafs/Spines Exceeds Critical Threshold Limit]
action.email = 1
action.email.include.search = 1
action.email.include.trigger = 1
action.email.include.trigger_time = 1
action.email.inline = 1
action.email.priority = 1
action.email.sendresults = 1
action.email.useNSSubject = 1
alert.severity = 4
alert.suppress = 0
alert.track = 1
counttype = number of events
cron_schedule = 0 * * * *
description = The Egress Port Utilization Exceeds the Critical Threshold Limit
dispatch.earliest_time = -1h
dispatch.latest_time = now
display.general.type = statistics
display.page.search.tab = statistics
enableSched = 1
quantity = 0
relation = greater than
request.ui_dispatch_app = cisco-app-ACI
request.ui_dispatch_view = search
search = eventtype=cisco_apic_stats component=eqptEgrTotal5min OR component=eqptEgrTotal15min | rex field=dn "node-(?<nodeID>\d+)\/sys\/phys-\[(?<Interface>.*?)\]" | stats avg(bytesRate), avg(utilLast) by Interface, nodeID, apic_host | rename avg(bytesRate) AS avg_bytesRate, avg(utilLast) AS avg_utilLast | eval avg_bytesRate=round(avg_bytesRate,2), avg_utilLast=round(avg_utilLast,2) | table apic_host, nodeID, avg_bytesRate, avg_utilLast, Interface | JOIN apic_host nodeID [ | `apic-fabric-overview` | search component=fabricNode Role=leaf OR Role=spine AND id>16 | table apic_host, name, Role, nodeID] | join [ inputlookup portutilThreshold.csv | stats values(warningThreshold) AS WarningThr, values(criticalThreshold) AS CriticalThr] | where avg_utilLast >= CriticalThr | table apic_host, name, nodeID, Role, Interface, avg_bytesRate, avg_utilLast, WarningThr, CriticalThr | SORT apic_host, role, name | rename avg_bytesRate AS "Total egress bytes rate", avg_utilLast AS "Egress port utilization", name AS "Node Name", WarningThr AS "Warning Threshold", CriticalThr AS "Critical Threshold", apic_host AS APIC


[ACI Monitoring Threshold: Ingress Port Utilization for Leafs/Spines Exceeds Warning Threshold Limit]
action.email = 1
action.email.include.search = 1
action.email.include.trigger = 1
action.email.include.trigger_time = 1
action.email.inline = 1
action.email.priority = 2
action.email.sendresults = 1
action.email.useNSSubject = 1
alert.suppress = 0
alert.track = 1
counttype = number of events
cron_schedule = 0 * * * *
description = The Ingress Port Utilization Exceeds the Warning Threshold Limit
dispatch.earliest_time = -1h
dispatch.latest_time = now
display.general.type = statistics
display.page.search.tab = statistics
enableSched = 1
quantity = 0
relation = greater than
request.ui_dispatch_app = cisco-app-ACI
request.ui_dispatch_view = search
search = eventtype=cisco_apic_stats component=eqptIngrTotal5min OR component=eqptIngrTotal15min | rex field=dn "node-(?<nodeID>\d+)\/sys\/phys-\[(?<Interface>.*?)\]" | stats avg(bytesRate), avg(utilLast) by Interface, nodeID, apic_host | rename avg(bytesRate) AS avg_bytesRate, avg(utilLast) AS avg_utilLast | eval avg_bytesRate=round(avg_bytesRate,2), avg_utilLast=round(avg_utilLast,2) | table apic_host, nodeID, avg_bytesRate, avg_utilLast, Interface | JOIN apic_host nodeID [ | `apic-fabric-overview` | search component=fabricNode Role=leaf OR Role=spine AND id>16 | table apic_host, name, Role, nodeID] | join [ inputlookup portutilThreshold.csv | stats values(warningThreshold) AS WarningThr, values(criticalThreshold) AS CriticalThr] | where avg_utilLast >= WarningThr AND avg_utilLast < CriticalThr | table apic_host, name, nodeID, Role, Interface, avg_bytesRate, avg_utilLast, WarningThr, CriticalThr | SORT apic_host, role, name | rename avg_bytesRate AS "Total egress bytes rate", avg_utilLast AS "Egress port utilization", name AS "Node Name", WarningThr AS "Warning Threshold", CriticalThr AS "Critical Threshold", apic_host AS APIC


[ACI Monitoring Threshold: Ingress Port Utilization for Leafs/Spines Exceeds Critical Threshold Limit]
action.email = 1
action.email.include.search = 1
action.email.include.trigger = 1
action.email.include.trigger_time = 1
action.email.inline = 1
action.email.priority = 1
action.email.sendresults = 1
action.email.useNSSubject = 1
alert.severity = 4
alert.suppress = 0
alert.track = 1
counttype = number of events
cron_schedule = 0 * * * *
description = The Ingress Port Utilization Exceeds the Critical Threshold Limit
dispatch.earliest_time = -1h
dispatch.latest_time = now
display.general.type = statistics
display.page.search.tab = statistics
enableSched = 1
quantity = 0
relation = greater than
request.ui_dispatch_app = cisco-app-ACI
request.ui_dispatch_view = search
search = eventtype=cisco_apic_stats component=eqptIngrTotal5min OR component=eqptIngrTotal15min | rex field=dn "node-(?<nodeID>\d+)\/sys\/phys-\[(?<Interface>.*?)\]" | stats avg(bytesRate), avg(utilLast) by Interface, nodeID, apic_host | rename avg(bytesRate) AS avg_bytesRate, avg(utilLast) AS avg_utilLast | eval avg_bytesRate=round(avg_bytesRate,2), avg_utilLast=round(avg_utilLast,2) | table apic_host, nodeID, avg_bytesRate, avg_utilLast, Interface | JOIN apic_host nodeID [ | `apic-fabric-overview` | search component=fabricNode Role=leaf OR Role=spine AND id>16 | table apic_host, name, Role, nodeID] | join [ inputlookup portutilThreshold.csv | stats values(warningThreshold) AS WarningThr, values(criticalThreshold) AS CriticalThr] | where avg_utilLast >= CriticalThr | table apic_host, name, nodeID, Role, Interface, avg_bytesRate, avg_utilLast, WarningThr, CriticalThr | SORT apic_host, role, name | rename avg_bytesRate AS "Total egress bytes rate", avg_utilLast AS "Egress port utilization", name AS "Node Name", WarningThr AS "Warning Threshold", CriticalThr AS "Critical Threshold", apic_host AS APIC



[ACI Monitoring Threshold: VLAN Pool Exceeds Max Threshold Limit]
alert.severity = 5
alert.suppress = 0
alert.track = 1
counttype = number of events
cron_schedule = 0 * * * *
description = The number of available VLANs in the pool count is zero
dispatch.earliest_time = -1h
dispatch.latest_time = now
enableSched = 1
quantity = 0
relation = greater than
search = sourcetype=cisco:apic:class "component=fvRsHyper" | rex field=dn "conn-\[vlan-(?<VlanID>[^\]]+)" | rex field=dn "epdefref-(?<mac>[^\/]+)"| rex field=dn "ctrlr-\[(?<Controller>[^\]]+)" | table mac,VlanID,Controller,apic_host| dedup VlanID | join Controller,apic_host [search sourcetype="cisco:apic:class" component=fvnsEncapBlk | rex field=dn "vlanns-\[(?<VLANPool>[^\]]+)"| rex field=dn "from-\[vlan-(?<FR>[^\]]+)" | rex field=dn "to-\[vlan-(?<TO>[^\]]+)"| table VLANPool,FR,TO,apic_host | join VLANPool,apic_host [search sourcetype=cisco:apic:class component=fvnsRtVlanNs | rex field=dn "vlanns-\[(?<VLANPool>[^\]]+)" | rex field=dn "uni\/vmmp-(?<VMM>[^\/]+)"| rex field=dn "\/dom-(?<Controller>[^\]]+)"| table VLANPool,Controller, VMM,apic_host| search VMM=VMware]]| stats count by FR,TO,VLANPool,Controller,apic_host | convert num(FR) num(TO) | eval TotalVLANs = (TO-FR)+1 | eval AvailableVLANs = TotalVLANs-count | eval "VLAN Range" = "[".FR." - ".TO."]"| table "VLAN Range", VLANPool, Controller, TotalVLANs, AvailableVLANs, count,FR,TO,apic_host| rename count AS "Used" VLANPool AS "Pool", TotalVLANs AS "Total", AvailableVLANs AS "Available" | where Available = 0

[ACI Monitoring Threshold: VLAN Pool Exceeds Critical Threshold Limit]
alert.severity = 4
alert.suppress = 0
alert.track = 1
counttype = number of events
cron_schedule = 0 * * * *
description = The number of available VLANs in the pool count is less than the limit (default limit: 5)
dispatch.earliest_time = -1h
dispatch.latest_time = now
enableSched = 1
quantity = 0
relation = greater than
search = sourcetype=cisco:apic:class "component=fvRsHyper" | rex field=dn "conn-\[vlan-(?<VlanID>[^\]]+)" | rex field=dn "epdefref-(?<mac>[^\/]+)"| rex field=dn "ctrlr-\[(?<Controller>[^\]]+)" | table mac,VlanID,Controller,apic_host| dedup VlanID | join Controller,apic_host [search sourcetype="cisco:apic:class" component=fvnsEncapBlk | rex field=dn "vlanns-\[(?<VLANPool>[^\]]+)"| rex field=dn "from-\[vlan-(?<FR>[^\]]+)" | rex field=dn "to-\[vlan-(?<TO>[^\]]+)"| table VLANPool,FR,TO,apic_host | join VLANPool,apic_host [search sourcetype=cisco:apic:class component=fvnsRtVlanNs | rex field=dn "vlanns-\[(?<VLANPool>[^\]]+)" | rex field=dn "uni\/vmmp-(?<VMM>[^\/]+)"| rex field=dn "\/dom-(?<Controller>[^\]]+)"| table VLANPool,Controller, VMM,apic_host| search VMM=VMware]]| stats count by FR,TO,VLANPool,Controller,apic_host | convert num(FR) num(TO) | eval TotalVLANs = (TO-FR)+1 | eval AvailableVLANs = TotalVLANs-count | eval "VLAN Range" = "[".FR." - ".TO."]"| table "VLAN Range", VLANPool, Controller, TotalVLANs, AvailableVLANs, count,FR,TO,apic_host| rename count AS "Used" VLANPool AS "Pool", TotalVLANs AS "Total", AvailableVLANs AS "Available" | where Available < 5
