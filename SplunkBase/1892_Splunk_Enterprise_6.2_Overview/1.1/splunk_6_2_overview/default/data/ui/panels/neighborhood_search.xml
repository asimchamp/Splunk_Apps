    <panel>
      <title>Neighborhood Search</title>
      <input type="dropdown" token="neighborhood">
        <label>Neighborhood</label>
        <selectFirstChoice>true</selectFirstChoice>
        <choice value="*">ALL</choice>
        <search>
          <query>index="sf_food_health" sourcetype=sf_food_violations risk_category="*" neighborhood="*" 
| stats count by neighborhood
| sort +neighborhood</query>
        </search>
        <fieldForLabel>neighborhood</fieldForLabel>
        <fieldForValue>neighborhood</fieldForValue>
      </input>
      <table>
        <search>
          <query>index="sf_food_health" sourcetype=sf_food_violations risk_category="*" neighborhood="$neighborhood$" | stats values(name) as name values(address) as address values(neighborhood) as neighborhood count(eval(risk_category="High Risk")) as "High Risk" count(eval(risk_category="Moderate Risk")) as "Moderate Risk" count(eval(risk_category="Low Risk")) as "Low Risk" count as "Total Violations" by business_id | sort -"Total Violations"</query>
          <earliest>0</earliest>
          <latest></latest>
        </search>
        <option name="fields">name, address, neighborhood, "High Risk", "Moderate Risk", "Low Risk", "Total Violations"</option>
        <drilldown>
          <set token="business">$row.business_id$</set>
          <set token="business_name">$row.name$</set>
        </drilldown>
      </table>

      <table depends="$business$">
        <title>Business Details - Health Violations for "$business_name$"</title>
        <search>
          <query>index="sf_food_health" sourcetype=sf_food_violations risk_category="*" neighborhood="*" business_id="$business$" | stats values(risk_category) as risk_category count by description | sort -count</query>
          <earliest>0</earliest>
          <latest></latest>
        </search>
      </table>
    </panel>