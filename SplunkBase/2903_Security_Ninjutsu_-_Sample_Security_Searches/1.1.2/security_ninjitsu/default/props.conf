[tmp_linux_secure]
TRANSFORMS-sethost = sethost
TRANSFORMS-fixsourcetype = fixsourcetype


[cisco:esa]
EXTRACT-mid = MID (?<mid>\d+)
EXTRACT-icid = ICID (?<icid>\d+)
EXTRACT-dcid = DCID (?<dcid>\d+)
EXTRACT-to = \sTo: \<(?<recipient>[^\>]+)
EXTRACT-from = \sFrom: \<(?<sender>[^\>]+)
EXTRACT-subject = Subject [\'\"](?<message_subject>.*?)[\'\"]
EXTRACT-attachname = attachment [\'\"](?<attachment_name>.*?)[\'\"]
EXTRACT-icid-detail1 = New (?<protocol>SMTP) ICID (?<icid>\d+) interface (?<dest_interface>.*) \((?<cs_ip>[0-9a-f\.\:]+)\) address (?<ss_ip>[0-9a-f\.\:]+)
EXTRACT-icid-detail2 = reverse dns host (?<src_host>\S+) verified (?<src_host_verify>\w+)
EXTRACT-tls-detail = TLS (?<tls_verify>\S+) protocol
EXTRACT-sbrs-detail = (?<mail_flow_policy>\S+) SG (?<sender_group>\S+) match \S+ SBRS (?<sender_reputation>\S+)
EXTRACT-message-id = Message-ID [\'\"]\<(?<message_id>[^\>]+)
EXTRACT-policy-detail = matched (\d+|all) recipients for per-recipien(t|ts) policy (?<policy_name>\S+) in the (?<policy_direction>\S+) table
EXTRACT-msgsize = MID (?<mid>\d+) ready (?<message_size>\d+) bytes
EXTRACT-vof-verdict = Outbreak Filters: verdict (?<vof_verdict>\S+)
EXTRACT-vof-detail = Threat Level=(?<vof_threat_level>\d) Category=(?<vof_threat_category>\S+) Type=(?<vof_threat_type>\S+)
EXTRACT-case-detail = using engine: CASE spam (?<spam_verdict>\S+)
EXTRACT-av-detail = antivirus (?<av_verdict>\w+)( \'(?<av_scan_result>\S+)\')?( \((?<av_unscannable_reason>\S+)\))?
EXTRACT-quarantine = quarantined to \"(?<quarantine_name>\S+)\" \((?<quarantine_reason>[^\)]+)
EXTRACT-dcid-detail = New (?<protocol>SMTP) DCID (?<dcid>\d+) interface (?<cc_ip>[0-9a-f\.\:]+) address (?<sc_ip>[0-9a-f\.\:]+) port (?<dest_port>\d+)
EXTRACT-bounce = MID (?<mid>\d+) was generated for bounce of MID (?<bounce_mid>\d+)
SHOULD_LINEMERGE = false

# Additional Fields
EVAL-threat_reason = coalesce(case(spam_verdict="positive","spam",vof_verdict="positive","outbreak",av_verdict="positive","viral"),"clean")

# CIM Compliance
FIELDALIAS-mid = mid AS internal_message_id
FIELDALIAS-ss_ip = ss_ip AS src_ip
FIELDALIAS-cs_ip = cs_ip AS dest_ip
FIELDALIAS-cc_ip = cc_ip AS src_ip
FIELDALIAS-sc_ip = sc_ip AS dest_ip

[asa_syslog]
EXTRACT-User = User .(?<user>.*?)\>
EXTRACT-Src = IP .(?<src>.*?)\>
EXTRACT-Address = Address .0{1,}(?<assigned_ip>.*?)\>
EXTRACT-Disconnect = (?<user>\S*), IP = 0{1,}(?<src>\S*?),{0,}




[WinEvent:Security]
FIELDALIAS-signature_id = EventCode as signature_id
FIELDALIAS-src = ComputerName as src



[bcoat_proxysg]
EXTRACT-main=(?<date>[^\s]+)\s+(?<time>[^\s]+)\s+(?<c_ip>[0-9.]+)\s+(?<filter_result>[^\s]+)\s+(?<cs_bytes>[^\s]+)\s+(?<sc_bytes>[^\s]+)\s+(?<x_exception_id>[^\s]+)\s+(?<cs_auth_group>[^\s]+)\s+(?<action>[^\"\s]+)\s+(?<method>[^\s]+)\s+(?<cs_host>[^\s]+)\s+(?<cs_method>[^\s]+)\s+(?<bytes>[^\s]+)\s+(?<cs_uri_path>[^\s]+)\s+(?<sc_mime_type>[^\s]+)\s+"+(?<cs_useragent>.*)"+
SHOULD_LINEMERGE=false
TIME_FORMAT=%Y-%m-%d %T
FIELDALIAS-srcip = c_ip AS src_ip
FIELDALIAS-src = c_ip AS src
FIELDALIAS-cs_host = cs_host AS dest_host
FIELDALIAS-cs_host = cs_host AS dest
FIELDALIAS-protocol = cs_uri_scheme as protocol
FIELDALIAS-dest_port = cs_uri_port as dest_port
FIELDALIAS-src_user = cs_username as src_user
FIELDALIAS-user = cs_username as user
FIELDALIAS-s_ip = s_ip as dvc_ip
FIELDALIAS-http_response = sc_status as http_response
FIELDALIAS-bytes_out = cs_bytes as bytes_out
FIELDALIAS-bytes_in = sc_bytes as bytes_in
FIELDALIAS-url = cs_uri_path as url
FIELDALIAS-http_user_agent = cs_useragent as http_user_agent
KV_MODE = none







[carbon_black]
FIELDALIAS-ipv4 = ipv4 AS dest_ip

KV_MODE=json
EXTRACT-filename = "\w:(\\\\[^\\]{1,})+\\\\(?<filename>[^\\"]*)"
EXTRACT-attachment_name = "\w:(\\\\[^\\]{1,})+\\\\Content.Outlook\\\\[^\\]*\\\\(?<attachment_name>[^\\"]*)"




