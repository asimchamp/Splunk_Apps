
===TA-squid===

   Author: Ted Skinner/Ironvine Security

   Version/Date: 1.0

   Supported product(s): Tested with squid 3.1, but should work with most versions, configured to work with Splunk Enterprise Security 2.4.

   Source type(s): sourcetype = squid

   Input requirements: configure input file monitor for access.log on the squid server. Also, need to create custom log format 
   in squid.conf file. This was in order to produce all of the fields that Enterprise Security is looking for in its Proxy Center dashboards.
   
   Required excerpt from squid.conf file:
   
   logformat       splunkES %ts.%03tu %09tr %09>a %09>st %09Ss %09>Hs %09<st %09rm %09ru %09un %09Sh %09<A "%09mt" "%09{User-Agent}>h" "%09{Referer}>h" "%09{Cookie}>h"

access_log /var/log/squid/access.log splunkES


   ===Using this Technology Add-on===

   Configuration: Manual

   Ports for automatic configuration: N/A

   Scripted input setup: N/A

   Capture groups from regex of custom squid log format -

1 - Duration
2 - src
3 - bytes_in
4 - action
5 - status
6 - bytes_out
7 - http_method
8 - url
9 - protocol
10 - user
11 - hierarchy_code
12 - destination
13 - http_content_type
14 - user_agent
15 - http_referrer
16 - http_cookie