<form stylesheet="fullscroll.css" script="autodiscover.js">
  <label>Correlation Audit</label>
  <fieldset submitButton="true">
    <input type="dropdown" token="status" searchWhenChanged="false">
      <label>Status</label>
      <choice value="*">- ALL -</choice>
      <choice value="Enabled">Enabled</choice>
      <choice value="Disabled">Disabled</choice>
      <default>Enabled</default>
    </input>
    <input type="dropdown" token="runtime" searchWhenChanged="false">
      <label>Runtime Status</label>
      <choice value="*">- ALL -</choice>
      <choice value="Realtime">Realtime</choice>
      <choice value="Scheduled">Scheduled</choice>
      <default>Scheduled</default>
    </input>
    <input type="multiselect" token="splunk_app" searchWhenChanged="false">
      <label>Application</label>
      <choice value="*">- ALL -</choice>
      <default>*</default>
      <populatingSearch earliest="$earliest$" latest="$latest$" fieldForLabel="eai:acl.app" fieldForValue="eai:acl.app">| rest /services/saved/searches   
| search  "action.summary_index._name"=notable
| rename dispatch.earliest_time as WTF 
| eval status = if(disabled == "1","Disabled","Enabled")  
| eval runtime = if(like(WTF,"rt%"),"Realtime","Scheduled") 
| search status=$status$ AND runtime=$runtime$ AND $rule_name$
| table eai:acl.app 
| sort eai:acl.app</populatingSearch>
      <valuePrefix>eai:acl.app="</valuePrefix>
      <valueSuffix>"</valueSuffix>
      <delimiter> OR </delimiter>
    </input>
    <input type="multiselect" token="rule_name" searchWhenChanged="false">
      <label>Correlation Search</label>
      <choice value="*">- ALL -</choice>
      <default>*</default>
      <populatingSearch earliest="$earliest$" latest="$latest$" fieldForLabel="title" fieldForValue="title">| rest /services/saved/searches   
| search  "action.summary_index._name"=notable
| rename dispatch.earliest_time as WTF 
| eval status = if(disabled == "1","Disabled","Enabled")  
| eval runtime = if(like(WTF,"rt%"),"Realtime","Scheduled") 
| search status=$status$ AND runtime=$runtime$ AND $splunk_app$
| table title
| sort title</populatingSearch>
      <valuePrefix>title="</valuePrefix>
      <valueSuffix>"</valueSuffix>
      <delimiter> OR </delimiter>
    </input>
    <input type="radio" token="transpose" searchWhenChanged="false">
      <label>Transpose</label>
      <choice value="sort 'Rule Name' | transpose  100">- ON -</choice>
      <choice value="sort 'Rule Name'">- OFF -</choice>
      <default>sort 'Rule Name'</default>
    </input>
  </fieldset>
  <row grouping="2">
    <html>
      <div id="slider1" class="splunk-view" data-require="app/ES_Validation/components/slidepanel/slidepanelgroup" data-options="{           &quot;items&quot;: [&quot;panel1&quot;],           &quot;title&quot;: &quot;Instructions&quot;,           &quot;hide&quot;: &quot;yes&quot;     }"/>
    </html>
    <html id="panel1">
                <p>This dashboard is used to audit correlation searches.  Use the following inputs to filter the results.
                     </p>
					<ul>
                       <li>Select a <b>Status</b> to filter enabled and disabled searches.
                           </li>
                       <li>Select a <b>Runtime Status</b> to filter realtime and scheduled searches.
                           </li>
                       <li>Select an <b>Application</b> to filter out the which application context the search resides.
                           </li>
                      <li>Select a <b>Correlation Search</b> to filter by correlation searches.
                           </li>
                      <li>Select to turn <b>Transpose</b> On or Off.  Useful for copy/paste into spreadsheet.
                           </li>
                    </ul>
        <p>* - ALL - is default.  Make sure to remove it when selecting specific applications or correlation searches
             <br> ** Input fields will recalculate based on application or correlation searches to only show relevant fields. </br>
        </p>
           </html>
  </row>
  <row>
    <panel>
      <table>
        <searchString>| rest /services/admin/correlationsearches count=0  
| eval id=title 
| join type=outer id 
[| rest /services/saved/searches | eval id=title ]
| search id="*Rule"  
| rename dispatch.earliest_time as WTF    
| rename action.risk as WTF2
| eval status = if(disabled == "1","Disabled","Enabled")     
| eval runtime = if(like(WTF,"rt%"),"Realtime","Scheduled")    
| eval action.summary_index_status = if(action.summary_index =="1","Disabled","Enabled")
| eval action.risk_status = if(WTF2 == "1","Enabled","Disabled")
| eval default_status_string = case(default_status == "1","New",default_status == "2","In Progress",default_status == "3","Pending",default_status == "4","Resolved",default_status == "5","Closed","1" == "1", "System Default")
| rename WTF as dispatch.earliest_time
| search status="$status$" AND runtime="$runtime$" AND $splunk_app$ AND $rule_name$
| table rule_name status runtime actions eai:acl.app splunk_server dispatch.earliest_time dispatch.latest_time cron_schedule next_scheduled_time alert.suppress.period alert.suppress.fields action.summary_index_status rule_title rule_description security_domain severity default_owner default_status_string drilldown_name drilldown_search action.risk_status action.risk._risk_score action.risk._risk_object action.risk._risk_object_type search
| rename 
rule_name as "Rule Name"
status  as "Rule Status"
runtime as "Runtime"
actions as "Actions"
eai:acl.app as "Splunk Application"
splunk_server as "Splunk Server"
dispatch.earliest_time as "Start Time"
dispatch.latest_time as "End Time"
cron_schedule as "Cront Schedule"
next_scheduled_time as "Next Scheduled Time"
alert.suppress.period as "Throttling Suppress Period"
alert.suppress.fields as "Throttling Suppress Fields"
action.summary_index_status as "Notable Status"
rule_title as "Notable Event Title"
rule_description as "Notable Event Description"
security_domain as "Security Domain"
severity as "Severity"
default_owner as "Default Owner"
default_status_string as "Default Status"
drilldown_name as "Drill-down Name"
drilldown_search as "Drill-down Search"
action.risk_status as "Risk Status"
action.risk._risk_score as "Risk Score"
action.risk._risk_object as "Risk Field"
action.risk._risk_object_type as "Risk Type"
search as "Search"
| $transpose$</searchString>
        <earliestTime>-30d@d</earliestTime>
        <latestTime>now</latestTime>
        <option name="wrap">true</option>
        <option name="rowNumbers">true</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">none</option>
        <option name="count">100</option>
      </table>
    </panel>
  </row>
</form>