<form stylesheet="fullscroll.css" script="autodiscover.js">
  <label>Data Model Field Validation</label>
  <fieldset submitButton="true">
    <input type="time" token="time" searchWhenChanged="true">
      <label>Time</label>
      <default>
        <earliestTime>-24h@h</earliestTime>
        <latestTime>now</latestTime>
      </default>
    </input>
    <input type="dropdown" token="datamodel" searchWhenChanged="true">
      <label>Data Models</label>
      <populatingSearch earliest="-1s" latest="now" fieldForLabel="datamodel" fieldForValue="datamodel">| inputlookup sourcetype_datamodel_lookup 
| table datamodel</populatingSearch>
    </input>
    <input type="radio" token="baseobject" searchWhenChanged="true">
      <label>Base Object</label>
      <populatingSearch earliest="-1s" latest="now" fieldForLabel="baseobject" fieldForValue="baseobject">| rest /services/datamodel/model/$datamodel$ | spath input=description output=baseobject path=objects{0}.objectName | fields baseobject</populatingSearch>
    </input>
    <input type="multiselect" token="sourcetype" searchWhenChanged="true">
      <label>Sourcetypes</label>
      <populatingSearch earliest="-1s" latest="now" fieldForLabel="sourcetypes" fieldForValue="sourcetypes">| inputlookup sourcetype_datamodel_lookup
| search datamodel = "$datamodel$"
| table sourcetypes</populatingSearch>
      <valuePrefix>sourcetype="</valuePrefix>
      <valueSuffix>"</valueSuffix>
      <delimiter> OR </delimiter>
    </input>
    <input type="multiselect" token="fields" searchWhenChanged="false">
      <label>Data Model Fields</label>
      <populatingSearch earliest="$time.earliest$" latest="$time.latest$" fieldForLabel="fields" fieldForValue="fields">| rest /services/datamodel/model/"$datamodel$"
| spath input=description output=aafields path=objects{0}.fields{}.fieldName
| append [| rest /services/datamodel/model/"$datamodel$"
| spath input=description output=aafields path=objects{0}.calculations{}.outputFields{}.fieldName]
| stats values(aafields) as fields
| mvexpand fields
| search NOT (fields=Datamodel_Acceleration OR fields=_time OR fields=host OR fields=source OR fields=sourcetype)</populatingSearch>
      <valuePrefix>values($baseobject$.</valuePrefix>
      <valueSuffix>)</valueSuffix>
      <delimiter>, </delimiter>
    </input>
  </fieldset>
  <row>
    <panel>
      <html>
      <div id="slider1" class="splunk-view" data-require="app/ES_Validation/components/slidepanel/slidepanelgroup" data-options="{           &quot;items&quot;: [&quot;panel1&quot;],           &quot;title&quot;: &quot;Instructions&quot;,           &quot;hide&quot;: &quot;yes&quot;     }"/>
    </html>
      <html id="panel1">
                <p>This dashboard is used to validate data populating the data models (accelerated only).  
              <br>Automating best practices outlined from <a href="http://docs.splunk.com/Documentation/ES/latest/Install/Accessdashboard#Dashboard_description" target="_blank">Splunk Documentation</a>
        </br>
        </p>
					<ul>
                       <li>Select a <b>data model</b>. Only accelerated data models with data will show. Run <a href="/manager/ES_Validation/saved/searches" target="_blank">Accelerated Sourcetypes and Datamodels</a> to update the drop down.
                           </li>
                       <li>Select the <b>base object</b> from the data model.  It is searched and not hard coded in case it has been changed.
                           </li>
                      <li>Select a <b>sourcetype</b>. Only sourcetypes pertaining to the selected data model will show. Run <a href="/manager/ES_Validation/saved/searches" target="_blank">Accelerated Sourcetypes and Datamodels</a> to update the drop down.
                           </li>
                      <li>Select the <b>fields</b> to display their values. *TIP* Type a letter and hit enter to quickly add fields.
                           </li>
                    </ul>
               
        <h3>Validate Validate Validate </h3>     
        <p>* The table width is set to auto to easily scroll horizontaly without going to the bottom of the page. 
        </p>
           </html>
    </panel>
  </row>
  <row>
    <panel>
      <table>
        <title>Datamodel Fields</title>
        <searchString>| tstats summariesonly=t $fields$ from datamodel=$datamodel$ where $sourcetype$ | rename values($baseobject$.*) as *</searchString>
        <earliestTime>$time.earliest$</earliestTime>
        <latestTime>$time.latest$</latestTime>
        <option name="wrap">false</option>
        <option name="rowNumbers">false</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">none</option>
        <option name="count">10</option>
      </table>
    </panel>
  </row>
</form>