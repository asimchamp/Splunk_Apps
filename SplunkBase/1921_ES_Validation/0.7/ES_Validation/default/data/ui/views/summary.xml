<form>
  <label>Summary</label>
  <fieldset autoRun="false" submitButton="false">
    <input type="time" searchWhenChanged="true">
      <label/>
      <default>
        <earliestTime>-24h@h</earliestTime>
        <latestTime>now</latestTime>
      </default>
    </input>
  </fieldset>
  <row>
    <panel>
      <html>  
         <h1>Overview</h1>
<p>Welcome to the Enterprise Security Data Validation Application. The purpose of the application is to assist in installing, migrating and performing health checks for Splunk Enterprise Security. Validating that the data is populating the Data Models correctly can take time. The goal of this application is to make that process a little easier...</p>

        <p>*This app is only visible to admins*</p> 
        
        <p>Run <a href="/manager/ES_Validation/saved/searches" target="_blank">Accelerated Sourcetypes and Datamodels</a> to update the drop downs in the dashboards.  It runs every day early in the morning.
        </p>
                  
        <h1>Documentation</h1>
<ul>
	<li>
            <a href="http://docs.splunk.com/Documentation/CIM/latest/User/Alerts" target="_blank">Data Models</a> (CIM Addon Docs) - Object names, field names, data types, descriptions, and expected values for each Data Model
      	</li>
    <li>
            <a href="http://docs.splunk.com/Documentation/ES/latest/CreateTA/DashboardRequirementsMatrix" target="_blank">Dashboard requirements matrix</a> - Info on which tags, fields, and source types are required by each dashboard and panel 
		</li>
    <li>
            <a href="http://docs.splunk.com/Documentation/ES/latest/Install/Datamodels#Data_model_default_retention" target="_blank">ES Data Model default retention</a> - Latest ES defaults for accelerated summary ranges.
        </li>
	<li>The Splunk Common Information Model Add-on download - <a href="http://apps.splunk.com/app/1621/" target="_blank">http://apps.splunk.com/app/1621/</a>
          </li>
	<li>CIM compliant Add-ons - <a href="http://apps.splunk.com/apps/#/type/addon/cim/4.1" target="_blank">http://apps.splunk.com/apps/#/type/addon/cim/4.1</a>
          </li>
	<li>CIM compliant Apps - <a href="http://apps.splunk.com/apps/#/type/app/cim/4.1" target="_blank">http://apps.splunk.com/apps/#/type/app/cim/4.1</a>
          </li>
</ul>

<h1>Good Ideas</h1>

<ul>
	<li>For new installations of ES, install the "The Splunk Common Information Model Add-on download" application and set each datamodel to accelerate for 1 day.  As you add new sources, you can easily start checking that each sourcetype is populating their perspecitve Data Model correclty.  Better to do this with a 1 day index, than waiting for a 1 year index to finish building to only to realize it is wrong.
          </li>
  	<li>Make sure the architecture specs meet minimum requirements. (ES is different than just standard Splunk Enterprise)
  		  </li>
    <li>Check Splunk docs to ensure the version of ES is compatible with the installed version of Splunk.
  		</li>
    <li>Reference Splunk docs during an upgrade or new install to see if new indexes need to be added to the indexers.
  		</li>
    <li>MAKE A BACKUP - we are all human...
         </li>
  
</ul>
    </html>
    </panel>
  </row>
  <row>
    <panel>
      <table>
        <title>Sourcetypes in Dashboards Utilizing Accelerated Data Models</title>
        <searchString>| rest /services/datamodel/model  | search NOT acceleration=*false*  | dedup displayName  | fields acceleration displayName title  | map  search="| tstats summariesonly=true values(sourcetype) AS Sourcetypes from datamodel=$$title$$ where NOT sourcetype='*-too_small' | eval DataModel=\"$$displayName$$\"" maxsearches=20 | fields Sourcetypes DataModel</searchString>
        <earliestTime>$earliest$</earliestTime>
        <latestTime>$latest$</latestTime>
        <option name="wrap">true</option>
        <option name="rowNumbers">false</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">none</option>
        <option name="count">100</option>
      </table>
    </panel>
    <panel>
      <table>
        <title>Data Model Acceleration Status and Range</title>
        <searchString>| rest /services/datamodel/model | spath input=acceleration output=enalbed path=enabled | spath input=acceleration output=current_summary_range path=earliest_time | eval accelerated=if(enalbed=="false", "false", "true") | fillnull value="?" | table title accelerated current_summary_range | lookup datamodel_summary_range_lookup datamodel as title | sort -accelerated</searchString>
        <earliestTime>@d</earliestTime>
        <latestTime>now</latestTime>
        <option name="wrap">true</option>
        <option name="rowNumbers">true</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">none</option>
        <option name="count">100</option>
      </table>
    </panel>
  </row>
</form>