<?xml version='1.0' encoding='utf-8'?>
<dashboard refresh="900">
  <label>RSA Netwitness Administration App Status</label>
  <row>
    <single>
      <searchString>| metadata type=sourcetypes | search sourcetype="netwitness_admin" | fields + totalCount</searchString>
      <title>Total RSA Netwitness Admin Events</title>
    </single>
    <single>
      <searchString>index=_* nwadmin.py sourcetype="splunkd" NOT Metrics NOT " - Ran script:" NOT LicenseUsage "INFO: Processing" | stats count</searchString>
      <title>REST Calls Performed (Today)</title>
      <earliestTime>-0d@d</earliestTime>
      <latestTime>now</latestTime>
      <option name="count">10</option>
      <option name="displayRowNumbers">true</option>
    </single>
  </row>
  <row>
    <table>
      <searchString>index=_* nwadmin.py sourcetype="splunkd" NOT Metrics NOT " - Ran script:" NOT LicenseUsage "ERROR:"| rex field=_raw "ERROR: (?&lt;error&gt;.*?) processing (?&lt;devtype&gt;\S+) device at (?&lt;url&gt;.*)" | top limit=0 error devtype url</searchString>
      <title>Errors (Real-Time 15min window)</title>
      <earliestTime>rt-15m</earliestTime>
      <latestTime>rt</latestTime>
      <option name="count">20</option>
      <option name="displayRowNumbers">false</option>
      <option name="drilldown">row</option>
      <option name="showPager">true</option>
    </table>
  </row>
  <row>
    <chart>
      <searchString>index=_* nwadmin.py sourcetype="splunkd" NOT Metrics NOT " - Ran script:" NOT LicenseUsage "ERROR:"| rex field=_raw "ERROR: (?&lt;error&gt;.*?) processing (?&lt;devtype&gt;\S+) device at (?&lt;url&gt;.*)" | rex field=error "(\&lt;urlopen error |\&lt;)?(?&lt;errmsg&gt;[^\&gt;]+)" | timechart count by errmsg </searchString>
      <title>Errors by Type (Last day)</title>
      <earliestTime>-1d</earliestTime>
      <latestTime>now</latestTime>
      <option name="charting.axisTitleX.text">Time</option>
      <option name="charting.axisTitleY.text">Count</option>
      <option name="charting.chart">line</option>
      <option name="drilldown">all</option>
    </chart>
  </row>
  <row>
    <chart>
      <searchString>index=_* nwadmin.py sourcetype="splunkd" NOT Metrics NOT " - Ran script:" NOT LicenseUsage "ERROR:"| rex field=_raw "ERROR: (?&lt;error&gt;.*?) processing (?&lt;devtype&gt;\S+) device at (?&lt;url&gt;.*)" | rex field=error "(\&lt;urlopen error |\&lt;)?(?&lt;errmsg&gt;[^\&gt;]+)" | timechart count by url </searchString>
      <title>Errors by URL (Last day)</title>
      <earliestTime>-1d</earliestTime>
      <latestTime>now</latestTime>
      <option name="charting.axisTitleX.text">Time</option>
      <option name="charting.axisTitleY.text">Count</option>
      <option name="charting.chart">line</option>
      <option name="drilldown">all</option>
    </chart>
  </row>
  <row>
    <table>
      <searchString>index=_* nwadmin.py sourcetype="splunkd" NOT Metrics NOT " - Ran script:" NOT LicenseUsage "ERROR:"| rex field=_raw "ERROR: (?&lt;error&gt;.*?) processing (?&lt;devtype&gt;\S+) device at (?&lt;url&gt;.*)" | top limit=0 error devtype url</searchString>
      <title>Top Errors by Host (Last day)</title>
      <earliestTime>-1d</earliestTime>
      <latestTime>now</latestTime>
      <option name="count">20</option>
      <option name="displayRowNumbers">false</option>
      <option name="drilldown">all</option>
    </table>
  </row>
  <row>
    <chart>
      <searchString>index=_* nwadmin.py sourcetype="splunkd" NOT Metrics NOT " - Ran script:" NOT LicenseUsage "INFO: Successfully " | rex field=_raw "entry (?&lt;stance&gt;\S+) for (?&lt;devtype&gt;\S+) device at (?&lt;url&gt;.*)" | timechart limit=0 count by stance usenull=f</searchString>
      <title>Devices Processed Successfully (Last day)</title>
      <earliestTime>-1d</earliestTime>
      <latestTime>now</latestTime>
      <option name="charting.axisTitleX.text">Time</option>
      <option name="charting.axisTitleY.text">Config Name</option>
      <option name="charting.chart">column</option>
      <option name="charting.chart.stackMode">stacked</option>
      <option name="charting.legend.placement">right</option>
      <option name="charting.secondaryAxisTitle.text"/>
      <option name="drilldown">all</option>
    </chart>
  </row>
  <row>
    <table>
      <searchString>index=_* nwadmin.py sourcetype="splunkd" NOT Metrics NOT " - Ran script:" NOT LicenseUsage "ERROR:" | rex field=_raw "\" (?&lt;message&gt;.*)" | fields + message
</searchString>
      <title>Errors (Last day)</title>
      <earliestTime>-1d</earliestTime>
      <latestTime>now</latestTime>
      <option name="count">10</option>
      <option name="displayRowNumbers">false</option>
      <option name="drilldown">row</option>
      <option name="showPager">true</option>
    </table>
  </row>
</dashboard>
