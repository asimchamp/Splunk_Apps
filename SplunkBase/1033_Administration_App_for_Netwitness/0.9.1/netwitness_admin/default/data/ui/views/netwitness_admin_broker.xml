<?xml version='1.0' encoding='utf-8'?>
<dashboard refresh="300">
  <label>RSA Netwitness Administration Brokers</label>
  <row>
    <chart>
      <searchString>sourcetype=netwitness_admin /broker/stats | timechart limit=0 span=15m max(meta_rate) by host usenull=f useother=f </searchString>
      <title>Meta Rate over time (Last day)</title>
      <earliestTime>-1d@h</earliestTime>
      <latestTime>now</latestTime>
      <option name="charting.axisTitleX.text">Time</option>
      <option name="charting.axisTitleY.text">Meta</option>
      <option name="charting.axisY.scale">linear</option>
      <option name="charting.chart">line</option>
      <option name="charting.legend.placement">right</option>
      <option name="drilldown">none</option>
    </chart>
    <chart>
      <searchString>sourcetype=netwitness_admin /broker/devices/ | rex field=_raw "/broker/devices/(?&lt;device&gt;[^:]+):" |eval connection=host+"-&gt;"+device | timechart limit=0 span=15m max(session_rate) by connection usenull=f useother=f </searchString>
      <title>Session Rate over time by Connection (Last day)</title>
      <earliestTime>-1d@h</earliestTime>
      <latestTime>now</latestTime>
      <option name="charting.axisTitleX.text">Time</option>
      <option name="charting.axisTitleY.text">Sessions</option>
      <option name="charting.axisY.scale">linear</option>
      <option name="charting.chart">line</option>
      <option name="charting.legend.placement">none</option>
      <option name="charting.primaryAxisTitle.text"/>
      <option name="drilldown">none</option>
    </chart>
  </row>
  <row>
    <chart>
      <searchString>sourcetype=netwitness_admin /broker/devices/ | rex field=_raw "/broker/devices/(?&lt;device&gt;[^:]+):" |eval connection=host+"-&gt;"+device | timechart limit=0 span=15m max(time_network) by connection usenull=f useother=f </searchString>
      <title>Time Network by Broker-Concentrator over time (Last day)</title>
      <earliestTime>-1d@h</earliestTime>
      <latestTime>now</latestTime>
      <option name="charting.axisTitleX.text">Time</option>
      <option name="charting.axisTitleY.text">Milliseconds</option>
      <option name="charting.axisY.scale">linear</option>
      <option name="charting.chart">line</option>
      <option name="charting.legend.placement">none</option>
      <option name="drilldown">none</option>
    </chart>
  </row>
  <row>
    <chart>
      <searchString>sourcetype=netwitness_admin /broker/devices/ | rex field=_raw "/broker/devices/(?&lt;device&gt;[^:]+):" |eval connection=host+"-&gt;"+device | timechart limit=0 span=15m max(sessions_behind) by connection usenull=f useother=f </searchString>
      <title>Sessions Behind by Broker-Concentrator over time (Last day)</title>
      <earliestTime>-1d@h</earliestTime>
      <latestTime>now</latestTime>
      <option name="charting.axisTitleX.text">Time</option>
      <option name="charting.axisTitleY.text">Sessions</option>
      <option name="charting.axisY.scale">linear</option>
      <option name="charting.chart">line</option>
      <option name="charting.legend.placement">none</option>
      <option name="drilldown">none</option>
    </chart>
    <chart>
      <searchString>sourcetype="netwitness_admin" /broker/stats | stats max(session_rate_max) as Peak by host</searchString>
      <title>Peak Session Rate per Broker (Since Last Restart)</title>
      <earliestTime>-10m@m</earliestTime>
      <latestTime>now</latestTime>
      <option name="charting.axisTitleX.text">Broker</option>
      <option name="charting.axisTitleY.text">Session</option>
      <option name="charting.chart">bar</option>
      <option name="count">20</option>
      <option name="displayRowNumbers">true</option>
      <option name="drilldown">row</option>
    </chart>
  </row>
  <row>
    <table>
      <searchString>sourcetype="netwitness_admin" broker /sdk/stats |eval moft=strptime(meta_oldest_file_time,"%Y-%b-%d %H:%M:%S") | eval duration=time()-moft | eval days=round(duration/86400) | stats max(cache_window_time_begin) as cache_window_time_begin max(cache_window_time_end) as cache_window_time_end by host | eval average_meta_per_session=round(meta_total/session_total) |appendcols [search sourcetype=netwitness_admin broker /sys/stats | stats max(cpu) as max_cpu min(cpu) as min_cpu max(running_since) as running_since  by host, hostname | fields host, hostname, max_cpu, min_cpu, running_since]</searchString>
      <title>Broker Stats (Last hour)</title>
      <earliestTime>-1h@m</earliestTime>
      <latestTime>now</latestTime>
      <option name="count">20</option>
      <option name="displayRowNumbers">false</option>
      <option name="drilldown">row</option>
    </table>
  </row>
</dashboard>
