<form>
  <label>統計情報</label>

    <fieldset autoRun="True">

    <input type="time" >
      <default>Last 7 days</default>
    </input>

  </fieldset>
  <row>
    <chart>
      <title>認証数タイムチャート</title>
        <searchTemplate>sourcetype="alaxala_auth_log" "*Login succ*" | timechart span="10m" count as login  | accum login | appendcols  [search sourcetype="alaxala_auth_log" "AUT* logout *" | timechart span="10m" count as logout | accum logout ] |  eval now_login=(login - logout) | eval now_login=if(0 > now_login, 0, now_login)</searchTemplate>
      <option name="charting.chart">line</option>
      <option name="charting.primaryAxisTitle.text">Time</option>
    </chart>
  </row>
  <row>
    <chart>
      <title>認証ログ別タイムチャート</title>
      <searchTemplate>sourcetype="alaxala_auth_log" "*:LOG*" | timechart span="1h" count by ala_auth_msg</searchTemplate>
      <option name="charting.chart">line</option>
      <option name="charting.primaryAxisTitle.text">Time</option>
    </chart>
  </row>
  <row>
    <table>
      <searchString>sourcetype="alaxala_auth_log" ala_auth_msg="*Login succeeded*" | RENAME ala_auth_MAC AS MAC | chart count by MAC | sort -count </searchString>
      <title>端末毎認証回数</title>
      <option name="count">10</option>
      <option name="displayRowNumbers">true</option>
      <option name="showPager">true</option>
    </table>
    <table>
      <searchString>sourcetype="alaxala_auth_log" ala_auth_msg="*Login succeeded*" | RENAME host AS SWITCH_NAME | chart count by SWITCH_NAME | sort -count </searchString>
      <title>スイッチ毎認証数</title>
      <option name="showPager">true</option>
      <option name="count">10</option>
      <option name="displayRowNumbers">true</option>
    </table>
    <table>
      <searchString>sourcetype="alaxala_auth_log" ala_auth_msg="*Login succeeded*" | RENAME ala_auth_vlan AS VLAN | chart count by VLAN | sort -count</searchString>
      <title>VLAN毎認証数</title>
      <option name="showPager">true</option>
      <option name="count">10</option>
      <option name="displayRowNumbers">true</option>
    </table>
  </row>
  <row>
    <table>
      <searchString>sourcetype="alaxala_auth_log" ala_auth_msg="*failed*" | RENAME ala_auth_MAC AS MAC | chart count by MAC | sort -count </searchString>
      <title>端末毎認証失敗数</title>
      <option name="showPager">true</option>
      <option name="count">10</option>
      <option name="displayRowNumbers">true</option>
    </table>
    <table>
      <searchString>sourcetype="alaxala_auth_log" ala_auth_msg="*failed*" | RENAME host AS SWITCH_NAME | chart count by SWITCH_NAME | sort -count </searchString>
      <title>スイッチ毎認証失敗数</title>
      <option name="showPager">true</option>
      <option name="count">10</option>
      <option name="displayRowNumbers">true</option>
    </table>
    <table>
      <searchString>sourcetype="alaxala_auth_log" ala_auth_msg="*failed*" | RENAME ala_auth_vlan AS VLAN | chart count by VLAN | sort -count </searchString>
      <title>VLAN毎認証失敗数</title>
      <option name="showPager">true</option>
      <option name="count">10</option>
      <option name="displayRowNumbers">true</option>
    </table>
  </row>
  <row>
    <table>
      <title>端末毎ログイン時間</title>
      <searchTemplate>sourcetype="alaxala_auth_log" ala_auth_msg="*Login succeeded*" | convert timeformat="%y/%m/%d %H:%M:%S" ctime(_time) AS LOGIN_TIME  | RENAME _time AS LIT | dedup MAC | rename ala_auth_ip AS IP | rename ala_auth_user AS USER | TABLE MAC,IP,USER,LOGIN_TIME, LIT  |
JOIN MAC
[ SEARCH sourcetype="alaxala_auth_log" ala_auth_msg="*Logout*" | convert timeformat="%y/%m/%d %H:%M:%S" ctime(_time) AS LOGOUT_TIME | RENAME _time AS LOT | rename ala_auth_ip AS IP | rename ala_auth_user AS USER | TABLE MAC,IP,USER,LOGOUT_TIME, LOT ] |
eval DT_sec = (LOT - LIT) | WHERE DT_sec > 0 | eval DT_min = (DT_sec / 60) |
TABLE MAC,IP,USER,LOGIN_TIME, LOGOUT_TIME, DT_sec, DT_min | sort -DT_sec
</searchTemplate>
      <option name="showPager">true</option>
    </table>
  </row>
</form>