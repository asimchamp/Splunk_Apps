##
## SPDX-FileCopyrightText: 2020 Splunk, Inc. <sales@splunk.com>
## SPDX-License-Identifier: LicenseRef-Splunk-1-2020
##
##
[squid:access]
KV_MODE = none
SHOULD_LINEMERGE = false
EVENT_BREAKER_ENABLE = true
pulldown_type = true
category = Network & Security
description = Squid Proxy system events
REPORT-2_extract_field = squid_access_extract_field_0, squid_access_extract_field_1, squid_access_extract_field_2, squid_access_extract_field_3
EVAL-url_length = len(url)
EVAL-http_content_type = if(http_content_type=="-" OR http_content_type=":", null , http_content_type)
EVAL-user = if(user=="-", null, user)
EVAL-bytes = bytes_in + bytes_out
EVAL-dest_ip = if(dest_ip=="-", dest_ip_tmp, dest_ip)
EVAL-dest = coalesce(url, if(dest_ip=="-", null, dest_ip))
EVAL-src_ip = if(src_ip=="-", null, src_ip)
EVAL-src = if(src_ip=="-", null, src_ip)
LOOKUP-3_look_up_extract = squid_actions_lookup vendor_action OUTPUT action
LOOKUP-4_look_up_extract = squid_httpstatus_lookup status OUTPUT status_description

[squid:access:recommended]
KV_MODE = auto
SHOULD_LINEMERGE = false
EVENT_BREAKER_ENABLE = true
pulldown_type = true
category = Network & Security
description = Squid Proxy system events
SEDCMD-empty=s/ [a-zA-z0-9\-]+\=(?:\"\-\"|-)//g
FIELDALIAS-src = src_ip as src
REPORT-squid_access_fields = squid_access_extract_url_domain, squid_access_extract_http_referrer
EVAL-app = "Squid"
EVAL-vendor_product = "Squid Proxy Server"
EVAL-squid_calculated_error_url= if(match(url,"^error:"), url, null)
EVAL-url = if(match(url,"^error:"), null, url)
EVAL-url_length = if(match(url,"^error:"), null, len(url))
EVAL-http_user_agent_length = len(http_user_agent)
EVAL-http_content_type = if(http_content_type=":", null, http_content_type)
EVAL-dest = if(match(url,"^error:"), dest_ip, coalesce(url, dest_ip))
EVAL-category = "Proxy Server Traffic"
LOOKUP-action = squid_actions_lookup vendor_action OUTPUT action
LOOKUP-description = squid_httpstatus_lookup status OUTPUT status_description
