
## Apply the following properties to sample text files by extension
[source::....airtight_basic]
sourcetype=airtight

[source::....airtight_cef]
sourcetype=airtight

[airtight]
EXTRACT-airtight_cef = \w{3}\s\d{1,2}\s\d{2}:\d{2}:\d{2}\s(?<dvc>.*)\s<.*>CEF:0\|(?<vendor>AirTight)\|(?<product>SpectraGuard\sEnterprise)\|(?<version>\d\.\d)\|(?<engine>.*)\|(?<signature>.*)\|(?<signature_id>.+)\|msg=(.*)\sAirTightSpectraGuardEnterprise

EXTRACT-airtight_external_ap = The AP's details are: MAC address \[(?<src_mac>.{2}:.{2}:.{2}:.{2}:.{2}:.{2})\], protocol \[(?<src_proto>.+)\], channel \[(?<src_channel>.+)\], SSID \[(?<src_ssid>.+)\], security setting \[(?<src_sec>.+)\], vendor \[(?<src_vendor>.+)\].

EXTRACT-airtight_cef_unauthorized_ap = Authorized Client \[(?<dest>.*)\] is connected to non-authorized AP. The Client's details are: MAC address \[(?<dest_mac>.*)\], user name \[(?<user>.*)\], vendor \[(?<dest_vendor>.*)\]. The AP's details are: MAC address \[(?<src_mac>.*)\], protocol \[(?<src_proto>.*)\], channel \[(?<src_channel>.*)\], SSID \[(?<src_ssid>.*)\], security setting \[(?<src_sec>.*)\], vendor \[(?<src_vendor>.*)\] .+ AirTightSpectraGuardEnterprise

EXTRACT-airtight_cef_client_quarantine = Client \[(?<dest>.*)\] needs to be quarantined. The Client's details are: MAC address \[(?<dest_mac>.*)\], user name \[(?<user>.*)\], vendor \[(?<dest_vendor>.*)\]\. .* dvc=(?<dvc>.*) AirTightSpectraGuardEnterprise

EXTRACT-airtight_location = AirTightSpectraGuardEnterpriseLocation=(?<dvc_location>.+)($|\sAir)
EXTRACT-airtight_sensor = AirTightSpectraGuardEnterpriseClosestSensor=(?<dvc_sensor>.*)

EXTRACT-airtight_vendor_severity = \s:\s\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}[+|-]\d{2}:\d{2}\s:\s(?<vendor_severity>\w+)\s:\s\d+\s:\s
LOOKUP-airtight_severity = severity_for_airtight vendor_severity OUTPUTNEW severity
FIELDALIAS-airtight_src = src_mac as src

