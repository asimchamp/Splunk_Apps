<form>
  <label>DeepSight IP Map</label>
  <fieldset autoRun="true" submitButton="true">
    <input type="multiselect" token="confidence">
      <label>Confidence</label>
      <default>*</default>
      <choice value="*">All</choice>
      <choice value="1">1</choice>
      <choice value="2">2</choice>
      <choice value="3">3</choice>
      <choice value="4">4</choice>
      <choice value="5">5</choice>
      <prefix>(</prefix>
      <suffix>)</suffix>
      <valuePrefix>confidence=</valuePrefix>
      <delimiter> OR </delimiter>
    </input>
    <input type="multiselect" token="hostility">
      <label>Hostility</label>
      <default>*</default>
      <choice value="*">All</choice>
      <choice value="1">1</choice>
      <choice value="2">2</choice>
      <choice value="3">3</choice>
      <choice value="4">4</choice>
      <choice value="5">5</choice>
      <prefix>(</prefix>
      <suffix>)</suffix>
      <valuePrefix>hostility=</valuePrefix>
      <delimiter> OR </delimiter>
    </input>
    <input type="multiselect" token="reputation">
      <label>Reputation</label>
      <default>*</default>
      <choice value="*">All</choice>
      <choice value="1">1</choice>
      <choice value="2">2</choice>
      <choice value="3">3</choice>
      <choice value="4">4</choice>
      <choice value="5">5</choice>
      <choice value="6">6</choice>
      <choice value="7">7</choice>
      <choice value="8">8</choice>
      <choice value="9">9</choice>
      <choice value="10">10</choice>
      <prefix>(</prefix>
      <suffix>)</suffix>
      <valuePrefix>reputation=</valuePrefix>
      <delimiter> OR </delimiter>
    </input>
    <input type="radio" token="filter1">
      <label>Split map by:</label>
      <choice value="City">City</choice>
      <choice value="Country">Country</choice>
      <choice value="Region">Region</choice>
    </input>
    <input type="time" searchWhenChanged="true">
      <default>Last 24 hours</default>
    </input>
  </fieldset>
  <row>
    <panel>
      <map>
        <search>
          <query>index=deepsight sourcetype=deepsight_ip $reputation$ $confidence$ $hostility$ | iplocation ip | eval City=if(City=="","N/A",City) | eval Region=if(Region=="","N/A",Region)  | eval Country=if(Country=="","N/A",Country) | geostats globallimit=0 count(ip) by $filter1$</query>
        </search>
        <option name="height">500px</option>
        <!--
      <option name="mapping.seriesColors">[0x5379af,0x9ac23c,0xf7902b,0x956d95,0x6ab7c7,0xd85d3c,0xfac51c,0xdd86af]</option>
      
     
      <option name="mapping.markerLayer.markerOpacity">0.8</option>
      <option name="mapping.markerLayer.markerMinSize">10</option>
      <option name="mapping.markerLayer.markerMaxSize">60</option>
      <option name="mapping.map.center">(30.810646,-10.556976)</option>
      
      -->
        <option name="mapping.map.zoom">3</option>
        <option name="drilldown">all</option>
        <option name="mapping.data.maxClusters">100</option>
        <option name="mapping.map.center">(0,0)</option>
        <option name="mapping.markerLayer.markerMaxSize">50</option>
        <option name="mapping.markerLayer.markerMinSize">10</option>
        <option name="mapping.markerLayer.markerOpacity">0.8</option>
        <option name="mapping.tileLayer.maxZoom">7</option>
        <option name="mapping.tileLayer.minZoom">0</option>
      </map>
    </panel>
  </row>
  <row>
    <panel>
      <table>
        <search>
          <query>index=deepsight sourcetype=deepsight_ip $reputation$ $confidence$ $hostility$ | iplocation ip | eval City=if(City=="","N/A",City) | eval Region=if(Region=="","N/A",Region) | eval Country=if(Country=="","N/A",Country) | stats count(ip) AS "IP Count" by Country City Region | sort -"IP Count"</query>
        </search>
        <option name="wrap">true</option>
        <option name="rowNumbers">false</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">cell</option>
        <option name="count">10</option>
      </table>
    </panel>
  </row>
</form>