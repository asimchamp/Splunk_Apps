Symantec DeepSight Security Intelligence App (GA 1.1)
GA 1.1 Release
FY2014
Author: Function1

 
Introduction
—————————————————————————————
Thank you for downloading the GA 1.1 release of Splunk® App for Symantec’s DeepSight Security Intelligence, by Function1. Function1 (www.function1.com) is a leader in the Operations Intelligence and Middleware space. We have designed the base architecture for some of the largest Splunk deployments in the world today, and have helped develop the standard for enterprise class governance and data on-boarding. Our strategic relationship with Splunk has provided a unique perspective that empowers our Professional Services Organization to bridge the gap between application and infrastructure management. Function1 team members are not only technology savvy but also business professionals, and able to provide the full picture, outlook, and strategy for your organization. Function1 is proud to serve multiple industries and delivers broad industry experience to your deployment. Our combined talent and years of experience in enterprise software deployments will help you gain more value from your technology investment.
We are committed to the success of your deployment and would be happy to assist. Contact support@function1.com for assistance.


Overview: About the Symantec DeepSight Security Intelligence App
—————————————————————————————
The Symantec DeepSight Security Intelligence App allows users to integrate the DeepSight Security Intelligence IP & Domain/URL data into users’ Splunk environment seamlessly. To use this application, users will need an active subscription to the Symantec DeepSight Security Intelligence IP and or Domain/URL datafeeds. The Symantec DeepSight Security Intelligence App provides metric and geographic dashboards for monitoring threats against the users’ data. 
Use the Symantec DeepSight Storage Server App to:
	• Get information about the current threats posed against your data.
	• Drilldown on specific threats to see their redundancy against your data.
	• A geographical breakdown of malicious IP addresses per country level.
	• A graphical representation of IP/URL threats over time.
	• Analyze the hostility, reputation, and confidence value of any given harmful IP/URL data against flagged threats from DeepSight’s Security Intelligence data.
	• A high-level overview of all IP and URL addresses hitting your data over time. 

The Symantec DeepSight Storage Server App is designed to work in tandem with Symantec DeepSight Security Intelligence IP and or Domain/URL datafeeds.


Technology Add-on Requirement
—————————————————————————————
The Splunk Technology Add-on (TA) for Symantec’s DeepSight Security Intelligence is designed for installation on either a full-instance of Splunk or a Splunk Universal Forwarder. If you install the TA on a full-instance of Splunk and are in a distributed environment, that full-instance must be configured to forward its data to the indexers. The TA-DeepSight is located in the appserver/addons directory of the Splunk For Symantec DeepSight Security Intelligence app.

The app itself, inclusive of the TA, is highly dynamic as well as independent to maximize on the native behavior and functionality within Splunk. The TA includes all the necessary technology to bridge the gap between these two technologies. 

Product documentation is widely available, though we highly recommend planning your deployment with a member of our Professional Services team. Please contact support@function1.com for more assistance.


Prerequisites for Technology Add-on Requirement
—————————————————————————————
Please note that TA-DeepSight was only tested and verified on RedHat and CentOS operating systems. We will include other operating systems in future releases. 
Before installing the technology add-on, please verify that your RedHat or CentOS environment fulfill the below requirements:
	• An environment variable in the OS must be set for "SPLUNK_HOME". This must be set to the base path of the Splunk installation (ex. "/opt/splunkforwarder").
	• The following need to be installed: unzip, curl and openssl. These are required for execution of the DeepSight shell scripts.


Deploy the Splunk App for Symantec’s DeepSight Security Intelligence
—————————————————————————————
There are only a couple of steps you will need to take to successfully install the Splunk App for Symantec’s DeepSight Security Intelligence. You will need to install the TA to its proper location and perform some slight configuration actions. 

Install the App
Install the app in $SPLUNK_HOME/etc/apps on your search head and indexer. Index-time properties are included in this app and must be placed on the indexers. The app can be installed on any operating system, but please keep in mind that the TA-DeepSight must be on RedHat or CentOS.

Install the Technology Add-on 
The TA-DeepSight is located in the appserver/addons directory of the Splunk For Symantec DeepSight Security Intelligence app. The TA-DeepSight should be moved to the $SPLUNK_HOME/etc/apps directory of a single Splunk instance. TA-DeepSight should not be installed on multiple forwarders; it should only be installed on a single Splunk instance that forwards its data to the indexers. This Splunk instance must also be able to retrieve data from the following sites over port 80:

	• https://datafeeds.symantec.com/Feeds:80
	• https://datafeeds.symantec.com/SCAPFeeds:80

You will need to provide your DeepSight username and password to successfully retrieve the IP & URL/Domain datafeeds. You will need to go to the $SPLUNK_HOME/etc/apps/TA-DeepSight/bin directory via command line/terminal and run the "configure.py" python script. If python is not currently installed on the system, you will have to install python first. To run the configure.py script you must run the following command: 
	• <Python_home>/python configure.py 
If you are placing the TA on a full instance of Splunk, it ships with its own version of python so you can run the following: 
	• $SPLUNK_HOME/bin/splunk cmd python configure.py

This will prompt you to enter a username and password for DeepSight. Be sure that the configure.py script has the proper settings to be executable. Once that is complete, restart the Splunk service. If you ever need to update your credentials, simply run the configure.py script again. 

The TA-DeepSight is now configured and ready to send the relevant data to the Splunk App for Symantec’s DeepSight Security Intelligence app. 
*** Please note, the initial pull of the data feeds may take place up to one hour after Splunk is restarted. ***

The .csv files that are created by the scripts are located in the following directories: 
	• $SPLUNK_HOME/etc/apps/TA-DeepSight/data/IPReputationCSVFeed 
	• $SPLUNK_HOME/etc/apps/TA-DeepSight/data/URLReputationCSVFeed

The inputs.conf file is already configured to monitor those directories and forward the data to the Splunk indexers. The following attributes have been set in the monitor stanza of the inputs.conf:
	• sourcetypes = deepsight_ip, deepsight_url
	• index = deepsight

Features of Splunk App for Symantec’s DeepSight Security Intelligence (TA)
The TA contains scripts that retrieve the DeepSight Security Intelligence IP & Domain/URL data. This data is currently updated once a day. The scripts produce .csv files, which are then indexed by Splunk. The script also removes the old csv files. The following files are shipped with the TA-DeepSight directory:

bin directory:
	• configure.py
	• DeepSightClient.sh

default directory:
	• app.conf
	• inputs.conf


Dashboard Views
—————————————————————————————

The Splunk App for Symantec’s DeepSight Security Intelligence is designed with four different dashboard views to allow users to integrate the DeepSight Security Intelligence IP & Domain/URL data into users’ Splunk environment seamlessly. This section will describe the different views accessible through the App and ways on how to maximize the functionality of these dashboards.

A. DeepSight Main

This page is an overview of malicious IP and URL data from DeepSight.  Users are able to filter by datafeed attributes to populate graphs that show key metrics into their data.
How to use:
Users will filter on certain URL/IP attributes (confidence, hostility, reputation, behavior) to the level of their choosing for a designated point in time or time range. Once these values are selected, four key metric panels are populated (total and unique IPs/URLs), along with eight associated drilldown graphics. These graphics highlight the type of threat and the counts associated with these threats over time for both IP/URL domains. This view enables the end user the ability to analyze the current threats posed against your data.

B. DeepSight IP Map

This page allows users to view suspicious IP sources by country by filtering datafeed attributes. 
How to Use:
Users will filter on certain IP attributes (confidence, hostility, reputation) to the level of their choosing and select how the data should be split for a designated point in time. Once these values are selected, counts of these threats will populate on a map, by the selected split by field, where the threat persists. By zooming in on the map and hovering over a point, users can get more geographical information regarding these threats. Users may also click on a pie chart and drilldown into those events. Simultaneously, a summary table will appear at the bottom of the dashboard view. Users can click on a designated country, city, or region of their choosing to see more information about these harmful IP addresses in the table. The table feature allows the user to drilldown into individual IP threat events. From here, users can gain key insights into the threats against their data on a granular level.

C. DeepSight Data

This page allows users to sort and drilldown into DeepSight data by filtering selected attributes. 
How to Use:
Users will filter on certain attributes (confidence, hostility, reputation, behavior, listing ratio, and consecutive listings) to the level of their choosing for a designated point in time or time range. Based on these desired attributes, relevant IP and URL DeepSight data will populate in tables within the dashboards. Users can drilldown into this data by clicking on a specific DeepSight IP or URL domain to see a list of events associated with this data. This view enables the end user the ability to analyze DeepSight data at a very microscopic level. 

D. DeepSight Correlation Search 
This page matches malicious IP’s and URL’s with threats flagged by DeepSight against the end user’s data.
How to Use:
In order for users to compare their data to DeepSight’s flagged threats, the user will first determine whether they’d like to compare IP or URL data. Once determined, users must enter a valid sourcetype and IP/URL/domain field name that exists in their Splunk environment. These two fields are text boxes that will need the user’s specified inputs in order to populate the page. If an invalid sourcetype or field name is entered, the search will not execute successfully.

Based upon the above inputs, a series of four panels will populate with the number of occurrences that match the users’ data along with a maximum reputation, confidence, and hostility score. Below these numbers, a panel will populate with the matched DeepSight hits of IPs/URLs/domains. These hits represent the number of matched IP/URL/domain threats that DeepSight has flagged against your data.

The final panel exhibits your raw data as indexed within Splunk. These events show the exact time that the IP/URL/domain interacts with your data. This view is most helpful in allowing the end user to analyze the hostility, reputation, and confidence value of any given harmful IP/URL/domain data against flagged threats from DeepSight’s Security Intelligence data.


Troubleshooting, Support, & Feature Enhancements
—————————————————————————————

We welcome the opportunity to work with you and help overcome any hurdle in your path to a successful deployment. This GA 1.1 release is designed to ensure that the most commonly desired features are included. If you would like enhanced functionality, additional features, help deploying, or wish to report a bug, we would love to hear from you. Please contact support@function1.com for assistance.


Release Notes:
3/10/2015 v1.1:
- DeepSight data feed script has been updated to delete the data files after indexing, and included options to support specific versions of SSL.
- Updated dropdowns on dashboards to allow for multiple selections. 
- Added DeepSight Malicious IP and URL Confidence Distribution panels to the main dashboard.
- Added split by option and drilldown capability to the Map visualization.



