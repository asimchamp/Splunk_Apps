{"version":3,"file":"Hook.js","sources":["../../../../../../../build-ui/js/utils/HelpLinkUtil.js","../../../../../../../build-ui/js/hooks/useFormData.jsx","../../../../../../../build-ui/js/components/QueueInput.jsx","../../../../../../../build-ui/js/components/RulesInput.jsx","../../../../../../../build-ui/js/components/MultiQueueInput.jsx","../../../../../../../build-ui/js/components/RegionInput.jsx","../../../../../../../build-ui/js/components/SingleInputWrapper.jsx","../../../../../../../build-ui/js/components/CustomFormRows.jsx","../../../../../../../build-ui/js/components/FormRowsWrapper.jsx","../../../../../../../build-ui/js/Hook.js"],"sourcesContent":["/*\n * SPDX-FileCopyrightText: 2021 Splunk, Inc. <sales@splunk.com>\n * SPDX-License-Identifier: LicenseRef-Splunk-8-2021\n *\n */\n\nclass HelpLinkUtil {\n  getServiceLocationMap () {\n    return ({\n      aws_config: 'aws.config',\n      aws_config_rule: 'aws.configrules',\n      aws_cloudwatch: 'aws.cloudwatch',\n      aws_cloudwatch_logs: 'aws.cloudwatchlogs',\n      aws_s3: 'aws.s3',\n      splunk_ta_aws_logs: 'aws.incrementals3',\n      aws_sqs_based_s3: 'aws.sqs_based_s3',\n      aws_billing: 'aws.billing',\n      aws_billing_cur: 'aws.billing.cur',\n      aws_cloudtrail: 'aws.cloudtrail',\n      aws_kinesis: 'aws.kinesis',\n      aws_inspector: 'aws.inspector',\n      aws_inspector_v2: 'aws.inspectorv2',\n      splunk_ta_aws_sqs: 'aws.sqs',\n      aws_metadata: 'aws.metadata'\n    })\n  }\n\n  getAllLinks () {\n    return ({\n      // aws.configure_aws.configure_sqs is hard coded in globalConfig.json\n      SQS_BASED_S3: 'aws.configure_aws.configure_sqs'\n    })\n  }\n\n  buildInputLink (input) {\n    const link = getServiceLocationMap()[input]\n    const text = 'Learn more'\n    return `<a data-test=\"link\" target=\"_blank\" class=\"imDUvl\" href=\"/help?location=${encodeURIComponent('[AddOns:released]')}${link}\">${text}<svg focusable=\"false\" height=\"8px\" width=\"8px\" viewBox=\"0 0 1500 1499\" aria-hidden=\"false\" class=\"help-link-icon\"><path d=\"M1500 1125h-189.04v185.96H189.04V189.04H375V0H0v1500h1500v-375zm0-1125H723.288v190.068h469.52l-666.78 648.288 133.56 134.59 650.344-665.754v469.52l189.04 1.028L1500 0z\"></path></svg></a>`\n  }\n}\n\nexport const { buildInputLink, getAllLinks, getServiceLocationMap } = new HelpLinkUtil()\n","/*\n * SPDX-FileCopyrightText: 2021 Splunk, Inc. <sales@splunk.com>\n * SPDX-License-Identifier: LicenseRef-Splunk-8-2021\n *\n */\n\nimport React, { createContext, useContext, useState } from \"react\";\nimport PropTypes from \"prop-types\";\n\nexport const FormDataContext = createContext({\n  regions: [],\n  setRegions: () => {},\n  queues: [],\n  setQueues: () => {},\n  effectiveState: {},\n  setEffectiveState: () => {},\n});\n\nexport const FormDataContextProvider = ({ hookProps, children }) => {\n  const { initFormRows, setFormState, serviceName, initAccount, initAwsIamRole } = hookProps;\n  const [account, setAccount] = useState(initAccount);\n  const [awsIamRole, setAwsIamRole] = useState(initAwsIamRole)\n  const [effectiveFormRows, setEffectiveFormRows] = useState(initFormRows);\n\n  const [regions, setRegions] = useState({});\n  const [queues, setQueues] = useState({});\n  const [rules, setRules] = useState({});\n\n  return (\n    <FormDataContext.Provider\n      value={{\n        setFormState, // to set values for region and queue in UCC form\n        serviceName, // input name\n        account, // selected account name\n        setAccount, // will be later attached to window object to provide hook data binding\n        awsIamRole,\n        setAwsIamRole,\n        effectiveFormRows, // maintains selected values of form rows\n        setEffectiveFormRows, // to set values of form rows\n        // rest are used for managing state of individual form row components\n        regions,\n        setRegions,\n        queues,\n        setQueues,\n        rules,\n        setRules,\n      }}\n    >\n      {children}\n    </FormDataContext.Provider>\n  );\n};\n\nFormDataContextProvider.propTypes = {\n  children: PropTypes.oneOfType([\n    PropTypes.arrayOf(PropTypes.node),\n    PropTypes.node,\n  ]).isRequired,\n};\n\nexport const useFormData = () => useContext(FormDataContext);\n","/*\n * SPDX-FileCopyrightText: 2021 Splunk, Inc. <sales@splunk.com>\n * SPDX-License-Identifier: LicenseRef-Splunk-8-2021\n *\n */\n\nimport React, { useState, useEffect, memo } from \"react\";\nimport Select from \"@splunk/react-ui/Select\";\nimport { CSRFToken } from \"@splunk/splunk-utils/config\";\nimport { createRESTURL } from \"@splunk/splunk-utils/url\";\n\nimport { useFormData } from \"../hooks/useFormData\";\n\nconst valueStyle = {\n  flex: \"1 0 0\",\n  borderColor: \"rgb(195, 203, 212)\",\n};\n\nconst ERROR_REGEX = /REST Error \\[([0-9]+)\\]: (.*)\\\\\".  See/;\n\nfunction QueueInput({\n  initValue,\n  effectiveRegion,\n  index,\n  handleFormStateUpdate,\n}) {\n  const { queues, setQueues, account, setFormState } = useFormData();\n  const [value, setValue] = useState(initValue);\n  const [options, setOptions] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [oldAwsRegion, setOldAwsRegion] = useState(effectiveRegion);\n\n  const handleChange = (e, { value }) => {\n    handleFormStateUpdate(index, effectiveRegion, value);\n    setValue(value);\n  };\n  const resetValues = (updateForm) => {\n    if (updateForm) {\n      handleFormStateUpdate(index, effectiveRegion, null);\n    }\n    setValue();\n    setOptions([]);\n    setLoading(false);\n  };\n  const generateOptions = (items) => {\n    return items.map((x) => <Select.Option label={x.label} value={x.value} />);\n  };\n  useEffect(() => {\n    if (!account) {\n      // if account is reset then the `RegionInput` removes the key from form state\n      resetValues(false);\n    }\n    if (typeof queues[account]?.[effectiveRegion] !== \"undefined\") {\n      setOptions(generateOptions(queues[account][effectiveRegion]));\n      // reset values in case dependent singleselect value is changed\n      if (effectiveRegion !== oldAwsRegion) {\n        setOldAwsRegion(effectiveRegion);\n        handleFormStateUpdate(index, effectiveRegion, null);\n        setValue();\n      }\n      setLoading(false);\n    }\n  }, [account, effectiveRegion, queues]);\n  useEffect(() => {\n    if (\n      account &&\n      effectiveRegion &&\n      typeof queues[account]?.[effectiveRegion] === \"undefined\"\n    ) {\n      setLoading(true);\n      const url = new URL(\n        createRESTURL(\"splunk_ta_aws/splunk_ta_aws_sqs_queue_names\"),\n        location\n      );\n      const params = {\n        aws_account: account,\n        aws_region: effectiveRegion,\n        output_mode: \"json\",\n        count: \"0\",\n      };\n      const headers = {\n        \"X-Splunk-Form-Key\": CSRFToken,\n        \"X-Requested-With\": \"XMLHttpRequest\",\n        \"Content-Type\": \"application/json\",\n      };\n      url.search = new URLSearchParams(params).toString();\n      /* Check if checkpoint for the entered Input Name exists of not. */\n      fetch(url, {\n        method: \"GET\",\n        headers,\n      })\n        .then((response) => {\n          if (!response.ok) {\n            return Promise.reject(response);\n          } else {\n            return response.json();\n          }\n        })\n        .then((content) => {\n          const entries = content?.entry || [];\n          const newQueues = { ...queues };\n          newQueues[account] =\n            typeof newQueues[account] === \"undefined\" ? {} : newQueues[account];\n          newQueues[account][effectiveRegion] = entries.map((x) => ({\n            label: x.name,\n            value: x.name,\n          }));\n          setQueues(newQueues);\n        })\n        .catch((error) => {\n          resetValues(true);\n          let message = `Failed to get SQS Queue for Region ${effectiveRegion}. `;\n          if (typeof error.text === \"function\") {\n            error.text().then((responseText) => {\n              let matches = responseText.match(ERROR_REGEX);\n\n              if (matches && matches.length === 3) {\n                message += `[${matches[1]}] ${matches[2]}`;\n              } else {\n                message += responseText;\n              }\n              setFormState((prevState) => {\n                const newState = { ...prevState };\n                newState.errorMsg = message;\n                return newState;\n              });\n            });\n          } else {\n            message += error;\n            setFormState((prevState) => {\n              const newState = { ...prevState };\n              newState.errorMsg = message;\n              return newState;\n            });\n          }\n        });\n    }\n  }, [account, effectiveRegion]);\n  return (\n    <Select\n      value={value}\n      onChange={handleChange}\n      disabled={loading}\n      placeholder={loading ? \"Loading...\" : \"Select an account and a region first\"}\n      style={valueStyle}\n      filter\n      inline\n    >\n      {options}\n    </Select>\n  );\n}\n\nexport default memo(QueueInput);\n","/*\n * SPDX-FileCopyrightText: 2021 Splunk, Inc. <sales@splunk.com>\n * SPDX-License-Identifier: LicenseRef-Splunk-8-2021\n *\n */\n\nimport React, { useState, useEffect, memo } from \"react\";\nimport Multiselect from \"@splunk/react-ui/Multiselect\";\nimport { CSRFToken } from \"@splunk/splunk-utils/config\";\nimport { createRESTURL } from \"@splunk/splunk-utils/url\";\n\nimport { useFormData } from \"../hooks/useFormData\";\n\nconst valueStyle = {\n  flex: \"1 0 0\",\n  borderColor: \"rgb(195, 203, 212)\",\n};\n\nconst ERROR_REGEX = /REST Error \\[([0-9]+)\\]: (.*)\\\\\".  See/;\n\nfunction RulesInput({\n  initValue,\n  effectiveRegion,\n  index,\n  handleFormStateUpdate,\n}) {\n  const { rules, setRules, account, awsIamRole, setFormState } = useFormData();\n  const [values, setValues] = useState(initValue);\n  const [options, setOptions] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [oldAwsRegion, setOldAwsRegion] = useState(effectiveRegion);\n\n  const handleChange = (e, { values }) => {\n    handleFormStateUpdate(index, effectiveRegion, values);\n    setValues(values);\n  };\n  const resetValues = (updateForm) => {\n    if (updateForm) {\n      handleFormStateUpdate(index, effectiveRegion, []);\n    }\n    setValues([]);\n    setOptions([]);\n    setLoading(false);\n  };\n  const generateOptions = (items) => {\n    return items.map((x) => (\n      <Multiselect.Option label={x.label} value={x.value} />\n    ));\n  };\n  useEffect(() => {\n    if (!account) {\n      // if account is reset then the `RegionInput` removes the key from form state\n      resetValues(false);\n    }\n    if (typeof rules[account]?.[effectiveRegion] !== \"undefined\") {\n      setOptions(generateOptions(rules[account][effectiveRegion]));\n      // reset values in case dependent singleselect value is changed\n      if (effectiveRegion !== oldAwsRegion) {\n        setOldAwsRegion(effectiveRegion);\n        handleFormStateUpdate(index, effectiveRegion, []);\n        setValues([]);\n      }\n      setLoading(false);\n    }\n  }, [account, effectiveRegion, rules]);\n  useEffect(() => {\n    if (\n      account &&\n      effectiveRegion &&\n      typeof rules[account]?.[effectiveRegion] === \"undefined\"\n    ) {\n      setLoading(true);\n      const url = new URL(\n        createRESTURL(\"splunk_ta_aws/splunk_ta_aws_config_rules\"),\n        location\n      );\n      let params = {\n        aws_account: account,\n        aws_region: effectiveRegion,\n        output_mode: \"json\",\n        count: \"0\",\n      };\n      if(awsIamRole)\n      {\n        params.aws_iam_role = awsIamRole;\n      };\n      const headers = {\n        \"X-Splunk-Form-Key\": CSRFToken,\n        \"X-Requested-With\": \"XMLHttpRequest\",\n        \"Content-Type\": \"application/json\",\n      };\n      url.search = new URLSearchParams(params).toString();\n      /* Check if checkpoint for the entered Input Name exists of not. */\n      fetch(url, {\n        method: \"GET\",\n        headers,\n      })\n        .then((response) => {\n          if (!response.ok) {\n            return Promise.reject(response);\n          } else {\n            return response.json();\n          }\n        })\n        .then((content) => {\n          const entries = content?.entry || [];\n          const newRules = { ...rules };\n          newRules[account] =\n            typeof newRules[account] === \"undefined\" ? {} : newRules[account];\n          newRules[account][effectiveRegion] = entries.map((x) => ({\n            label: x.name,\n            value: x.name,\n          }));\n          setRules(newRules);\n        })\n        .catch((error) => {\n          let message = `Failed to get Config Rules for Region ${effectiveRegion}. `;\n          if (typeof error.text === \"function\") {\n            error.text().then((responseText) => {\n              let matches = responseText.match(ERROR_REGEX);\n              if (matches && matches.length === 3) {\n                message += `[${matches[1]}] ${matches[2]}`;\n              } else {\n                message += responseText;\n              }\n              setFormState((prevState) => {\n                const newState = { ...prevState };\n                const regions = newState.data.region.value\n                if (regions.includes(effectiveRegion)) {\n                  resetValues(true)\n                  handleFormStateUpdate(index, effectiveRegion, null, error = message);\n                  newState.errorMsg = message;\n                }\n                return newState;\n              });\n            });\n          } else {\n            message += error;\n            setFormState((prevState) => {\n              const newState = { ...prevState };\n              newState.errorMsg = message;\n              return newState;\n            });\n          }\n        });\n    }\n  }, [account, effectiveRegion]);\n  return (\n    <Multiselect\n      values={values}\n      onChange={handleChange}\n      disabled={loading}\n      placeholder={loading ? \"Loading...\" : \"Leave blank to select all rules in this region\"}\n      style={valueStyle}\n      inline\n    >\n      {options}\n    </Multiselect>\n  );\n}\n\nexport default memo(RulesInput);\n","/*\n * SPDX-FileCopyrightText: 2021 Splunk, Inc. <sales@splunk.com>\n * SPDX-License-Identifier: LicenseRef-Splunk-8-2021\n *\n */\n\nimport React, { useState, useEffect, memo } from \"react\";\nimport Multiselect from \"@splunk/react-ui/Multiselect\";\nimport { CSRFToken } from \"@splunk/splunk-utils/config\";\nimport { createRESTURL } from \"@splunk/splunk-utils/url\";\n\nimport { useFormData } from \"../hooks/useFormData\";\n\nconst valueStyle = {\n  flex: \"1 0 0\",\n  borderColor: \"rgb(195, 203, 212)\",\n};\n\nconst ERROR_REGEX = /REST Error \\[([0-9]+)\\]: (.*)\\\\\".  See/;\n\nfunction MultiQueueInput({\n  initValue,\n  effectiveRegion,\n  index,\n  handleFormStateUpdate,\n}) {\n  const { queues, setQueues, account, awsIamRole, setFormState, effectiveFormRows } =\n    useFormData();\n  const [values, setValues] = useState(initValue);\n  const [options, setOptions] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [oldAwsRegion, setOldAwsRegion] = useState(effectiveRegion);\n\n  const handleChange = (e, { values }) => {\n    handleFormStateUpdate(index, effectiveRegion, values);\n    setValues(values);\n  };\n  const resetValues = (updateForm) => {\n    if (updateForm) {\n      handleFormStateUpdate(index, effectiveRegion, []);\n    }\n    setValues([]);\n    setOptions([]);\n    setLoading(false);\n  };\n  const generateOptions = (items) => {\n    return items.map((x) => (\n      <Multiselect.Option label={x.label} value={x.value} />\n    ));\n  };\n  useEffect(() => {\n    if (!account) {\n      // if account is reset then the `RegionInput` removes the key from form state\n      resetValues(false);\n    }\n    if (typeof queues[account]?.[effectiveRegion] !== \"undefined\") {\n      setOptions(generateOptions(queues[account][effectiveRegion]));\n      // reset values in case dependent singleselect value is changed\n      if (effectiveRegion !== oldAwsRegion) {\n        setOldAwsRegion(effectiveRegion);\n        handleFormStateUpdate(index, effectiveRegion, []);\n        setValues([]);\n      }\n      setLoading(false);\n    }\n  }, [account, effectiveRegion, queues]);\n  useEffect(() => {\n    if (\n      account &&\n      effectiveRegion &&\n      typeof queues[account]?.[effectiveRegion] === \"undefined\"\n    ) {\n      setLoading(true);\n      const url = new URL(\n        createRESTURL(\"splunk_ta_aws/splunk_ta_aws_sqs_queue_names\"),\n        location\n      );\n      const params = {\n        aws_account: account,\n        aws_iam_role: awsIamRole,\n        aws_region: effectiveRegion,\n        output_mode: \"json\",\n        count: \"0\",\n      };\n      const headers = {\n        \"X-Splunk-Form-Key\": CSRFToken,\n        \"X-Requested-With\": \"XMLHttpRequest\",\n        \"Content-Type\": \"application/json\",\n      };\n      url.search = new URLSearchParams(params).toString();\n      /* Check if checkpoint for the entered Input Name exists of not. */\n      fetch(url, {\n        method: \"GET\",\n        headers,\n      })\n        .then((response) => {\n          if (!response.ok) {\n            return Promise.reject(response);\n          } else {\n            return response.json();\n          }\n        })\n        .then((content) => {\n          const entries = content?.entry || [];\n          const newQueues = { ...queues };\n          newQueues[account] =\n            typeof newQueues[account] === \"undefined\" ? {} : newQueues[account];\n          newQueues[account][effectiveRegion] = entries.map((x) => ({\n            label: x.name,\n            value: x.name,\n          }));\n          setQueues(newQueues);\n        })\n        .catch((error) => {\n          resetValues(true);\n          let message = `Failed to get SQS Queues for Region ${effectiveRegion}. `;\n          if (typeof error.text === \"function\") {\n            error.text().then((responseText) => {\n              let matches = responseText.match(ERROR_REGEX);\n\n              if (matches && matches.length === 3) {\n                message += `[${matches[1]}] ${matches[2]}`;\n              } else {\n                message += responseText;\n              }\n              setFormState((prevState) => {\n                const newState = { ...prevState };\n                newState.errorMsg = message;\n                return newState;\n              });\n            });\n          } else {\n            message += error;\n            setFormState((prevState) => {\n              const newState = { ...prevState };\n              newState.errorMsg = message;\n              return newState;\n            });\n          }\n        });\n    }\n  }, [account, effectiveRegion]);\n  return (\n    <Multiselect\n      values={values}\n      onChange={handleChange}\n      disabled={loading}\n      placeholder={loading ? \"Loading...\" : \"Select an account and a region first\"}\n      style={valueStyle}\n      inline\n    >\n      {options}\n    </Multiselect>\n  );\n}\n\nexport default memo(MultiQueueInput);\n","/*\n * SPDX-FileCopyrightText: 2021 Splunk, Inc. <sales@splunk.com>\n * SPDX-License-Identifier: LicenseRef-Splunk-8-2021\n *\n */\n\nimport React, { useState, useEffect, memo } from \"react\";\nimport Select from \"@splunk/react-ui/Select\";\nimport { CSRFToken } from \"@splunk/splunk-utils/config\";\nimport { createRESTURL } from \"@splunk/splunk-utils/url\";\n\nimport { useFormData } from \"../hooks/useFormData\";\n\nconst keyStyle = {\n  flex: \"0 0 150px\",\n  display: \"flex\",\n  alignItems: \"center\",\n};\n\nconst ERROR_REGEX = /REST Error \\[([0-9]+)\\]: (.*)\\\\\".  See/;\n\nfunction RegionInput({\n  initValue,\n  handleChangeRegion,\n  index,\n  handleFormStateUpdate,\n  handleFormStateDelete,\n}) {\n  const { regions, setRegions, serviceName, account, setFormState } =\n    useFormData();\n  const [options, setOptions] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [value, setValue] = useState(initValue);\n\n  const handleChange = (e, { value }) => {\n    setValue(value);\n    handleChangeRegion(value);\n    if (serviceName === \"aws_config_rule\") {\n      handleFormStateUpdate(index, value, []);\n    } else if (serviceName === \"splunk_ta_aws_sqs\") {\n      handleFormStateUpdate(index, value, []);\n    } else {\n      handleFormStateUpdate(index, value, null);\n    }\n    // reset error message of rest requests on filter change\n    setFormState((prevState) => {\n      const newState = { ...prevState };\n      newState.errorMsg = \"\";\n      return newState;\n    });\n  };\n  const resetValues = () => {\n    handleFormStateDelete(index);\n    setValue();\n    setOptions([]);\n    setLoading(false);\n  };\n  const generateOptions = (items) => {\n    const list = items.map((x) => (\n      <Select.Option label={x.label} value={x.value} />\n    ));\n    return list;\n  };\n\n  useEffect(() => {\n    if (!account) {\n      resetValues();\n    }\n    if (typeof regions[account] !== \"undefined\") {\n      setOptions(generateOptions(regions[account]));\n      setLoading(false);\n    }\n  }, [account, regions]);\n  useEffect(() => {\n    if (account && typeof regions[account] === \"undefined\") {\n      setLoading(true);\n      const url = new URL(\n        createRESTURL(\"splunk_ta_aws/splunk_ta_aws_regions\"),\n        location\n      );\n      const params = {\n        aws_service: serviceName,\n        aws_account: account,\n        output_mode: \"json\",\n        count: \"0\",\n      };\n      const headers = {\n        \"X-Splunk-Form-Key\": CSRFToken,\n        \"X-Requested-With\": \"XMLHttpRequest\",\n        \"Content-Type\": \"application/json\",\n      };\n      url.search = new URLSearchParams(params).toString();\n      /* Check if checkpoint for the entered Input Name exists of not. */\n      fetch(url, {\n        method: \"GET\",\n        headers,\n      })\n        .then((response) => {\n          if (!response.ok) {\n            return Promise.reject(response);\n          } else {\n            return response.json();\n          }\n        })\n        .then((content) => {\n          const entries = content?.entry || [];\n          const newRegions = { ...regions };\n          newRegions[account] = entries.map((x) => ({\n            label: x.content.label,\n            value: x.name,\n          }));\n          setRegions(newRegions);\n        })\n        .catch((error) => {\n          resetValues();\n          let message = `Failed to get Region for Account ${account}. `;\n          if (typeof error.text === \"function\") {\n            error.text().then((responseText) => {\n              let matches = responseText.match(ERROR_REGEX);\n\n              if (matches && matches.length === 3) {\n                message += `[${matches[1]}] ${matches[2]}`;\n              } else {\n                message += responseText;\n              }\n              setFormState((prevState) => {\n                const newState = { ...prevState };\n                newState.errorMsg = message;\n                return newState;\n              });\n            });\n          } else {\n            message += error;\n            setFormState((prevState) => {\n              const newState = { ...prevState };\n              newState.errorMsg = message;\n              return newState;\n            });\n          }\n        });\n    }\n  }, [account]);\n  return (\n    <div style={keyStyle}>\n      <Select\n        value={value}\n        onChange={handleChange}\n        disabled={loading}\n        placeholder={loading ? \"Loading...\" : \"Select...\"}\n        style={{ width: \"150px\", minWidth: \"100%\", borderColor: \"rgb(195, 203, 212)\" }}\n        filter\n        inline\n      >\n        {options}\n      </Select>\n    </div>\n  );\n}\n\nexport default memo(RegionInput);\n","/*\n * SPDX-FileCopyrightText: 2021 Splunk, Inc. <sales@splunk.com>\n * SPDX-License-Identifier: LicenseRef-Splunk-8-2021\n *\n */\n\nimport React, { useState, memo, useEffect } from \"react\";\n\nimport QueueInput from \"./QueueInput\";\nimport RulesInput from \"./RulesInput\";\nimport MultiQueueInput from \"./MultiQueueInput\";\nimport { useFormData } from \"../hooks/useFormData\";\nimport RegionInput from \"./RegionInput\";\n\nconst spanStyle = {\n  display: \"inline-flex\",\n  lineHeight: \"32px\",\n  flex: \"0 0 30px\",\n  justifyContent: \"center\",\n  alignItems: \"center\",\n};\n\nfunction SingleInputWrapper({\n  initValue,\n  index,\n  handleFormStateUpdate,\n  handleFormStateDelete,\n}) {\n  const [effectiveRegion, setEffectiveRegion] = useState(initValue?.region);\n  const { serviceName } = useFormData();\n\n  useEffect(() => {\n    // remove item from effectiveFormState on component unmount\n    return () => {\n      handleFormStateDelete(index);\n    };\n  }, []);\n\n  let secondInput = (\n    <RulesInput\n      initValue={initValue?.rules}\n      effectiveRegion={effectiveRegion}\n      index={index}\n      handleFormStateUpdate={handleFormStateUpdate}\n    />\n  );\n  if (serviceName === \"splunk_ta_aws_sqs\") {\n    secondInput = (\n      <MultiQueueInput\n        initValue={initValue?.queues}\n        effectiveRegion={effectiveRegion}\n        index={index}\n        handleFormStateUpdate={handleFormStateUpdate}\n      />\n    );\n  } else if (serviceName === \"aws_config\") {\n    secondInput = (\n      <QueueInput\n        initValue={initValue?.queues}\n        effectiveRegion={effectiveRegion}\n        index={index}\n        handleFormStateUpdate={handleFormStateUpdate}\n      />\n    );\n  }\n\n  return (\n    <div style={{ display: \"flex\" }}>\n      <RegionInput\n        initValue={initValue?.region}\n        handleChangeRegion={setEffectiveRegion}\n        index={index}\n        handleFormStateUpdate={handleFormStateUpdate}\n        handleFormStateDelete={handleFormStateDelete}\n      />\n      <span style={spanStyle}></span>\n      {secondInput}\n    </div>\n  );\n}\n\nexport default memo(SingleInputWrapper);\n","/*\n * SPDX-FileCopyrightText: 2021 Splunk, Inc. <sales@splunk.com>\n * SPDX-License-Identifier: LicenseRef-Splunk-8-2021\n *\n */\n\nimport React, { useState, useEffect, memo } from \"react\";\n\nimport { createDOMID } from \"@splunk/ui-utils/id\";\nimport FormRows from \"@splunk/react-ui/FormRows\";\n\nimport { useFormData } from \"../hooks/useFormData\";\nimport SingleInputWrapper from \"./SingleInputWrapper\";\n\nfunction CustomFormRows() {\n  const [items, setItems] = useState([]);\n  const {\n    setAccount,\n    setAwsIamRole,\n    serviceName,\n    setFormState,\n    effectiveFormRows,\n    setEffectiveFormRows,\n  } = useFormData();\n\n  // data binding for account state var -> custom hook onChange\n  window.setAccount = (value) => {\n    setAccount(value);\n  };\n\n  window.setAwsIamRole = (value) => {\n    setAwsIamRole(value);\n  };\n\n  useEffect(() => {\n    // update form state to submit updated data on form save\n    const regions = [];\n    const queues = [];\n    const rules = [];\n    const errors = [];\n    Object.entries(effectiveFormRows).forEach(([_, v]) => {\n      regions.push(v.region);\n      if (serviceName === \"aws_config_rule\") {\n        rules.push(v.rules && v.rules.join(\",\"));\n        errors.push(v.error);\n      } else if (serviceName === \"splunk_ta_aws_sqs\") {\n        queues.push(v.queues && v.queues.join(\",\"));\n      } else {\n        queues.push(v.queues);\n      }\n    });\n    setFormState((prevState) => {\n      const newState = { ...prevState };\n      if (serviceName === \"aws_config_rule\") {\n        newState.data.region.value =\n          regions.length === 0 ? JSON.stringify([\"\"]) : JSON.stringify(regions);\n        newState.data.rule_names.value =\n          rules.length === 0 ? JSON.stringify([\"\"]) : JSON.stringify(rules);\n        newState.data.rule_names.custom_errors =\n          errors.length === 0 ? JSON.stringify([\"\"]) : JSON.stringify(errors);\n      } else if (serviceName === \"splunk_ta_aws_sqs\") {\n        newState.data.aws_region.value =\n          regions.length === 0 ? JSON.stringify([\"\"]) : JSON.stringify(regions);\n        newState.data.sqs_queues.value =\n          queues.length === 0 ? JSON.stringify([\"\"]) : JSON.stringify(queues);\n      } else {\n        newState.data.aws_region.value =\n          regions.length === 0 ? JSON.stringify([\"\"]) : JSON.stringify(regions);\n        newState.data.sqs_queue.value =\n          queues.length === 0 ? JSON.stringify([\"\"]) : JSON.stringify(queues);\n      }\n      return newState;\n    });\n  }, [effectiveFormRows]);\n\n  const handleFormStateUpdate = (index, region, value, error = null) => {\n    setEffectiveFormRows((oldFormRows) => {\n      const newFormRows = { ...oldFormRows };\n      if (serviceName === \"aws_config_rule\") {\n        newFormRows[index] = { region, rules: value, error: error };\n      } else if (serviceName === \"splunk_ta_aws_sqs\") {\n        newFormRows[index] = { region, queues: value };\n      } else {\n        newFormRows[index] = { region, queues: value };\n      }\n\n      return newFormRows;\n    });\n  };\n\n  const handleFormStateDelete = (index) => {\n    setEffectiveFormRows((oldFormRows) => {\n      const newFormRows = { ...oldFormRows };\n      delete newFormRows[index];\n      return newFormRows;\n    });\n  };\n\n  const handleRequestRemove = (e, { index }) => {\n    setItems((oldItems) => {\n      if (oldItems.length === 1) {\n        return oldItems;\n      }\n      return FormRows.removeRow(index, oldItems);\n    });\n  };\n\n  const handleRequestAdd = () => {\n    setItems((oldItems) => {\n      const index =\n        Date.now().toString(36) + Math.random().toString(36).substr(2);\n      setEffectiveFormRows((oldFormRows) => {\n        const newFormRows = { ...oldFormRows };\n        newFormRows[index] = {};\n        return newFormRows;\n      });\n      return FormRows.addRow(\n        <FormRows.Row\n          index={oldItems.length}\n          key={createDOMID()}\n          onRequestRemove={handleRequestRemove}\n        >\n          <SingleInputWrapper\n            index={index}\n            handleFormStateUpdate={handleFormStateUpdate}\n            handleFormStateDelete={handleFormStateDelete}\n          />\n        </FormRows.Row>,\n        oldItems\n      );\n    });\n  };\n\n  useEffect(() => {\n    if (Object.entries(effectiveFormRows).length > 0) {\n      setItems(\n        Object.entries(effectiveFormRows).map(([k, v], idx) => {\n          return (\n            <FormRows.Row\n              index={idx}\n              key=\"uniqueRowUno\"\n              onRequestRemove={handleRequestRemove}\n            >\n              <SingleInputWrapper\n                initValue={v}\n                index={k}\n                handleFormStateUpdate={handleFormStateUpdate}\n                handleFormStateDelete={handleFormStateDelete}\n              />\n            </FormRows.Row>\n          );\n        })\n      );\n    } else {\n      setItems([\n        <FormRows.Row\n          index={0}\n          key=\"uniqueRowUno\"\n          onRequestRemove={handleRequestRemove}\n        >\n          <SingleInputWrapper\n            index={\n              Date.now().toString(36) + Math.random().toString(36).substr(2)\n            }\n            handleFormStateUpdate={handleFormStateUpdate}\n            handleFormStateDelete={handleFormStateDelete}\n          />\n        </FormRows.Row>,\n      ]);\n    }\n  }, []);\n  let title = \"Config Rules\";\n  if (serviceName === \"splunk_ta_aws_sqs\") {\n    title = \"SQS Queues\";\n  } else if (serviceName === \"aws_config\") {\n    title = \"SQS Queue\";\n  }\n  const header = (\n    <div>\n      <span\n        style={{\n          display: \"inline-block\",\n          width: 180,\n        }}\n        id=\"header-key\"\n      >\n        Region\n      </span>\n      <span style={{ display: \"inline-block\" }} id=\"header-value\">\n        {title}\n      </span>\n    </div>\n  );\n  return (\n    <FormRows\n      addLabel=\"Add Another\"\n      header={header}\n      onRequestAdd={handleRequestAdd}\n      style={{ width: 500 }}\n    >\n      {items}\n    </FormRows>\n  );\n}\n\nexport default memo(CustomFormRows);\n","/*\n * SPDX-FileCopyrightText: 2021 Splunk, Inc. <sales@splunk.com>\n * SPDX-License-Identifier: LicenseRef-Splunk-8-2021\n *\n */\n\nimport React from \"react\";\n\nimport { SplunkThemeProvider } from \"@splunk/themes\";\n\nimport { ThemeProviderSettings } from \"../styles/Theme\";\nimport { FormDataContextProvider } from \"../hooks/useFormData\";\nimport CustomFormRows from \"./CustomFormRows\";\n\nfunction FormRowsWrapper({ hookProps }) {\n  return (\n    <SplunkThemeProvider {...ThemeProviderSettings}>\n      <FormDataContextProvider hookProps={hookProps}>\n        <CustomFormRows />\n      </FormDataContextProvider>\n    </SplunkThemeProvider>\n  );\n}\n\nexport default FormRowsWrapper;\n","/*\n * SPDX-FileCopyrightText: 2021 Splunk, Inc. <sales@splunk.com>\n * SPDX-License-Identifier: LicenseRef-Splunk-8-2021\n *\n */\n\nimport { CSRFToken } from '@splunk/splunk-utils/config'\nimport { isArray, omit } from 'underscore'\nimport $, { Deferred } from 'jquery'\nimport '../stylesheets/Hook.css'\nimport { getMapData, detectSource } from './configs/SourceInput'\nimport { buildInputLink } from './utils/HelpLinkUtil'\nimport { getComponent } from './utils/GlobalConfigUtil'\nimport moment from 'moment'\nimport { createRESTURL } from '@splunk/splunk-utils/url'\nimport ReactDOM from 'react-dom'\nimport React from 'react'\nimport FormRowsWrapper from './components/FormRowsWrapper'\n\nconst APP_NAME = 'Splunk_TA_aws'\n\nconst MAX_TIME = moment('2038-01-19T03:14:07Z')\n\nconst LOG_NAME_FORMAT_POSTFIX = '.%Y-%m-%d-'\n\nconst SERVICES_WITH_CONFLICT_FIELDS = [\n  'aws_cloudwatch',\n  'aws_config',\n  'aws_config_rule',\n  'splunk_ta_aws_sqs'\n]\n\nconst SERVICES_WITH_GROUP_SELECTION = ['aws_config', 'aws_config_rule', 'splunk_ta_aws_sqs']\n\nconst SQS_BASED_S3_SOURCETYPES = {\n  CloudTrail: 'aws:cloudtrail',\n  Config: 'aws:config',\n  S3AccessLogs: 'aws:s3:accesslogs',\n  CloudFrontAccessLogs: 'aws:cloudfront:accesslogs',\n  ELBAccessLogs: 'aws:elb:accesslogs',\n  VPCFlowLogs: 'aws:cloudwatchlogs:vpcflow',\n  DelimitedFilesDecoder: 'aws:s3:csv',\n  CustomLogs: 'aws:s3'\n}\n\nconst SPLUNK_TA_AWS_LOGS_SOURCETYPES = {\n  cloudtrail: 'aws:cloudtrail',\n  's3:accesslogs': 'aws:s3:accesslogs',\n  'cloudfront:accesslogs': 'aws:cloudfront:accesslogs',\n  'elb:accesslogs': 'aws:elb:accesslogs'\n}\n\nconst DLQ_REQUIRED_ERROR = 'Enabling dead letter queue is required for the SQS queue in this input. '\nconst VISIBILITY_TIMEOUT_WARNING =\n  'It is recommended to set VisibilityTimeout larger than 5 minutes for specified SQS queue. '\nconst QUEUE_NOT_FOUND_ERROR = 'The SQS Queue entered may not be present in the given region. '\n\nclass Hook {\n  /**\n     * Form hook\n     * @constructor\n     * @param {Object} globalConfig - Global configuration.\n     * @param {string} serviceName - Service name\n     * @param {object} state - object with state of the components on the servcice/page\n     * @param {string} mode - edit,create or clone\n     * @param {object} util - the utility object\n     */\n  constructor (globalConfig, serviceName, state, mode, util) {\n    this.globalConfig = globalConfig\n    this.serviceName = serviceName\n    this.state = state\n    this.mode = mode\n    this.util = util\n    this._debouncedNameChange = this.debounce(this._nameChange.bind(this), 200)\n    this.context = getComponent(globalConfig, serviceName)\n  }\n\n  onCreate () {\n    const cancelButton = $(\"button[label='Cancel']\")\n    // On click of Cancel button, URL is not getting updated properly - queryparams are not completely removed from URL\n    if (cancelButton) {\n      cancelButton.on('click', (e) => this._removeExtraParamsFromURL())\n    }\n  }\n\n  debounce (func, wait) {\n    let timeout\n    return function executedFunction (...args) {\n      clearTimeout(timeout)\n      timeout = setTimeout(() => {\n        func(...args)\n      }, wait)\n    }\n  }\n\n  onChange (field, value, dataDict) {\n    if (field === 's3_file_decoder') {\n      const sourceType = SQS_BASED_S3_SOURCETYPES[value]\n      this._setValue('sourcetype', sourceType)\n    }\n\n    if (field === 'distribution_id') {\n      const logNameFormat = value + LOG_NAME_FORMAT_POSTFIX\n      this._setValue('log_name_format', logNameFormat)\n    }\n    if (this.serviceName === 'aws_config' && field === 'aws_account') {\n      window.setAccount(dataDict.data.aws_account.value)\n    }\n    if (this.serviceName === 'splunk_ta_aws_sqs' && field === 'aws_account') {\n      window.setAccount(dataDict.data.aws_account.value)\n    }\n    if (this.serviceName === 'splunk_ta_aws_sqs' && field === 'aws_iam_role') {\n      window.setAwsIamRole(dataDict.data.aws_iam_role.value)\n    }\n    if (this.serviceName === 'aws_config_rule' && field === 'account') {\n      window.setAccount(dataDict.data.account.value)\n    }\n    if (this.serviceName === 'aws_config_rule' && field === 'aws_iam_role') {\n      window.setAwsIamRole(dataDict.data.aws_iam_role.value)\n    }\n    if (this.serviceName === 'aws_kinesis'){\n      if (field === 'account'){\n        this._setValue('region', this.state.data['region'].value)\n      }\n      if(field === 'account' || field === 'aws_iam_role' || field === 'region' || field === 'private_endpoint_enabled' || field === 'sts_private_endpoint_url' || field === 'kinesis_private_endpoint_url') {\n        this._setValue('stream_names', this.state.data['stream_names'].value)\n      }\n    }\n  }\n\n  onRender () {\n    const { input, service } = this._getInputService()\n    if (this.mode === 'edit' || this.mode === 'clone') {\n      const val = window.location.toString().split('?')\n      const url = `${val[0]}?service=${service}&input=${input}&action=${this.mode}`\n      setTimeout(() => window.history.pushState({}, '', url))\n    }\n    const label = $('form > div')\n\n    if (label.length > 0) {\n      const html = buildInputLink(service)\n      $(label[0]).append(html)\n    }\n    const mapData = getMapData()\n    const item = mapData.find((item) => {\n      return item.service === service && item.input === input\n    })\n\n    if (item) {\n      const models = omit(item, ['service', 'input'])\n      Object.keys(models).forEach((key) => {\n        this._setValue(key, models[key])\n      })\n    }\n\n    if (SERVICES_WITH_GROUP_SELECTION.includes(this.serviceName)) {\n      const waitForElementToDisplay = (selector, callback, checkFrequencyInMs, timeoutInMs) => {\n        const startTimeInMs = Date.now()\n        const loopSearch = () => {\n          if (document.querySelector(selector) != null) {\n            callback()\n          } else {\n            setTimeout(function () {\n              if (timeoutInMs && Date.now() - startTimeInMs > timeoutInMs) return\n              loopSearch()\n            }, checkFrequencyInMs)\n          }\n        }\n        loopSearch()\n      }\n      this.account = this.state.data[this.serviceName === 'aws_config_rule' ? 'account' : 'aws_account'].value\n\n      if (this.serviceName === 'aws_config_rule' || this.serviceName === 'splunk_ta_aws_sqs') {\n        this.aws_iam_role = this.state.data.aws_iam_role.value\n      }\n      this.initFormRows = {}\n      if (this.mode === 'edit' || this.mode === 'clone') {\n        if (this.serviceName === 'aws_config_rule') {\n          const awsRegions = JSON.parse(this.state.data.region.value)\n          const ruleNames = JSON.parse(this.state.data.rule_names.value).map((x) => x.split(','))\n          awsRegions.forEach((region, idx) => {\n            // key for `initFormRows` needs to be unique instead of being index\n            this.initFormRows[Date.now().toString(36) + Math.random().toString(36).substr(2)] = {\n              region,\n              rules: ruleNames[idx]\n            }\n          })\n        } else {\n          const awsRegions = JSON.parse(this.state.data.aws_region.value)\n          let sqsQueues = null\n          if (this.serviceName === 'splunk_ta_aws_sqs') {\n            sqsQueues = JSON.parse(this.state.data.sqs_queues.value).map((x) => x.split(','))\n          } else {\n            sqsQueues = JSON.parse(this.state.data.sqs_queue.value)\n          }\n          awsRegions.forEach((region, idx) => {\n            // key for `initFormRows` needs to be unique instead of being index\n            this.initFormRows[Date.now().toString(36) + Math.random().toString(36).substr(2)] = {\n              region,\n              queues: sqsQueues[idx]\n            }\n          })\n        }\n      }\n\n      waitForElementToDisplay(\n        '#group_selection',\n        () => {\n          ReactDOM.render(\n            <FormRowsWrapper\n              hookProps={{\n                initFormRows: this.initFormRows,\n                setFormState: this.util.setState,\n                serviceName: this.serviceName,\n                initAccount: this.account,\n                initAwsIamRole: this.aws_iam_role\n              }}\n            />,\n            document.getElementById('group_selection')\n          )\n        },\n        500,\n        9000\n      )\n    }\n\n    if (this.serviceName === 'aws_billing') {\n      if (\n        this.state.data.initial_scan_datetime.value === null ||\n        this.state.data.initial_scan_datetime.value === ''\n      ) {\n        const defaultValue =\n          moment().utc().subtract(3, 'months').startOf('month').format('YYYY-MM-DDTHH:mm:ss') + 'Z'\n        this._setValue('initial_scan_datetime', defaultValue)\n      }\n    } else if (this.serviceName === 'aws_billing_cur') {\n      if (this.state.data.start_date.value === null || this.state.data.start_date.value === '') {\n        const defaultValue = moment().utc().subtract(3, 'months').startOf('month').format('YYYY-MM')\n        this._setValue('start_date', defaultValue)\n      }\n    } else if (this.serviceName === 'aws_s3') {\n      if (this.state.data.parse_csv_with_delimiter.value === null || this.state.data.parse_csv_with_delimiter.value === '' || this.state.data.parse_csv_with_delimiter.value === undefined) {\n        const defaultValue = ','\n        this._setValue('parse_csv_with_delimiter', defaultValue)\n      }\n      if (this.state.data.parse_csv_with_header.value === null || this.state.data.parse_csv_with_header.value === '' || this.state.data.parse_csv_with_header.value === undefined) {\n        const defaultValue = 0\n        this._setValue('parse_csv_with_header', defaultValue)\n      }\n      if (\n        this.state.data.initial_scan_datetime.value === null ||\n        this.state.data.initial_scan_datetime.value === ''\n      ) {\n        const defaultValue = moment().utc().format('YYYY-MM-DDTHH:mm:ss') + 'Z'\n        this._setValue('initial_scan_datetime', defaultValue)\n      }\n    } else if (this.serviceName === 'aws_sqs_based_s3') {\n      // Do not set sourcetype in case of 'edit'\n      if (this.state.data.sourcetype.value === null || this.state.data.sourcetype.value === '') {\n        const sourceType = SQS_BASED_S3_SOURCETYPES[this.state.data.s3_file_decoder.value]\n        this._setValue('sourcetype', sourceType)\n      }\n      if (this.state.data.parse_csv_with_delimiter.value === null || this.state.data.parse_csv_with_delimiter.value === '' || this.state.data.parse_csv_with_delimiter.value === undefined) {\n        const defaultValue = ','\n        this._setValue('parse_csv_with_delimiter', defaultValue)\n      }\n      if (this.state.data.parse_csv_with_header.value === null || this.state.data.parse_csv_with_header.value === '' || this.state.data.parse_csv_with_header.value === undefined) {\n        const defaultValue = 0\n        this._setValue('parse_csv_with_header', defaultValue)\n      }\n    }\n\n    if (this.serviceName === 'aws_s3') {\n      if (input !== 'aws_cloudtrail') {\n        this._hideField('ct_blacklist')\n      }\n\n      if (input !== 'others') {\n        this._hideField(['whitelist', 'blacklist'])\n        this._disabledField('sourcetype')\n      }\n    } else if (this.serviceName === 'splunk_ta_aws_logs') {\n      if (input === 'cloudfront_access_logs') {\n        this._hideField('distribution_id', true)\n      }\n      const sourceType = SPLUNK_TA_AWS_LOGS_SOURCETYPES[this.state.data.log_type.value]\n      this._setValue('sourcetype', sourceType)\n      const defaultValue = moment().utc().subtract(7, 'days').format('YYYY-MM-DD')\n      this._setValue('log_start_date', defaultValue)\n      this._disabledField(['log_type', 'sourcetype'])\n      if (this.mode !== 'create' && input === 'cloudfront_access_logs') {\n        let distributionID = this.state.data.log_name_format.value\n        if (distributionID.indexOf(LOG_NAME_FORMAT_POSTFIX) !== -1) {\n          distributionID = distributionID.substring(0, distributionID.length - LOG_NAME_FORMAT_POSTFIX.length)\n        }\n        this._setValue('distribution_id', distributionID)\n        if (this.mode === 'edit') {\n          this._disabledField('distribution_id')\n        }\n      }\n    } else if (this.serviceName === 'aws_sqs_based_s3') {\n      if (input !== 'others') {\n        this._disabledField(['s3_file_decoder', 'sourcetype'])\n      }\n    } else if (this.serviceName === 'aws_kinesis') {\n      if (input === 'vpc_flow_logs') {\n        this._disabledField(['format', 'encoding', 'sourcetype'])\n      }\n    }\n\n    // Generic S3 Input UI warning\n    if (this.serviceName === 'aws_s3') {\n      const warningMessage = 'Amazon S3 buckets with an excessive number of files or abundant size will result in significant performance degradation and ingestion delays. Configure an SQS-Based S3 input to achieve efficiency.'\n      this.util.setState((prevState) => {\n        return { ...prevState, warningMsg: warningMessage }\n      })\n    }\n  }\n\n  onSave (dataDict) {\n    if (this.serviceName === 'splunk_ta_aws_logs' && dataDict.log_type === 'cloudfront:accesslogs') {\n      // Cannot set required=true for log_name_format since it is only required in \"cloudfront:accesslogs\"\n      if (dataDict.log_name_format == null) {\n        this.util.setErrorFieldMsg('distribution_id', 'Field Distribution ID is required.')\n        return false\n      } else {\n        this._setValue('distribution_id', null)\n      }\n    } else if (this.serviceName === 'aws_cloudwatch') {\n      if ('period' in dataDict && 'polling_interval' in dataDict) {\n        const times = dataDict.polling_interval / dataDict.period\n\n        if (Math.floor(times) !== times) {\n          this.util.setErrorMsg(\n            'The number of \"Polling Interval\" field should be a multiple of \"Granularity\".'\n          )\n          return false\n        }\n      }\n    } else if (this.serviceName === 'aws_s3') {\n      if ('terminal_scan_datetime' in dataDict) {\n        let termnalTime = dataDict.terminal_scan_datetime\n        try {\n          termnalTime = moment(termnalTime)\n          if (termnalTime > MAX_TIME) {\n            this.util.setErrorFieldMsg(\n              'terminal_scan_datetime',\n              'The max supported timestamp is 2038-01-19T03:14:07Z due to Year 2038 problem'\n            )\n            return false\n          } else {\n            this.util.clearAllErrorMsg()\n          }\n        } catch (err) {\n          return false\n        }\n      }\n    } else if (this.serviceName === 'aws_sqs_based_s3') {\n      if (dataDict.aws_account && dataDict.sqs_queue_region && dataDict.sqs_queue_url) {\n        const isValid = this._validateSQSqueue(dataDict)\n        return isValid\n      }\n    } else if (this.serviceName === 'aws_config_rule') {\n      const ruleErrors = JSON.parse(this.state.data.rule_names.custom_errors)\n      for (const error_m of ruleErrors.values()) {\n        if (error_m !== null && error_m !== '') {\n          this.util.setErrorMsg(error_m)\n          return false\n        }\n      }\n    }\n    else if (this.serviceName === 'aws_metadata') {\n      if ('apis' in dataDict) {\n          const RegNumber = /^[1-9]\\d*?$/\n          let api_interval = dataDict.apis.split(', ')\n          for (let i = 0; i < api_interval.length; i++) {\n              let interval = api_interval[i].split('/')\n              if (interval[1] === null || interval[1] === '') {\n                  return this.util.setErrorMsg('Field Interval is Required')\n              }\n              else if (!RegNumber.test(interval[1])) {\n                  return this.util.setErrorMsg('Interval value should be a non-zero positive integer')\n              }\n          }\n      }\n  }\n    return true\n  }\n\n  onSaveSuccess () {\n    this._removeExtraParamsFromURL()\n  }\n\n  onSaveFail () {\n    if (\n      this.serviceName === 'splunk_ta_aws_logs' &&\n      this.state.data.log_type.value === 'cloudfront:accesslogs'\n    ) {\n      const logNameFormat = this.state.data.log_name_format.value\n      if (logNameFormat !== null) {\n        const distributionId = logNameFormat.split('.')[0]\n        this._setValue('distribution_id', distributionId)\n      }\n    }\n  }\n\n  onEditLoad () {\n    if (SERVICES_WITH_CONFLICT_FIELDS.includes(this.serviceName)) {\n      this._fetchConflictFields(this.serviceName).done(() => {\n        if (Object.keys(this._conflict_fields || {}).length > 0) {\n          const entity = this.context.entity\n          let msg = 'The following fields have conflict. '\n          msg += Object.keys(this._conflict_fields || {})\n            .map((key) => {\n              if (key !== 'disabled') {\n                this.util.setErrorFieldMsg(key, '')\n              }\n              const globalConfigField = entity.find((el) => el.field === key)\n              const label = (globalConfigField) ? globalConfigField.label : key\n              return `${label} = [${this._conflict_fields[key].join(', ')}]`\n            })\n            .join(', ')\n          msg += '. Please resolve the conflict in conf file first.'\n          this.util.setErrorMsg(msg)\n        }\n      })\n    }\n  }\n\n  _validateSQSqueue (dataDict) {\n    let restURI = `splunk_ta_aws/splunk_ta_aws_sqs_queue_attributes?aws_account=${dataDict.aws_account}&aws_region=${dataDict.sqs_queue_region}&sqs_queue_url=${dataDict.sqs_queue_url}&private_endpoint_enabled=${dataDict.private_endpoint_enabled}&sts_private_endpoint_url=${dataDict.sts_private_endpoint_url}&sqs_private_endpoint_url=${dataDict.sqs_private_endpoint_url}&output_mode=json`\n    const iamRole = dataDict.aws_iam_role\n\n    if (iamRole) {\n      restURI += `&aws_iam_role=${iamRole}`\n    }\n\n    const url = createRESTURL(restURI, {\n      app: APP_NAME,\n      sharing: 'app'\n    })\n\n    const usingDLQ = dataDict.using_dlq\n    try {\n      const client = new XMLHttpRequest() /* global XMLHttpRequest:false */\n      client.open('GET', url, false)\n      client.setRequestHeader('X-Splunk-Form-Key', CSRFToken)\n      client.setRequestHeader('X-Requested-With', 'XMLHttpRequest')\n      client.setRequestHeader('Content-Type', 'application/json')\n      client.send()\n      if (client.status === 200) {\n        const data = JSON.parse(client.responseText)\n        const queueAttributes = data.entry[0].content\n        const visibilityTimeout = queueAttributes.VisibilityTimeout\n        const redrivePolicy = queueAttributes.RedrivePolicy\n\n        // check redrivePolicy & visibilityTimeout if it is DLQ (only if using_dlq is checked)\n        if (usingDLQ !== 0 && !redrivePolicy) {\n          this.util.setErrorFieldMsg('sqs_queue_url', DLQ_REQUIRED_ERROR)\n          return false\n        } else if (usingDLQ !== 0 && visibilityTimeout < 300) {\n          this.util.setErrorFieldMsg('sqs_queue_url', VISIBILITY_TIMEOUT_WARNING)\n          return false\n        }\n      } else {\n        this.util.setErrorFieldMsg('sqs_queue_url', QUEUE_NOT_FOUND_ERROR)\n        return false\n      }\n    } catch (err) {\n      this.util.setErrorFieldMsg('sqs_queue_url', `validation of selected SQS queue failed. ERROR : ${err}`)\n      return false\n    }\n    return true\n  }\n\n  _nameChange (dataDict) { }\n\n  _getInputService () {\n    this.urlParams = this._extractQuery()\n    let { input, service } = this.urlParams\n\n    if (!input || this.mode === 'edit' || this.mode === 'clone') {\n      const data = this._getNormalizeData()\n      input = detectSource(data, this.serviceName)\n    }\n\n    return {\n      input,\n      service\n    }\n  }\n\n  _removeExtraParamsFromURL () {\n    const url = window.location.toString()\n    const val = url.split('?')\n    if (val.length === 2) {\n      setTimeout(() => window.history.pushState({}, '', val[0]))\n    }\n  }\n\n  _extractQuery () {\n    // ADDON-17149. On IE, the URL location is different, so we need to use hash.\n    const search = document.location.search || document.location.hash\n    if (!search || search.length === 0) {\n      return\n    }\n\n    const pos = search.indexOf('?') + 1 || 0\n    const paramsArr = search.substring(pos).split('&')\n    const params = {}\n    paramsArr.forEach((param) => {\n      const kv = param.split('=')\n      if (kv.length === 1) {\n        params[kv[0]] = null\n      } else {\n        params[kv[0]] = kv[1]\n      }\n    })\n\n    return params\n  }\n\n  _setValue (key, value) {\n    this.util.setState((prevState) => {\n      const data = { ...prevState.data }\n      data[key].value = value\n      return { data }\n    })\n  }\n\n  _hideField (keys, inverse) {\n    if (!isArray(keys)) {\n      keys = [keys]\n    }\n    for (const key of keys) {\n      this.util.setState((prevState) => {\n        const data = { ...prevState.data }\n        if (inverse) {\n          data[key].display = true\n        } else {\n          data[key].display = false\n        }\n        return { data }\n      })\n    }\n  }\n\n  _disabledField (keys) {\n    if (!isArray(keys)) {\n      keys = [keys]\n    }\n    for (const key of keys) {\n      this.util.setState((prevState) => {\n        const data = { ...prevState.data }\n        data[key].disabled = true\n        return { data }\n      })\n    }\n  }\n\n  _fetchConflictFields (service) {\n    const dfd = Deferred()\n    const contextURL = createRESTURL('splunk_ta_aws_' + service, {\n      app: APP_NAME,\n      sharing: 'app'\n    })\n    fetch(contextURL + '?output_mode=json')/* global fetch:false */\n      .then((response) => response.json())\n      .then((data) => {\n        if (data.entry !== []) {\n          for (let i = 0; i < data.entry.length; i++) {\n            if (\n              data.entry[i].name === this.state.data.name.value &&\n              '_conflict_fields' in data.entry[i].content\n            ) {\n              this._conflict_fields = JSON.parse(data.entry[i].content._conflict_fields)\n            }\n          }\n        }\n        dfd.resolve()\n      })\n    return dfd\n  }\n\n  _getNormalizeData () {\n    const data = {}\n    const dataKeys = Object.keys(this.state.data)\n    dataKeys.forEach((key) => {\n      data[key] = this.state.data[key].value\n    })\n    return data\n  }\n}\n\nexport default Hook\n"],"names":["aws_config","aws_config_rule","aws_cloudwatch","aws_cloudwatch_logs","aws_s3","splunk_ta_aws_logs","aws_sqs_based_s3","aws_billing","aws_billing_cur","aws_cloudtrail","aws_kinesis","aws_inspector","aws_inspector_v2","splunk_ta_aws_sqs","aws_metadata","SQS_BASED_S3","input","link","getServiceLocationMap","encodeURIComponent","buildInputLink","getAllLinks","FormDataContext","createContext","regions","setRegions","queues","setQueues","effectiveState","setEffectiveState","FormDataContextProvider","hookProps","children","initFormRows","setFormState","serviceName","initAccount","initAwsIamRole","useState","account","setAccount","awsIamRole","setAwsIamRole","effectiveFormRows","setEffectiveFormRows","rules","setRules","React","Provider","value","propTypes","PropTypes","oneOfType","arrayOf","node","isRequired","useFormData","useContext","valueStyle","flex","borderColor","ERROR_REGEX","QueueInput","initValue","effectiveRegion","index","handleFormStateUpdate","setValue","options","setOptions","loading","setLoading","oldAwsRegion","setOldAwsRegion","resetValues","updateForm","useEffect","_queues$account","map","x","Select","Option","label","_queues$account2","url","URL","createRESTURL","location","params","aws_account","aws_region","output_mode","count","headers","CSRFToken","search","URLSearchParams","toString","fetch","method","then","response","ok","json","Promise","reject","content","entries","entry","newQueues","name","error","message","text","responseText","matches","match","length","prevState","newState","errorMsg","onChange","e","disabled","placeholder","style","filter","inline","memo","RulesInput","values","setValues","_rules$account","Multiselect","_rules$account2","aws_iam_role","newRules","data","region","includes","MultiQueueInput","keyStyle","display","alignItems","RegionInput","handleChangeRegion","handleFormStateDelete","aws_service","newRegions","width","minWidth","spanStyle","lineHeight","justifyContent","SingleInputWrapper","setEffectiveRegion","secondInput","CustomFormRows","items","setItems","window","errors","Object","forEach","v","push","join","JSON","stringify","rule_names","custom_errors","sqs_queues","sqs_queue","oldFormRows","newFormRows","handleRequestRemove","oldItems","FormRows","removeRow","idx","k","Row","key","onRequestRemove","Date","now","Math","random","substr","title","header","id","addLabel","onRequestAdd","addRow","createDOMID","FormRowsWrapper","SplunkThemeProvider","ThemeProviderSettings","MAX_TIME","moment","SERVICES_WITH_CONFLICT_FIELDS","SERVICES_WITH_GROUP_SELECTION","SQS_BASED_S3_SOURCETYPES","CloudTrail","Config","S3AccessLogs","CloudFrontAccessLogs","ELBAccessLogs","VPCFlowLogs","DelimitedFilesDecoder","CustomLogs","SPLUNK_TA_AWS_LOGS_SOURCETYPES","cloudtrail","Hook","globalConfig","state","mode","util","_debouncedNameChange","this","debounce","_nameChange","bind","context","getComponent","cancelButton","$","on","_this","_removeExtraParamsFromURL","func","wait","timeout","args","clearTimeout","setTimeout","field","dataDict","sourceType","_setValue","logNameFormat","_getInputService","service","val","split","history","pushState","html","append","selector","callback","checkFrequencyInMs","timeoutInMs","startTimeInMs","item","getMapData","find","models","omit","keys","_this2","awsRegions","parse","ruleNames","sqsQueues","ReactDOM","render","setState","document","getElementById","loopSearch","querySelector","initial_scan_datetime","defaultValue","utc","subtract","startOf","format","start_date","parse_csv_with_delimiter","undefined","parse_csv_with_header","sourcetype","s3_file_decoder","_hideField","_disabledField","log_type","distributionID","log_name_format","indexOf","substring","warningMsg","setErrorFieldMsg","times","polling_interval","period","floor","setErrorMsg","termnalTime","terminal_scan_datetime","clearAllErrorMsg","err","sqs_queue_region","sqs_queue_url","_validateSQSqueue","ruleErrors","error_m","RegNumber","api_interval","apis","i","interval","test","distributionId","_fetchConflictFields","done","_this3","_conflict_fields","entity","msg","globalConfigField","el","restURI","private_endpoint_enabled","sts_private_endpoint_url","sqs_private_endpoint_url","iamRole","app","sharing","usingDLQ","using_dlq","client","XMLHttpRequest","open","setRequestHeader","send","status","queueAttributes","visibilityTimeout","VisibilityTimeout","redrivePolicy","RedrivePolicy","urlParams","_extractQuery","_getNormalizeData","detectSource","hash","pos","paramsArr","param","kv","inverse","isArray","_this4","_this5","dfd","Deferred","contextURL","_this6","resolve","_this7"],"mappings":"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"}