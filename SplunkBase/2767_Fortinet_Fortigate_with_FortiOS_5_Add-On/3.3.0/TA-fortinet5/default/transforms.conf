
## This transform will force sourcetype to fortinet based on syslog device_id
#[force_sourcetype_fortinet_5]
#DEST_KEY = MetaData:Sourcetype
#REGEX = device_id\=FG\w{14}
#FORMAT = sourcetype::fortinet

## This transform will force a variable host based on the syslog devname
#[force_host_for_fortinet_5]
#DEST_KEY = MetaData:Host
#REGEX = devname=(.*?)(?=[,\s]\s*[\w_]+=|$)
#FORMAT = host::$1

[status_as_vendor_action_for_fortinet_5]
REGEX  = status=(.*?)(?=[,\s]\s*[\w_]+=|$)
## Simpler form that doesn't allow for commas in space separated kv or spaces in comma separated kv
#REGEX = status=([^,\s]*)
FORMAT = vendor_action::$1

[action_as_vendor_action_for_fortinet_5]
REGEX  = action=(.*?)(?=[,\s]\s*[\w_]+=|$)
## Simpler form that doesn't allow for commas in space separated kv or spaces in comma separated kv
#REGEX = action=([^,\s]*)
FORMAT = vendor_action::$1

## Modify firewall messages for fortinet firewall, need to set status and action as they cannot be extracted
[vendor_action_for_fortinet_firewall_change_5]
REGEX  = subtype=admin.*msg\="(\w+)\s+(\w+)\s+(\w+)
FORMAT = vendor_action::$3

[fortinet5_action_lookup]
filename = fortinet5_actions.csv

[fortinet5_transport_protocol_lookup]
filename = fortinet5_transport_protocols.csv


###### Fortinet Restarts ######

## REPORT
[fortinet_restart_field_5]
REGEX  = devname=([A-z0-9-_]+).*action=(reboot|shutdown).*msg="([A-z0-9\s]+)"
FORMAT = dest::$1 vendor_action::$2 result::$3


###### IPS ######
[fortinet_ips_category_5]
REGEX  = msg=\"([^:]+):
FORMAT = category::$1

[fortinet5_vendor_info_lookup]
filename = fortinet5_vendor_info.csv

[fortinet5_severities_lookup]
filename = fortinet5_severities.csv
