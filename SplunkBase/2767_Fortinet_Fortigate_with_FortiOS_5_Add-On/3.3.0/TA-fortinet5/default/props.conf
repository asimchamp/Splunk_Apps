# This is a hack and may not be supported in the future
# Blame jconger :-)
# http://blogs.splunk.com/2014/07/31/quick-tip-wildcard-sourcetypes-in-props-conf
[(?::){0}fortios5*]
SHOULD_LINEMERGE=false

## First we normalize the fortinet field values to "vendor_action"
REPORT-0vendor_action_for_fortinet_5 = status_as_vendor_action_for_fortinet_5,action_as_vendor_action_for_fortinet_5,vendor_action_for_fortinet_firewall_change_5
## Next we map from vendor_action to action using OUTPUT in order to override any existing vendor specified action field
LOOKUP-1action_for_fortinet_5        = fortinet5_action_lookup vendor_action OUTPUT action,change_type

## Fortinet fields on the left -> CIM fields on the right
FIELDALIAS-bytes_out_sourcetype_fortinet_5 = bytes_sent AS bytes_out
FIELDALIAS-bytes_in_sourcetype_fortinet_5 = bytes_received AS bytes_in
FIELDALIAS-dest_ip_sourcetype_fortinet_5 = dstpip as dest_ip,dstip as dest
FIELDALIAS-dest_dns_sourcetype_fortinet_5 = dstname as dest_dns
FIELDALIAS-dest_port_for_fortinet_5 = dstport as dest_port
FIELDALIAS-dvc_for_fortinet_5 = devname as dvc
FIELDALIAS-dvc_id_for_fortinet_5 = devid as dvc_id
FIELDALIAS-event_id_for_fortinet_5 = logid as event_id
FIELDALIAS-inbound_interface_sourcetype_fortinet_5 = srcint as inbound_interface
FIELDALIAS-outbund_interface_sourcetype_fortinet_5 = dstint as outbound_interface
FIELDALIAS-rule_number_for_fortinet_5 = policyid as rule_number
FIELDALIAS-session_id_for_fortinet_5 = sessionid as session_id
LOOKUP-severity_for_fortinet_5 = fortinet5_severities_lookup pri OUTPUT severity
FIELDALIAS-src_ip_sourcetype_fortinet_5 = srcip as src_ip
FIELDALIAS-src_dns_sourcetype_fortinet_5 = srcname as src_dns
LOOKUP-transport_for_fortinet_5 = fortinet5_transport_protocol_lookup transport_id OUTPUT transport
FIELDALIAS-transport_id_for_fortinet_5 = proto as transport_id
FIELDALIAS-command_for_fortinet_5 = msg as command

###### Fortinet Restarts ######
REPORT-fortinet_restart_5 = fortinet_restart_field_5

###### IPS ######
FIELDALIAS-signature = msg as signature
REPORT-category_5 = fortinet_ips_category_5
LOOKUP-vendor_info_for_fortinet_5 = fortinet5_vendor_info_lookup sourcetype OUTPUT ids_type,vendor,product
