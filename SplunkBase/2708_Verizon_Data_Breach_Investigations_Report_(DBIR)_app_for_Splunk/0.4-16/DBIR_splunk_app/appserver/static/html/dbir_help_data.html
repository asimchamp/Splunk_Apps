<div class="dbirHelp">
    
	<h1>Data By Any Other Name</h1>
    <div class="dbirBuffer" />
    <p>
        <b>If you take care of your data, it will take care of you.  Anyone 
        who has worked with data in the past knows that the best way
        to care for your data is to categorize your data.  By categorizing
        it, you can find what you're looking for pretty quickly.  We're not
        going to ask you go to out and buy a label maker (though they are
        pretty handy), but imagine shopping for soup if nothing was labeled.
        You'd be in for a surprise.  And we don't want surprises.
        </b>
    </p>
    <p>
        As we mentioned earlier, many of our queries are centered around using the 
        <a href="http://docs.splunk.com/Documentation/CIM/latest/User/Overview" target="_blank">
        Splunk Common Information Model</a> (CIM) as a least common denominator between
        disparate sources. (Say that five times fast.)  By doing this, even if you have
        similar data coming from three different places we can categorize that
        data in a manner that one report will give you a summary across all 
        sources.
    </p>
    <br />
    <p class="standOut">
        Give your data a map.  Over the river and through the woods is no longer enough.
    </p>
    <br />
    <p>
        Knowing where your data needs to live will help you categorize it.  But just
        knowing the location doesn't mean you can find what you're looking for without
        some sort of map to find it.  Our queries attempt to use generalized
        objects (such as CIM) to allow you to map a concept to actual data.
        We'll talk about:
    </p>
    <ul>
        <li>Choosing the right index</li>
        <li>Understanding how CIM translates to tags</li>
        <li>Understanding how tags translate to other types</li>
        <li>Understanding how other types translate to search strings</li>
    </ul>
    <br />
    
    <h3>ARE THEY INDEXES OR INDICES?</h3>
    <p>
        No matter what you call them, a Splunk Index is the most basic manner 
        in which to categorize your data.  Consider them buckets (because they
        actually are, in Splunk-speak).  While it isn't efficient to have
        a separate index for each and every type of data, in some cases it
        streamlines the process of organizing your data.
    </p>
    <p>
        Within the DBIR App, we query (at least) three indexes:
    </p>
    <br />
    <div class="dbirTable">
        <div class="dbirHeader">
            <div class="dbirCell dbirCellLeft dbirCellTop">
                INDEX
            </div>
            <div class="dbirCell dbirCellRight dbirCellTop">
                DESCRIPTION
            </div>
        </div>
        <div class="dbirRow dbirRowOdd">
            <div class="dbirCell dbirCellLeft">
                [none specified] 
            </div>
            <div class="dbirCell dbirCellRight">
                Data in a user's default index
            </div>
        </div>
        <div class="dbirRow dbirRowEven">
            <div class="dbirCell dbirCellLeft">
                email 
            </div>
            <div class="dbirCell dbirCellRight">
                Used for email related dashboards
            </div>
        </div>
        <div class="dbirRow dbirRowOdd">
            <div class="dbirCell dbirCellLeft">
                proxy 
            </div>
            <div class="dbirCell dbirCellRight">
                Used for phishing dashboards
            </div>
        </div>
     </div>
     <br /><br />
    <p>
        I say at least because by default a Splunk user will query
        the <b>main</b> index.  However, you can set up your users'
        default search index to anything.
    </p>
    <div class="dbirPad15">
        <img src="/static/app/DBIR_splunk_app/images/dbir-help-09.png" width="627"
            height="114" title="Default Index" alt="Default Index">
    </div>
    <p>
        Whether you are attempting to point to existing data or 
        determining where to store new data, choosing the right
        index is a good place to start.
    </p>
    <br />
    
    <h3>CIM</h3>
    <p>
        The Common Information Model (CIM) is all about relationships.  Specifically, 
        relationships between common event data and your actual data.  In this
        way, we can build common queries that will search equivalent event data
        from different sources and vendors.  The easiest way to understand is
        to take a look. Here is the beginning of a query from one of the DBIR App reports:
    </p>
    <div class="dbirPad15">
        <img src="/static/app/DBIR_splunk_app/images/dbir-help-21.png" width="600"
            height="66" title="Malware Example" alt="Malware Example">
    </div>
    <p>
        Notice the references <samp>datamodel=Malware</samp> and 
        <samp>Malware_Attacks.action</samp>.  These are part of the data model defined within CIM.
        If we go to Settings | Data models and click on Malware, we'll see this:
    </p>
    <div class="dbirPad15">
        <img src="/static/app/DBIR_splunk_app/images/dbir-help-22.png" width="600"
            height="227" title="Malware Model" alt="Malware Model">
    </div>
    <p>
        The <b>Malware_Attacks</b> object is defined by the tags:
        <b>malware</b> and <b>attack</b>.
    </p>
    <br />
    <h3>TAGS</h3>
    <p>
        Tags are another way to group event data together in an abstract way. 
        Within the CIM, <b>Malware_Attacks</b> incorporates the
        abstract tags <b>malware</b> and <b>attack</b>.  Then each source or vendor 
        can provide definitions for those two tags to build that relationship.
    </p>
    <p>
        Let's go to Settings | Tags and search by <b>malware</b> so you can see what I mean:
    </p>
    <div class="dbirPad15">
        <img src="/static/app/DBIR_splunk_app/images/dbir-help-24.png" width="600"
            height="66" title="Malware Tag" alt="Malware Tag">
    </div>
    <p>
        When we install the vendor add-on from Sophos, that add-on configures
        the <b>malware</b> tag that we are using.  Another add-on could define
        the same abstract tag a different way.
    </p>
    <br />
    <h3>TYPES</h3>
    <p>
        Event types are further objects that help categorize individual
        events.  In the previous section, we saw that the <b>malware</b>
        tag was a combination of four different event types, all of
        which are created by the Sophos add-on.
    </p>
    <p>
        Finally, let's go to Settings | Event types and search by <b>sophos_attack</b>  :
    </p>
    <div class="dbirPad15">
        <img src="/static/app/DBIR_splunk_app/images/dbir-help-25.png" width="600"
            height="62" title="Malware Type" alt="Malware Type">
    </div>
    <p>
        Here we see how the <b>sophos_attack</b> event type translates to a 
        specific search string that is used in the original query.  
        It takes a while to get there, but if you examine the following 
        table that summarizes what we just examined, you'll see how
        the various layers of abstraction allow a common query to 
        access your specific data.  More importantly, you can query
        by a single data model and you won't have to duplicate
        multiple search strings to pull in all the data you need.
    </p>
    <br />
    <div class="dbirTable">
        <div class="dbirHeader">
            <div class="dbirCell dbirCellLeft dbirCellTop">
                ITEM
            </div>
            <div class="dbirCell dbirCellLeft dbirCellTop">
                LAYER
            </div>
            <div class="dbirCell dbirCellRight dbirCellTop">
                DESCRIPTION
            </div>
        </div>
        <div class="dbirRow dbirRowOdd">
            <div class="dbirCell dbirCellLeft">
                DBIR query
            </div>
            <div class="dbirCell dbirCellLeft">
                DBIR App
            </div>
            <div class="dbirCell dbirCellRight">
                Initial query using CIM 
            </div>
        </div>
        <div class="dbirRow dbirRowEven">
            <div class="dbirCell dbirCellLeft">
                Data Model 
            </div>
            <div class="dbirCell dbirCellLeft">
                CIM
            </div>
            <div class="dbirCell dbirCellRight">
                Common definition of fields linked to common tags
            </div>
        </div>
        <div class="dbirRow dbirRowOdd">
            <div class="dbirCell dbirCellLeft">
                Tag
            </div>
            <div class="dbirCell dbirCellLeft">
                Vendor
            </div>
            <div class="dbirCell dbirCellRight">
                Vendor or user defined tags linked to other types (or search strings)
            </div>
        </div>
        <div class="dbirRow dbirRowEven">
            <div class="dbirCell dbirCellLeft">
                Event Type 
            </div>
            <div class="dbirCell dbirCellLeft">
                Vendor
            </div>
            <div class="dbirCell dbirCellRight">
                Vendor or user defined event types linked to search strings
            </div>
        </div>
    </div>
    <br /><br />
    <p class="standOut">
        Follow the trail to see where it leads.  Click 
        <a href="/app/DBIR_splunk_app/dbir_help5">here</a> for another example.
    </p>
    <br />
    
    <h3>WHAT ABOUT MY DATA?</h3>
    <p>
        Relying on an add-on to define the tags and types necessary to link the data model
        queries to my data isn't always enough.  What if my data is unique?
    </p>
    <p>
        Well, that's easy enough.  Just follow the same process outlined above and create
        your own tags and types.  You'll want to examine the data models to make sure
        your data is equivalent.  The <b>Malware_Attacks</b> data model is a good place
        to start.  Open it from the Settings | Data models page and you'll see on the 
        right side of the screen four sections:
    </p>
    <ul>
        <li>Constraints</li>
        <li>Inherited</li>
        <li>Extracted</li>
        <li>Calculated</li>
    </ul>
    <p>
        Look through the various fields and how they are defined by clicking <em>Edit</em>.
        You'll see that some fields are merely extracted from the data
        (hence the name), but others are calculated.  If your data doesn't fit exactly
        within these data models, you can put together your own calculated fields to override the defaults, so that
        you can still use these common data models (albeit with your own special flavor)
        against your own raw data.
    </p>
    
    <br /><br /><br /><br /><br /><br />
</div>