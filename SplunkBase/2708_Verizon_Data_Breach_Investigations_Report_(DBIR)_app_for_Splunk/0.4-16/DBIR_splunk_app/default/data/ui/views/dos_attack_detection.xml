<dashboard stylesheet="dbir-0.4-16.css">
  <label>DoS Attack Detection</label>
  <description>IP usage metrics for identification of Denial-of-Service attacks over the last 24 hours</description>
  <row>
    <panel>
      <chart>
        <title>Top 20 - Noisy Source IP's</title>
        <search>
          <query>sourcetype=* | top limit=20 src_ip | rename src_ip AS "Source IP" count AS Count</query>
          <earliest>-24h@h</earliest>
          <latest>now</latest>
        </search>
        <option name="charting.chart">pie</option>
      </chart>
    </panel>
    <panel>
      <chart>
        <title>Top 20 - Noisy Destination IP's</title>
        <search>
          <query>sourcetype=* | top limit=20 dest_ip | rename dest_ip AS "Destination IP" count AS Count</query>
          <earliest>-24h@h</earliest>
          <latest>now</latest>
        </search>
        <option name="charting.chart">pie</option>
      </chart>
    </panel>
  </row>
  <row>
    <panel>
      <chart>
        <title>Noisy Source IP's - Trending Chart</title>
        <search>
          <query>sourcetype=* | timechart span=1hr useother=f usenull=f count by src_ip</query>
          <earliest>-24h@h</earliest>
          <latest>now</latest>
        </search>
        <option name="charting.axisTitleX.visibility">collapsed</option>
        <option name="charting.chart">line</option>
      </chart>
    </panel>
    <panel>
      <chart>
        <title>Noisy Destination IP's - Trending Chart</title>
        <search>
          <query>sourcetype=* | timechart span=1hr useother=f usenull=f count by dest_ip</query>
          <earliest>-24h@h</earliest>
          <latest>now</latest>
        </search>
        <option name="charting.axisTitleX.visibility">collapsed</option>
        <option name="charting.chart">line</option>
      </chart>
    </panel>
  </row>
  <row>
    <panel>
      <chart>
        <title>Traffic Volume - Inbound Vs Outbound</title>
        <search>
          <query>(sourcetype="stream:http") OR (sourcetype="stream:dns" tag=network)
| bucket 1m 
| stats sum(bytes_in) as bytes_in sum(bytes_out) as bytes_out by _time 
| eval gb_bytes_in=bytes_in/1000 
| eval gb_bytes_out=bytes_out/1000 
| timechart span=1hr max(gb_bytes_in) as "Inbound" max(gb_bytes_out) as "Outbound"</query>
          <earliest>-24h@h</earliest>
          <latest>now</latest>
        </search>
        <option name="charting.chart">area</option>
        <option name="charting.axisTitleX.visibility">collapsed</option>
      </chart>
    </panel>
  </row>
  <row>
    <panel>
      <table>
        <title>Top Hit IP's</title>
        <search>
          <query>sourcetype=* | top limit=20 src_ip | rename src_ip as "Source IP", count as "Number of Hits" | fields - percent</query>
          <earliest>-24h@h</earliest>
          <latest>now</latest>
        </search>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <chart>
        <title>Top HTTP Status Codes</title>
        <search>
          <query>sourcetype=* status&gt;200 AND status&lt;600 | timechart span=1hr count by status</query>
          <earliest>-24h@h</earliest>
          <latest>now</latest>
        </search>
        <option name="charting.chart">line</option>
        <option name="charting.axisTitleX.visibility">collapsed</option>
      </chart>
    </panel>
  </row>
</dashboard>