#### pfSense filterlog stanzas ####
# Changing sourcetype for filterlog logs
[set_sourcety_for_filterlog]
REGEX = \d\d\s+filterlog
CLEAN_KEYS = 0
FORMAT = sourcetype::pfsense_filterlog
DEST_KEY = MetaData:Sourcetype

# Lookup table definition
[lookup_pfsense_filterlog_actions]
filename = lookup_pfsense_filterlog_actions.csv

# Field transform definiton
[filterlog-tcp-udp]
CLEAN_KEYS = 0
REGEX = (?=[^f]*(?:filterlog|f.*filterlog))^(?:[^:\n]*:){5}\s+(\d+)(?:[^,\n]*,){4}(\w+),match,(\w+)(?:[^,\n]*,){10}([a-z]+),\d+,([^,]+),([^,]+),(\d+),([^,]+)
FORMAT = rule::$1 interface::$2 vendor_action::$3 transport::$4 src::$5 dest::$6 src_port::$7 dest_port::$8



#### pfSense openvpn stanzas ####
# Changing sourcetype for openvpn logs
[set_sourcety_for_openvpn]
REGEX = :\d\d\s+openvpn
CLEAN_KEYS = 0
FORMAT = sourcetype::pfsense_openvpn
DEST_KEY = MetaData:Sourcetype

# Lookup table definition
[lookup_pfsense_openvpn_auth]
filename = lookup_pfsense_openvpn_auth.csv

# Field transform definiton
[openvpn_auth_ok]
CLEAN_KEYS = 0
FORMAT = user::$1 src::$2 vendor_action::$3
REGEX = :\s+(\w+)/([^:]+):\d+\s+(MULTI_sva)

# Field transform definiton
[openvpn_auth_error]
CLEAN_KEYS = 0
FORMAT = src::$1 vendor_action::$2
REGEX = \]:\s+([^:]+):\d+\s+([^:]+): Auth Username



#### pfSense webui stanzas ####
# Changing sourcetype for webui logs
[set_sourcety_for_webui]
REGEX = \s+php-fpm
CLEAN_KEYS = 0
FORMAT = sourcetype::pfsense_webui
DEST_KEY = MetaData:Sourcetype

# Lookup table definition
[lookup_pfsense_webui_auth]
filename = lookup_pfsense_webui_auth.csv

# Field transform definiton
[webui-login]
CLEAN_KEYS = 0
FORMAT = app::$1 vendor_action::$2 user::$3 src::$4
REGEX = ^(?:[^ \n]* ){9}(php-fpm).+\.php:\s+(.+)'(\w+)'.+\s+(\d+\.\d+\.\d+\.\d+$)


