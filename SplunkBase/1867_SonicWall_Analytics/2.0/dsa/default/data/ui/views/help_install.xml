<dashboard>
    <label>Install/Configuration Instructions</label>
    <row>
        <html>
          <h1>Installation Steps</h1>
          	<ol>
              <li><strong>Create a Custom Index for SonicWALLs</strong></li>
              <li><strong>Configure Splunk to search your Index by default (optional)</strong></li>
              <li><strong>Create an IPFix inbound Port</strong></li>
              <li><strong>Configure the firewall to send data through IPFix</strong></li>
	        </ol>
          <h2>1. Create a Custom Index</h2>
          	<ol>
              <li>Log in to Splunk with an Admin account</li>
              <li>Go to <strong>Settings > Indexes</strong></li>
              <li>Select <strong>New</strong></li>
              <li>The index should be named <strong>sonicwall</strong></li>
              <p>
                The sonicwall index grows quickly and gets very large. Our testing server daily processes more than 50GB of events.
                We recommend you create your index on a NAS server or similar volume in the same system. If you
                have limited disk space, set the maximum index size when creating the index to prevent overfilling your filesystem
              </p>
            </ol>
          <h2>2. Configure Splunk to search sonicwall index by default (Optional)</h2>
          	<p>
              This feature works during the first 60 days of a free license. When you convert to the 500MB perpetual
              free license, it stops working. Splunk Enterprise (licensed). 
          </p>
          	<ol>
              <li>Go to <strong>Settings > Users and Authentication > Access Controls > Roles</strong></li>
              <li>Select <strong>Roles</strong></li>
              <li>Select your user account</li>
              <li>Find <strong>Indexes searched by default</strong></li>
              <li>Add your <em>sonicwall</em> index to the list</li>
              <li>Repeat these steps for all other users or roles that apply</li>
            </ol>
          <h2>3. Create an IPFix Inbound Port (Verify)</h2>
            <ol>
              <li>Select <strong>Settings > Data Inputs</strong></li>
              <li>Add a new connection for the <strong>Dell IPFix Collector</strong></li>
              <li>Name:<strong>dell_ipfix</strong></li>
              <li>Listen Port:<strong>2055</strong></li>
              <li>Check <strong>More Settings</strong></li>
              <li>Change the default index to <em>sonicwall</em></li>
            </ol>
          <h2>4. Configure the Firewall to send IPFix</h2>
            <ol>
              <li>Log in to your firewall</li>
              <li>Navigate to<strong> App Flow > Flow Reporting > External Collector</strong></li>
              <li>YOU MIGHT HAVE TO REBOOT YOUR FIREWALL TO ENABLE THIS FEATURE</li>
              <li>Check the <strong>Send Flows and Real-time Data to the External Collector</strong> option</li>
              <li>External Flow Reporting Format: <strong>IPFIX with extensions</strong></li>
              <li>External Collector's IP address: ENTER THE IP OF YOUR SPLUNK SERVER/COLLECTOR</li>
              <li>External Collector's UDP Port Number: <strong>2055</strong></li>
              <li>Report On Connection Close: <strong>CHECK</strong></li>
            </ol>
          <p> <strong>WARNING:</strong> There is a known bug in 6.x preventing the firewall from sending connection closed messages on flows that
              age out. This could prevent you from receiving large amount of events.
	        </p>
		    <p>
              Connection Open, Closed, KB Sent options: If you enable Connection Open, you will receive two IPFix messages per
              flow through the firewall. This doubles your license usage and is not advised. Enabling "KB sent"  
              increases the message count, but does not retrieve your delta values because they are combined at the collector to 
              reduce data into Splunk. You should not enable "KB sent." 
            </p>
        </html>
		<html>
          <h1>Debugging</h1>
          <ol>
            
            <li>Run the search: <em>index=sonicwall</em>
            <ul>
              <li>If you receive results, you are getting your data as expected</li>
            </ul>
            </li>
            
            <li>Verify that data is getting to your collector
            <ul>
              <li>TCP Dump port 2055 on Splunk</li>
            </ul>
            </li>
            
            <li>Makes sure port 2055 is open on Splunk
            <ul>
              <li><em>netstatn -an | grep 2055</em></li>
            </ul>
            </li>
            
            <li>Verify that IPTables is not blocking that port (flush)
            <ul>
              <li><em>iptables -F</em></li>
            </ul>
            </li>
            
            <li>Turn off SELINUX on CentOS or Redhat
            <ul>
              <li><em> echo 0 > /selinux/enforce</em></li>
            </ul>
            </li>
          </ol>
          <h1>Default Landing Page</h1>
          <p>This configuration information (Help) is set as the default landing page. We advise you change this after Splunk
            is configured and you are receiving working dashboards. To change the defaults:
          </p>
          <ol>
            <li>Take the file located at:
              $SPLUNK_HOME/dsa/default/data/ui/nav/default.xml and copy it to $SPLUNK_HOME/dsa/local/data/ui/nav/default.xml</li>
            <li>Edit the file and change the summary_dashboard to the default. </li>
            <li>Restart Splunk and verify your changes</li>
          </ol>
          <h1>Name your Firewalls (Recomended)</h1>
          <ol>
            <li>Settings > search, report and alerts</li>
            <li>App context > Dell SonicWALL Analytics for Splunk Enterprise</li>
            <li>Firewall hostname > run</li>
            <p>This report searches the last four hours and generates a lookup table at $SPLUNK_HOME/dsa/lookups/sonicwall_firewalls.csv
              That file contains the <strong>IP > Hostname Mapping</strong> information </p>
            <li>Edit the file at the command line. Replace the second occurence of the IP with the name of your firewall. If the name has a space
              surrounding the name in double quotes. For example, "space station"</li>
            <li>Navigate to the applications dashboard and reload it. You should now see the named firewall(s)</li>
          </ol>
        </html>
    </row>
</dashboard>