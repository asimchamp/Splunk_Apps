<form script="table_data_bar.js, link_switcher.js, autodiscover.js" stylesheet="table_data_bar.css">
  <label>Search Strings v2</label>
  <description>Things people are searching the web for</description>
  <!-- Begin Post-Process Base Search -->
  <search id="baseSearch">
    <query>index=sonicwall tid=262 OR tid=359 google OR twitter OR apple OR stack OR youtube OR amazon OR bing 
      OR wikipedia OR ebay OR ask OR linkedin OR newegg OR netflix OR facebook OR craigslist $firewall$ | urldecode</query>
    <earliest>$time.earliest$</earliest>
    <latest>$time.latest$</latest>
  </search>
  <!-- End Post-Process -->
  <fieldset submitButton="false" autoRun="true">
    <input type="time" token="time" searchWhenChanged="true">
      <label>Time</label>
      <default>
        <earliest>-4h</earliest>
        <latest>now</latest>
      </default>
    </input>
    <input type="multiselect" token="firewall">
      <label>Firewalls</label>
      <search>
        <query>index=sonicwall TemplateID=262 OR tid=359 | eval firewall_hostname=coalesce(firewall_hostname, host) | top firewall_hostname</query>
      </search>
      <fieldForLabel>firewall_hostname</fieldForLabel>
      <fieldForValue>firewall_hostname</fieldForValue>
      <delimiter> OR </delimiter>
      <choice value="*">All</choice>
      <default>*</default>
      <valuePrefix>firewall_hostname="</valuePrefix>
      <valueSuffix>"</valueSuffix>
    </input>
  </fieldset>
  <row>
    <panel>
      <table>
        <search base="baseSearch">
          <query>chart count, values(url_domain) as "domain" by url_search_string | rename url_search_string as "Search"</query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
      </table>
    </panel>
    <panel>
      <table id="table1">
        <title>raw hits by site</title>
        <search>
          <query>index=sonicwall tid=262 OR tid=359 $firewall$ | top limit=20 url_domain</query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="wrap">true</option>
        <option name="rowNumbers">false</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">cell</option>
        <option name="count">10</option>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <html>
      <!-- Placeholder/container for the link switcher to appear -->
      <div class="link-switcher" data-items="link1,link2,link3,link4,link5,link6,link7,link8,link9">Select a view: <!--Links go here-->
      </div>
    </html>
      <table id="link1">
        <title>Google</title>
        <search base="baseSearch">
          <query>chart count by google_search | sort -count</query>
          <earliest>$time.earliest$</earliest>
          <latest>$time.latest$</latest>
        </search>
        <option name="wrap">true</option>
        <option name="rowNumbers">false</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">row</option>
        <option name="count">10</option>
      </table>
      <table id="link2">
        <title>Microsoft Bing</title>
        <search base="baseSearch">
          <query>search url_process_function=bing | chart count by url_search_string | sort -count</query>
        </search>
        <option name="wrap">true</option>
        <option name="rowNumbers">false</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">row</option>
        <option name="count">10</option>
      </table>
      <table id="link3">
        <title>Ask.com</title>
        <search base="baseSearch">
          <query>search url_process_function=ask | chart count by url_search_string | sort -count</query>
        </search>
        <option name="wrap">true</option>
        <option name="rowNumbers">false</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">row</option>
        <option name="count">10</option>
      </table>
      <table id="link4">
        <title>Twitter</title>
        <search base="baseSearch">
          <query>chart count by twitter_search | sort -count</query>
        </search>
        <option name="wrap">true</option>
        <option name="rowNumbers">false</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">row</option>
        <option name="count">10</option>
      </table>
      <table id="link5">
        <title>Facebook</title>
        <search base="baseSearch">
          <query>search url_process_function="facebook" | chart count by url_search_string | sort -count</query>
        </search>
        <option name="wrap">true</option>
        <option name="rowNumbers">false</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">row</option>
        <option name="count">10</option>
      </table>
      <table id="link6">
        <title>Amazon</title>
        <search base="baseSearch">
          <!-- fix this so it's for amazon -->
          <query>search amazon | chart count by url_search_string | sort -count</query>
        </search>
        <option name="wrap">true</option>
        <option name="rowNumbers">false</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">row</option>
        <option name="count">10</option>
      </table>
      <table id="link7">
        <title>Ebay</title>
        <search base="baseSearch">
          <query>search url_process_function="ebay" | chart count by url_search_string | sort -count</query>
        </search>
        <option name="wrap">true</option>
        <option name="rowNumbers">false</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">row</option>
        <option name="count">10</option>
      </table>
      <table id="link8">
        <title>Newegg</title>
        <search base="baseSearch">
          <query>search url_process_function=newegg | chart count by url_search_string | sort -count</query>
        </search>
        <option name="wrap">true</option>
        <option name="rowNumbers">false</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">row</option>
        <option name="count">10</option>
      </table>
      <table id="link9">
        <title>Craigslist</title>
        <search base="baseSearch">
          <query>search craigslist | search NOT url_type="image" | search cl_uri_root="search" |  
          chart count, values(cl_sub_region) by url_search_string | sort -count</query>
        </search>
        <option name="wrap">true</option>
        <option name="rowNumbers">false</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">row</option>
        <option name="count">10</option>
      </table>
    </panel>
  </row>
</form>