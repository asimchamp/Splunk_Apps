<?xml version='1.0' encoding='utf-8'?>
<form version="1.1" script="main.js, boot_delays.js" stylesheet="main.css, boot_delays.css">

   <label>Boot Delays</label>
   <description>This dashboard displays information about applications, services and drivers that caused boot delays. The events that are processed here are generated only when a delay occurs. The data displayed here does not reflect typical boot processes.</description>

   <fieldset autoRun="true">
      <input type="time" searchWhenChanged="true">
         <label>Time range:</label>
         <default>
            <earliest>-1h</earliest>
            <latest>now</latest>
         </default>
         <change>
            <eval token="TimeRangePickerSpan">relative_time(now(), latest) - relative_time(now(), earliest)</eval>
            <eval token="PivotPeriodAutoSolo">case('TimeRangePickerSpan' &lt; 350000, "auto", 'TimeRangePickerSpan' &lt; 610000, "hour", 1=1, "auto")</eval>
            <eval token="PivotPeriodAutoTimechart">case('TimeRangePickerSpan' &lt; 1200, "second", 'TimeRangePickerSpan' &lt; 300000, "minute", 'TimeRangePickerSpan' &lt; 700000, "hour", 1=1, "day")</eval>
         </change>
      </input>
      <input type="dropdown" token="FilterField" id="Input_FilterField">
         <label>Filter field:</label>
      </input>
      <input type="dropdown" token="FilterOperator" id="Input_FilterOperator">
         <label>Filter operator:</label>
      </input>
      <input type="text" token="FilterExpression" id="Input_FilterExpression">
         <label>Filter expression:</label>
         <default>*</default>
      </input>
      <input type="dropdown" token="FilterField2" id="Input_FilterField2" depends="$FilterLevel2$">
      </input>
      <input type="dropdown" token="FilterOperator2" id="Input_FilterOperator2" depends="$FilterLevel2$">
      </input>
      <input type="text" token="FilterExpression2" id="Input_FilterExpression2" depends="$FilterLevel2$">
      </input>
      <input type="dropdown" token="FilterField3" id="Input_FilterField3" depends="$FilterLevel3$">
      </input>
      <input type="dropdown" token="FilterOperator3" id="Input_FilterOperator3" depends="$FilterLevel3$">
      </input>
      <input type="text" token="FilterExpression3" id="Input_FilterExpression3" depends="$FilterLevel3$">
      </input>
      <input type="dropdown" token="FilterField4" id="Input_FilterField4" depends="$FilterLevel4$">
      </input>
      <input type="dropdown" token="FilterOperator4" id="Input_FilterOperator4" depends="$FilterLevel4$">
      </input>
      <input type="text" token="FilterExpression4" id="Input_FilterExpression4" depends="$FilterLevel4$">
      </input>
      <input type="dropdown" token="FilterField5" id="Input_FilterField5" depends="$FilterLevel5$">
      </input>
      <input type="dropdown" token="FilterOperator5" id="Input_FilterOperator5" depends="$FilterLevel5$">
      </input>
      <input type="text" token="FilterExpression5" id="Input_FilterExpression5" depends="$FilterLevel5$">
      </input>
      <input type="dropdown" token="FilterField6" id="Input_FilterField6" depends="$FilterLevel6$">
      </input>
      <input type="dropdown" token="FilterOperator6" id="Input_FilterOperator6" depends="$FilterLevel6$">
      </input>
      <input type="text" token="FilterExpression6" id="Input_FilterExpression6" depends="$FilterLevel6$">
      </input>
      <input type="text" token="FilterLevels" id="Input_FilterLevels" depends="$FilterLevels_Hidden$">
      </input>
      <input type="text" token="FilterDatamodel" id="Input_FilterDatamodel" depends="$FilterDatamodel_Hidden$">
         <default>OnOffTransition_SlowStartup</default>
      </input>
   </fieldset>

   <search id="Search_Charts">
      <query>
         | pivot `uA_DM_OnOffTransition_SlowStartup` OnOffTransition_SlowStartup
            count(TotalTimeMs) as "Number of events"
            sum(DegradationTimeMs) as SumDegradationTimeMs
            sum(TotalTimeMs) as SumTotalTimeMs
            avg(TotalTimeMs) as AvgTotalTimeMs
            splitrow
               Name
            $SearchFilter$
         | eval "Total delay (s)" = round(SumDegradationTimeMs/1000, 2)
         | eval "Total startup time (s)" = round(SumTotalTimeMs/1000, 2)
         | eval "Average startup time (s)" = round(AvgTotalTimeMs/1000, 2)
      </query>
   </search>
   
   <!-- Row 1 -->
   <row>

      <!-- Column 1 -->
      <panel>
         <title>Number of delays (top 5)</title>
         <chart>
            <search base="Search_Charts">
               <query>
                  sort limit=5 - "Number of events"
                  | fields
                     Name
                     "Number of events"
               </query>
            </search>
            <option name="height">250</option>
            <option name="charting.chart">bar</option>
            <option name="charting.legend.placement">none</option>
            <option name="charting.axisTitleX.visibility">collapsed</option>
            <option name="charting.drilldown">none</option>
         </chart>
      </panel>

      <!-- Column 2 -->
      <panel>
         <title>Total delay (top 5)</title>
         <chart>
            <search base="Search_Charts">
               <query>
                  sort limit=5 - "Total delay (s)"
                  | fields
                     Name
                     "Total delay (s)"
               </query>
            </search>
            <option name="height">250</option>
            <option name="charting.chart">bar</option>
            <option name="charting.legend.placement">none</option>
            <option name="charting.axisTitleX.visibility">collapsed</option>
            <option name="charting.drilldown">none</option>
         </chart>
      </panel>
   </row>

   
   <!-- Row 2 -->
   <row>

      <!-- Column 1 -->
      <panel>
         <title>Total startup time (top 5)</title>
         <chart>
            <search base="Search_Charts">
               <query>
                  sort limit=5 - "Total startup time (s)"
                  | fields
                     Name
                     "Total startup time (s)"
               </query>
            </search>
            <option name="height">250</option>
            <option name="charting.chart">bar</option>
            <option name="charting.legend.placement">none</option>
            <option name="charting.axisTitleX.visibility">collapsed</option>
            <option name="charting.drilldown">none</option>
         </chart>
      </panel>

      <!-- Column 2 -->
      <panel>
         <title>Average startup time (top 5)</title>
         <chart>
            <search base="Search_Charts">
               <query>
                  sort limit=5 - "Average startup time (s)"
                  | fields
                     Name
                     "Average startup time (s)"
               </query>
            </search>
            <option name="height">250</option>
            <option name="charting.chart">bar</option>
            <option name="charting.legend.placement">none</option>
            <option name="charting.axisTitleX.visibility">collapsed</option>
            <option name="charting.drilldown">none</option>
         </chart>
      </panel>
   </row>

   <!-- Row 3 -->
   <row>
      <panel>
         <title>Data table</title>
         <table id="Table_Panel31">
            <search>
               <query>
                  | pivot `uA_DM_OnOffTransition_SlowStartup` OnOffTransition_SlowStartup
                     latest(FriendlyName) as "Display name"
                     values(Version) as "Version(s)"
                     count(TotalTimeMs) as "#Events"
                     sum(DegradationTimeMs) as SumDegradationTimeMs
                     avg(DegradationTimeMs) as AvgDegradationTimeMs
                     sum(TotalTimeMs) as SumTotalTimeMs
                     avg(TotalTimeMs) as AvgTotalTimeMs
                     splitrow
                        Name
                     $SearchFilter$
                  | eval "Total degradation (s)" = round(SumDegradationTimeMs/1000, 2)
                  | eval "Avg. degradation (s)" = round(AvgDegradationTimeMs/1000, 2)
                  | eval "Total startup (s)" = round(SumTotalTimeMs/1000, 2)
                  | eval "Avg. startup (s)" = round(AvgTotalTimeMs/1000, 2)
                  | eval sortfield=lower('Name')
                  | table
                     "Display name"
                     Name
                     "Version(s)"
                     "Total startup (s)"
                     "Avg. startup (s)"
                     "Total degradation (s)"
                     "Avg. degradation (s)"
                     "#Events"
                     sortfield
                  | sort limit=0 sortfield
                  | fields - sortfield
               </query>
            </search>
            <option name="count">50</option>
            <option name="drilldown">none</option>
         </table>

      <html src="boot_delays_explanation.html">
      </html>
      </panel>
   </row>

</form>
