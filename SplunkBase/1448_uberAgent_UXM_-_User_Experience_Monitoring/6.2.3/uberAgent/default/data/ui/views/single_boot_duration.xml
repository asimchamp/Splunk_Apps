<?xml version='1.0' encoding='utf-8'?>
<form version="1.1" script="main.js, single_boot_duration.js" stylesheet="main.css, single_boot_duration.css">

   <label>Single Boot</label>
   <description>This dashboard displays information about a specific boot process.</description>

   <fieldset autoRun="true">
      <input type="time" searchWhenChanged="true">
         <label>Time range:</label>
         <change>
            <eval token="TimeRangePickerSpan">relative_time(now(), latest) - relative_time(now(), earliest)</eval>
            <eval token="PivotPeriodAutoSolo">case('TimeRangePickerSpan' &lt; 350000, "auto", 'TimeRangePickerSpan' &lt; 610000, "hour", 1=1, "auto")</eval>
            <eval token="PivotPeriodAutoTimechart">case('TimeRangePickerSpan' &lt; 1200, "second", 'TimeRangePickerSpan' &lt; 300000, "minute", 'TimeRangePickerSpan' &lt; 700000, "hour", 1=1, "day")</eval>
         </change>
      </input>
      <input type="dropdown" token="FilterField" id="Input_FilterField">
         <label>Filter field:</label>
      </input>
      <input type="dropdown" token="FilterOperator" id="Input_FilterOperator">
         <label>Filter operator:</label>
      </input>
      <input type="text" token="FilterExpression" id="Input_FilterExpression">
         <label>Filter expression:</label>
         <default>*</default>
      </input>
      <input type="dropdown" token="FilterField2" id="Input_FilterField2" depends="$FilterLevel2$">
      </input>
      <input type="dropdown" token="FilterOperator2" id="Input_FilterOperator2" depends="$FilterLevel2$">
      </input>
      <input type="text" token="FilterExpression2" id="Input_FilterExpression2" depends="$FilterLevel2$">
      </input>
      <input type="dropdown" token="FilterField3" id="Input_FilterField3" depends="$FilterLevel3$">
      </input>
      <input type="dropdown" token="FilterOperator3" id="Input_FilterOperator3" depends="$FilterLevel3$">
      </input>
      <input type="text" token="FilterExpression3" id="Input_FilterExpression3" depends="$FilterLevel3$">
      </input>
      <input type="dropdown" token="FilterField4" id="Input_FilterField4" depends="$FilterLevel4$">
      </input>
      <input type="dropdown" token="FilterOperator4" id="Input_FilterOperator4" depends="$FilterLevel4$">
      </input>
      <input type="text" token="FilterExpression4" id="Input_FilterExpression4" depends="$FilterLevel4$">
      </input>
      <input type="dropdown" token="FilterField5" id="Input_FilterField5" depends="$FilterLevel5$">
      </input>
      <input type="dropdown" token="FilterOperator5" id="Input_FilterOperator5" depends="$FilterLevel5$">
      </input>
      <input type="text" token="FilterExpression5" id="Input_FilterExpression5" depends="$FilterLevel5$">
      </input>
      <input type="dropdown" token="FilterField6" id="Input_FilterField6" depends="$FilterLevel6$">
      </input>
      <input type="dropdown" token="FilterOperator6" id="Input_FilterOperator6" depends="$FilterLevel6$">
      </input>
      <input type="text" token="FilterExpression6" id="Input_FilterExpression6" depends="$FilterLevel6$">
      </input>
      <input type="text" token="FilterLevels" id="Input_FilterLevels" depends="$FilterLevels_Hidden$">
      </input>
      <input type="text" token="FilterDatamodel" id="Input_FilterDatamodel" depends="$FilterDatamodel_Hidden$">
         <default>OnOffTransition_BootDetail</default>
      </input>
   </fieldset>

   <search id="Search_Single">
      <query>
         | pivot `uA_DM_OnOffTransition_BootDetail` OnOffTransition_BootDetail
            latest(host) as Host
            latest(_time) as BootStartTime
            avg(TotalBootTimeMs) as AvgTotalBootTimeMs
            avg(MainPathBootTimeMs) as AvgMainPathBootTimeMs
            avg(PostBootTimeMs) as AvgPostBootTimeMs
            $SearchFilter$
         | eval BootStartTime=strftime(strptime(BootStartTime, "%Y-%m-%dT%H:%M:%S.%Q%z"), "%Y-%m-%d %H:%M:%S")
         | eval AvgTotalBootTimeSRounded=round(AvgTotalBootTimeMs/1000,2)
         | eval AvgMainPathBootTimeSRounded=round(AvgMainPathBootTimeMs/1000,2)
         | eval AvgPostBootTimeSRounded=round(AvgPostBootTimeMs/1000,2)
         | appendcols
         [
         | pivot `uA_DM_OnOffTransition_BootProcesses` OnOffTransition_BootProcesses
            sum(ProcIOReadCount) as SumProcIOReadCount
            sum(ProcIOWriteCount) as SumProcIOWriteCount
            $SearchFilter$
         | eval SumProcIOReadWriteCount = SumProcIOReadCount + SumProcIOWriteCount
         ]
         | appendcols
         [
         | pivot `uA_DM_OnOffTransition_BootProcesses` OnOffTransition_BootProcesses
            count(OnOffTransition_BootProcesses) as ProcessCount
            $SearchFilter$
         ]
      </query>
   </search>
   
   <!-- Row 1 -->
   <row>
      <panel>
         <viz type="uberAgent.uberagent-singlevalue">
            <search base="Search_Single" />
            <option name="uberAgent.uberagent-singlevalue.1-field">BootStartTime</option>
            <option name="uberAgent.uberagent-singlevalue.1-title">Boot start time:</option>
            <option name="uberAgent.uberagent-singlevalue.1-afterLabel"></option>
            <option name="uberAgent.uberagent-singlevalue.2-field">Host</option>
            <option name="uberAgent.uberagent-singlevalue.2-title">Host:</option>
            <option name="uberAgent.uberagent-singlevalue.2-afterLabel"></option>
            <option name="uberAgent.uberagent-singlevalue.3-field">AvgTotalBootTimeSRounded</option>
            <option name="uberAgent.uberagent-singlevalue.3-title">Total boot duration:</option>
            <option name="uberAgent.uberagent-singlevalue.3-afterLabel">s</option>
            <option name="uberAgent.uberagent-singlevalue.4-field">AvgMainPathBootTimeSRounded</option>
            <option name="uberAgent.uberagent-singlevalue.4-title">Main path duration:</option>
            <option name="uberAgent.uberagent-singlevalue.4-afterLabel">s</option>
            <option name="uberAgent.uberagent-singlevalue.5-field">AvgPostBootTimeSRounded</option>
            <option name="uberAgent.uberagent-singlevalue.5-title">Post boot duration:</option>
            <option name="uberAgent.uberagent-singlevalue.5-afterLabel">s</option>
            <option name="uberAgent.uberagent-singlevalue.6-field">SumProcIOReadWriteCount</option>
            <option name="uberAgent.uberagent-singlevalue.6-title">Total IO count:</option>
            <option name="uberAgent.uberagent-singlevalue.6-afterLabel"></option>
            <option name="uberAgent.uberagent-singlevalue.7-field">ProcessCount</option>
            <option name="uberAgent.uberagent-singlevalue.7-title">Total process count:</option>
            <option name="uberAgent.uberagent-singlevalue.7-afterLabel"></option>
         </viz>
      </panel>
   </row>

   <!-- Row 2 -->
   <row>
      <panel>
         <title>IO count per process (top 15)</title>
         <chart>
            <search>
               <query>
                  | pivot `uA_DM_OnOffTransition_BootProcessDetail` OnOffTransition_BootProcessDetail
                     latest(ProcessIOReadCount) as "Process read count"
                     latest(ProcessIOWriteCount) as "Process write count"
                     latest(ProcessIOCount) as ProcessIOCount
                     splitrow
                        ProcessName as "Process name"
                     $SearchFilter$
                  | sort - ProcessIOCount
                  | head 15
                  | fields "Process name" "Process read count" "Process write count"
               </query>
            </search>
            <option name="height">300</option>
            <option name="charting.chart">bar</option>
            <option name="charting.chart.stackMode">stacked</option>
            <option name="charting.legend.placement">right</option>
            <option name="charting.axisY.includeZero">true</option>
            <option name="charting.axisTitleX.visibility">collapsed</option>
            <option name="charting.axisTitleY.visibility">collapsed</option>
            <option name="charting.drilldown">none</option>
         </chart>
      </panel>
   </row>

   <!-- Row 3 -->
   <row>
      <panel>
         <title>Boot process performance</title>
         <table id="Table_Panel31">
            <search>
               <query>
                  | pivot `uA_DM_OnOffTransition_BootProcesses` OnOffTransition_BootProcesses
                     latest(ProcName) as ProcName
                     latest(ProcID) as ProcID
                     latest(SessionID) as SessionID
                     latest(ProcParentID) as "Parent ID"
                     latest(ProcCmdline) as "Command line"
                     latest(ProcIOReadCount) as "IO read count"
                     latest(ProcIOWriteCount) as "IO write count"
                     latest(ProcIOReadMB) as "IO read volume (MB)"
                     latest(ProcIOWriteMB) as "IO write volume (MB)"
                     latest(TotalBootDurationMs) as TotalBootDurationMs
                     splitrow
                        ProcStartTimeRelativeMs
                     splitrow
                        ProcLifetimeMs
                     splitrow
                        SortOrder
                     $SearchFilter$
                  | eval "Name (ID)" = ProcName + " (" + ProcID + ")"
                  | eval "Session ID" = SessionID
                  | eval Lifetime = ProcStartTimeRelativeMs + ";" + ProcLifetimeMs + ";" + TotalBootDurationMs + ";" + ProcName + ";" + SessionID
                  | sort SortOrder
                  | table
                     Lifetime
                     "Name (ID)"
                     "Parent ID"
                     "Session ID"
                     "Command line"
                     "IO read count"
                     "IO write count"
                     "IO read volume (MB)"
                     "IO write volume (MB)"
               </query>
            </search>
            <option name="count">100</option>
            <option name="drilldown">none</option>
         </table>
      </panel>
   </row>

</form>
