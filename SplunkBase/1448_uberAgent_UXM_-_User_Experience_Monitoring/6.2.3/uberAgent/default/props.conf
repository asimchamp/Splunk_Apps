###########################################################################
# uberAgent:Logon:GroupPolicyCSEDetail2
###########################################################################
[uberAgent:Logon:GroupPolicyCSEDetail2]

KV_MODE = none
REPORT-class_uberagent_logon_grouppolicycsedetail2 = extract_uberagent_logon_grouppolicycsedetail2

EVAL-action = "success"
EVAL-app = "win"

FIELDALIAS-src = host AS src

EXTRACT-src_nt_domain = (?<src_nt_domain>[^\\]+) in User
EXTRACT-user = [^\\]*\\?(?<user>[^\\]+) in User

LOOKUP-systemusers = lookup_systemusers ProcUser AS User OUTPUTNEW ProcUserExpanded AS UserExpanded
LOOKUP-hostinfo = lookup_hostinfo host OUTPUTNEW OsVersion OsBuild OsType AdDomainDns AdSite AdOu CtxFarmName CtxMachineCatalogName CtxDeliveryGroupName HwManufacturer HwModel Ipv4Address OsPlatform RAMSizeGB IsBatteryPresent CPUName CPUSockets CPUCoresPhysical CPUCoresLogical CPUMaxMhz HwIsVirtualMachine OsUpdateBuildRevision
LOOKUP-hosttags = lookup_hosttags host OUTPUTNEW TagsHost
LOOKUP-usertags = lookup_usertags User OUTPUTNEW TagsUser

###########################################################################
# uberAgent:Logon:LogonDetail
###########################################################################
[uberAgent:Logon:LogonDetail]

KV_MODE = none
REPORT-class_uberagent_logon_logondetail = extract_uberagent_logon_logondetail

EVAL-action = "success"
EVAL-app = "win"

FIELDALIAS-src = host AS src

EXTRACT-src_nt_domain = (?<src_nt_domain>[^\\]+) in User
EXTRACT-user = [^\\]*\\?(?<user>[^\\]+) in User

LOOKUP-systemusers = lookup_systemusers ProcUser OUTPUTNEW ProcUserExpanded
LOOKUP-hostinfo = lookup_hostinfo host OUTPUTNEW OsVersion OsBuild OsType AdDomainDns AdSite AdOu CtxFarmName CtxMachineCatalogName CtxDeliveryGroupName HwManufacturer HwModel Ipv4Address OsPlatform RAMSizeGB IsBatteryPresent CPUName CPUSockets CPUCoresPhysical CPUCoresLogical CPUMaxMhz HwIsVirtualMachine OsUpdateBuildRevision
LOOKUP-hosttags = lookup_hosttags host OUTPUTNEW TagsHost
LOOKUP-usertags = lookup_usertags User OUTPUTNEW TagsUser

###########################################################################
# uberAgent:Logoff:LogoffDetail
###########################################################################
[uberAgent:Logoff:LogoffDetail]

KV_MODE = none
REPORT-class_uberagent_logoff_logoffdetail = extract_uberagent_logoff_logoffdetail

EVAL-action = "success"
EVAL-app = "win"

FIELDALIAS-src = host AS src

EXTRACT-src_nt_domain = (?<src_nt_domain>[^\\]+) in User
EXTRACT-user = [^\\]*\\?(?<user>[^\\]+) in User

LOOKUP-systemusers = lookup_systemusers ProcUser OUTPUTNEW ProcUserExpanded
LOOKUP-hostinfo = lookup_hostinfo host OUTPUTNEW OsVersion OsBuild OsType AdDomainDns AdSite AdOu CtxFarmName CtxMachineCatalogName CtxDeliveryGroupName HwManufacturer HwModel Ipv4Address OsPlatform RAMSizeGB IsBatteryPresent CPUName CPUSockets CPUCoresPhysical CPUCoresLogical CPUMaxMhz HwIsVirtualMachine OsUpdateBuildRevision
LOOKUP-hosttags = lookup_hosttags host OUTPUTNEW TagsHost
LOOKUP-usertags = lookup_usertags User OUTPUTNEW TagsUser

###########################################################################
# uberAgent:Process:LogonProcesses
###########################################################################
[uberAgent:Process:LogonProcesses]

KV_MODE = none
REPORT-class_uberagent_process_logonprocesses = extract_uberagent_process_logonprocesses

EVAL-action = "success"
EVAL-app = "win"

FIELDALIAS-src = host AS src

EXTRACT-src_nt_domain = (?<src_nt_domain>[^\\]+) in User
EXTRACT-user = [^\\]*\\?(?<user>[^\\]+) in User

LOOKUP-appnameidmapping = lookup_appnameidmapping AppId OUTPUTNEW AppName
LOOKUP-systemusers = lookup_systemusers ProcUser OUTPUTNEW ProcUserExpanded
LOOKUP-hostinfo = lookup_hostinfo host OUTPUTNEW OsVersion OsBuild OsType AdDomainDns AdSite AdOu CtxFarmName CtxMachineCatalogName CtxDeliveryGroupName HwManufacturer HwModel Ipv4Address OsPlatform RAMSizeGB IsBatteryPresent CPUName CPUSockets CPUCoresPhysical CPUCoresLogical CPUMaxMhz HwIsVirtualMachine OsUpdateBuildRevision
LOOKUP-hosttags = lookup_hosttags host OUTPUTNEW TagsHost

###########################################################################
# uberAgent:Process:LogoffProcesses
###########################################################################
[uberAgent:Process:LogoffProcesses]

KV_MODE = none
REPORT-class_uberagent_process_logoffprocesses = extract_uberagent_process_logoffprocesses

EVAL-action = "success"
EVAL-app = "win"

FIELDALIAS-src = host AS src

EXTRACT-src_nt_domain = (?<src_nt_domain>[^\\]+) in User
EXTRACT-user = [^\\]*\\?(?<user>[^\\]+) in User

LOOKUP-appnameidmapping = lookup_appnameidmapping AppId OUTPUTNEW AppName
LOOKUP-systemusers = lookup_systemusers ProcUser OUTPUTNEW ProcUserExpanded
LOOKUP-hostinfo = lookup_hostinfo host OUTPUTNEW OsVersion OsBuild OsType AdDomainDns AdSite AdOu CtxFarmName CtxMachineCatalogName CtxDeliveryGroupName HwManufacturer HwModel Ipv4Address OsPlatform RAMSizeGB IsBatteryPresent CPUName CPUSockets CPUCoresPhysical CPUCoresLogical CPUMaxMhz HwIsVirtualMachine OsUpdateBuildRevision
LOOKUP-hosttags = lookup_hosttags host OUTPUTNEW TagsHost

###########################################################################
# uberAgent:Application:BrowserPerformanceIE
###########################################################################
[uberAgent:Application:BrowserPerformanceIE]

KV_MODE = none
REPORT-class_uberagent_application_browserperformanceie = extract_uberagent_application_browserperformanceie

FIELDALIAS-dest = host AS dest
FIELDALIAS-process_id = ProcID as process_id

EVAL-resource_type = "browser"
EVAL-process = "iexplore.exe"

LOOKUP-hostinfo = lookup_hostinfo host OUTPUTNEW OsVersion OsBuild OsType AdDomainDns AdSite AdOu CtxFarmName CtxMachineCatalogName CtxDeliveryGroupName HwManufacturer HwModel Ipv4Address OsPlatform RAMSizeGB IsBatteryPresent CPUName CPUSockets CPUCoresPhysical CPUCoresLogical CPUMaxMhz HwIsVirtualMachine OsUpdateBuildRevision
LOOKUP-hosttags = lookup_hosttags host OUTPUTNEW TagsHost

###########################################################################
# uberAgent:Application:BrowserPerformanceChrome
###########################################################################
[uberAgent:Application:BrowserPerformanceChrome]

KV_MODE = none
REPORT-class_uberagent_application_browserperformancechrome = extract_uberagent_application_browserperformancechrome

FIELDALIAS-dest = host AS dest

EVAL-resource_type = "browser"
EVAL-process = "chrome.exe"

LOOKUP-systemusers = lookup_systemusers ProcUser OUTPUTNEW ProcUserExpanded
LOOKUP-hostinfo = lookup_hostinfo host OUTPUTNEW OsVersion OsBuild OsType AdDomainDns AdSite AdOu CtxFarmName CtxMachineCatalogName CtxDeliveryGroupName HwManufacturer HwModel Ipv4Address OsPlatform RAMSizeGB IsBatteryPresent CPUName CPUSockets CPUCoresPhysical CPUCoresLogical CPUMaxMhz HwIsVirtualMachine OsUpdateBuildRevision
LOOKUP-hosttags = lookup_hosttags host OUTPUTNEW TagsHost
LOOKUP-usertags = lookup_usertags User AS ProcUser OUTPUTNEW TagsUser

###########################################################################
# uberAgent:Application:BrowserWebRequests2
###########################################################################
[uberAgent:Application:BrowserWebRequests2]

KV_MODE = none
REPORT-class_uberagent_application_browserwebrequests2 = extract_uberagent_application_browserwebrequests2

FIELDALIAS-dest = TabHost AS dest
FIELDALIAS-url = dest AS URL
FIELDALIAS-src = host AS src
EVAL-RequestHost = if (RequestHost = "$0", TabHost, replace (RequestHost, "\$2", replace (TabHost, ".*?([^.]+\.[^.]+)$", "\1")))
EVAL-vendor_product = "uberAgent"

LOOKUP-browser_browsers = lookup_browser_browsers Browser OUTPUTNEW BrowserDisplayName
LOOKUP-browser_requesttypes = lookup_browser_requesttypes RequestType OUTPUTNEW RequestTypeDisplayName
LOOKUP-browser_urischemestab = lookup_browser_urischemes UriScheme as TabUriScheme OUTPUTNEW UriSchemeDisplayName as TabUriSchemeDisplayName
LOOKUP-browser_urischemesreq = lookup_browser_urischemes UriScheme as RequestUriScheme OUTPUTNEW UriSchemeDisplayName as RequestUriSchemeDisplayName
LOOKUP-hostinfo = lookup_hostinfo host OUTPUTNEW OsVersion OsBuild OsType AdDomainDns AdSite AdOu CtxFarmName CtxMachineCatalogName CtxDeliveryGroupName HwManufacturer HwModel Ipv4Address OsPlatform RAMSizeGB IsBatteryPresent CPUName CPUSockets CPUCoresPhysical CPUCoresLogical CPUMaxMhz HwIsVirtualMachine OsUpdateBuildRevision
LOOKUP-hosttags = lookup_hosttags host OUTPUTNEW TagsHost
LOOKUP-usertags = lookup_usertags User AS ProcUser OUTPUTNEW TagsUser

###########################################################################
# uberAgent:Application:Errors
###########################################################################
[uberAgent:Application:Errors]

KV_MODE = none
REPORT-class_uberagent_application_errors = extract_uberagent_application_errors

FIELDALIAS-dest = host AS dest

LOOKUP-application_errors_type = lookup_application_errors_type ErrorType
LOOKUP-appnameidmapping = lookup_appnameidmapping AppId OUTPUTNEW AppName
LOOKUP-hostinfo = lookup_hostinfo host OUTPUTNEW OsVersion OsBuild OsType AdDomainDns AdSite AdOu CtxFarmName CtxMachineCatalogName CtxDeliveryGroupName HwManufacturer HwModel Ipv4Address OsPlatform RAMSizeGB IsBatteryPresent CPUName CPUSockets CPUCoresPhysical CPUCoresLogical CPUMaxMhz HwIsVirtualMachine OsUpdateBuildRevision
LOOKUP-systemusers = lookup_systemusers ProcUser OUTPUTNEW ProcUserExpanded
LOOKUP-hosttags = lookup_hosttags host OUTPUTNEW TagsHost
LOOKUP-usertags = lookup_usertags User AS ProcUser OUTPUTNEW TagsUser

###########################################################################
# uberAgent:Application:OutlookPluginLoad
###########################################################################
[uberAgent:Application:OutlookPluginLoad]

KV_MODE = none
REPORT-class_uberagent_application_outlookpluginload = extract_uberagent_application_outlookpluginload

FIELDALIAS-dest = host AS dest

EVAL-resource_type = "plugin"
EVAL-process = "outlook.exe"

LOOKUP-outlook_plugin_load = lookup_outlook_plugin_load LoadBehavior
LOOKUP-hostinfo = lookup_hostinfo host OUTPUTNEW OsVersion OsBuild OsType AdDomainDns AdSite AdOu CtxFarmName CtxMachineCatalogName CtxDeliveryGroupName HwManufacturer HwModel Ipv4Address OsPlatform RAMSizeGB IsBatteryPresent CPUName CPUSockets CPUCoresPhysical CPUCoresLogical CPUMaxMhz HwIsVirtualMachine OsUpdateBuildRevision
LOOKUP-hosttags = lookup_hosttags host OUTPUTNEW TagsHost

###########################################################################
# uberAgent:System:SystemPerformanceSummary
###########################################################################
[uberAgent:System:SystemPerformanceSummary]

KV_MODE = auto_escaped

FIELDALIAS-dest = host AS dest
FIELDALIAS-cpu_load_percent = CPUUsagePercent AS cpu_load_percent
FIELDALIAS-read_ops = IOCountRead AS read_ops
FIELDALIAS-write_ops = IOCountWrite AS write_ops
FIELDALIAS-read_latency = IOLatencyMsRead AS read_latency
FIELDALIAS-write_latency = IOLatencyMsWrite AS write_latency

EVAL-resource_type = "system"
EVAL-mem_used = RAMUsageGB*1024

LOOKUP-hostinfo = lookup_hostinfo host OUTPUTNEW OsVersion OsBuild OsType AdDomainDns AdSite AdOu CtxFarmName CtxMachineCatalogName CtxDeliveryGroupName HwManufacturer HwModel Ipv4Address OsPlatform RAMSizeGB IsBatteryPresent CPUName CPUSockets CPUCoresPhysical CPUCoresLogical CPUMaxMhz HwIsVirtualMachine OsUpdateBuildRevision
LOOKUP-hosttags = lookup_hosttags host OUTPUTNEW TagsHost

###########################################################################
# uberAgent:System:SystemPerformanceSummary2
###########################################################################
[uberAgent:System:SystemPerformanceSummary2]

KV_MODE = none
REPORT-class_uberagent_system_systemperformancesummary2 = extract_uberagent_system_systemperformancesummary2

FIELDALIAS-dest = host AS dest
FIELDALIAS-cpu_load_percent = CPUUsagePercent AS cpu_load_percent
FIELDALIAS-read_ops = IOCountRead AS read_ops
FIELDALIAS-write_ops = IOCountWrite AS write_ops
FIELDALIAS-read_latency = IOLatencyMsRead AS read_latency
FIELDALIAS-write_latency = IOLatencyMsWrite AS write_latency

EVAL-resource_type = "system"
EVAL-mem_used = RAMUsageGB*1024

LOOKUP-hostinfo = lookup_hostinfo host OUTPUTNEW OsVersion OsBuild OsType AdDomainDns AdSite AdOu CtxFarmName CtxMachineCatalogName CtxDeliveryGroupName HwManufacturer HwModel Ipv4Address OsPlatform RAMSizeGB IsBatteryPresent CPUName CPUSockets CPUCoresPhysical CPUCoresLogical CPUMaxMhz HwIsVirtualMachine OsUpdateBuildRevision
LOOKUP-hosttags = lookup_hosttags host OUTPUTNEW TagsHost

###########################################################################
# uberAgent:System:GpuUsage
###########################################################################
[uberAgent:System:GpuUsage]

KV_MODE = none
REPORT-class_uberagent_system_gpuusage = extract_uberagent_system_gpuusage

FIELDALIAS-dest = host AS dest

EVAL-resource_type = "gpu"

LOOKUP-hostinfo = lookup_hostinfo host OUTPUTNEW OsVersion OsBuild OsType AdDomainDns AdSite AdOu CtxFarmName CtxMachineCatalogName CtxDeliveryGroupName HwManufacturer HwModel Ipv4Address OsPlatform RAMSizeGB IsBatteryPresent CPUName CPUSockets CPUCoresPhysical CPUCoresLogical CPUMaxMhz HwIsVirtualMachine OsUpdateBuildRevision
LOOKUP-hosttags = lookup_hosttags host OUTPUTNEW TagsHost

###########################################################################
# uberAgent:System:GpuUsageEngine
###########################################################################
[uberAgent:System:GpuUsageEngine]

KV_MODE = none
REPORT-class_uberagent_system_gpuusageengine = extract_uberagent_system_gpuusageengine

FIELDALIAS-dest = host AS dest

EVAL-resource_type = "gpu"

LOOKUP-hostinfo = lookup_hostinfo host OUTPUTNEW OsVersion OsBuild OsType AdDomainDns AdSite AdOu CtxFarmName CtxMachineCatalogName CtxDeliveryGroupName HwManufacturer HwModel Ipv4Address OsPlatform RAMSizeGB IsBatteryPresent CPUName CPUSockets CPUCoresPhysical CPUCoresLogical CPUMaxMhz HwIsVirtualMachine OsUpdateBuildRevision
LOOKUP-gpuengine_gpuenginetype = lookup_gpuengine_gpuenginetype GpuEngineType OUTPUTNEW GpuEngineTypeDisplayName
LOOKUP-hosttags = lookup_hosttags host OUTPUTNEW TagsHost

###########################################################################
# uberAgent:System:MachineInventory
###########################################################################
[uberAgent:System:MachineInventory]

KV_MODE = auto_escaped

FIELDALIAS-dest = host AS dest
FIELDALIAS-version = OsVersion AS version
FIELDALIAS-os = OsName AS os

EVAL-description = "uberAgent"
EVAL-vendor_product = HwManufacturer + " " + HwModel
EVAL-mem = RAMSizeGB*1024

LOOKUP-hostinfo = lookup_hostinfo host OUTPUT Ipv4Address OsPlatform
LOOKUP-hosttags = lookup_hosttags host OUTPUTNEW TagsHost

###########################################################################
# uberAgent:System:MonitorInventory
###########################################################################
[uberAgent:System:MonitorInventory]

KV_MODE = none
REPORT-class_uberagent_system_monitorinventory = extract_uberagent_system_monitorinventory

FIELDALIAS-dest = host AS dest

LOOKUP-hostinfo = lookup_hostinfo host OUTPUTNEW OsVersion OsBuild OsType AdDomainDns AdSite AdOu CtxFarmName CtxMachineCatalogName CtxDeliveryGroupName HwManufacturer HwModel Ipv4Address OsPlatform RAMSizeGB IsBatteryPresent CPUName CPUSockets CPUCoresPhysical CPUCoresLogical CPUMaxMhz HwIsVirtualMachine OsUpdateBuildRevision
LOOKUP-hosttags = lookup_hosttags host OUTPUTNEW TagsHost

###########################################################################
# uberAgent:Process:NetworkTargetPerformance
###########################################################################
[uberAgent:Process:NetworkTargetPerformance]

KV_MODE = none
REPORT-class_uberagent_process_networktargetperformance = extract_uberagent_process_networktargetperformance

FIELDALIAS-dest_ip = NetTargetRemoteAddress AS dest_ip
EVAL-dest = coalesce(NetTargetRemoteName, NetTargetRemoteAddress)
FIELDALIAS-dest_port = NetTargetRemotePort AS dest_port

FIELDALIAS-src  = host AS src
FIELDALIAS-src_ip = NetTargetSourceAddress AS src_ip
FIELDALIAS-src_port = NetTargetSourcePort AS src_port

EVAL-transport = lower(NetTargetProtocols)
EVAL-bytes_out = NetTargetSendKBPS/1024
EVAL-bytes_in = NetTargetReceiveKBPS/1024
EVAL-bytes = bytes_out+bytes_in

EVAL-direction = "outbound"
EVAL-duration = NetTargetSendLatencyMs*NetTargetSendLatencyCount

LOOKUP-appnameidmapping = lookup_appnameidmapping AppId OUTPUTNEW AppName
LOOKUP-systemusers = lookup_systemusers ProcUser OUTPUTNEW ProcUserExpanded
LOOKUP-hostinfo = lookup_hostinfo host OUTPUTNEW OsVersion OsBuild OsType AdDomainDns AdSite AdOu CtxFarmName CtxMachineCatalogName CtxDeliveryGroupName HwManufacturer HwModel Ipv4Address OsPlatform RAMSizeGB IsBatteryPresent CPUName CPUSockets CPUCoresPhysical CPUCoresLogical CPUMaxMhz HwIsVirtualMachine OsUpdateBuildRevision
LOOKUP-hosttags = lookup_hosttags host OUTPUTNEW TagsHost
LOOKUP-usertags = lookup_usertags User AS ProcUser OUTPUTNEW TagsUser

###########################################################################
# uberAgent:System:NetworkConfigInformation
###########################################################################
[uberAgent:System:NetworkConfigInformation]

KV_MODE = none
REPORT-class_uberagent_system_networkconfiginformation = extract_uberagent_system_networkconfiginformation

FIELDALIAS-dest = host AS dest
FIELDALIAS-ip = NetworkConfigIPv4 AS ip
FIELDALIAS-dns = NetworkConfigDnsSuffix AS dns

EVAL-NetworkConfigDescription = if (NetworkConfigDescription = "$0", NetworkConfigFriendlyName, NetworkConfigDescription)
EVAL-NetworkConfigMACAddress = substr(NetworkConfigMACAddress,1,2)  + "-" + substr(NetworkConfigMACAddress,3,2)  + "-" + substr(NetworkConfigMACAddress,5,2)  + "-" + substr(NetworkConfigMACAddress,7,2)  + "-" + substr(NetworkConfigMACAddress,9,2)  + "-" + substr(NetworkConfigMACAddress,11,2)
EVAL-mac = lower(replace(NetworkConfigMACAddress,"-",":"))

FIELDALIAS-interface = NetworkConfigDescription as interface

LOOKUP-networkconfiginfo_interfacetype = lookup_networkconfiginfo_interfacetype NetworkConfigInterfaceType OUTPUTNEW NetworkConfigInterfaceTypeDisplayName
LOOKUP-hostinfo = lookup_hostinfo host OUTPUTNEW OsVersion OsBuild OsType AdDomainDns AdSite AdOu CtxFarmName CtxMachineCatalogName CtxDeliveryGroupName HwManufacturer HwModel Ipv4Address OsPlatform RAMSizeGB IsBatteryPresent CPUName CPUSockets CPUCoresPhysical CPUCoresLogical CPUMaxMhz HwIsVirtualMachine OsUpdateBuildRevision
LOOKUP-hosttags = lookup_hosttags host OUTPUTNEW TagsHost
LOOKUP-wifi_authentication = lookup_wifi_authentication NetworkConfigWiFiAuthentication OUTPUTNEW NetworkConfigWiFiAuthenticationDisplayName
LOOKUP-wifi_type = lookup_wifi_type NetworkConfigWiFiType OUTPUTNEW NetworkConfigWiFiTypeDisplayName

###########################################################################
# uberAgent:Session:SessionDetail
###########################################################################
[uberAgent:Session:SessionDetail]

KV_MODE = none
REPORT-class_uberagent_session_sessiondetail = extract_uberagent_session_sessiondetail

FIELDALIAS-dest = host AS dest
FIELDALIAS-cpu_load_percent = SessionCPUUsagePercent AS cpu_load_percent
FIELDALIAS-mem_used = SessionWorkingSetMB AS mem_used

EVAL-resource_type = "session"
EVAL-cpu_time = SessionCPUTimeMs/1000
EVAL-thruput = SessionNetKBPS*1024

LOOKUP-appnameidmapping = lookup_appnameidmapping AppId AS SessionFgAppId OUTPUTNEW AppName AS SessionFgAppName
LOOKUP-systemusers = lookup_systemusers ProcUser AS SessionUser OUTPUTNEW ProcUserExpanded AS SessionUserExpanded
LOOKUP-hostinfo = lookup_hostinfo host OUTPUTNEW OsVersion OsBuild OsType AdDomainDns AdSite AdOu CtxFarmName CtxMachineCatalogName CtxDeliveryGroupName HwManufacturer HwModel Ipv4Address OsPlatform RAMSizeGB IsBatteryPresent CPUName CPUSockets CPUCoresPhysical CPUCoresLogical CPUMaxMhz HwIsVirtualMachine OsUpdateBuildRevision
LOOKUP-browser_browsers = lookup_browser_browsers Browser As SessionFgBrowserType OUTPUTNEW BrowserDisplayName as SessionFgBrowserDisplayName
LOOKUP-hosttags = lookup_hosttags host OUTPUTNEW TagsHost
LOOKUP-usertags = lookup_usertags User AS SessionUser OUTPUTNEW TagsUser

###########################################################################
# uberAgent:Application:ApplicationUsage
###########################################################################
[uberAgent:Application:ApplicationUsage]

KV_MODE = none
REPORT-class_uberagent_application_applicationusage = extract_uberagent_application_applicationusage

LOOKUP-systemusers = lookup_systemusers ProcUser AS UserName OUTPUTNEW ProcUserExpanded AS UserNameExpanded
LOOKUP-hostinfo = lookup_hostinfo host OUTPUTNEW OsVersion OsBuild OsType AdDomainDns AdSite AdOu CtxFarmName CtxMachineCatalogName CtxDeliveryGroupName HwManufacturer HwModel Ipv4Address OsPlatform RAMSizeGB IsBatteryPresent CPUName CPUSockets CPUCoresPhysical CPUCoresLogical CPUMaxMhz HwIsVirtualMachine OsUpdateBuildRevision
LOOKUP-hosttags = lookup_hosttags host OUTPUTNEW TagsHost
LOOKUP-usertags = lookup_usertags User AS UserName OUTPUTNEW TagsUser

###########################################################################
# uberAgent:Application:AppNameIdMapping
###########################################################################
[uberAgent:Application:AppNameIdMapping]

KV_MODE = none
REPORT-class_uberagent_application_appnameidmapping = extract_uberagent_application_appnameidmapping

###########################################################################
# uberAgent:Application:ApplicationInventory
###########################################################################
[uberAgent:Application:ApplicationInventory]

KV_MODE = none
REPORT-class_uberagent_application_applicationinventory = extract_uberagent_application_applicationinventory

FIELDALIAS-dest = host AS dest
FIELDALIAS-version = DisplayVersion AS version

EVAL-description = "uberAgent"
EVAL-vendor_product = Publisher + " " + DisplayName

LOOKUP-hostinfo = lookup_hostinfo host OUTPUTNEW OsVersion OsBuild OsType AdDomainDns AdSite AdOu CtxFarmName CtxMachineCatalogName CtxDeliveryGroupName HwManufacturer HwModel Ipv4Address OsPlatform RAMSizeGB IsBatteryPresent CPUName CPUSockets CPUCoresPhysical CPUCoresLogical CPUMaxMhz HwIsVirtualMachine OsUpdateBuildRevision
LOOKUP-hosttags = lookup_hosttags host OUTPUTNEW TagsHost

###########################################################################
# uberAgent:Process:ProcessDetail
###########################################################################
[uberAgent:Process:ProcessDetail]

KV_MODE = none
REPORT-class_uberagent_process_processdetail = extract_uberagent_process_processdetail

FIELDALIAS-dest = host AS dest
FIELDALIAS-process = ProcName AS process
FIELDALIAS-user = ProcUser AS user
FIELDALIAS-cpu_load_percent = ProcCPUPercent AS cpu_load_percent
FIELDALIAS-mem_used = ProcWorkingSetMB AS mem_used
FIELDALIAS-read_ops = ProcIOReadCount AS read_ops
FIELDALIAS-write_ops = ProcIOWriteCount AS write_ops
FIELDALIAS-read_latency = ProcIOLatencyReadMs2 AS read_latency
FIELDALIAS-write_latency = ProcIOLatencyWriteMs2 AS write_latency

EVAL-resource_type = "process"
EVAL-cpu_time = ProcCPUTimeMs/1000
EVAL-thruput = ProcNetKBPS*1024

LOOKUP-appnameidmapping = lookup_appnameidmapping AppId OUTPUTNEW AppName
LOOKUP-systemusers = lookup_systemusers ProcUser OUTPUTNEW ProcUserExpanded
LOOKUP-hostinfo = lookup_hostinfo host OUTPUTNEW OsVersion OsBuild OsType AdDomainDns AdSite AdOu CtxFarmName CtxMachineCatalogName CtxDeliveryGroupName HwManufacturer HwModel Ipv4Address OsPlatform RAMSizeGB IsBatteryPresent CPUName CPUSockets CPUCoresPhysical CPUCoresLogical CPUMaxMhz HwIsVirtualMachine OsUpdateBuildRevision
LOOKUP-gpuengine_gpuenginetype = lookup_gpuengine_gpuenginetype GpuEngineType AS ProcGpuEngineMostUsed OUTPUTNEW GpuEngineTypeDisplayName AS ProcGpuEngineMostUsedDisplayName
LOOKUP-hosttags = lookup_hosttags host OUTPUTNEW TagsHost
LOOKUP-usertags = lookup_usertags User AS ProcUser OUTPUTNEW TagsUser

###########################################################################
# uberAgent:Process:ProcessStartup
###########################################################################
[uberAgent:Process:ProcessStartup]

KV_MODE = none
REPORT-class_uberagent_process_processstartup = extract_uberagent_process_processstartup

FIELDALIAS-dest = host AS dest
FIELDALIAS-parent_process_name = ProcParentName AS parent_process_name
FIELDALIAS-parent_process_guid = ProcParentGUID AS parent_process_guid
FIELDALIAS-parent_process_id = ProcParentID AS parent_process_id
FIELDALIAS-process_name = ProcName AS process_name
FIELDALIAS-process_path = ProcPath AS process_path
FIELDALIAS-process = ProcCmdline AS process
EVAL-process_hash = coalesce(HashSHA256, HashSHA1, HashMD5, HashIMP, ProcHash, null())
FIELDALIAS-user = ProcUser AS user

EVAL-vendor_product = "uberAgent"
EVAL-resource_type = "process"

LOOKUP-appnameidmapping = lookup_appnameidmapping AppId OUTPUTNEW AppName
LOOKUP-systemusers = lookup_systemusers ProcUser OUTPUTNEW ProcUserExpanded
LOOKUP-hostinfo = lookup_hostinfo host OUTPUTNEW OsVersion OsBuild OsType AdDomainDns AdSite AdOu CtxFarmName CtxMachineCatalogName CtxDeliveryGroupName HwManufacturer HwModel Ipv4Address OsPlatform RAMSizeGB IsBatteryPresent CPUName CPUSockets CPUCoresPhysical CPUCoresLogical CPUMaxMhz HwIsVirtualMachine OsUpdateBuildRevision
LOOKUP-hosttags = lookup_hosttags host OUTPUTNEW TagsHost
LOOKUP-usertags = lookup_usertags User AS ProcUser OUTPUTNEW TagsUser
LOOKUP-hashtypes = lookup_hashtypes HashType OUTPUTNEW HashTypeDisplayName
LOOKUP-signaturestatustypes = lookup_signaturestatustypes SignatureStatus OUTPUTNEW SignatureStatusDisplayName

###########################################################################
# uberAgent:Application:SoftwareUpdateInventory
###########################################################################
[uberAgent:Application:SoftwareUpdateInventory]

KV_MODE = none
REPORT-class_uberagent_application_softwareupdateinventory = extract_uberagent_application_softwareupdateinventory

FIELDALIAS-dest = host AS dest
FIELDALIAS-signature = DisplayName AS signature

LOOKUP-hostinfo = lookup_hostinfo host OUTPUTNEW OsVersion OsBuild OsType AdDomainDns AdSite AdOu CtxFarmName CtxMachineCatalogName CtxDeliveryGroupName HwManufacturer HwModel Ipv4Address OsPlatform RAMSizeGB IsBatteryPresent CPUName CPUSockets CPUCoresPhysical CPUCoresLogical CPUMaxMhz HwIsVirtualMachine OsUpdateBuildRevision
LOOKUP-hosttags = lookup_hosttags host OUTPUTNEW TagsHost

###########################################################################
# uberAgent:System:DiskInventory
###########################################################################
[uberAgent:System:DiskInventory]

KV_MODE = none
REPORT-class_uberagent_system_diskinventory = extract_uberagent_system_diskinventory

FIELDALIAS-dest = host AS dest

LOOKUP-hostinfo = lookup_hostinfo host OUTPUTNEW OsVersion OsBuild OsType AdDomainDns AdSite AdOu CtxFarmName CtxMachineCatalogName CtxDeliveryGroupName HwManufacturer HwModel Ipv4Address OsPlatform RAMSizeGB IsBatteryPresent CPUName CPUSockets CPUCoresPhysical CPUCoresLogical CPUMaxMhz HwIsVirtualMachine OsUpdateBuildRevision
LOOKUP-hosttags = lookup_hosttags host OUTPUTNEW TagsHost

###########################################################################
# uberAgent:System:VolumeInventory
###########################################################################
[uberAgent:System:VolumeInventory]

KV_MODE = none
REPORT-class_uberagent_system_volumeinventory = extract_uberagent_system_volumeinventory

FIELDALIAS-dest = host AS dest
FIELDALIAS-mount = MountPoints as mount
FIELDALIAS-parent = DeviceName as parent
FIELDALIAS-storage_free = FreeMB as storage_free
FIELDALIAS-storage_used_percent = UsedSpacePercent as storage_used_percent

EVAL-storage_used = CapacityMB*UsedSpacePercent/100
EVAL-storage_free_percent = 100-UsedSpacePercent
EVAL-resource_type = "volume"

LOOKUP-hostinfo = lookup_hostinfo host OUTPUTNEW OsVersion OsBuild OsType AdDomainDns AdSite AdOu CtxFarmName CtxMachineCatalogName CtxDeliveryGroupName HwManufacturer HwModel Ipv4Address OsPlatform RAMSizeGB IsBatteryPresent CPUName CPUSockets CPUCoresPhysical CPUCoresLogical CPUMaxMhz HwIsVirtualMachine OsUpdateBuildRevision
LOOKUP-hosttags = lookup_hosttags host OUTPUTNEW TagsHost

###########################################################################
# uberAgent:OnOffTransition:BootDetail
###########################################################################
[uberAgent:OnOffTransition:BootDetail]

KV_MODE = auto_escaped

FIELDALIAS-dest = host AS dest

EVAL-resource_type = "onofftransition"

LOOKUP-hostinfo = lookup_hostinfo host OUTPUTNEW OsVersion OsBuild OsType AdDomainDns AdSite AdOu CtxFarmName CtxMachineCatalogName CtxDeliveryGroupName HwManufacturer HwModel Ipv4Address OsPlatform RAMSizeGB IsBatteryPresent CPUName CPUSockets CPUCoresPhysical CPUCoresLogical CPUMaxMhz HwIsVirtualMachine OsUpdateBuildRevision
LOOKUP-hosttags = lookup_hosttags host OUTPUTNEW TagsHost

###########################################################################
# uberAgent:OnOffTransition:BootDetail2
###########################################################################
[uberAgent:OnOffTransition:BootDetail2]

KV_MODE = none
REPORT-class_uberagent_onofftransition_bootdetail2 = extract_uberagent_onofftransition_bootdetail2

FIELDALIAS-dest = host AS dest

EVAL-resource_type = "onofftransition"

LOOKUP-hostinfo = lookup_hostinfo host OUTPUTNEW OsVersion OsBuild OsType AdDomainDns AdSite AdOu CtxFarmName CtxMachineCatalogName CtxDeliveryGroupName HwManufacturer HwModel Ipv4Address OsPlatform RAMSizeGB IsBatteryPresent CPUName CPUSockets CPUCoresPhysical CPUCoresLogical CPUMaxMhz HwIsVirtualMachine OsUpdateBuildRevision
LOOKUP-hosttags = lookup_hosttags host OUTPUTNEW TagsHost

###########################################################################
# uberAgent:OnOffTransition:BootProcesses
###########################################################################
[uberAgent:OnOffTransition:BootProcesses]

KV_MODE = none
REPORT-class_uberagent_onofftransition_bootprocesses = extract_uberagent_onofftransition_bootprocesses

EVAL-action = "success"
EVAL-app = "win"

FIELDALIAS-src = host AS src

LOOKUP-appnameidmapping = lookup_appnameidmapping AppId OUTPUTNEW AppName
LOOKUP-hostinfo = lookup_hostinfo host OUTPUTNEW OsVersion OsBuild OsType AdDomainDns AdSite AdOu CtxFarmName CtxMachineCatalogName CtxDeliveryGroupName HwManufacturer HwModel Ipv4Address OsPlatform RAMSizeGB IsBatteryPresent CPUName CPUSockets CPUCoresPhysical CPUCoresLogical CPUMaxMhz HwIsVirtualMachine OsUpdateBuildRevision
LOOKUP-hosttags = lookup_hosttags host OUTPUTNEW TagsHost

###########################################################################
# uberAgent:OnOffTransition:BootProcessDetail
###########################################################################
[uberAgent:OnOffTransition:BootProcessDetail]

KV_MODE = none
REPORT-class_uberagent_onofftransition_bootprocessdetail = extract_uberagent_onofftransition_bootprocessdetail

FIELDALIAS-dest = host AS dest

EVAL-resource_type = "onofftransition"

LOOKUP-hostinfo = lookup_hostinfo host OUTPUTNEW OsVersion OsBuild OsType AdDomainDns AdSite AdOu CtxFarmName CtxMachineCatalogName CtxDeliveryGroupName HwManufacturer HwModel Ipv4Address OsPlatform RAMSizeGB IsBatteryPresent CPUName CPUSockets CPUCoresPhysical CPUCoresLogical CPUMaxMhz HwIsVirtualMachine OsUpdateBuildRevision
LOOKUP-hosttags = lookup_hosttags host OUTPUTNEW TagsHost

###########################################################################
# uberAgent:OnOffTransition:ShutdownDetail
###########################################################################
[uberAgent:OnOffTransition:ShutdownDetail]

KV_MODE = auto_escaped

FIELDALIAS-dest = host AS dest

EVAL-resource_type = "onofftransition"

LOOKUP-hostinfo = lookup_hostinfo host OUTPUTNEW OsVersion OsBuild OsType AdDomainDns AdSite AdOu CtxFarmName CtxMachineCatalogName CtxDeliveryGroupName HwManufacturer HwModel Ipv4Address OsPlatform RAMSizeGB IsBatteryPresent CPUName CPUSockets CPUCoresPhysical CPUCoresLogical CPUMaxMhz HwIsVirtualMachine OsUpdateBuildRevision
LOOKUP-hosttags = lookup_hosttags host OUTPUTNEW TagsHost

###########################################################################
# uberAgent:OnOffTransition:StandbyDetail
###########################################################################
[uberAgent:OnOffTransition:StandbyDetail]

KV_MODE = auto_escaped

FIELDALIAS-dest = host AS dest

EVAL-resource_type = "onofftransition"

LOOKUP-hostinfo = lookup_hostinfo host OUTPUTNEW OsVersion OsBuild OsType AdDomainDns AdSite AdOu CtxFarmName CtxMachineCatalogName CtxDeliveryGroupName HwManufacturer HwModel Ipv4Address OsPlatform RAMSizeGB IsBatteryPresent CPUName CPUSockets CPUCoresPhysical CPUCoresLogical CPUMaxMhz HwIsVirtualMachine OsUpdateBuildRevision
LOOKUP-targetstate = lookup_standbyresume_targetstate TargetState OUTPUTNEW TargetStateDisplayName
LOOKUP-effectivestate = lookup_standbyresume_targetstate TargetState As EffectiveState OUTPUTNEW TargetStateDisplayName As EffectiveStateDisplayName
LOOKUP-wakesourcetype = lookup_standbyresume_wakesourcetype WakeSourceType OUTPUTNEW WakeSourceTypeDisplayName
LOOKUP-hosttags = lookup_hosttags host OUTPUTNEW TagsHost

###########################################################################
# uberAgent:OnOffTransition:StandbyDetail2
###########################################################################
[uberAgent:OnOffTransition:StandbyDetail2]

KV_MODE = none
REPORT-class_uberagent_onofftransition_standbydetail2 = extract_uberagent_onofftransition_standbydetail2

FIELDALIAS-dest = host AS dest

EVAL-resource_type = "onofftransition"

LOOKUP-hostinfo = lookup_hostinfo host OUTPUTNEW OsVersion OsBuild OsType AdDomainDns AdSite AdOu CtxFarmName CtxMachineCatalogName CtxDeliveryGroupName HwManufacturer HwModel Ipv4Address OsPlatform RAMSizeGB IsBatteryPresent CPUName CPUSockets CPUCoresPhysical CPUCoresLogical CPUMaxMhz HwIsVirtualMachine OsUpdateBuildRevision
LOOKUP-targetstate = lookup_standbyresume_targetstate TargetState OUTPUTNEW TargetStateDisplayName
LOOKUP-effectivestate = lookup_standbyresume_targetstate TargetState As EffectiveState OUTPUTNEW TargetStateDisplayName As EffectiveStateDisplayName
LOOKUP-wakesourcetype = lookup_standbyresume_wakesourcetype WakeSourceType OUTPUTNEW WakeSourceTypeDisplayName
LOOKUP-hosttags = lookup_hosttags host OUTPUTNEW TagsHost

###########################################################################
# uberAgent:OnOffTransition:SlowAppStartup
###########################################################################
[uberAgent:OnOffTransition:SlowAppStartup]

KV_MODE = auto_escaped

FIELDALIAS-dest = host AS dest

EVAL-resource_type = "onofftransition"

LOOKUP-hostinfo = lookup_hostinfo host OUTPUTNEW OsVersion OsBuild OsType AdDomainDns AdSite AdOu CtxFarmName CtxMachineCatalogName CtxDeliveryGroupName HwManufacturer HwModel Ipv4Address OsPlatform RAMSizeGB IsBatteryPresent CPUName CPUSockets CPUCoresPhysical CPUCoresLogical CPUMaxMhz HwIsVirtualMachine OsUpdateBuildRevision
LOOKUP-hosttags = lookup_hosttags host OUTPUTNEW TagsHost

###########################################################################
# uberAgent:OnOffTransition:SlowAppShutdown
###########################################################################
[uberAgent:OnOffTransition:SlowAppShutdown]

KV_MODE = auto_escaped

FIELDALIAS-dest = host AS dest

EVAL-resource_type = "onofftransition"

LOOKUP-hostinfo = lookup_hostinfo host OUTPUTNEW OsVersion OsBuild OsType AdDomainDns AdSite AdOu CtxFarmName CtxMachineCatalogName CtxDeliveryGroupName HwManufacturer HwModel Ipv4Address OsPlatform RAMSizeGB IsBatteryPresent CPUName CPUSockets CPUCoresPhysical CPUCoresLogical CPUMaxMhz HwIsVirtualMachine OsUpdateBuildRevision
LOOKUP-hosttags = lookup_hosttags host OUTPUTNEW TagsHost

###########################################################################
# uberAgent:OnOffTransition:SlowAppStandby
###########################################################################
[uberAgent:OnOffTransition:SlowAppStandby]

KV_MODE = auto_escaped

FIELDALIAS-dest = host AS dest

EVAL-resource_type = "onofftransition"

LOOKUP-hostinfo = lookup_hostinfo host OUTPUTNEW OsVersion OsBuild OsType AdDomainDns AdSite AdOu CtxFarmName CtxMachineCatalogName CtxDeliveryGroupName HwManufacturer HwModel Ipv4Address OsPlatform RAMSizeGB IsBatteryPresent CPUName CPUSockets CPUCoresPhysical CPUCoresLogical CPUMaxMhz HwIsVirtualMachine OsUpdateBuildRevision
LOOKUP-hosttags = lookup_hosttags host OUTPUTNEW TagsHost

###########################################################################
# uberAgent:OnOffTransition:SlowServiceStartup
###########################################################################
[uberAgent:OnOffTransition:SlowServiceStartup]

KV_MODE = auto_escaped

FIELDALIAS-dest = host AS dest

EVAL-resource_type = "onofftransition"

LOOKUP-hostinfo = lookup_hostinfo host OUTPUTNEW OsVersion OsBuild OsType AdDomainDns AdSite AdOu CtxFarmName CtxMachineCatalogName CtxDeliveryGroupName HwManufacturer HwModel Ipv4Address OsPlatform RAMSizeGB IsBatteryPresent CPUName CPUSockets CPUCoresPhysical CPUCoresLogical CPUMaxMhz HwIsVirtualMachine OsUpdateBuildRevision
LOOKUP-hosttags = lookup_hosttags host OUTPUTNEW TagsHost

###########################################################################
# uberAgent:OnOffTransition:SlowServiceShutdown
###########################################################################
[uberAgent:OnOffTransition:SlowServiceShutdown]

KV_MODE = auto_escaped

FIELDALIAS-dest = host AS dest

EVAL-resource_type = "onofftransition"

LOOKUP-hostinfo = lookup_hostinfo host OUTPUTNEW OsVersion OsBuild OsType AdDomainDns AdSite AdOu CtxFarmName CtxMachineCatalogName CtxDeliveryGroupName HwManufacturer HwModel Ipv4Address OsPlatform RAMSizeGB IsBatteryPresent CPUName CPUSockets CPUCoresPhysical CPUCoresLogical CPUMaxMhz HwIsVirtualMachine OsUpdateBuildRevision
LOOKUP-hosttags = lookup_hosttags host OUTPUTNEW TagsHost

###########################################################################
# uberAgent:OnOffTransition:SlowServiceHybridStandby
###########################################################################
[uberAgent:OnOffTransition:SlowServiceHybridStandby]

KV_MODE = auto_escaped

FIELDALIAS-dest = host AS dest

EVAL-resource_type = "onofftransition"

LOOKUP-hostinfo = lookup_hostinfo host OUTPUTNEW OsVersion OsBuild OsType AdDomainDns AdSite AdOu CtxFarmName CtxMachineCatalogName CtxDeliveryGroupName HwManufacturer HwModel Ipv4Address OsPlatform RAMSizeGB IsBatteryPresent CPUName CPUSockets CPUCoresPhysical CPUCoresLogical CPUMaxMhz HwIsVirtualMachine OsUpdateBuildRevision
LOOKUP-hosttags = lookup_hosttags host OUTPUTNEW TagsHost

###########################################################################
# uberAgent:OnOffTransition:SlowDriverStartup
###########################################################################
[uberAgent:OnOffTransition:SlowDriverStartup]

KV_MODE = auto_escaped

FIELDALIAS-dest = host AS dest

EVAL-resource_type = "onofftransition"

LOOKUP-hostinfo = lookup_hostinfo host OUTPUTNEW OsVersion OsBuild OsType AdDomainDns AdSite AdOu CtxFarmName CtxMachineCatalogName CtxDeliveryGroupName HwManufacturer HwModel Ipv4Address OsPlatform RAMSizeGB IsBatteryPresent CPUName CPUSockets CPUCoresPhysical CPUCoresLogical CPUMaxMhz HwIsVirtualMachine OsUpdateBuildRevision
LOOKUP-hosttags = lookup_hosttags host OUTPUTNEW TagsHost

###########################################################################
# uberAgent:OnOffTransition:SlowDriverShutdown
###########################################################################
[uberAgent:OnOffTransition:SlowDriverShutdown]

KV_MODE = auto_escaped

FIELDALIAS-dest = host AS dest

EVAL-resource_type = "onofftransition"

LOOKUP-hostinfo = lookup_hostinfo host OUTPUTNEW OsVersion OsBuild OsType AdDomainDns AdSite AdOu CtxFarmName CtxMachineCatalogName CtxDeliveryGroupName HwManufacturer HwModel Ipv4Address OsPlatform RAMSizeGB IsBatteryPresent CPUName CPUSockets CPUCoresPhysical CPUCoresLogical CPUMaxMhz HwIsVirtualMachine OsUpdateBuildRevision
LOOKUP-hosttags = lookup_hosttags host OUTPUTNEW TagsHost

###########################################################################
# uberAgent:OnOffTransition:SlowDriverStandby
###########################################################################
[uberAgent:OnOffTransition:SlowDriverStandby]

KV_MODE = auto_escaped

FIELDALIAS-dest = host AS dest

EVAL-resource_type = "onofftransition"

LOOKUP-hostinfo = lookup_hostinfo host OUTPUTNEW OsVersion OsBuild OsType AdDomainDns AdSite AdOu CtxFarmName CtxMachineCatalogName CtxDeliveryGroupName HwManufacturer HwModel Ipv4Address OsPlatform RAMSizeGB IsBatteryPresent CPUName CPUSockets CPUCoresPhysical CPUCoresLogical CPUMaxMhz HwIsVirtualMachine OsUpdateBuildRevision
LOOKUP-hosttags = lookup_hosttags host OUTPUTNEW TagsHost

###########################################################################
# uberAgent:OnOffTransition:SlowDriverResume
###########################################################################
[uberAgent:OnOffTransition:SlowDriverResume]

KV_MODE = auto_escaped

FIELDALIAS-dest = host AS dest

EVAL-resource_type = "onofftransition"

LOOKUP-hostinfo = lookup_hostinfo host OUTPUTNEW OsVersion OsBuild OsType AdDomainDns AdSite AdOu CtxFarmName CtxMachineCatalogName CtxDeliveryGroupName HwManufacturer HwModel Ipv4Address OsPlatform RAMSizeGB IsBatteryPresent CPUName CPUSockets CPUCoresPhysical CPUCoresLogical CPUMaxMhz HwIsVirtualMachine OsUpdateBuildRevision
LOOKUP-hosttags = lookup_hosttags host OUTPUTNEW TagsHost

###########################################################################
# uberAgent:OnOffTransition:SlowUserPolicy
###########################################################################
[uberAgent:OnOffTransition:SlowUserPolicy]

KV_MODE = auto_escaped

FIELDALIAS-dest = host AS dest

EVAL-resource_type = "onofftransition"

LOOKUP-hostinfo = lookup_hostinfo host OUTPUTNEW OsVersion OsBuild OsType AdDomainDns AdSite AdOu CtxFarmName CtxMachineCatalogName CtxDeliveryGroupName HwManufacturer HwModel Ipv4Address OsPlatform RAMSizeGB IsBatteryPresent CPUName CPUSockets CPUCoresPhysical CPUCoresLogical CPUMaxMhz HwIsVirtualMachine OsUpdateBuildRevision
LOOKUP-hosttags = lookup_hosttags host OUTPUTNEW TagsHost

###########################################################################
# uberAgent:OnOffTransition:SlowSMSSInit
###########################################################################
[uberAgent:OnOffTransition:SlowSMSSInit]

KV_MODE = auto_escaped

FIELDALIAS-dest = host AS dest

EVAL-resource_type = "onofftransition"

LOOKUP-hostinfo = lookup_hostinfo host OUTPUTNEW OsVersion OsBuild OsType AdDomainDns AdSite AdOu CtxFarmName CtxMachineCatalogName CtxDeliveryGroupName HwManufacturer HwModel Ipv4Address OsPlatform RAMSizeGB IsBatteryPresent CPUName CPUSockets CPUCoresPhysical CPUCoresLogical CPUMaxMhz HwIsVirtualMachine OsUpdateBuildRevision
LOOKUP-hosttags = lookup_hosttags host OUTPUTNEW TagsHost

###########################################################################
# uberAgent:Application:UIDelay
###########################################################################
[uberAgent:Application:UIDelay]

KV_MODE = none
REPORT-class_uberagent_application_uidelay = extract_uberagent_application_uidelay

FIELDALIAS-process = ProcessName AS process
FIELDALIAS-process_id = ProcessId as process_id

LOOKUP-appnameidmapping = lookup_appnameidmapping AppId OUTPUTNEW AppName
LOOKUP-systemusers = lookup_systemusers ProcUser AS User OUTPUTNEW ProcUserExpanded AS UserExpanded
LOOKUP-hostinfo = lookup_hostinfo host OUTPUTNEW OsVersion OsBuild OsType AdDomainDns AdSite AdOu CtxFarmName CtxMachineCatalogName CtxDeliveryGroupName HwManufacturer HwModel Ipv4Address OsPlatform RAMSizeGB IsBatteryPresent CPUName CPUSockets CPUCoresPhysical CPUCoresLogical CPUMaxMhz HwIsVirtualMachine OsUpdateBuildRevision
LOOKUP-hosttags = lookup_hosttags host OUTPUTNEW TagsHost
LOOKUP-usertags = lookup_usertags User OUTPUTNEW TagsUser

###########################################################################
# uberAgent:Application:NetworkConnectFailure
###########################################################################
[uberAgent:Application:NetworkConnectFailure]

KV_MODE = none
REPORT-class_uberagent_application_networkconnectfailure = extract_uberagent_application_networkconnectfailure

FIELDALIAS-process = ProcessName AS process
FIELDALIAS-process_id = ProcessId as process_id

FIELDALIAS-dest_ip = NetTargetRemoteAddress AS dest_ip
EVAL-dest = coalesce(NetTargetRemoteName, NetTargetRemoteAddress)
FIELDALIAS-dest_port = NetTargetRemotePort AS dest_port

FIELDALIAS-src  = host AS src
FIELDALIAS-src_ip = NetTargetSourceAddress AS src_ip
FIELDALIAS-src_port = NetTargetSourcePort AS src_port

EVAL-transport = lower(NetTargetProtocols)
EVAL-direction = "outbound"

LOOKUP-appnameidmapping = lookup_appnameidmapping AppId OUTPUTNEW AppName
LOOKUP-systemusers = lookup_systemusers ProcUser AS User OUTPUTNEW ProcUserExpanded AS UserExpanded
LOOKUP-hostinfo = lookup_hostinfo host OUTPUTNEW OsVersion OsBuild OsType AdDomainDns AdSite AdOu CtxFarmName CtxMachineCatalogName CtxDeliveryGroupName HwManufacturer HwModel Ipv4Address OsPlatform RAMSizeGB IsBatteryPresent CPUName CPUSockets CPUCoresPhysical CPUCoresLogical CPUMaxMhz HwIsVirtualMachine OsUpdateBuildRevision
LOOKUP-hosttags = lookup_hosttags host OUTPUTNEW TagsHost
LOOKUP-usertags = lookup_usertags User OUTPUTNEW TagsUser

###########################################################################
# uberAgent:System:SmbClient
###########################################################################
[uberAgent:System:SmbClient]

KV_MODE = none
REPORT-class_uberagent_system_smbclient = extract_uberagent_system_smbclient

LOOKUP-hostinfo = lookup_hostinfo host OUTPUTNEW OsVersion OsBuild OsType AdDomainDns AdSite AdOu CtxFarmName CtxMachineCatalogName CtxDeliveryGroupName HwManufacturer HwModel Ipv4Address OsPlatform RAMSizeGB IsBatteryPresent CPUName CPUSockets CPUCoresPhysical CPUCoresLogical CPUMaxMhz HwIsVirtualMachine OsUpdateBuildRevision
LOOKUP-hosttags = lookup_hosttags host OUTPUTNEW TagsHost

###########################################################################
# uberAgent:License:LicenseInfo
###########################################################################
[uberAgent:License:LicenseInfo]

KV_MODE = auto_escaped

LOOKUP-hostinfo = lookup_hostinfo host OUTPUTNEW OsVersion OsBuild OsType AdDomainDns AdSite AdOu CtxFarmName CtxMachineCatalogName CtxDeliveryGroupName HwManufacturer HwModel Ipv4Address OsPlatform RAMSizeGB IsBatteryPresent CPUName CPUSockets CPUCoresPhysical CPUCoresLogical CPUMaxMhz HwIsVirtualMachine OsUpdateBuildRevision
LOOKUP-hosttags = lookup_hosttags host OUTPUTNEW TagsHost

###########################################################################
# uberAgent:Citrix:DesktopGroups
###########################################################################
[uberAgent:Citrix:DesktopGroups]

KV_MODE = auto_escaped

LOOKUP-citrix_desktopkind = lookup_citrix_desktopkind DesktopKind OUTPUTNEW DesktopKindDisplayName
LOOKUP-citrix_lifecyclestate = lookup_citrix_lifecyclestate LifecycleState OUTPUTNEW LifecycleStateDisplayName
LOOKUP-citrix_sessionsupport = lookup_citrix_sessionsupport SessionSupport OUTPUTNEW SessionSupportDisplayName
LOOKUP-citrix_deliverytype = lookup_citrix_deliverytype DeliveryType OUTPUTNEW DeliveryTypeDisplayName
LOOKUP-hosttags = lookup_hosttags host OUTPUTNEW TagsHost

###########################################################################
# uberAgent:Citrix:Hypervisors
###########################################################################
[uberAgent:Citrix:Hypervisors]

KV_MODE = auto_escaped

LOOKUP-citrix_lifecyclestate = lookup_citrix_lifecyclestate LifecycleState OUTPUTNEW LifecycleStateDisplayName
LOOKUP-hosttags = lookup_hosttags host OUTPUTNEW TagsHost

###########################################################################
# uberAgent:Citrix:Catalogs
###########################################################################
[uberAgent:Citrix:Catalogs]

KV_MODE = auto_escaped

LOOKUP-citrix_lifecyclestate = lookup_citrix_lifecyclestate LifecycleState OUTPUTNEW LifecycleStateDisplayName
LOOKUP-citrix_provisioningtype = lookup_citrix_provisioningtype ProvisioningType OUTPUTNEW ProvisioningTypeDisplayName
LOOKUP-citrix_persistentuserchanges = lookup_citrix_persistentuserchanges PersistentUserChanges OUTPUTNEW PersistentUserChangesDisplayName
LOOKUP-citrix_allocationtype = lookup_citrix_allocationtype AllocationType OUTPUTNEW AllocationTypeDisplayName
LOOKUP-citrix_sessionsupport = lookup_citrix_sessionsupport SessionSupport OUTPUTNEW SessionSupportDisplayName
LOOKUP-hosttags = lookup_hosttags host OUTPUTNEW TagsHost

###########################################################################
# uberAgent:Citrix:Machines
###########################################################################
[uberAgent:Citrix:Machines]

KV_MODE = none
REPORT-class_uberagent_citrix_machines = extract_uberagent_citrix_machines

LOOKUP-citrix_lifecyclestate = lookup_citrix_lifecyclestate LifecycleState OUTPUTNEW LifecycleStateDisplayName
LOOKUP-citrix_powerstate = lookup_citrix_powerstate CurrentPowerState OUTPUTNEW CurrentPowerStateDisplayName
LOOKUP-citrix_registrationstate = lookup_citrix_registrationstate CurrentRegistrationState OUTPUTNEW CurrentRegistrationStateDisplayName
LOOKUP-citrix_machinefaultstatecode = lookup_citrix_machinefaultstatecode FaultState OUTPUTNEW FaultStateDisplayName
LOOKUP-citrix_functionallevelcode = lookup_citrix_functionallevelcode FunctionalLevel OUTPUTNEW FunctionalLevelDisplayName
LOOKUP-citrix_deregistrationreasoncode = lookup_citrix_deregistrationreasoncode LastDeregisteredCode OUTPUTNEW LastDeregisteredCodeDisplayName
LOOKUP-citrix_machinerole = lookup_citrix_machinerole MachineRole OUTPUTNEW MachineRoleDisplayName
LOOKUP-citrix_windowsconnectionsettingcode  = lookup_citrix_windowsconnectionsettingcode WindowsConnectionSetting OUTPUTNEW WindowsConnectionSettingDisplayName
LOOKUP-hostinfo = lookup_hostinfo host AS NameHost OUTPUTNEW OsVersion OsBuild OsType AdDomainDns AdSite AdOu CtxFarmName CtxMachineCatalogName CtxDeliveryGroupName HwManufacturer HwModel Ipv4Address RAMSizeGB IsBatteryPresent CPUName CPUSockets CPUCoresPhysical CPUCoresLogical CPUMaxMhz HwIsVirtualMachine OsUpdateBuildRevision
LOOKUP-hosttags = lookup_hosttags host OUTPUTNEW TagsHost

###########################################################################
# uberAgent:Citrix:Applications
###########################################################################
[uberAgent:Citrix:Applications]

KV_MODE = none
REPORT-class_uberagent_citrix_applications = extract_uberagent_citrix_applications

LOOKUP-citrix_applicationtype = lookup_citrix_applicationtype ApplicationType OUTPUTNEW ApplicationTypeDisplayName
LOOKUP-hosttags = lookup_hosttags host OUTPUTNEW TagsHost

###########################################################################
# uberAgent:Citrix:PublishedDesktops
###########################################################################
[uberAgent:Citrix:PublishedDesktops]

KV_MODE = none
REPORT-class_uberagent_citrix_publisheddesktops = extract_uberagent_citrix_publisheddesktops

LOOKUP-citrix_colordepth = lookup_citrix_colordepth ColorDepth OUTPUTNEW ColorDepthDisplayName ColorDepthBits
LOOKUP-citrix_leasingbehavior = lookup_citrix_leasingbehavior LeasingBehavior OUTPUTNEW LeasingBehaviorDisplayName
LOOKUP-citrix_sessionreconnection = lookup_citrix_sessionreconnection SessionReconnection OUTPUTNEW SessionReconnectionDisplayName
LOOKUP-hosttags = lookup_hosttags host OUTPUTNEW TagsHost

###########################################################################
# uberAgent:Citrix:Licenses
###########################################################################
[uberAgent:Citrix:Licenses]

KV_MODE = auto_escaped

LOOKUP-citrix_licenseedition2 = lookup_citrix_licenseedition LicenseEdition AS LicenseEdition2 OUTPUTNEW LicenseEditionDisplayName
LOOKUP-citrix_licenseedition = lookup_citrix_licenseedition LicenseEdition OUTPUTNEW LicenseEditionDisplayName
LOOKUP-citrix_licensemodel = lookup_citrix_licensemodel LicenseModel OUTPUTNEW LicenseModelDisplayName
LOOKUP-citrix_licenseproductname = lookup_citrix_licenseproductname LicenseProductName OUTPUTNEW LicenseProductNameDisplayName
LOOKUP-hosttags = lookup_hosttags host OUTPUTNEW TagsHost

###########################################################################
# uberAgent:Citrix:Databases
###########################################################################
[uberAgent:Citrix:Databases]

KV_MODE = auto_escaped

LOOKUP-hosttags = lookup_hosttags host OUTPUTNEW TagsHost

###########################################################################
# uberAgent:System:Bugcheck
###########################################################################
[uberAgent:System:Bugcheck]

KV_MODE = auto_escaped

LOOKUP-bugcheck = lookup_bugcheck BugcheckCode OUTPUTNEW BugcheckCodeDisplayName
LOOKUP-hostinfo = lookup_hostinfo host OUTPUTNEW OsVersion OsBuild OsType AdDomainDns AdSite AdOu CtxFarmName CtxMachineCatalogName CtxDeliveryGroupName HwManufacturer HwModel Ipv4Address OsPlatform RAMSizeGB IsBatteryPresent CPUName CPUSockets CPUCoresPhysical CPUCoresLogical CPUMaxMhz HwIsVirtualMachine OsUpdateBuildRevision
LOOKUP-hosttags = lookup_hosttags host OUTPUTNEW TagsHost

###########################################################################
# uberAgent:CitrixADC:ApplianceInventory
###########################################################################
[uberAgent:CitrixADC:ApplianceInventory]

KV_MODE = none

REPORT-class_uberagent_citrixadc_applianceinventory = extract_uberagent_citrixadc_applianceinventory

LOOKUP-hosttags = lookup_hosttags host OUTPUTNEW TagsHost

###########################################################################
# uberAgent:CitrixADC:AppliancePerformance
###########################################################################
[uberAgent:CitrixADC:AppliancePerformance]

KV_MODE = none

REPORT-class_uberagent_citrixadc_applianceperformance = extract_uberagent_citrixadc_applianceperformance

LOOKUP-hosttags = lookup_hosttags host OUTPUTNEW TagsHost
LOOKUP-citrixadc_powersupply1 = lookup_citrixadc_powersupplystatus PowerSupplyStatus as PowerSupply1Status OUTPUTNEW PowerSupplyStatusDisplayName as PowerSupply1StatusDisplayName
LOOKUP-citrixadc_powersupply2 = lookup_citrixadc_powersupplystatus PowerSupplyStatus as PowerSupply2Status OUTPUTNEW PowerSupplyStatusDisplayName as PowerSupply2StatusDisplayName
LOOKUP-citrixadc_powersupply3 = lookup_citrixadc_powersupplystatus PowerSupplyStatus as PowerSupply3Status OUTPUTNEW PowerSupplyStatusDisplayName as PowerSupply3StatusDisplayName
LOOKUP-citrixadc_powersupply4 = lookup_citrixadc_powersupplystatus PowerSupplyStatus as PowerSupply4Status OUTPUTNEW PowerSupplyStatusDisplayName as PowerSupply4StatusDisplayName

###########################################################################
# uberAgent:CitrixADC:Certificate
###########################################################################
[uberAgent:CitrixADC:Certificate]

KV_MODE = none

REPORT-class_uberagent_citrixadc_certificate = extract_uberagent_citrixadc_certificate

FIELDALIAS-dest = HostName AS dest
FIELDALIAS-ssl_name = CertName AS ssl_name
EVAL-dest_category = "CitrixADC"
EVAL-ssl_end_time = strptime(CertExpirationDate, "%Y-%m-%d %H:%M:%S")

LOOKUP-hosttags = lookup_hosttags host OUTPUTNEW TagsHost

###########################################################################
# uberAgent:CitrixADC:Gateway
###########################################################################
[uberAgent:CitrixADC:Gateway]

KV_MODE = none

REPORT-class_uberagent_citrixadc_gateway = extract_uberagent_citrixadc_gateway

LOOKUP-hosttags = lookup_hosttags host OUTPUTNEW TagsHost

###########################################################################
# uberAgent:CitrixADC:Ip
###########################################################################
[uberAgent:CitrixADC:Ip]

KV_MODE = none

REPORT-class_uberagent_citrixadc_ip = extract_uberagent_citrixadc_ip

LOOKUP-hosttags = lookup_hosttags host OUTPUTNEW TagsHost

###########################################################################
# uberAgent:CitrixADC:Service
###########################################################################
[uberAgent:CitrixADC:Service]

KV_MODE = none

REPORT-class_uberagent_citrixadc_service = extract_uberagent_citrixadc_service

LOOKUP-hosttags = lookup_hosttags host OUTPUTNEW TagsHost

###########################################################################
# uberAgent:CitrixADC:ServiceGroup
###########################################################################
[uberAgent:CitrixADC:ServiceGroup]

KV_MODE = none

REPORT-class_uberagent_citrixadc_servicegroup = extract_uberagent_citrixadc_servicegroup

LOOKUP-hosttags = lookup_hosttags host OUTPUTNEW TagsHost

###########################################################################
# uberAgent:CitrixADC:vServer
###########################################################################
[uberAgent:CitrixADC:vServer]

KV_MODE = none

REPORT-class_uberagent_citrixadc_vserver = extract_uberagent_citrixadc_vserver

LOOKUP-hosttags = lookup_hosttags host OUTPUTNEW TagsHost

###########################################################################
# uberAgent:Tags:UserHost
###########################################################################
[uberAgent:Tags:UserHost]

KV_MODE = none

REPORT-class_uberagent_tags_userhost = extract_uberagent_tags_userhost

LOOKUP-tagtypes = lookup_tags_type TagType OUTPUTNEW TagTypeDisplayName
LOOKUP-tagSources = lookup_tags_source TagSource OUTPUTNEW TagSourceDisplayName
LOOKUP-systemusers = lookup_systemusers ProcUser AS User OUTPUTNEW ProcUserExpanded AS UserExpanded
LOOKUP-hostinfo = lookup_hostinfo host OUTPUTNEW OsVersion OsBuild OsType AdDomainDns AdSite AdOu CtxFarmName CtxMachineCatalogName CtxDeliveryGroupName HwManufacturer HwModel Ipv4Address OsPlatform RAMSizeGB IsBatteryPresent CPUName CPUSockets CPUCoresPhysical CPUCoresLogical CPUMaxMhz HwIsVirtualMachine OsUpdateBuildRevision

###########################################################################
# source::uberagent_score_machine
###########################################################################
[source::uberagent_score_machine]
EVAL-host = orig_host
LOOKUP-hostinfo = lookup_hostinfo host OUTPUTNEW OsVersion OsBuild OsType AdDomainDns AdSite AdOu CtxFarmName CtxMachineCatalogName CtxDeliveryGroupName HwManufacturer HwModel Ipv4Address OsPlatform RAMSizeGB IsBatteryPresent CPUName CPUSockets CPUCoresPhysical CPUCoresLogical CPUMaxMhz HwIsVirtualMachine OsUpdateBuildRevision
LOOKUP-hosttags = lookup_hosttags host OUTPUTNEW TagsHost

###########################################################################
# source::uberagent_score_session
###########################################################################
[source::uberagent_score_session]
EVAL-host = orig_host
LOOKUP-hostinfo = lookup_hostinfo host OUTPUTNEW OsVersion OsBuild OsType AdDomainDns AdSite AdOu CtxFarmName CtxMachineCatalogName CtxDeliveryGroupName HwManufacturer HwModel Ipv4Address OsPlatform RAMSizeGB IsBatteryPresent CPUName CPUSockets CPUCoresPhysical CPUCoresLogical CPUMaxMhz HwIsVirtualMachine OsUpdateBuildRevision
LOOKUP-hosttags = lookup_hosttags host OUTPUTNEW TagsHost

###########################################################################
# source::uberagent_score_application
###########################################################################
[source::uberagent_score_application]
EVAL-host = orig_host
LOOKUP-appnameidmapping = lookup_appnameidmapping AppId OUTPUTNEW AppName
LOOKUP-hostinfo = lookup_hostinfo host OUTPUTNEW OsVersion OsBuild OsType AdDomainDns AdSite AdOu CtxFarmName CtxMachineCatalogName CtxDeliveryGroupName HwManufacturer HwModel Ipv4Address OsPlatform RAMSizeGB IsBatteryPresent CPUName CPUSockets CPUCoresPhysical CPUCoresLogical CPUMaxMhz HwIsVirtualMachine OsUpdateBuildRevision
LOOKUP-hosttags = lookup_hosttags host OUTPUTNEW TagsHost
