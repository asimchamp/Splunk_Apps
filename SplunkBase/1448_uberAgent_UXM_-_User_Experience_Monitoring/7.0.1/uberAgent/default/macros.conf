##############################################################
#
# Dynamically calculate the timechart span, adapting to the time range of the search
# Use in place of the span argument, e.g.: timechart count `uberAgent_dynamic_span`
# Reference: https://answers.splunk.com/answers/79779/passing-span-as-argument-to-timechart.html
#
# Span lengths depending on search range:
# -   Up to 20m: 15s
# -   Up to 4h: 1m
# -   Up to 1d: 5m
# -   Up to 3d: 15m
# -   Up to 1w: 1h
# -   Everything else: 1d
#
##############################################################

[uberAgent_dynamic_span]
definition = [stats count | addinfo | eval range = info_max_time-info_min_time | eval span = "span=" . case(range < 1200, "15s", range < 15000, "1m", range < 90000, "5m", range < 300000, "15m", range < 700000, "1h", 1=1, "1d") | return $span]

##############################################################
#
# Make the index used by all searches easily configurable
# When changing the index name make sure to update eventtypes.conf, too
#
##############################################################

[uberAgent_index]
definition = uberagent*

[uberAgentUXM_score_index]
definition = score_uberagent_uxm

##############################################################
#
# Exclude applications that are part of the OS from pivot searches
#
##############################################################

[uberAgent_filter_AppNameIsNotOS]
definition = filter AppName isNot "Microsoft Windows OS" filter AppName isNot "macOS"

##############################################################
#
# Make it possible to move data model objects between data models
# The following macros associate objects with data models
# The macros should be used in searches instead of hard-coding data model names
#
##############################################################

[uA_DM_Application_ApplicationInventory]
definition = uberAgentUXM_Application
[uA_DM_Application_AppNameIdMapping]
definition = uberAgentUXM_Application
[uA_DM_Application_BrowserPerformanceChrome]
definition = uberAgentUXM_Application
[uA_DM_Application_BrowserPerformanceIE]
definition = uberAgentUXM_Application
[uA_DM_Application_BrowserWebRequests2]
definition = uberAgentUXM_Application
[uA_DM_Application_Errors]
definition = uberAgentUXM_Application
[uA_DM_Application_NetworkConnectFailure]
definition = uberAgentUXM_Application
[uA_DM_Application_OutlookPluginLoad]
definition = uberAgentUXM_Application
[uA_DM_Application_SoftwareUpdateInventory]
definition = uberAgentUXM_Application
[uA_DM_Application_UIDelay]
definition = uberAgentUXM_Application

[uA_DM_Citrix_Applications]
definition = uberAgentUXM_Citrix
[uA_DM_Citrix_Catalogs]
definition = uberAgentUXM_Citrix
[uA_DM_Citrix_Databases]
definition = uberAgentUXM_Citrix
[uA_DM_Citrix_DesktopGroups]
definition = uberAgentUXM_Citrix
[uA_DM_Citrix_Licenses]
definition = uberAgentUXM_Citrix
[uA_DM_Citrix_Machines]
definition = uberAgentUXM_Citrix
[uA_DM_Citrix_PublishedDesktops]
definition = uberAgentUXM_Citrix

[uA_DM_CitrixADC_ApplianceInventory]
definition = uberAgentUXM_CitrixADC
[uA_DM_CitrixADC_AppliancePerformance]
definition = uberAgentUXM_CitrixADC
[uA_DM_CitrixADC_Certificate]
definition = uberAgentUXM_CitrixADC
[uA_DM_CitrixADC_Gateway]
definition = uberAgentUXM_CitrixADC
[uA_DM_CitrixADC_Ip]
definition = uberAgentUXM_CitrixADC
[uA_DM_CitrixADC_Service]
definition = uberAgentUXM_CitrixADC
[uA_DM_CitrixADC_ServiceGroup]
definition = uberAgentUXM_CitrixADC
[uA_DM_CitrixADC_vServer]
definition = uberAgentUXM_CitrixADC

[uA_DM_License_LicenseInfo]
definition = uberAgentUXM_License

[uA_DM_Logoff_LogoffDetail]
definition = uberAgentUXM_Logoff

[uA_DM_Logon_GroupPolicyCSEDetail]
definition = uberAgentUXM_Logon
[uA_DM_Logon_LogonDetail]
definition = uberAgentUXM_Logon

[uA_DM_OnOffTransition_BootDetail]
definition = uberAgentUXM_OnOffTransition
[uA_DM_OnOffTransition_BootProcessDetail]
definition = uberAgentUXM_OnOffTransition
[uA_DM_OnOffTransition_BootProcesses]
definition = uberAgentUXM_OnOffTransition
[uA_DM_OnOffTransition_ShutdownDetail]
definition = uberAgentUXM_OnOffTransition
[uA_DM_OnOffTransition_SlowShutdown]
definition = uberAgentUXM_OnOffTransition
[uA_DM_OnOffTransition_SlowStandbyResume]
definition = uberAgentUXM_OnOffTransition
[uA_DM_OnOffTransition_SlowStartup]
definition = uberAgentUXM_OnOffTransition
[uA_DM_OnOffTransition_StandbyDetail]
definition = uberAgentUXM_OnOffTransition

[uA_DM_Process_LogoffProcesses]
definition = uberAgentUXM_Process
[uA_DM_Process_LogonProcesses]
definition = uberAgentUXM_Process
[uA_DM_Process_NetworkTargetPerformance]
definition = uberAgentUXM_Process
[uA_DM_Process_ProcessDetail]
definition = uberAgentUXM_Process
[uA_DM_Process_ProcessStartup]
definition = uberAgentUXM_Process

[uA_DM_Score_Application]
definition = uberAgentUXM_Score
[uA_DM_Score_Machine]
definition = uberAgentUXM_Score
[uA_DM_Score_Session]
definition = uberAgentUXM_Score

[uA_DM_Session_SessionDetail]
definition = uberAgentUXM_Session
[uA_DM_Session_SessionDetail_Session0]
definition = uberAgentUXM_Session
[uA_DM_Session_SessionDetail_Users]
definition = uberAgentUXM_Session

[uA_DM_CitrixSession_VirtualChannelDetail]
definition = uberAgentUXM_CitrixSession
[uA_DM_CitrixSession_SessionConfig]
definition = uberAgentUXM_CitrixSession

[uA_DM_System_Bugcheck]
definition = uberAgentUXM_System
[uA_DM_System_DiskInventory]
definition = uberAgentUXM_System
[uA_DM_System_GpuUsage]
definition = uberAgentUXM_System
[uA_DM_System_GpuUsageEngine]
definition = uberAgentUXM_System
[uA_DM_System_MachineInventory]
definition = uberAgentUXM_System
[uA_DM_System_MonitorInventory]
definition = uberAgentUXM_System
[uA_DM_System_NetworkConfigInformation]
definition = uberAgentUXM_System
[uA_DM_System_PerformanceCounter]
definition = uberAgentUXM_System
[uA_DM_System_SmbClient]
definition = uberAgentUXM_System
[uA_DM_System_SystemPerformanceSummary]
definition = uberAgentUXM_System
[uA_DM_System_VolumeInventory]
definition = uberAgentUXM_System

[uA_DM_Tags_UserHost]
definition = uberAgentUXM_Tags