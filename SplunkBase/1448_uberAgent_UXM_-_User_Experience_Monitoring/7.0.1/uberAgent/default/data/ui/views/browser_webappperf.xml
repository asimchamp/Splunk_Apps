<?xml version='1.0' encoding='utf-8'?>
<form version="1.1" script="main.js" stylesheet="main.css">

   <label>Browser Web App Performance</label>
   <description>This dashboard displays detailed information for page loads and background data transfers (XMLHttpRequests and web socket handshake requests). Data is collected via browser extensions, which must be installed in addition to the endpoint agent. "Tab URL" stands for the URL entered in the browser's address bar; "Request URL" stands for an address the browser exchanged data with.</description>

   <fieldset autoRun="true">
      <input type="time" searchWhenChanged="true">
         <label>Time range:</label>
         <default>
            <earliest>-1h</earliest>
            <latest>now</latest>
         </default>
         <change>
            <eval token="TimeRangePickerSpan">relative_time(now(), latest) - relative_time(now(), earliest)</eval>
            <eval token="PivotPeriodAutoSolo">case('TimeRangePickerSpan' &lt; 350000, "auto", 'TimeRangePickerSpan' &lt; 610000, "hour", 1=1, "auto")</eval>
            <eval token="PivotPeriodAutoTimechart">case('TimeRangePickerSpan' &lt; 1200, "second", 'TimeRangePickerSpan' &lt; 300000, "minute", 'TimeRangePickerSpan' &lt; 700000, "hour", 1=1, "day")</eval>
         </change>
      </input>
      <input type="dropdown" token="FilterField" id="Input_FilterField">
         <label>Filter field:</label>
      </input>
      <input type="dropdown" token="FilterOperator" id="Input_FilterOperator">
         <label>Filter operator:</label>
      </input>
      <input type="text" token="FilterExpression" id="Input_FilterExpression">
         <label>Filter expression:</label>
         <default>*</default>
      </input>
      <input type="dropdown" token="FilterField2" id="Input_FilterField2" depends="$FilterLevel2$">
      </input>
      <input type="dropdown" token="FilterOperator2" id="Input_FilterOperator2" depends="$FilterLevel2$">
      </input>
      <input type="text" token="FilterExpression2" id="Input_FilterExpression2" depends="$FilterLevel2$">
      </input>
      <input type="dropdown" token="FilterField3" id="Input_FilterField3" depends="$FilterLevel3$">
      </input>
      <input type="dropdown" token="FilterOperator3" id="Input_FilterOperator3" depends="$FilterLevel3$">
      </input>
      <input type="text" token="FilterExpression3" id="Input_FilterExpression3" depends="$FilterLevel3$">
      </input>
      <input type="dropdown" token="FilterField4" id="Input_FilterField4" depends="$FilterLevel4$">
      </input>
      <input type="dropdown" token="FilterOperator4" id="Input_FilterOperator4" depends="$FilterLevel4$">
      </input>
      <input type="text" token="FilterExpression4" id="Input_FilterExpression4" depends="$FilterLevel4$">
      </input>
      <input type="dropdown" token="FilterField5" id="Input_FilterField5" depends="$FilterLevel5$">
      </input>
      <input type="dropdown" token="FilterOperator5" id="Input_FilterOperator5" depends="$FilterLevel5$">
      </input>
      <input type="text" token="FilterExpression5" id="Input_FilterExpression5" depends="$FilterLevel5$">
      </input>
      <input type="dropdown" token="FilterField6" id="Input_FilterField6" depends="$FilterLevel6$">
      </input>
      <input type="dropdown" token="FilterOperator6" id="Input_FilterOperator6" depends="$FilterLevel6$">
      </input>
      <input type="text" token="FilterExpression6" id="Input_FilterExpression6" depends="$FilterLevel6$">
      </input>
      <input type="text" token="FilterLevels" id="Input_FilterLevels" depends="$FilterLevels_Hidden$">
      </input>
      <input type="text" token="FilterDatamodel" id="Input_FilterDatamodel" depends="$FilterDatamodel_Hidden$">
         <default>Application_BrowserWebRequests2</default>
      </input>
   </fieldset>

   <search id="Search_Single">
      <query>
         | pivot `uA_DM_Application_BrowserWebRequests2` Application_BrowserWebRequests2
            dc(host) as HostCount
            dc(User) as UserCount
            dc(TabHost) as TabHostCount
            dc(RequestHost) as RequestHostCount
            $SearchFilter$
         | appendcols
         [
         | pivot `uA_DM_Application_BrowserWebRequests2` Application_BrowserWebRequests2
            sum(RequestCount) as SumRequestCount
            sum(PageLoadTotalDurationMs) as SumPageLoadTotalDurationMs
            sum(PageLoadNetworkDurationMs) as SumPageLoadNetworkDurationMs
            sum(PageLoadRenderDurationMs) as SumPageLoadRenderDurationMs
            filter RequestTypeDisplayName is "PageLoad"
            filter IsFrame is "0"
            $SearchFilter$
         | eval AvgTotalDurationS = round (SumPageLoadTotalDurationMs / SumRequestCount / 1000, 1)
         | eval AvgNetworkDurationS = round (SumPageLoadNetworkDurationMs / SumRequestCount / 1000, 1)
         | eval AvgRenderDurationS = round (SumPageLoadRenderDurationMs / SumRequestCount / 1000, 1)
         ]
         | appendcols
         [
         | pivot `uA_DM_Application_BrowserWebRequests2` Application_BrowserWebRequests2
            sum(RequestCount) as SumRequestCount
            sum(WebRequestDurationMs) as SumWebRequestDurationMs
            filter RequestTypeDisplayName in ("XmlHttpRequest", "WebSocket")
            $SearchFilter$
         | eval AvgTotalDurationS = round (SumWebRequestDurationMs / SumRequestCount / 1000, 1)
         ]
      </query>
   </search>
   
   <!-- Row 1 -->
   <row>
      <panel>
         <title>Overview</title>
         <viz type="uberAgent.uberagent-singlevalue">
            <search base="Search_Single" />
            <option name="uberAgent.uberagent-singlevalue.1-field">HostCount</option>
            <option name="uberAgent.uberagent-singlevalue.1-title">#Hosts:</option>
            <option name="uberAgent.uberagent-singlevalue.1-afterLabel"></option>
            <option name="uberAgent.uberagent-singlevalue.2-field">UserCount</option>
            <option name="uberAgent.uberagent-singlevalue.2-title">#Users:</option>
            <option name="uberAgent.uberagent-singlevalue.2-afterLabel"></option>
            <option name="uberAgent.uberagent-singlevalue.3-field">TabHostCount</option>
            <option name="uberAgent.uberagent-singlevalue.3-title">#Tab URLs:</option>
            <option name="uberAgent.uberagent-singlevalue.3-afterLabel"></option>
            <option name="uberAgent.uberagent-singlevalue.4-field">RequestHostCount</option>
            <option name="uberAgent.uberagent-singlevalue.4-title">#Request URLs:</option>
            <option name="uberAgent.uberagent-singlevalue.4-afterLabel"></option>
            <option name="uberAgent.uberagent-singlevalue.5-field">SumRequestCount</option>
            <option name="uberAgent.uberagent-singlevalue.5-title">#Page loads (no frames):</option>
            <option name="uberAgent.uberagent-singlevalue.5-afterLabel"></option>
            <option name="uberAgent.uberagent-singlevalue.6-field">AvgTotalDurationS</option>
            <option name="uberAgent.uberagent-singlevalue.6-title">Avg. page load - total (no frames):</option>
            <option name="uberAgent.uberagent-singlevalue.6-afterLabel">s</option>
            <option name="uberAgent.uberagent-singlevalue.7-field">AvgNetworkDurationS</option>
            <option name="uberAgent.uberagent-singlevalue.7-title">Avg. page load - network (no frames):</option>
            <option name="uberAgent.uberagent-singlevalue.7-afterLabel">s</option>
            <option name="uberAgent.uberagent-singlevalue.8-field">AvgRenderDurationS</option>
            <option name="uberAgent.uberagent-singlevalue.8-title">Avg. page load - render (no frames):</option>
            <option name="uberAgent.uberagent-singlevalue.8-afterLabel">s</option>
            <option name="uberAgent.uberagent-singlevalue.9-field">SumRequestCount</option>
            <option name="uberAgent.uberagent-singlevalue.9-title">#Background requests:</option>
            <option name="uberAgent.uberagent-singlevalue.9-afterLabel"></option>
            <option name="uberAgent.uberagent-singlevalue.10-field">AvgTotalDurationS</option>
            <option name="uberAgent.uberagent-singlevalue.10-title">Avg. background request:</option>
            <option name="uberAgent.uberagent-singlevalue.10-afterLabel">s</option>
         </viz>
      </panel>
   </row>

   <!-- Row 2 -->
   <row>
      <panel>
         <title>Requests over time</title>
         <input type="dropdown" token="Panel21FieldSelect" searchWhenChanged="true">
            <choice value="PageLoad_Total">Page load (total)</choice>
            <choice value="PageLoad_Network">Page load (network)</choice>
            <choice value="PageLoad_Render">Page load (render)</choice>
            <choice value="XMLHttpRequest">XMLHttpRequest</choice>
            <choice value="WebSocket">Web socket handshake request</choice>
            <default>PageLoad_Total</default>
            <label>Show metric:</label>
            <change>
               <condition value="PageLoad_Total">
                  <set token="Panel21RequestTypeFilter">filter RequestTypeDisplayName is "PageLoad"</set>
                  <set token="Panel21Duration">PageLoadTotalDurationMs</set>
                  <set token="Panel21Display">page load - total</set>
               </condition>
               <condition value="PageLoad_Network">
                  <set token="Panel21RequestTypeFilter">filter RequestTypeDisplayName is "PageLoad"</set>
                  <set token="Panel21Duration">PageLoadNetworkDurationMs</set>
                  <set token="Panel21DisplayNoFrames">page load - network</set>
               </condition>
               <condition value="PageLoad_Render">
                  <set token="Panel21RequestTypeFilter">filter RequestTypeDisplayName is "PageLoad"</set>
                  <set token="Panel21Duration">PageLoadRenderDurationMs</set>
                  <set token="Panel21DisplayNoFrames">page load - render</set>
               </condition>
               <condition value="XMLHttpRequest">
                  <set token="Panel21RequestTypeFilter">filter RequestTypeDisplayName is "XmlHttpRequest"</set>
                  <set token="Panel21Duration">WebRequestDurationMs</set>
                  <set token="Panel21DisplayNoFrames">XMLHttpRequest</set>
               </condition>
               <condition value="WebSocket">
                  <set token="Panel21RequestTypeFilter">filter RequestTypeDisplayName is "WebSocket"</set>
                  <set token="Panel21Duration">WebRequestDurationMs</set>
                  <set token="Panel21DisplayNoFrames">web socket handshake request</set>
               </condition>
            </change>
         </input>
         <input type="dropdown" token="Panel21GroupBy" searchWhenChanged="true">
            <choice value="BrowserDisplayName">Browser name</choice>
            <choice value="BrowserVersion">Browser version</choice>
            <choice value="host">Host</choice>
            <choice value="RequestHost">Request URL</choice>
            <choice value="TabHost">Tab URL</choice>
            <choice value="User">User</choice>
            <default>TabHost</default>
            <label>Group by:</label>
         </input>
         <input type="radio" token="Panel21IncludeFrames" searchWhenChanged="true">
            <label>Include frames?</label>
            <choice value="1">Yes</choice>
            <choice value="0">No</choice>
            <default>0</default>
            <change>              
               <condition value="1">
                  <set token="Panel21IncludeFramesFilter"></set>
               </condition>
               <condition value="0">
                  <set token="Panel21IncludeFramesFilter">filter IsFrame is "0"</set>
               </condition>
            </change> 
         </input>
         
         <chart>
            <title>Average request duration (s)</title>
            <search>
               <query>
                  | pivot `uA_DM_Application_BrowserWebRequests2` Application_BrowserWebRequests2
                     sum(RequestCount) as SumRequestCount
                     sum($Panel21Duration$) as SumPanel21Duration
                     splitrow
                        _time
                        period $PivotPeriodAutoTimechart$
                     splitrow
                        $Panel21GroupBy$
                     $Panel21RequestTypeFilter$
                     $Panel21IncludeFramesFilter$
                     $SearchFilter$
                  | timechart
                     `uberAgent_dynamic_span`
                     eval(round(sum(SumPanel21Duration)/sum(SumRequestCount)/1000,1)) as "Avg. $Panel21Display$ (s)"
                     by
                        $Panel21GroupBy$
               </query>
            </search>
            <option name="height">250</option>
            <option name="charting.chart">column</option>
            <option name="charting.chart.stackMode">stacked</option>
            <option name="charting.legend.placement">bottom</option>
            <option name="charting.axisTitleX.visibility">collapsed</option>
            <option name="charting.axisTitleY.visibility">collapsed</option>
            <option name="charting.drilldown">none</option>
         </chart>
         
         <chart>
            <title>Request count</title>
            <search>
               <query>
                  | pivot `uA_DM_Application_BrowserWebRequests2` Application_BrowserWebRequests2
                     sum(RequestCount) as SumRequestCount
                     splitrow
                        _time
                        period $PivotPeriodAutoTimechart$
                     splitrow
                        $Panel21GroupBy$
                     $Panel21RequestTypeFilter$
                     $Panel21IncludeFramesFilter$
                    $SearchFilter$
                  | timechart
                     `uberAgent_dynamic_span`
                     eval(sum(SumRequestCount)) as "Count of $Panel21Display$"
                     by
                        $Panel21GroupBy$
               </query>
            </search>
            <option name="height">250</option>
            <option name="charting.chart">column</option>
            <option name="charting.chart.stackMode">stacked</option>
            <option name="charting.legend.placement">bottom</option>
            <option name="charting.axisTitleX.visibility">collapsed</option>
            <option name="charting.axisTitleY.visibility">collapsed</option>
            <option name="charting.drilldown">none</option>
         </chart>
      </panel>
   </row>

   <!-- Row 3 -->
   <row>
      <panel>
         <title>Request statistics grouped (top 100)</title>
         <input type="dropdown" token="Panel31GroupBy" searchWhenChanged="true">
            <choice value="BrowserDisplayName">Browser name</choice>
            <choice value="BrowserVersion">Browser version</choice>
            <choice value="host">Host</choice>
            <choice value="RequestHost">Request URL</choice>
            <choice value="TabHost">Tab URL</choice>
            <choice value="User">User</choice>
            <default>TabHost</default>
            <label>Group by:</label>
            <change>
               <condition value="TabHost">
                  <set token="Panel31GroupByDisplay">$label$</set>
                  <set token="DrilldownGroupBy31">RequestHost</set>
                  <set token="DrilldownGroupBy31Display">Request URL</set>
                  <unset token="DrilldownFilterBy31"></unset>
                  <unset token="DrilldownFilterBy41"></unset>
               </condition>            
               <condition value="*">
                  <set token="Panel31GroupByDisplay">$label$</set>
                  <set token="DrilldownGroupBy31">TabHost</set>
                  <set token="DrilldownGroupBy31Display">Tab URL</set>
                  <unset token="DrilldownFilterBy31"></unset>
                  <unset token="DrilldownFilterBy41"></unset>
               </condition>            
            </change>
         </input>
         <input type="dropdown" token="Panel31SortBy" searchWhenChanged="true">
            <choice value="#Page loads">Page load count</choice>
            <choice value="Avg. page load total (s)">Page load: total duration</choice>
            <choice value="Avg. page load network (s)">Page load: network duration</choice>
            <choice value="Avg. page load render (s)">Page load: render duration</choice>
            <choice value="#XMLHttpRequests">XMLHttpRequest count</choice>
            <choice value="Avg. XMLHttpRequest (s)">XMLHttpRequest duration</choice>
            <choice value="#Web socket req.">Web socket request count</choice>
            <choice value="Avg. web socket req. (s)">Web socket request duration</choice>
            <default>Page load count</default>
            <label>Sort by:</label>
         </input>
         <input type="radio" token="Panel31IncludeFrames" searchWhenChanged="true">
            <label>Include frames?</label>
            <choice value="1">Yes</choice>
            <choice value="0">No</choice>
            <default>0</default>
            <change>              
               <condition value="1">
                  <set token="Panel31IncludeFramesFilter"></set>
               </condition>
               <condition value="0">
                  <set token="Panel31IncludeFramesFilter">filter IsFrame is "0"</set>
               </condition>
            </change> 
         </input>
         <table>
            <search>
               <query>
                  | pivot `uA_DM_Application_BrowserWebRequests2` Application_BrowserWebRequests2
                     sum(RequestCount) as SumRequestCount
                     sum(WebRequestDurationMs) as SumWebRequestDurationMs
                     sum(PageLoadTotalDurationMs) as SumPageLoadTotalDurationMs
                     sum(PageLoadNetworkDurationMs) as SumPageLoadNetworkDurationMs
                     sum(PageLoadRenderDurationMs) as SumPageLoadRenderDurationMs
                     sum(HttpStatusCount4xx) as SumHttpStatusCount4xx
                     sum(HttpStatusCount5xx) as SumHttpStatusCount5xx
                     values(host) as ValuesHost
                     values(User) as ValuesUser
                     values(TabHost) as ValuesTabHost
                     values(RequestHost) as ValuesRequestHost
                     values(BrowserVersion) as ValuesBrowserVersion
                     splitrow
                        RequestTypeDisplayName
                     splitrow
                        $Panel31GroupBy$
                     $Panel31IncludeFramesFilter$
                     $SearchFilter$
                  | eval RequestCountPageLoad = if (RequestTypeDisplayName = "PageLoad", SumRequestCount, 0)
                  | eval RequestCountXmlHttpRequest = if (RequestTypeDisplayName = "XmlHttpRequest", SumRequestCount, 0)
                  | eval RequestCountWebSocket = if (RequestTypeDisplayName = "WebSocket", SumRequestCount, 0)
                  | eval XmlHttpRequestDurationMs = if (RequestTypeDisplayName = "XmlHttpRequest", SumWebRequestDurationMs, "")
                  | eval WebSocketDurationMs = if (RequestTypeDisplayName = "WebSocket", SumWebRequestDurationMs, "")
                  | stats
                     sum(RequestCountPageLoad) as SumRequestCountPageLoad
                     sum(RequestCountXmlHttpRequest) as SumRequestCountXmlHttpRequest
                     sum(RequestCountWebSocket) as SumRequestCountWebSocket
                     sum(XmlHttpRequestDurationMs) as SumXmlHttpDurationMs
                     sum(WebSocketDurationMs) as SumWebSocketDurationMs
                     sum(SumPageLoadTotalDurationMs) as SumPageLoadTotalDurationMs
                     sum(SumPageLoadNetworkDurationMs) as SumPageLoadNetworkDurationMs
                     sum(SumPageLoadRenderDurationMs) as SumPageLoadRenderDurationMs
                     sum(SumHttpStatusCount4xx) as SumHttpStatusCount4xx
                     sum(SumHttpStatusCount5xx) as SumHttpStatusCount5xx
                     dc(ValuesHost) as "#Hosts"
                     dc(ValuesUser) as "#Users"
                     dc(ValuesTabHost) as "#Tab URLs"
                     dc(ValuesRequestHost) as "#Request URLs"
                     dc(ValuesBrowserVersion) as "#Browser versions"
                     by
                        $Panel31GroupBy$
                  | eval "#Page loads" = round (SumRequestCountPageLoad, 0)
                  | eval "#XMLHttpRequests" = round (SumRequestCountXmlHttpRequest, 0)
                  | eval "#Web socket req." = round (SumRequestCountWebSocket, 0)
                  | eval "#HTTP status 4xx" = round (SumHttpStatusCount4xx, 0)
                  | eval "#HTTP status 5xx" = round (SumHttpStatusCount5xx, 0)
                  | eval "Avg. page load total (s)" = round (SumPageLoadTotalDurationMs / SumRequestCountPageLoad / 1000, 2)
                  | eval "Avg. page load network (s)" = round (SumPageLoadNetworkDurationMs / SumRequestCountPageLoad / 1000, 2)
                  | eval "Avg. page load render (s)" = round (SumPageLoadRenderDurationMs / SumRequestCountPageLoad / 1000, 2)
                  | eval "Avg. XMLHttpRequest (s)" = round (SumXmlHttpDurationMs / SumRequestCountXmlHttpRequest / 1000, 2)
                  | eval "Avg. web socket req. (s)" = round (SumWebSocketDurationMs / SumRequestCountWebSocket / 1000, 2)
                  | rename $Panel31GroupBy$ as "$Panel31GroupByDisplay$"
                  | sort limit=100 - "$Panel31SortBy$"
                  | fillnull
                     "#Page loads" "#XMLHttpRequests" "#Web socket req." "#HTTP status 4xx" "#HTTP status 5xx"
                  | table
                     "$Panel31GroupByDisplay$"
                     "#Page loads"
                     "Avg. page load total (s)"
                     "Avg. page load network (s)"
                     "Avg. page load render (s)"
                     "#XMLHttpRequests"
                     "Avg. XMLHttpRequest (s)"
                     "#Web socket req."
                     "Avg. web socket req. (s)"
                     "#HTTP status 4xx"
                     "#HTTP status 5xx"
                     "#Hosts"
                     "#Users"
                     "#Tab URLs"
                     "#Request URLs"
                     "#Browser versions"
               </query>
            </search>
            <option name="count">20</option>
            <option name="drilldown">row</option>
            <drilldown>
               <set token="DrilldownFilterBy31">$click.value$</set>
               <unset token="DrilldownFilterBy41"></unset>
            </drilldown>
         </table>
         
         <html src="browser_webappperf_explanation.html">
         </html>
      </panel>
   </row>
         
   <!-- Row 4 -->
   <row>
      <panel depends="$DrilldownFilterBy31$">
         <title>Requests with: $Panel31GroupByDisplay$ = $DrilldownFilterBy31$</title>
         <input type="dropdown" token="Panel41GroupBy" searchWhenChanged="true">
            <choice value="BrowserDisplayName">Browser name</choice>
            <choice value="BrowserVersion">Browser version</choice>
            <choice value="host">Host</choice>
            <choice value="RequestHost">Request URL</choice>
            <choice value="TabHost">Tab URL</choice>
            <choice value="User">User</choice>
            <default>$DrilldownGroupBy31$</default>
            <label>Group by:</label>
            <change>
               <condition value="*">
                  <set token="Panel41GroupByDisplay">$label$</set>
               </condition>            
            </change>
         </input>
         <input type="radio" token="Panel41IncludeFrames" searchWhenChanged="true">
            <label>Include frames?</label>
            <choice value="1">Yes</choice>
            <choice value="0">No</choice>
            <default>0</default>
            <change>              
               <condition value="1">
                  <set token="Panel41IncludeFramesFilter"></set>
               </condition>
               <condition value="0">
                  <set token="Panel41IncludeFramesFilter">filter IsFrame is "0"</set>
               </condition>
            </change> 
         </input>
         <table>
            <search>
               <query>
                  | pivot `uA_DM_Application_BrowserWebRequests2` Application_BrowserWebRequests2
                     sum(RequestCount) as SumRequestCount
                     sum(WebRequestDurationMs) as SumWebRequestDurationMs
                     sum(PageLoadTotalDurationMs) as SumPageLoadTotalDurationMs
                     sum(PageLoadNetworkDurationMs) as SumPageLoadNetworkDurationMs
                     sum(PageLoadRenderDurationMs) as SumPageLoadRenderDurationMs
                     sum(HttpStatusCount4xx) as SumHttpStatusCount4xx
                     sum(HttpStatusCount5xx) as SumHttpStatusCount5xx
                     values(host) as ValuesHost
                     values(User) as ValuesUser
                     values(TabHost) as ValuesTabHost
                     values(RequestHost) as ValuesRequestHost
                     values(BrowserVersion) as ValuesBrowserVersion
                     splitrow
                        RequestTypeDisplayName
                     splitrow
                        $Panel41GroupBy$
                     $Panel41IncludeFramesFilter$
                     filter $Panel31GroupBy$ is $DrilldownFilterBy31|s$
                     $SearchFilter$
                  | eval RequestCountPageLoad = if (RequestTypeDisplayName = "PageLoad", SumRequestCount, 0)
                  | eval RequestCountXmlHttpRequest = if (RequestTypeDisplayName = "XmlHttpRequest", SumRequestCount, 0)
                  | eval RequestCountWebSocket = if (RequestTypeDisplayName = "WebSocket", SumRequestCount, 0)
                  | eval XmlHttpRequestDurationMs = if (RequestTypeDisplayName = "XmlHttpRequest", SumWebRequestDurationMs, "")
                  | eval WebSocketDurationMs = if (RequestTypeDisplayName = "WebSocket", SumWebRequestDurationMs, "")
                  | stats
                     sum(RequestCountPageLoad) as SumRequestCountPageLoad
                     sum(RequestCountXmlHttpRequest) as SumRequestCountXmlHttpRequest
                     sum(RequestCountWebSocket) as SumRequestCountWebSocket
                     sum(XmlHttpRequestDurationMs) as SumXmlHttpDurationMs
                     sum(WebSocketDurationMs) as SumWebSocketDurationMs
                     sum(SumPageLoadTotalDurationMs) as SumPageLoadTotalDurationMs
                     sum(SumPageLoadNetworkDurationMs) as SumPageLoadNetworkDurationMs
                     sum(SumPageLoadRenderDurationMs) as SumPageLoadRenderDurationMs
                     sum(SumHttpStatusCount4xx) as SumHttpStatusCount4xx
                     sum(SumHttpStatusCount5xx) as SumHttpStatusCount5xx
                     dc(ValuesHost) as "#Hosts"
                     dc(ValuesUser) as "#Users"
                     dc(ValuesTabHost) as "#Tab URLs"
                     dc(ValuesRequestHost) as "#Request URLs"
                     dc(ValuesBrowserVersion) as "#Browser versions"
                     by
                        $Panel41GroupBy$
                  | eval "#Page loads" = round (SumRequestCountPageLoad, 0)
                  | eval "#XMLHttpRequests" = round (SumRequestCountXmlHttpRequest, 0)
                  | eval "#Web socket req." = round (SumRequestCountWebSocket, 0)
                  | eval "#HTTP status 4xx" = round (SumHttpStatusCount4xx, 0)
                  | eval "#HTTP status 5xx" = round (SumHttpStatusCount5xx, 0)
                  | eval "Avg. page load total (s)" = round (SumPageLoadTotalDurationMs / SumRequestCountPageLoad / 1000, 2)
                  | eval "Avg. page load network (s)" = round (SumPageLoadNetworkDurationMs / SumRequestCountPageLoad / 1000, 2)
                  | eval "Avg. page load render (s)" = round (SumPageLoadRenderDurationMs / SumRequestCountPageLoad / 1000, 2)
                  | eval "Avg. XMLHttpRequest (s)" = round (SumXmlHttpDurationMs / SumRequestCountXmlHttpRequest / 1000, 2)
                  | eval "Avg. web socket req. (s)" = round (SumWebSocketDurationMs / SumRequestCountWebSocket / 1000, 2)
                  | rename $Panel41GroupBy$ as "$Panel41GroupByDisplay$"
                  | sort limit=100 - "$Panel31SortBy$"
                  | fillnull
                     "#Page loads" "#XMLHttpRequests" "#Web socket req." "#HTTP status 4xx" "#HTTP status 5xx"
                  | table
                     "$Panel41GroupByDisplay$"
                     "#Page loads"
                     "Avg. page load total (s)"
                     "Avg. page load network (s)"
                     "Avg. page load render (s)"
                     "#XMLHttpRequests"
                     "Avg. XMLHttpRequest (s)"
                     "#Web socket req."
                     "Avg. web socket req. (s)"
                     "#HTTP status 4xx"
                     "#HTTP status 5xx"
                     "#Hosts"
                     "#Users"
                     "#Tab URLs"
                     "#Request URLs"
                     "#Browser versions"
               </query>
            </search>
            <option name="count">20</option>
            <option name="drilldown">row</option>
            <drilldown>
               <set token="DrilldownFilterBy41">$click.value$</set>
            </drilldown>
         </table>
      </panel>
   </row>
   
   <!-- Row 5 -->
   <row depends="$DrilldownFilterBy41$">

      <panel>
         <title>Page loads with: $Panel31GroupByDisplay$ = $DrilldownFilterBy31$, $Panel41GroupByDisplay$ = $DrilldownFilterBy41$: usage over time</title>
         <chart>
            <search>
               <query>
                  | pivot `uA_DM_Application_BrowserWebRequests2` Application_BrowserWebRequests2
                     sum(RequestCount) as SumRequestCount
                     sum(PageLoadNetworkDurationMs) as SumPageLoadNetworkDurationMs
                     sum(PageLoadRenderDurationMs) as SumPageLoadRenderDurationMs
                     splitrow
                        _time
                        period $PivotPeriodAutoTimechart$
                     $Panel41IncludeFramesFilter$
                     filter $Panel31GroupBy$ is $DrilldownFilterBy31|s$
                     filter $Panel41GroupBy$ is $DrilldownFilterBy41|s$
                     filter RequestTypeDisplayName is "PageLoad"
                     $SearchFilter$
                  | timechart
                     `uberAgent_dynamic_span`
                     eval(round(sum(SumPageLoadNetworkDurationMs)/sum(SumRequestCount)/1000,1)) as "Avg. page load (network) (s)"
                     eval(round(sum(SumPageLoadRenderDurationMs)/sum(SumRequestCount)/1000,1)) as "Avg. page load (render) (s)"
               </query>
            </search>
            <option name="height">250</option>
            <option name="charting.chart">column</option>
            <option name="charting.chart.stackMode">stacked</option>
            <option name="charting.legend.placement">bottom</option>
            <option name="charting.axisTitleX.visibility">collapsed</option>
            <option name="charting.axisTitleY.visibility">collapsed</option>
            <option name="charting.drilldown">none</option>
         </chart>
      </panel>
   </row>
      
</form>
