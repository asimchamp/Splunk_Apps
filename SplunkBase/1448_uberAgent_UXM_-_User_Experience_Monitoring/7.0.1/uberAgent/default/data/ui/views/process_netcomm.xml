<?xml version='1.0' encoding='utf-8'?>
<form version="1.1" script="main.js, process_netcomm.js" stylesheet="main.css, process_netcomm.css">

   <label>Network Communication</label>
   <description>This dashboard displays detailed information about network communication per application, process, host, target or user.</description>

   <fieldset autoRun="true">
      <input type="time" id="TimeRange1" searchWhenChanged="true">
         <label>Time range:</label>
         <default>
            <earliest>-1h</earliest>
            <latest>now</latest>
         </default>         
         <change>
            <eval token="TimeRangePickerSpan">relative_time(now(), latest) - relative_time(now(), earliest)</eval>
            <eval token="PivotPeriodAutoSolo">case('TimeRangePickerSpan' &lt; 350000, "auto", 'TimeRangePickerSpan' &lt; 610000, "hour", 1=1, "auto")</eval>
            <eval token="PivotPeriodAutoTimechart">case('TimeRangePickerSpan' &lt; 1200, "second", 'TimeRangePickerSpan' &lt; 300000, "minute", 'TimeRangePickerSpan' &lt; 700000, "hour", 1=1, "day")</eval>
         </change>
      </input>
      <input type="dropdown" token="FilterField" id="Input_FilterField">
         <label>Filter field:</label>
      </input>
      <input type="dropdown" token="FilterOperator" id="Input_FilterOperator">
         <label>Filter operator:</label>
      </input>
      <input type="text" token="FilterExpression" id="Input_FilterExpression">
         <label>Filter expression:</label>
         <default>*</default>
      </input>
      <input type="dropdown" token="FilterField2" id="Input_FilterField2" depends="$FilterLevel2$">
      </input>
      <input type="dropdown" token="FilterOperator2" id="Input_FilterOperator2" depends="$FilterLevel2$">
      </input>
      <input type="text" token="FilterExpression2" id="Input_FilterExpression2" depends="$FilterLevel2$">
      </input>
      <input type="dropdown" token="FilterField3" id="Input_FilterField3" depends="$FilterLevel3$">
      </input>
      <input type="dropdown" token="FilterOperator3" id="Input_FilterOperator3" depends="$FilterLevel3$">
      </input>
      <input type="text" token="FilterExpression3" id="Input_FilterExpression3" depends="$FilterLevel3$">
      </input>
      <input type="dropdown" token="FilterField4" id="Input_FilterField4" depends="$FilterLevel4$">
      </input>
      <input type="dropdown" token="FilterOperator4" id="Input_FilterOperator4" depends="$FilterLevel4$">
      </input>
      <input type="text" token="FilterExpression4" id="Input_FilterExpression4" depends="$FilterLevel4$">
      </input>
      <input type="dropdown" token="FilterField5" id="Input_FilterField5" depends="$FilterLevel5$">
      </input>
      <input type="dropdown" token="FilterOperator5" id="Input_FilterOperator5" depends="$FilterLevel5$">
      </input>
      <input type="text" token="FilterExpression5" id="Input_FilterExpression5" depends="$FilterLevel5$">
      </input>
      <input type="dropdown" token="FilterField6" id="Input_FilterField6" depends="$FilterLevel6$">
      </input>
      <input type="dropdown" token="FilterOperator6" id="Input_FilterOperator6" depends="$FilterLevel6$">
      </input>
      <input type="text" token="FilterExpression6" id="Input_FilterExpression6" depends="$FilterLevel6$">
      </input>
      <input type="text" token="FilterLevels" id="Input_FilterLevels" depends="$FilterLevels_Hidden$">
      </input>
      <input type="text" token="FilterDatamodel" id="Input_FilterDatamodel" depends="$FilterDatamodel_Hidden$">
         <default>Process_NetworkTargetPerformance</default>
      </input>
   </fieldset>
   
   <!-- Row 1 -->
   <row>
      <!-- Column 1 -->
      <panel>
         <title>Data volume</title>
         <input type="dropdown" token="Panel11GroupBy" searchWhenChanged="true">
            <choice value="AppName">Application</choice>
            <choice value="ProcName">Process</choice>
            <choice value="NetTargetSourceAddress">Source IP</choice>
            <choice value="NetTargetSourcePort">Source port</choice>
            <choice value="host">Source host</choice>
            <choice value="NetTargetRemoteNameAddress">Target host</choice>
            <choice value="NetTargetRemotePort">Target port</choice>
            <choice value="ProcUser">User</choice>
            <default>$Tokenlink_Panel11$</default>
            <label>Group by:</label>
            <change>
            <condition value="AppName">
               <set token="Panel11GroupByDisplay">$label$</set>
               <set token="Panel11Splitrow">
                     splitrow
                        AppName
               </set>
            </condition>
            <condition value="ProcName">
               <set token="Panel11GroupByDisplay">$label$</set>
               <set token="Panel11Splitrow">
                     splitrow
                        ProcName
               </set>
            </condition>
            <condition value="NetTargetSourceAddress">
               <set token="Panel11GroupByDisplay">$label$</set>
               <set token="Panel11Splitrow">
                     splitrow
                        NetTargetSourceAddress
               </set>
            </condition>
            <condition value="NetTargetSourcePort">
               <set token="Panel11GroupByDisplay">$label$</set>
               <set token="Panel11Splitrow">
                     splitrow
                        NetTargetSourcePort
               </set>
            </condition>
            <condition value="host">
               <set token="Panel11GroupByDisplay">$label$</set>
               <set token="Panel11Splitrow">
                     splitrow
                        host
               </set>
            </condition>
            <condition value="NetTargetRemoteNameAddress">
               <set token="Panel11GroupByDisplay">$label$</set>
               <set token="Panel11Splitrow"> </set>
            </condition>
            <condition value="NetTargetRemotePort">
               <set token="Panel11GroupByDisplay">$label$</set>
               <set token="Panel11Splitrow">
                     splitrow
                        NetTargetRemotePort
               </set>
            </condition>
            <condition value="ProcUser">
               <set token="Panel11GroupByDisplay">$label$</set>
               <set token="Panel11Splitrow">
                     splitrow
                        ProcUser
               </set>
            </condition>
            </change>
         </input>
         <input type="dropdown" token="Panel11PortFilter" searchWhenChanged="true">
            <choice value="*">All</choice>
            <default>*</default>
            <label>Target port:</label>
            <allowCustomValues>true</allowCustomValues>
         </input>
         <input type="radio" token="Panel11NewTargetsCheckbox" searchWhenChanged="true">
            <label>Only show new targets?</label>
            <choice value="1">Yes</choice>
            <choice value="0">No</choice>
            <default>No</default>
            <change>
            <condition label="Yes">
               <set token="Chart_Panel11_OnlyNew">
                  | eval NetTargetRemoteNameAddressLower = lower(NetTargetRemoteNameAddress)
                  | lookup lookup_networktargetperformance_targetlist NetTargetRemoteNameAddress as NetTargetRemoteNameAddressLower OUTPUTNEW FirstSeen
                  | where isNull(FirstSeen) OR (EventTime-FirstSeen &lt; 3600)
               </set>
            </condition>
            <condition label="No">
               <set token="Chart_Panel11_OnlyNew"> </set>
            </condition>
            </change> 
         </input>
         
         <chart id="Chart_Panel11">
            <title>Data volume (top 10)</title>
            <search>
               <query>
                  | pivot `uA_DM_Process_NetworkTargetPerformance` Process_NetworkTargetPerformance
                     earliest(_time) as EventTime
                     sum(NetTargetSendMB) as SumNetTargetSendMB
                     sum(NetTargetReceiveMB) as SumNetTargetReceiveMB
                     sum(NetTargetSendReceiveMB) as SumNetTargetSendReceiveMB
                     $Panel11Splitrow$
                     splitrow
                        NetTargetRemoteNameAddress
                     filter NetTargetRemotePort = $Panel11PortFilter$
                     filter $Panel11GroupBy$ isNotNull
                     $SearchFilter$
                  | eval EventTime = round (strptime (EventTime, "%Y-%m-%dT%H:%M:%S.%Q%z"), 0) 
                  $Chart_Panel11_OnlyNew$
                  | stats
                     sum(SumNetTargetSendMB) as "Send volume (MB)"
                     sum(SumNetTargetReceiveMB) as "Receive volume (MB)"
                     sum(SumNetTargetSendReceiveMB) as "Send+Receive volume (MB)"
                     by
                        $Panel11GroupBy$
                  | rename $Panel11GroupBy$ as "$Panel11GroupByDisplay$"
                  | sort limit=10 - "Send+Receive volume (MB)"
                  | fields
                     "$Panel11GroupByDisplay$"
                     "Send volume (MB)"
                     "Receive volume (MB)"
               </query>
            </search>
            <option name="height">250</option>
            <option name="charting.chart">bar</option>
            <option name="charting.chart.stackMode">stacked</option>
            <option name="charting.legend.placement">none</option>
            <option name="charting.axisTitleX.visibility">collapsed</option>
            <option name="charting.axisTitleY.visibility">collapsed</option>
         </chart>
         <chart id="Chart_Panel21">
            <title>Data volume over time</title>
            <search>
               <query>
                  | pivot `uA_DM_Process_NetworkTargetPerformance` Process_NetworkTargetPerformance
                     sum(NetTargetSendMB) as SumNetTargetSendMB
                     sum(NetTargetReceiveMB) as SumNetTargetReceiveMB
                     splitrow
                        _time
                        period $PivotPeriodAutoTimechart$
                     splitrow
                        NetTargetRemoteNameAddress
                     filter NetTargetRemotePort = $Panel11PortFilter$
                     filter $Panel11GroupBy$ isNotNull
                     $SearchFilter$
                  | eval EventTime = _time
                  $Chart_Panel11_OnlyNew$
                  | timechart
                     `uberAgent_dynamic_span`
                     sum(SumNetTargetSendMB) as "Send volume (MB)"
                     sum(SumNetTargetReceiveMB) as "Receive volume (MB)"
               </query>
            </search>
            <option name="height">250</option>
            <option name="charting.chart">$TimechartChartType$</option>
            <option name="charting.chart.stackMode">stacked</option>
            <option name="charting.legend.placement">bottom</option>
            <option name="charting.axisTitleX.visibility">collapsed</option>
            <option name="charting.axisTitleY.visibility">collapsed</option>
            <option name="charting.drilldown">none</option>
            <option name="charting.chart.nullValueMode">zero</option>
         </chart>
      </panel>

      <!-- Column 2 -->
      <panel>
         <title>Latency</title>
         <input type="dropdown" token="Panel12GroupBy" searchWhenChanged="true">
            <choice value="AppName">Application</choice>
            <choice value="ProcName">Process</choice>
            <choice value="NetTargetSourceAddress">Source IP</choice>
            <choice value="NetTargetSourcePort">Source port</choice>
            <choice value="host">Source host</choice>
            <choice value="NetTargetRemoteNameAddress">Target host</choice>
            <choice value="NetTargetRemotePort">Target port</choice>
            <choice value="ProcUser">User</choice>
            <default>$Tokenlink_Panel12$</default>
            <label>Group by:</label>
            <change>
            <condition value="AppName">
               <set token="Panel12GroupByDisplay">$label$</set>
               <set token="Panel12Splitrow">
                     splitrow
                        AppName
               </set>
            </condition>
            <condition value="ProcName">
               <set token="Panel12GroupByDisplay">$label$</set>
               <set token="Panel12Splitrow">
                     splitrow
                        ProcName
               </set>
            </condition>
            <condition value="NetTargetSourceAddress">
               <set token="Panel12GroupByDisplay">$label$</set>
               <set token="Panel12Splitrow">
                     splitrow
                        NetTargetSourceAddress
               </set>
            </condition>
            <condition value="NetTargetSourcePort">
               <set token="Panel12GroupByDisplay">$label$</set>
               <set token="Panel12Splitrow">
                     splitrow
                        NetTargetSourcePort
               </set>
            </condition>
            <condition value="host">
               <set token="Panel12GroupByDisplay">$label$</set>
               <set token="Panel12Splitrow">
                     splitrow
                        host
               </set>
            </condition>
            <condition value="NetTargetRemoteNameAddress">
               <set token="Panel12GroupByDisplay">$label$</set>
               <set token="Panel12Splitrow"> </set>
            </condition>
            <condition value="NetTargetRemotePort">
               <set token="Panel12GroupByDisplay">$label$</set>
               <set token="Panel12Splitrow">
                     splitrow
                        NetTargetRemotePort
               </set>
            </condition>
            <condition value="ProcUser">
               <set token="Panel12GroupByDisplay">$label$</set>
               <set token="Panel12Splitrow">
                     splitrow
                        ProcUser
               </set>
            </condition>
            </change>
         </input>
         <input type="dropdown" token="Panel12PortFilter" searchWhenChanged="true">
            <choice value="*">All</choice>
            <default>*</default>
            <label>Target port:</label>
            <allowCustomValues>true</allowCustomValues>
         </input>
         <input type="radio" token="Panel12NewTargetsCheckbox" searchWhenChanged="true">
            <label>Only show new targets?</label>
            <choice value="1">Yes</choice>
            <choice value="0">No</choice>
            <default>No</default>
            <change>              
            <condition label="Yes">
               <set token="Chart_Panel12_OnlyNew">
                  | eval NetTargetRemoteNameAddressLower = lower(NetTargetRemoteNameAddress)
                  | lookup lookup_networktargetperformance_targetlist NetTargetRemoteNameAddress as NetTargetRemoteNameAddressLower OUTPUTNEW FirstSeen
                  | where isNull(FirstSeen) OR (EventTime-FirstSeen &lt; 3600)
               </set>               
            </condition>
            <condition label="No">
               <set token="Chart_Panel12_OnlyNew"> </set>
            </condition>
            </change> 
         </input>       
         <chart id="Chart_Panel12">
            <title>Average latency (top 10)</title>
            <search>
               <query>
                  | pivot `uA_DM_Process_NetworkTargetPerformance` Process_NetworkTargetPerformance
                     earliest(_time) as EventTime
                     sum(NetTargetSendLatencyCount) AS SumNetTargetSendLatencyCount
                     sum(NetTargetSendDurationMs) AS SumNetTargetSendDurationMs
                     $Panel12Splitrow$
                     splitrow
                        NetTargetRemoteNameAddress
                     filter NetTargetRemotePort = $Panel12PortFilter$
                     filter $Panel12GroupBy$ isNotNull
                     $SearchFilter$
                  | eval EventTime = round (strptime (EventTime, "%Y-%m-%dT%H:%M:%S.%Q%z"), 0) 
                  $Chart_Panel12_OnlyNew$
                  | stats
                     sum(SumNetTargetSendLatencyCount) AS SumNetTargetSendLatencyCount
                     sum(SumNetTargetSendDurationMs) AS SumNetTargetSendDurationMs
                     by
                        $Panel12GroupBy$
                  | eval "Avg. TCP send latency (ms)"=round(SumNetTargetSendDurationMs/SumNetTargetSendLatencyCount,1)
                  | rename $Panel12GroupBy$ as "$Panel12GroupByDisplay$"
                  | sort limit=10 - "Avg. TCP send latency (ms)"
                  | fields
                     "$Panel12GroupByDisplay$"
                     "Avg. TCP send latency (ms)"
               </query>
            </search>
            <option name="height">250</option>
            <option name="charting.chart">bar</option>
            <option name="charting.legend.placement">none</option>
            <option name="charting.axisTitleX.visibility">collapsed</option>
            <option name="charting.axisTitleY.visibility">collapsed</option>
         </chart>
         <chart id="Chart_Panel22">
            <title>Average latency over time</title>
            <search>
               <query>
                  | pivot `uA_DM_Process_NetworkTargetPerformance` Process_NetworkTargetPerformance
                     sum(NetTargetSendLatencyCount) as SumNetTargetSendLatencyCount
                     sum(NetTargetSendDurationMs) as SumNetTargetSendDurationMs
                     sum(NetTargetSendJitterCount) as SumNetTargetSendJitterCount
                     sum(NetTargetSendJitterMs) as SumNetTargetSendJitterMs
                     sum(NetTargetSendLatencyInitialCount) as SumNetTargetSendLatencyInitialCount
                     sum(NetTargetSendLatencyInitialMs) as SumNetTargetSendLatencyInitialMs
                     splitrow
                        _time
                        period $PivotPeriodAutoTimechart$
                     splitrow
                        NetTargetRemoteNameAddress
                     filter NetTargetRemotePort = $Panel12PortFilter$
                     filter $Panel12GroupBy$ isNotNull
                     $SearchFilter$
                  | eval EventTime = _time
                  $Chart_Panel12_OnlyNew$
                  | timechart
                     `uberAgent_dynamic_span`
                     eval(round(sum(SumNetTargetSendLatencyInitialMs)/sum(SumNetTargetSendLatencyInitialCount),1)) as "Avg. initial TCP send latency (ms)"
                     eval(round(sum(SumNetTargetSendDurationMs)/sum(SumNetTargetSendLatencyCount),1)) as "Avg. TCP send latency (ms)"
                     eval(round(sum(SumNetTargetSendJitterMs)/sum(SumNetTargetSendJitterCount),1)) as "Avg. TCP send jitter (ms)"
               </query>
            </search>
            <option name="height">250</option>
            <option name="charting.chart">$TimechartChartType$</option>
            <option name="charting.chart.stackMode">stacked</option>
            <option name="charting.legend.placement">bottom</option>
            <option name="charting.axisTitleX.visibility">collapsed</option>
            <option name="charting.axisTitleY.visibility">collapsed</option>
            <option name="charting.drilldown">none</option>
         </chart>
      </panel>
   </row>

   <!-- Row 3 -->
   <row>
      <panel>   
         <title>Network statistics grouped (top 100)</title>
         <input type="dropdown" token="Panel31GroupBy" searchWhenChanged="true">
            <choice value="AppName">Application</choice>
            <choice value="ProcName">Process</choice>
            <choice value="NetTargetSourceAddress">Source IP</choice>
            <choice value="NetTargetSourcePort">Source port</choice>
            <choice value="host">Source host</choice>
            <choice value="NetTargetRemoteNameAddress">Target host</choice>
            <choice value="NetTargetRemotePort">Target port</choice>
            <choice value="ProcUser">User</choice>
            <default>$Tokenlink_Panel31$</default>
            <label>Group by:</label>
            <change>
            <condition value="AppName">
               <set token="Panel31GroupByDisplay">$label$</set>
               <unset token="DrilldownFilterBy31"></unset>
               <set token="Panel31Splitrow">
                     splitrow
                        AppName
               </set>
            </condition>
            <condition value="ProcName">
               <set token="Panel31GroupByDisplay">$label$</set>
               <unset token="DrilldownFilterBy31"></unset>
               <set token="Panel31Splitrow">
                     splitrow
                        ProcName
               </set>
            </condition>
            <condition value="NetTargetSourceAddress">
               <set token="Panel31GroupByDisplay">$label$</set>
               <unset token="DrilldownFilterBy31"></unset>
               <set token="Panel31Splitrow">
                     splitrow
                        NetTargetSourceAddress
               </set>
            </condition>
            <condition value="NetTargetSourcePort">
               <set token="Panel31GroupByDisplay">$label$</set>
               <unset token="DrilldownFilterBy31"></unset>
               <set token="Panel31Splitrow">
                     splitrow
                        NetTargetSourcePort
               </set>
            </condition>
            <condition value="host">
               <set token="Panel31GroupByDisplay">$label$</set>
               <unset token="DrilldownFilterBy31"></unset>
               <set token="Panel31Splitrow">
                     splitrow
                        host
               </set>
            </condition>
            <condition value="NetTargetRemoteNameAddress">
               <set token="Panel31GroupByDisplay">$label$</set>
               <unset token="DrilldownFilterBy31"></unset>
               <set token="Panel31Splitrow"> </set>
            </condition>
            <condition value="NetTargetRemotePort">
               <set token="Panel31GroupByDisplay">$label$</set>
               <unset token="DrilldownFilterBy31"></unset>
               <set token="Panel31Splitrow">
                     splitrow
                        NetTargetRemotePort
               </set>
            </condition>
            <condition value="ProcUser">
               <set token="Panel31GroupByDisplay">$label$</set>
               <unset token="DrilldownFilterBy31"></unset>
               <set token="Panel31Splitrow">
                     splitrow
                        ProcUser
               </set>
            </condition>            
            </change>
         </input>
         <input type="dropdown" token="Panel31PortFilter" searchWhenChanged="true">
            <choice value="*">All</choice>
            <default>*</default>
            <label>Target port:</label>
            <allowCustomValues>true</allowCustomValues>
         </input>
         <input type="dropdown" token="Panel31SortBy" searchWhenChanged="true">
            <choice value="Avg. TCP send latency (ms)">Avg. TCP send latency</choice>
            <choice value="Send volume (MB)">Send volume</choice>
            <choice value="Receive volume (MB)">Receive volume</choice>
            <choice value="#Sends">#Sends</choice>
            <choice value="#Receives">#Receives</choice>
            <choice value="#Connects">#Connects</choice>
            <choice value="#Reconnects">#Reconnects</choice>
            <choice value="#Retransmits">#Retransmits</choice>
            <default>Avg. TCP send latency (ms)</default>
            <label>Sort by:</label>
         </input>
         <input type="radio" token="Panel31NewTargetsCheckbox" searchWhenChanged="true">
            <label>Only show new targets?</label>
            <choice value="1">Yes</choice>
            <choice value="0">No</choice>
            <default>No</default>
            <change>              
            <condition label="Yes">
               <set token="Chart_Panel31_OnlyNew">
                  | eval NetTargetRemoteNameAddressLower = lower(NetTargetRemoteNameAddress)
                  | lookup lookup_networktargetperformance_targetlist NetTargetRemoteNameAddress as NetTargetRemoteNameAddressLower OUTPUTNEW FirstSeen
                  | where isNull(FirstSeen) OR (EventTime-FirstSeen &lt; 3600)
               </set>               
            </condition>
            <condition label="No">
               <set token="Chart_Panel31_OnlyNew"> </set>
            </condition>
            </change> 
         </input>
      
         <title>Fields</title>
         <input type="multiselect" token="FieldFilter" id="Input_Panel21FieldFilter" searchWhenChanged="true">
            <choice value='"#Sends"'>#Sends</choice>
            <choice value='"#Receives"'>#Receives</choice>
            <choice value='"#Connects"'>#Connects</choice>
            <choice value='"#Reconnects"'>#Reconnects</choice>
            <choice value='"#Retransmits"'>#Retransmits</choice>
            <choice value='"Send volume (MB)"'>Send volume (MB)</choice>
            <choice value='"Receive volume (MB)"'>Receive volume (MB)</choice>
            <choice value='"Avg. initial TCP send latency (ms)"'>Avg. initial TCP send latency (ms)</choice>
            <choice value='"Avg. TCP send latency (ms)"'>Avg. TCP send latency (ms)</choice>
            <choice value='"Avg. TCP send jitter (ms)"'>Avg. TCP send jitter (ms)</choice>
            <choice value='"TCP send packet loss (%)"'>TCP send packet loss (%)</choice>
            <choice value='"#Targets"'>#Targets</choice>
            <choice value='"#Hosts"'>#Hosts</choice>
            <choice value='"#Processes"'>#Processes</choice>
            <choice value='"#Users"'>#Users</choice>
            <default>
               "#Sends",
               "#Receives",
               "#Connects",
               "#Reconnects",
               "#Retransmits",
               "Send volume (MB)",
               "Receive volume (MB)",
               "Avg. initial TCP send latency (ms)",
               "Avg. TCP send latency (ms)",
               "Avg. TCP send jitter (ms)",
               "TCP send packet loss (%)"
            </default>
            <label>Fields to display:</label>
            <prefix></prefix>
            <suffix></suffix>
            <valuePrefix></valuePrefix>
            <valueSuffix></valueSuffix>
            <delimiter> </delimiter>
         </input>
         
         <table>
            <search>
               <query>
                  | pivot `uA_DM_Process_NetworkTargetPerformance` Process_NetworkTargetPerformance
                     earliest(_time) as EventTime
                     sum(NetTargetSendCount) as SumNetTargetSendCount
                     sum(NetTargetReceiveCount) as SumNetTargetReceiveCount
                     sum(NetTargetConnectCount) as SumNetTargetConnectCount
                     sum(NetTargetReconnectCount) as SumNetTargetReconnectCount
                     sum(NetTargetRetransmitCount) as SumNetTargetRetransmitCount
                     sum(NetTargetSendMB) as SumNetTargetSendMB
                     sum(NetTargetReceiveMB) as SumNetTargetReceiveMB
                     sum(NetTargetSendLatencyCount) as SumNetTargetSendLatencyCount
                     sum(NetTargetSendDurationMs) as SumNetTargetSendDurationMs
                     sum(NetTargetSendJitterCount) as SumNetTargetSendJitterCount
                     sum(NetTargetSendJitterMs) as SumNetTargetSendJitterMs
                     sum(NetTargetSendLatencyInitialCount) as SumNetTargetSendLatencyInitialCount
                     sum(NetTargetSendLatencyInitialMs) as SumNetTargetSendLatencyInitialMs
                     values(NetTargetRemoteNameAddressPort) as ValuesNetTargetRemoteNameAddressPort
                     values(host) as Valueshost
                     values(ProcName) as ValuesProcName
                     values(ProcUser) as ValuesProcUser
                  $Panel31Splitrow$
                     splitrow
                        NetTargetRemoteNameAddress
                     filter NetTargetRemotePort = $Panel31PortFilter$
                     filter $Panel31GroupBy$ isNotNull
                     $SearchFilter$
                  | eval EventTime = round (strptime (EventTime, "%Y-%m-%dT%H:%M:%S.%Q%z"), 0) 
                  $Chart_Panel31_OnlyNew$
                  | stats
                     sum(SumNetTargetSendCount) as SumNetTargetSendCount
                     sum(SumNetTargetReceiveCount) as SumNetTargetReceiveCount
                     sum(SumNetTargetConnectCount) as SumNetTargetConnectCount
                     sum(SumNetTargetReconnectCount) as SumNetTargetReconnectCount
                     sum(SumNetTargetRetransmitCount) as SumNetTargetRetransmitCount
                     sum(SumNetTargetSendMB) as SumNetTargetSendMB
                     sum(SumNetTargetReceiveMB) as SumNetTargetReceiveMB
                     sum(SumNetTargetSendLatencyCount) as SumNetTargetSendLatencyCount
                     sum(SumNetTargetSendDurationMs) as SumNetTargetSendDurationMs
                     sum(SumNetTargetSendJitterCount) as SumNetTargetSendJitterCount
                     sum(SumNetTargetSendJitterMs) as SumNetTargetSendJitterMs
                     sum(SumNetTargetSendLatencyInitialCount) as SumNetTargetSendLatencyInitialCount
                     sum(SumNetTargetSendLatencyInitialMs) as SumNetTargetSendLatencyInitialMs
                     dc(ValuesNetTargetRemoteNameAddressPort) as "#Targets"
                     dc(Valueshost) as "#Hosts"
                     dc(ValuesProcName) as "#Processes"
                     dc(ValuesProcUser) as "#Users"
                     by
                        $Panel31GroupBy$
                  | eval "#Sends"=round(SumNetTargetSendCount,0)
                  | eval "#Receives"=round(SumNetTargetReceiveCount,0)
                  | eval "#Connects"=round(SumNetTargetConnectCount,0)
                  | eval "#Reconnects"=round(SumNetTargetReconnectCount,0)
                  | eval "#Retransmits"=round(SumNetTargetRetransmitCount,0)
                  | eval "Send volume (MB)"=round(SumNetTargetSendMB,1)
                  | eval "Receive volume (MB)"=round(SumNetTargetReceiveMB,1)
                  | eval "Avg. initial TCP send latency (ms)"=round(SumNetTargetSendLatencyInitialMs/SumNetTargetSendLatencyInitialCount,1)
                  | eval "Avg. TCP send latency (ms)"=round(SumNetTargetSendDurationMs/SumNetTargetSendLatencyCount,1)
                  | eval "Avg. TCP send jitter (ms)"=round(SumNetTargetSendJitterMs/SumNetTargetSendJitterCount,1)  
                  | eval "TCP send packet loss (%)"=round( (100 / (SumNetTargetRetransmitCount+SumNetTargetSendCount)) * SumNetTargetRetransmitCount, 1)
                  | rename $Panel31GroupBy$ as "$Panel31GroupByDisplay$"
                  | sort limit=100 - "$Panel31SortBy$"
                  | fields
                     "$Panel31GroupByDisplay$" $FieldFilter$
               </query>
            </search>
            <option name="count">20</option>
            <option name="drilldown">row</option>
            <drilldown>
                <set token="DrilldownFilterBy31">$click.value$</set>
            </drilldown>
         </table>
         
         <html src="process_netcomm_explanation.html">
         </html>
      </panel>
   </row>

   <!-- Row 4 -->
   <row depends="$DrilldownFilterBy31$">
      <panel>
         <title>Detail: $Panel31GroupByDisplay$ = $DrilldownFilterBy31$</title>
         <table>
            <title>Statistics</title>
            <search>
               <query>
                  | pivot `uA_DM_Process_NetworkTargetPerformance` Process_NetworkTargetPerformance
                     earliest(_time) as EventTime
                     sum(NetTargetSendMB) as SumNetTargetSendMB
                     sum(NetTargetReceiveMB) as SumNetTargetReceiveMB
                     sum(NetTargetSendLatencyCount) as SumNetTargetSendLatencyCount
                     sum(NetTargetSendDurationMs) as SumNetTargetSendDurationMs
                     sum(NetTargetSendJitterCount) as SumNetTargetSendJitterCount
                     sum(NetTargetSendJitterMs) as SumNetTargetSendJitterMs
                     sum(NetTargetSendCount) as SumNetTargetSendCount
                     sum(NetTargetSendLatencyInitialCount) as SumNetTargetSendLatencyInitialCount
                     sum(NetTargetSendLatencyInitialMs) as SumNetTargetSendLatencyInitialMs
                     sum(NetTargetRetransmitCount) as SumNetTargetRetransmitCount
                     sum(NetTargetReceiveCount) as SumNetTargetReceiveCount
                     sum(NetTargetConnectCount) as SumNetTargetConnectCount
                     sum(NetTargetReconnectCount) as SumNetTargetReconnectCount
                     dc(NetTargetRemoteNameAddressPort) as "#Targets"
                     dc(host) as "#Hosts"
                     dc(ProcName) as "#Processes"
                     dc(ProcUser) as "#Users"
                     values(NetTargetSourcePort) as "Source ports"
                     splitrow
                        NetTargetRemoteNameAddress
                     splitrow
                        NetTargetRemotePort
                     splitrow
                        NetTargetSourceAddress
                     filter $Panel31GroupBy$ is $DrilldownFilterBy31|s$
                     filter NetTargetRemotePort = $Panel31PortFilter$
                     $SearchFilter$
                  | eval "Send volume (MB)" = round (SumNetTargetSendMB, 1)
                  | eval "Receive volume (MB)" = round (SumNetTargetReceiveMB, 1)
                  | eval "Avg. initial TCP send latency (ms)" = round (SumNetTargetSendLatencyInitialMs/SumNetTargetSendLatencyInitialCount, 1)
                  | eval "Avg. TCP send latency (ms)" = round (SumNetTargetSendDurationMs/SumNetTargetSendLatencyCount, 1)
                  | eval "Avg. TCP send jitter (ms)"= round (SumNetTargetSendJitterMs/SumNetTargetSendJitterCount, 1)
                  | eval "TCP send packet loss (%)"=round( (100 / (SumNetTargetRetransmitCount+SumNetTargetSendCount)) * SumNetTargetRetransmitCount, 1)
                  | eval "#Sends"=round(SumNetTargetSendCount,0)
                  | eval "#Receives"=round(SumNetTargetReceiveCount,0)
                  | eval "#Connects"=round(SumNetTargetConnectCount,0)
                  | eval "#Reconnects"=round(SumNetTargetReconnectCount,0)
                  | eval "#Retransmits"=round(SumNetTargetRetransmitCount,0)
                  | eval EventTime = round (strptime (EventTime, "%Y-%m-%dT%H:%M:%S.%Q%z"), 0) 
                  $Chart_Panel31_OnlyNew$
                  | rename NetTargetRemoteNameAddress as "Target host" NetTargetRemotePort as "Target port" NetTargetSourceAddress as "Source IP"
                  | sort limit=0 - "$Panel31SortBy$"
                  | table
                     "Source IP"
                     "Source ports"
                     "Target host"
                     "Target port"
                     $FieldFilter$
               </query>
            </search>
            <option name="count">10</option>
            <option name="drilldown">none</option>
         </table>
         <chart>
            <title>Latency over time</title>
            <search>
               <query>
                  | pivot `uA_DM_Process_NetworkTargetPerformance` Process_NetworkTargetPerformance
                     sum(NetTargetSendLatencyCount) as SumNetTargetSendLatencyCount
                     sum(NetTargetSendDurationMs) as SumNetTargetSendDurationMs
                     sum(NetTargetSendLatencyInitialCount) as SumNetTargetSendLatencyInitialCount
                     sum(NetTargetSendLatencyInitialMs) as SumNetTargetSendLatencyInitialMs
                     splitrow
                        _time
                        period $PivotPeriodAutoTimechart$
                     splitrow
                        NetTargetRemoteNameAddress
                     filter $Panel31GroupBy$ is $DrilldownFilterBy31|s$
                     filter NetTargetRemotePort = $Panel31PortFilter$
                     $SearchFilter$
                  | eval EventTime = _time
                  $Chart_Panel31_OnlyNew$
                  | timechart
                     `uberAgent_dynamic_span`
                     eval(round(sum(SumNetTargetSendLatencyInitialMs)/sum(SumNetTargetSendLatencyInitialCount),1)) as "Avg. initial TCP send latency (ms)"
                     eval(round(sum(SumNetTargetSendDurationMs)/sum(SumNetTargetSendLatencyCount),1)) as "Avg. TCP send latency (ms)"
               </query>
            </search>
            <option name="height">250</option>
            <option name="charting.chart">$TimechartChartType$</option>
            <option name="charting.chart.stackMode">stacked</option>
            <option name="charting.legend.placement">bottom</option>
            <option name="charting.axisTitleX.visibility">collapsed</option>
            <option name="charting.axisTitleY.visibility">collapsed</option>
            <option name="charting.drilldown">none</option>
         </chart>
       <chart>
            <title>Jitter over time</title>
            <search>
               <query>
                  | pivot `uA_DM_Process_NetworkTargetPerformance` Process_NetworkTargetPerformance
                     sum(NetTargetSendJitterCount) as SumNetTargetSendJitterCount
                     sum(NetTargetSendJitterMs) as SumNetTargetSendJitterMs
                     splitrow
                        _time
                        period $PivotPeriodAutoTimechart$
                     splitrow
                        NetTargetRemoteNameAddress
                     filter $Panel31GroupBy$ is $DrilldownFilterBy31|s$
                     filter NetTargetRemotePort = $Panel31PortFilter$
                     $SearchFilter$
                  | eval EventTime = _time
                  $Chart_Panel31_OnlyNew$
                  | timechart
                     `uberAgent_dynamic_span`
                     eval(round(sum(SumNetTargetSendJitterMs)/sum(SumNetTargetSendJitterCount),1)) as "Avg. TCP send jitter (ms)"
               </query>
            </search>
            <option name="height">250</option>
            <option name="charting.chart">$TimechartChartType$</option>
            <option name="charting.chart.stackMode">stacked</option>
            <option name="charting.legend.placement">bottom</option>
            <option name="charting.axisTitleX.visibility">collapsed</option>
            <option name="charting.axisTitleY.visibility">collapsed</option>
            <option name="charting.drilldown">none</option>
         </chart>
         <chart>
            <title>Data volume over time</title>
            <search>
               <query>
                  | pivot `uA_DM_Process_NetworkTargetPerformance` Process_NetworkTargetPerformance
                     sum(NetTargetSendMB) as SumNetTargetSendMB
                     sum(NetTargetReceiveMB) as SumNetTargetReceiveMB
                     splitrow
                        _time
                        period $PivotPeriodAutoTimechart$
                     splitrow
                        NetTargetRemoteNameAddress
                     filter $Panel31GroupBy$ is $DrilldownFilterBy31|s$
                     filter NetTargetRemotePort = $Panel31PortFilter$
                     $SearchFilter$
                  | eval EventTime = _time
                  $Chart_Panel31_OnlyNew$
                  | timechart
                     `uberAgent_dynamic_span`
                     sum(SumNetTargetSendMB) as "Send volume (MB)"
                     sum(SumNetTargetReceiveMB) as "Receive volume (MB)"
               </query>
            </search>
            <option name="height">250</option>
            <option name="charting.chart">$TimechartChartType$</option>
            <option name="charting.chart.stackMode">stacked</option>
            <option name="charting.legend.placement">bottom</option>
            <option name="charting.axisTitleX.visibility">collapsed</option>
            <option name="charting.axisTitleY.visibility">collapsed</option>
            <option name="charting.drilldown">none</option>
         </chart>
      </panel>
   </row>
   
   <!-- Config row -->
   <row>
   
      <panel>
         <title>Dashboard configuration</title>
         
         <input type="dropdown" token="TimechartChartType" searchWhenChanged="true">
            <choice value="line">Line</choice>
            <choice value="column">Column</choice>
            <default>line</default>
            <label>Timechart type:</label>
         </input>
         
      </panel>
      
   </row>
   
</form>
