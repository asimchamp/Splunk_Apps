[emc:isilon:rest]
SHOULD_LINEMERGE = False
TIME_PREFIX = timestamp":"
MAX_TIMESTAMP_LOOKAHEAD = 25
TIME_FORMAT = %Y-%m-%d %H:%M:%S%z
ANNOTATE_PUNCT = false
KV_MODE = json
TRUNCATE = 0
EVAL-vendor_product = "Dell_Isilon"

[emc:isilon:syslog]
EVAL-vendor_product = "Dell_Isilon"
EXTRACT-syslog_fields_no_nodename_without_node_ip = ^.*?(?<process_name>\S+)\[\d+\]\:(?<message>.*)
EXTRACT-syslog_fields_no_nodename = .(?<node_ip>\d+\.\d+\.\d+\.\d+)\s\d{4}\-\d{2}\-\S+.*?(?<process_name>\S+)\[\d*\]\:(?<message>.*)
EXTRACT-syslog_fields_nodename = .\d+\.\d+\.\d+\.\d+\s\d{4}\-\d{2}\-\S+\s(?<node_name>\S+)\s\S+\[\d*\]\:.*$
EXTRACT-audit_config_fields = uid:\s(?<uid>\d+)\;\ssid\:[\s\w]+\:?(?<sid>\S*)\;\sremote_addr:\s(?<remote_address>.*)\;[\s\S]*uri:\s(?<uri>\S+)\;\smethod\:\s(?<method>\S+)\;
EXTRACT-authentication_fields = (?:authentication|Accepted).*for\s(?<src_user>.*?)\s\w+\s(?<src>\d{0,3}\.\d{0,3}\.\d{0,3}\.\d{0,3})
EXTRACT-audit_protocol_sid_and_uid = .*?audit_protocol\s\d+\s+.*\s(?<sid>.*?)\|(?<uid>.*?)\|
EXTRACT-audit_protocol_fields = .*?audit_protocol.*?[a-z0-9]\|(?<zone_id>\d+?)\|(?<client_ip>(?:\d+\.){3}\d+)\|(?:(?:\w+)\|)?(?<event_action>\S+?)\|(?<event_result>(?:SUCCESS|FAILED))(?:\:\d+\||\||$)
EXTRACT-audit_protocol_fields_Open = OPEN\|(\w+|\w+\:\d+)\|\d+\|(?<file_type>\S+?)\|(?<action_result>\w+?)(\|(\d+|)\||\|)(?<file_path>.*)$
EXTRACT-audit_protocol_fields_Close = CLOSE\|(\w+|\w+\:\d+)\|(?<file_type>\S+?)\|(?<bytes_reads>\d+)\:(?<NumberOfbytesRead>\d+)\|(?<bytes_write>\d+)\:(?<NumberOfbytesWrite>\d+)(\|(\d+|)\||\|)(?<file_path>.*?)$
EXTRACT-audit_protocol_fields_Delete = DELETE\|(\w+|\w+\:\d+)\|(?<file_type>\S+?)(\|(\d+|)\||\|)(?<file_path>.*?)$
EXTRACT-audit_protocol_fields_Rename = RENAME\|(\w+|\w+\:\d+)\|(?<file_type>\S+?)(\|(\d+|)\||\|)(?<source_path>.*?)\|(?<destination_path>.*?)$
EXTRACT-audit_protocol_fields_Write = WRITE\|(\w+|\w+\:\d+)\|(?<file_type>\S+)(\|(\d+|)\||\|)(?<file_path>.*)$
EXTRACT-audit_protocol_fields_Read = READ\|(\w+|\w+\:\d+)\|(?<file_type>\S+)(\|(\d+|)\||\|)(?<file_path>.*)$
EXTRACT-audit_protocol_fail_code = FAILED\:(?<fail_code>[^\|]+)\|
EVAL-action = case(message like "%Accepted%","success",message like "%authentication%","failure")
EVAL-Cluster_Name = coalesce(Cluster_Name1, Cluster_Name2)
FIELDALIAS-app_for_authentication_CIM = process_name as app
FIELDALIAS-user_for_authentication_CIM = src_user as user
FIELDALIAS-dest_for_authentication_CIM = node_ip as dest
REPORT-extract_isilon_fields = privilege-fields,member-fields,audit_protocol_cluster


#[source::.../platform/1/cluster/config]
[source::...platform_1_cluster_config]
FIELDALIAS-version_for_inventory_CIM = onefs_version.version as version
FIELDALIAS-array_for_inventory_CIM = devices{}.guid as array
FIELDALIAS-cluster_for_inventory_CIM = name as cluster
FIELDALIAS-os_for_inventory_CIM = onefs_version.type as os
FIELDALIAS-dest_for_CIM = node as dest

#[source::.../platform/1/statistics/current\?key\=node.cpu.count\&devid\=all]
[source::...platform_1_statistics_current_key_cpu_count_devid_all]
EVAL-cpu_count = 'stats.value'
FIELDALIAS-dest_for_CIM = stats.devid as dest

#[source::.../platform/1/cluster/external-ips]
[source::...platform_1_cluster_external_ips]
FIELDALIAS-ip_for_inventory_CIM = ipAddress as ip
FIELDALIAS-dest_for_CIM = devId as dest

#[source::.../platform/1/cluster/statfs]
[source::...platform_1_cluster_statfs]
FIELDALIAS-blocksize_for_inventory_CIM = f_bsize as blocksize
FIELDALIAS-mount_for_inventory_CIM = f_mntonname as mount
FIELDALIAS-dest_for_CIM = node as dest

#[source::.../platform/1/statistics/current\?key\=node.disk.access.latency.avg\&devid\=all]
[source::...platform_1_statistics_current_key_latency_avg_devid_all]
EVAL-latency = 'stats.value'

[source::.../platform/1/statistics/current\?key\=node.ifs.heat.read.total\&devid\=all]
EVAL-read_ops = 'stats.value'

[source::.../platform/1/statistics/current\?key\=node.ifs.heat.write.total\&devid\=all]
EVAL-write_ops = 'stats.value'

#[source::.../platform/1/statistics/current\?substr\=true\&keys\=node.ifs.heat\&devid\=all]
[source::...platform_1_statistics_current_substr_true_keys_heat_devid_all]
EVAL-read_ops = case('stats.key'="node.ifs.heat.read.total", 'stats.value')
EVAL-write_ops = case('stats.key'="node.ifs.heat.write.total", 'stats.value')

#[source::.../platform/3/statistics/summary/system]
[source::...platform_3_statistics_summary_system]
FIELDALIAS-cpu_load_percent_for_performance_CIM = system.cpu as cpu_load_percent
EVAL-thruput = 'system.net_in' + 'system.net_out'
FIELDALIAS-dest_for_CIM = node as dest

[source::.../platform/1/statistics/current\?key\=node.cpu.user.max\&devid\=all]
EVAL-cpu_user_percent = 'stats.value'
FIELDALIAS-dest_for_CIM = node as dest

#[source::.../platform/1/statistics/current\?keys\=node.cpu.user.max\,node.cpu.sys.max\,node.health\&devid\=all]
[source::...platform_1_statistics_current_keys_user_max_sys_max_health_devid_all]
EVAL-cpu_user_percent = case('stats.key'="node.cpu.user.max", 'stats.value')
EVAL-dest = case('stats.key'="node.cpu.user.max", node)

[source::.../platform/1/statistics/current\?key\=node.memory.free\&devid\=all]
EVAL-mem_free = 'stats.value'
FIELDALIAS-dest_for_CIM = stats.devid as dest

[source::.../platform/1/statistics/current\?key\=node.memory.used\&devid\=all]
EVAL-mem_used = 'stats.value'
FIELDALIAS-dest_for_CIM = stats.devid as dest

#[source::.../platform/1/statistics/current\?keys\=node.memory.free\,node.memory.used\&devid\=all]
[source::...platform_1_statistics_current_keys_memory_free_memory_used_devid_all]
EVAL-mem_free = case('stats.key'="node.memory.free", 'stats.value')
EVAL-mem_used = case('stats.key'="node.memory.used", 'stats.value')
FIELDALIAS-dest_for_CIM = stats.devid as dest

[source::.../platform/1/statistics/current\?key\=ifs.bytes.free]
EVAL-storage_free = 'stats.value'
FIELDALIAS-dest_for_CIM = node as dest

[source::.../platform/1/statistics/current\?key\=ifs.bytes.total]
EVAL-storage = 'stats.value'

[source::.../platform/1/statistics/current\?key\=ifs.bytes.used]
EVAL-storage_used = 'stats.value'
FIELDALIAS-dest_for_CIM = node as dest

[source::.../platform/1/statistics/current\?key\=ifs.percent.avail]
EVAL-storage_free_percent = 'stats.value'
FIELDALIAS-dest_for_CIM = node as dest

[source::.../platform/1/statistics/current\?key\=ifs.percent.used]
EVAL-storage_used_percent = 'stats.value'
FIELDALIAS-dest_for_CIM = node as dest

#[source::.../platform/1/statistics/current\?keys\=ifs.bytes.avail\,ifs.bytes.free\,ifs.bytes.used\,ifs.bytes.total\,ifs.percent.used\,ifs.percent.avail\,ifs.ssd.bytes.free\,ifs.ssd.bytes.used\&devid\=all]
[source::...platform_1_statistics_current_keys_ifs_avail_ifs_free_ifs_used_ifs_total_ifs_used_ifs_avail_ifs_free_ifs_used_devid_all]
EVAL-storage_free = case('stats.key'="ifs.bytes.free", 'stats.value')
EVAL-storage_used = case('stats.key'="ifs.bytes.used", 'stats.value')
EVAL-storage = case('stats.key'="ifs.bytes.total", 'stats.value')
EVAL-dest = case('stats.key'="ifs.bytes.free" OR 'stats.key'="ifs.bytes.used" OR 'stats.key'="ifs.percent.avail" OR 'stats.key'="ifs.percent.used", node)
EVAL-storage_free_percent = case('stats.key'="ifs.percent.avail", 'stats.value')
EVAL-storage_used_percent = case('stats.key'="ifs.percent.used", 'stats.value')

#[source::.../platform/1/statistics/current\?key\=node.uptime\&devid\=all]
[source::...platform_1_statistics_current_key_node_uptime_devid_all]
EVAL-uptime = 'stats.value'
FIELDALIAS-dest_for_CIM = stats.devid as dest

[source::.../platform/1/statistics/current\?key\=node.sensor.fan.rpms.\$get_count\$\&devid\=all]
EVAL-fan_speed = 'stats.value'
FIELDALIAS-dest_for_CIM = stats.devid as dest

[source::.../platform/1/statistics/current\?key\=node.sensor.power.watts.\$get_count\$\&devid\=all]
EVAL-power = 'stats.value'
FIELDALIAS-dest_for_CIM = stats.devid as dest

[source::.../platform/1/statistics/current\?key\=node.sensor.temp.celsius.\$get_count\$\&devid\=all]
EVAL-temperature = 'stats.value'
FIELDALIAS-dest_for_CIM = stats.devid as dest

#[source::.../platform/1/statistics/current\?substr\=true\&keys\=node.sensor.volt.volts\,node.sensor.temp.celsius\,node.sensor.fan.rpms\,sensor.power.watts\&devid\=all]
[source::...platform_1_statistics_current_substr_true_keys_volts_celsius_rpms_watts_devid_all]
EVAL-fan_speed = case(like('stats.key',"node.sensor.fan.rpms.%"), 'stats.value')
EVAL-power = case(like('stats.key',"node.sensor.power.watts.%"), 'stats.value')
EVAL-temperature = case(like('stats.key',"node.sensor.temp.celsius.%"), 'stats.value')
FIELDALIAS-dest_for_CIM = stats.devid as dest

#[source::.../platform/3/event/eventlists\?begin\=\$get_events_from_version\$]
[source::...platform_3_event_eventlists_begin_get_events_from_version]
FIELDALIAS-events_time = events.time AS events.start

#[source::.../platform/1/statistics/current\?key\=cluster.protostats...]
[source::...platform_1_statistics_current_key_cifs_total]
REPORT-extract_protocol =  extract_protocol

#[source::.../platform/1/statistics/current\?substr\=true\&keys\=cluster.protostats...]
[source::...platform_1_statistics_current_substr_true_keys_protostats]
REPORT-extract_protocol =  extract_protocol

[source::.../platform/1/statistics/current\?key\=node.disk...]
REPORT-extract_disk_index =  extract_disk_index

#[source::.../platform/1/statistics/current\?substr\=true\&keys\=node.disk...]
[source::...platform_1_statistics_current_substr_true_keys_node_disk...]
REPORT-extract_disk_index =  extract_disk_index

#[source::.../platform/1/auth/users]
[source::...platform_1_auth_users]
REPORT-extract_sid = extract_sid
FIELDALIAS-user_for_auth = users.name as Users

#[source::.../platform/1/statistics/current\?key\=cluster.node.count.down]
[source::...platform_1_statistics_current_key_cluster_down]
EVAL-node_down_count = 'stats.value'

[source::.../platform/1/statistics/current\?key\=cluster.node.list.all]
EVAL-node_count = mvcount(split('stats.value',","))

[source::.../platform/1/statistics/current\?key\=cluster.node.list.diskless]
EVAL-node_diskless_count = ifnull(mvcount(split('stats.value',",")),0)

[source::.../platform/1/statistics/current\?key\=cluster.node.list.readonly]
EVAL-node_readonly_count = ifnull(mvcount(split('stats.value',",")),0)

#[source::.../platform/1/statistics/current\?keys\=cluster.node.list.all\,cluster.node.list.diskless\,cluster.node.list.readonly]
[source::...platform_1_statistics_current_keys_cluster_all_cluster_diskless_cluster_readonly]
EVAL-node_count = case('stats.key'="cluster.node.list.all", mvcount(split('stats.value',",")))
EVAL-node_diskless_count = case('stats.key'="cluster.node.list.diskless", ifnull(mvcount(split('stats.value',",")),0))
EVAL-node_readonly_count = case('stats.key'="cluster.node.list.readonly", ifnull(mvcount(split('stats.value',",")),0))

#[source::.../platform/1/auth/providers/ads/\$get_ad_domains\$/search\?search_users\=true]
[source::...platform_auth_providers_ads_get_ad_domains_search_users_true_limit_1000]
EXTRACT-sid_for_ads =  id[\S\s]+"SID:(?<sid>\S+)\"
FIELDALIAS-user_for_ads = objects.id.name as Users
