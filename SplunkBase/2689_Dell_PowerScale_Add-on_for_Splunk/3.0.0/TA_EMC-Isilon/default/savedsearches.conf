[EMC-Isilon-Syslog-user-lookup]
cron_schedule = 5,15,25,35,45,55 * * * *
description = To populate the lookup table for user dropdown for audit_potocol syslog events
dispatch.earliest_time = -30m
dispatch.latest_time = now
display.page.search.mode = fast
enableSched = 1
run_on_startup = 1
search = `isilon_index` sourcetype=emc:isilon:syslog \
| dedup host, uid \
| eval unique_key_field = (host + "||" + uid) \
| table host uid unique_key_field \
| append [ inputlookup "dell_isilon_username" | eval key=_key | rename key as unique_key_field] \
| stats values(username) as username , values(host) as host, values(uid) as uid by unique_key_field \
| outputlookup "dell_isilon_username" key_field=unique_key_field

[EMC-Isilon-Syslog-user-lookup-All-Time]
disabled = 1
description = To populate the lookup table for user dropdown for audit_potocol syslog events in all time
search = `isilon_index` sourcetype=emc:isilon:syslog \
| dedup host, uid \
| eval unique_key_field = (host + "||" + uid) \
| table host uid unique_key_field \
| append [ inputlookup "dell_isilon_username" | eval key=_key | rename key as unique_key_field] \
| stats values(username) as username , values(host) as host, values(uid) as uid by unique_key_field \
| outputlookup "dell_isilon_username" key_field=unique_key_field

[EMC-Isilon-custom-command]
cron_schedule = 0,10,20,30,40,50 * * * *
description = To update the lookup table with username field for audit_potocol syslog events
dispatch.earliest_time = -30m
dispatch.latest_time = now
display.page.search.mode = fast
enableSched = 1
run_on_startup = 1
search = | inputlookup "dell_isilon_username" where username!=* \
| eval key=_key \
| rename key as unique_key_field \
| table host uid username unique_key_field \
| usernamescript