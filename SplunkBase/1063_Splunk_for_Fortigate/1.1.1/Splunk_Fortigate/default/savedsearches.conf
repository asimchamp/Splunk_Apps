########################
#
# Summary Indexing
#
########################

[SI - Fortigate - Traffic - DataCube]
action.summary_index = 1
action.summary_index.DataCube = traffic
cron_schedule = */5 * * * *
dispatch.earliest_time = -5m@m
displayview = flashtimeline
enableSched = 1
realtime_schedule = 0
request.ui_dispatch_view = flashtimeline
search = `fortigate_traffic` | fillnull device_name vdom source_interface source_ip user group destination_interface destination_ip session_type destination_port application service action policy_id bytes_sent bytes_received destination_country | fields  device_name vdom source_interface source_ip user group destination_interface destination_ip session_type destination_port application service action policy_id bytes_sent bytes_received destination_country | untable _time field value | stats count by field value

#[SI - Fortigate - Traffic- DataCube 2]
#action.summary_index = 1
#action.summary_index.DataCube = traffic
#cron_schedule = */5 * * * *
#dispatch.earliest_time = -5m@m
#displayview = flashtimeline
#enableSched = 1
#realtime_schedule = 0
#request.ui_dispatch_view = flashtimeline
#search = `fortigate_traffic` | stats sum(bytes_sent) as sum_bytes_sent sum(bytes_received) as sum_bytes_recieved by destination_interface source_interface | eval total_megabytes_sent = (sum_bytes_sent/(1024*1024)) | eval total_megabytes_received = (sum_bytes_recieved/(1024*1024))
#disabled = 1

[SI - Fortigate - Virus - DataCube]
action.summary_index = 1
action.summary_index.DataCube = virus
cron_schedule = */5 * * * *
dispatch.earliest_time = -5m@m
displayview = flashtimeline
enableSched = 1
realtime_schedule = 0
request.ui_dispatch_view = flashtimeline
search = `fortigate_virus` | fillnull device_name vdom source_ip user destination_ip priority malware dtype subtype service file profile url policyid | fields device_name vdom source_ip user destination_ip priority malware dtype subtype service file profile url policyid | untable _time field value | stats count by field value

[SI - Fortigate - Virus - DataCube 2]
action.summary_index = 1
action.summary_index.DataCube = virus
cron_schedule = */5 * * * *
dispatch.earliest_time = -5m@m
displayview = flashtimeline
enableSched = 1
realtime_schedule = 0
request.ui_dispatch_view = flashtimeline
search = `fortigate_virus` | stats count by malware
disabled = 1

[SI - Fortigate - IPS - DataCube]
action.summary_index = 1
action.summary_index.DataCube = ips
cron_schedule = */5 * * * *
dispatch.earliest_time = -5m@m
displayview = flashtimeline
enableSched = 1
realtime_schedule = 0
request.ui_dispatch_view = flashtimeline
search = `fortigate_ips` | fillnull device_name vdom source_ip user group destination_ip severity description action subtype service sensor policyid | fields device_name vdom source_ip user group destination_ip severity description action subtype service sensor policyid | untable _time field value | stats count by field value

[SI - Fortigate - IPS - DataCube 2]
action.summary_index = 1
action.summary_index.DataCube = ips
cron_schedule = */5 * * * *
dispatch.earliest_time = -5m@m
displayview = flashtimeline
enableSched = 1
realtime_schedule = 0
request.ui_dispatch_view = flashtimeline
search = `fortigate_ips` | stats count by description
disabled = 1

[SI - Fortigate - App-ctrl - DataCube]
action.summary_index = 1
action.summary_index.DataCube = app-ctrl
cron_schedule = */5 * * * *
dispatch.earliest_time = -5m@m
displayview = flashtimeline
enableSched = 1
realtime_schedule = 0
request.ui_dispatch_view = flashtimeline
search = `fortigate_app-ctrl`  | fillnull device_name vdom source_ip destination_ip source_interface destination_interface user group app_type application destination_port session_type action app_list policyid category_and_application | fields device_name vdom source_ip destination_ip source_interface destination_interface user group app_type application destination_port session_type action app_list policyid category_and_application | untable _time field value | stats count by field value

[SI - Fortigate - App-ctrl - DataCube 2]
action.summary_index = 1
action.summary_index.DataCube = app-ctrl
cron_schedule = */5 * * * *
dispatch.earliest_time = -5m@m
displayview = flashtimeline
enableSched = 1
realtime_schedule = 0
request.ui_dispatch_view = flashtimeline
search = `fortigate_app-ctrl` | stats count by application
disabled = 1

[SI - Fortigate - Webfilter - DataCube]
action.summary_index = 1
action.summary_index.DataCube = webfilter
cron_schedule = */5 * * * *
dispatch.earliest_time = -5m@m
displayview = flashtimeline
enableSched = 1
realtime_schedule = 0
request.ui_dispatch_view = flashtimeline
search = `fortigate_webfilter` | fillnull device_name vdom source_ip destination_ip source_interface destination_interface site service categorization user group status profile policyid bytes_sent bytes_received | fields device_name vdom source_ip destination_ip source_interface destination_interface site service categorization user group status profile policyid bytes_sent bytes_received | untable _time field value | stats count by field value

[SI - Fortigate - Webfilter - DataCube 2]
action.summary_index = 1
action.summary_index.DataCube = webfilter
cron_schedule = */5 * * * *
dispatch.earliest_time = -5m@m
displayview = flashtimeline
enableSched = 1
realtime_schedule = 0
request.ui_dispatch_view = flashtimeline
search = `fortigate_webfilter` | stats sum(mbytes_transfered) as MBytes by user,service | eval mbytes_transfered=((bytes_received+bytes_sent)/(1024*1024))
disabled = 1


########################
#
# TRAFFIC Reports
#
########################


[Fortigate - Traffic - Top services]
dispatch.earliest_time = -4h
dispatch.latest_time = +0s
is_visible = true
search = `fortigate_traffic` | stats count by service | sort -count

[Fortigate - Traffic - Top destnation IP]
dispatch.earliest_time = -4h
dispatch.latest_time = +0s
is_visible = true
search = `fortigate_traffic` | stats count by destination_ip | sort -count

[Fortigate - Traffic - Top source IP]
dispatch.earliest_time = -4h
dispatch.latest_time = +0s
is_visible = true
search = `fortigate_traffic` | eval mbytes_transfered=((bytes_received+bytes_sent)/(1024*1024)) | stats sum(mbytes_transfered) as MBytes_transfered by source_ip | sort -MBytes_transfered 

[Fortigate - Traffic - Top source user]
dispatch.earliest_time = -4h
dispatch.latest_time = +0s
is_visible = true
search = `fortigate_traffic` | eval mbytes_transfered=((bytes_received+bytes_sent)/(1024*1024)) | stats sum(mbytes_transfered) as MBytes_transfered by user | sort -MBytes_transfered 

########################
#
# Malware Reports
#
########################

[Fortigate - Virus - Malwares by policy]
dispatch.earliest_time = -4h
dispatch.latest_time = +0s
search = `fortigate_virus` | stats count by devname, vdom, policyid | sort -count

[Fortigate - Virus - Malwares by source IP]
dispatch.earliest_time = -4h
dispatch.latest_time = +0s
search = `fortigate_virus` | stats count by source_ip | sort -count

[Fortigate - Virus - Malwares by source user]
dispatch.earliest_time = -4h
dispatch.latest_time = +0s
search = `fortigate_virus` | stats count by user | sort -count

[Fortigate - Virus - Malwares by destination IP]
dispatch.earliest_time = -4h
dispatch.latest_time = +0s
search = `fortigate_virus` | stats count by destination_ip | sort -count

[Fortigate - Virus - Events by service]
dispatch.earliest_time = -4h
dispatch.latest_time = +0s
search = `fortigate_virus` | stats count by service | sort -count

[Fortigate - Virus - Top malwares]
dispatch.earliest_time = -4h
dispatch.latest_time = +0s
search = `fortigate_virus` | stats count by virus | sort -count


########################
#
# IPS Reports
#
########################

[Fortigate - IPS - Attacks by policy]
dispatch.earliest_time = -4h
dispatch.latest_time = +0s
search = `fortigate_ips` | stats count by devname, vdom, policyid | sort -count

[Fortigate - IPS - Attacks by source IP]
dispatch.earliest_time = -4h
dispatch.latest_time = +0s
search = `fortigate_ips` | stats count by source_ip | sort -count

[Fortigate - IPS - Attacks by source user]
dispatch.earliest_time = -4h
dispatch.latest_time = +0s
search = `fortigate_ips` | stats count by user | sort -count

[Fortigate - IPS - Attacks by destination IP]
dispatch.earliest_time = -4h
dispatch.latest_time = +0s
search = `fortigate_ips` | stats count by destination_ip | sort -count

[Fortigate - IPS - Events by service]
dispatch.earliest_time = -4h
dispatch.latest_time = +0s
search = `fortigate_ips` | stats count by service | sort -count

[Fortigate - IPS - Top attacks]
dispatch.earliest_time = -4h
dispatch.latest_time = +0s
search = `fortigate_ips` | stats count by attack_name | sort -count

