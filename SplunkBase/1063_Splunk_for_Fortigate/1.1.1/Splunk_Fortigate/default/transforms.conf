#

[fortigate_virus]
DEST_KEY = MetaData:Sourcetype
REGEX = ( type=virus )
FORMAT = sourcetype::fortigate_virus

[fortigate_app-ctrl]
DEST_KEY = MetaData:Sourcetype
REGEX = ( type=app-ctrl )
FORMAT = sourcetype::fortigate_app-ctrl

[fortigate_webfilter]
DEST_KEY = MetaData:Sourcetype
REGEX = ( type=webfilter )
FORMAT = sourcetype::fortigate_webfilter

[fortigate_traffic]
DEST_KEY = MetaData:Sourcetype
REGEX = ( type=traffic )
FORMAT = sourcetype::fortigate_traffic

[fortigate_event_auth_captive_portal]
DEST_KEY = MetaData:Sourcetype
REGEX = ( (type=event subtype=auth.*action=authentication|subtype=auth.*action=authentication type=event) )
FORMAT = sourcetype::fortigate_event_auth_captive_portal

[fortigate_event_auth_FSSO]
DEST_KEY = MetaData:Sourcetype
REGEX = ( type=event subtype=auth.*action=(FSSO-logon|FSSO-logoff) )
FORMAT = sourcetype::fortigate_event_auth_FSSO

[fortigate_event_pattern]
DEST_KEY = MetaData:Sourcetype
REGEX = ( (type=event subtype=pattern|subtype=pattern type=event) )
FORMAT = sourcetype::fortigate_event_pattern

[fortigate_event_dhcp]
DEST_KEY = MetaData:Sourcetype
REGEX = ( (type=event subtype=dhcp|subtype=dhcp type=event) )
FORMAT = sourcetype::fortigate_event_dhcp

[fortigate_event_his_performance]
DEST_KEY = MetaData:Sourcetype
REGEX = ( type=event (subtype=his-performance|subtype=perf-historical) )
FORMAT = sourcetype::fortigate_event_his_performance

[fortigate_event_wireless]
DEST_KEY = MetaData:Sourcetype
REGEX = ( type=event subtype=wireless )
FORMAT = sourcetype::fortigate_event_wireless

[fortigate_sslvpn]
DEST_KEY = MetaData:Sourcetype
REGEX = ( type=event subtype=(sslvpn-user|sslvpn-session) )
FORMAT = sourcetype::fortigate_sslvpn

[fortigate_ips]
DEST_KEY = MetaData:Sourcetype
REGEX = ( type=ips )
FORMAT = sourcetype::fortigate_ips

[fortigate_event_config]
DEST_KEY = MetaData:Sourcetype
REGEX = ( type=event subtype=config )
FORMAT = sourcetype::fortigate_event_config

[fortigate_event_ipsec]
DEST_KEY = MetaData:Sourcetype
REGEX = ( type=event subtype=ipsec )
FORMAT = sourcetype::fortigate_event_ipsec

[fortigate_event_system]
DEST_KEY = MetaData:Sourcetype
REGEX = ( type=event subtype=system )
FORMAT = sourcetype::fortigate_event_system

[fortigate_event_dns]
DEST_KEY = MetaData:Sourcetype
REGEX = ( type=event subtype=dns )
FORMAT = sourcetype::fortigate_event_dns

[fortigate_event]
DEST_KEY = MetaData:Sourcetype
REGEX = ( type=event subtype=(admin|ssl-admin|ppp) )
FORMAT = sourcetype::fortigate_event

[extract_traffic]
REGEX = (devname\=(?<device_name>\S+)|cluster_id\=(?<device_name>\S+)) device_id\=(?<serial>\S+) log_id\=(?<log_id>\S+) (type\=traffic subtype\=(?<subtype>\S+)|subtype\=(?<subtype>\S+) type\=traffic) pri\=(?<priority>\S+) (vd\=(?<vdom>\S+) dir_disp\=(?<dir_disp>\S+) tran_disp\=(?<tran_disp>\S+) src\=(?<source_ip>\S+) srcname\=(?<host_source>\S+) src_port\=(?<src_port>\S+) dst\=(?<destination_ip>\S+) dstname\=(?<host_destination>\S+) dst_port\=(?<destination_port>\S+) tran_ip\=(?<tran_ip>\S+) tran_port\=(?<tran_port>\S+) service\=(?<service>\S+) proto\=(?<session_type>\S+) app_type\=(?<application_type>\S+) duration\=(?<duration>\S+) rule\=(?<rule>\S+) policyid\=(?<policy_id>\S+) identidx\=(?<identidx>\S+) sent\=(?<bytes_sent>\S+) rcvd\=(?<bytes_received>\S+) shaper_drop_sent\=(?<shaper_drop_sent>\S+) shaper_drop_rcvd\=(?<shaper_drop_rcvd>\S+) perip_drop\=(?<perip_drop>\S+) sent_pkt\=(?<sent_pkt>\S+) rcvd_pkt\=(?<rcvd_pkt>\S+) src_int\=(?<source_interface>\S+) dst_int\=(?<destination_interface>\S+) SN\=(?<SN>\S+) app\=(?<application>\S+) app_cat\=(?<application_category>\S+) carrier_ep\=(?<carrier_ep>\S+) vpn\=(?<vpn>\S+) status\=(?<action>\S+) user\=(?<user>\S+) group\=(?<group>\S+) shaper_sent_name\=(?<shaper_sent_name>\S+) shaper_rcvd_name\=(?<shaper_rcvd_name>\S+) perip_name\=(?<perip_name>\S+) tran_sip\=(?<tran_sip>\S+) tran_sport\=(?<tran_sport>\S+) dst_country\=(?<destination_country>\S+) vpn_type\=(?<vpn_type>\S+) vpn_tunnel\=(?<vpn_tunnel>\S+) profilegroup\=(?<profilegroup>\S+) subappcat\=(?<subappcat>\S+) subapp\=(?<subapp>\S+)|status\=(?<action>\S+) vd\="(?<vdom>[^\"]+)" (src\=(?<source_ip>\S+)|dir_disp\=(?<dir_dip>\S+) tran_disp\=(?<tran_disp>\S+) src\=(?<source_ip>\S+)) (src_port\=(?<src_port>\S+)|srcname\=(?<host_source>\S+)) (srcname\=(?<host_source>\S+)|src_port\=(?<src_port>\S+)) dst\=(?<destination_ip>\S+) dstname\=(?<host_destination>\S+) (dst_port\=(?<destination_port>\S+) tran_ip\=(?<tran_ip>\S+) tran_port\=(?<tran_port>\S+) service\=(?<service>\S+)|dst_country\="(?<destination_country>[^\"]+)" dst_port\=(?<destination_port>\S+) (service\=(?<service>\S+)|tran_ip\=(?<tran_ip>\S+) tran_port\=(?<tran_port>\S+) tran_sip=(?<tran_sip>\S+) tran_sport\=(?<tran_sport>\S+) service\=(?<service>\S+))) proto\=(?<session_type>\S+) app_type\=(?<application_type>\S+) duration\=(?<duration>\S+) rule\=(?<rule>\S+) policyid\=(?<policy_id>\S+) identidx\=(?<identidx>\S+) sent\=(?<bytes_sent>\S+) rcvd\=(?<bytes_received>\S+) shaper_drop_sent\=(?<shaper_drop_sent>\S+) shaper_drop_rcvd\=(?<shaper_drop_rcvd>\S+) perip_drop\=(?<perip_drop>\S+) shaper_sent_name\="(?<shaper_sent_name>[^\"]+)" shaper_rcvd_name\="(?<shaper_rcvd_name>[^\"]+)" perip_name\="(?<perip_name>[^\"]+)" (vpn\="(?<vpn>[^\"]+)"|sent_pkt\=(?<sent_pkt>\S+) rcvd_pkt\=(?<rcvd_pkt>\S+) vpn\="(?<vpn>[^\"]+)") (src_int\="(?<source_interface>[^\"]+)" dst_int\="(?<destination_interface>[^\"]+)"|vpn_type\=(?<vpn_type>\S+) vpn_tunnel\="(?<vpn_tunnel>[^\"]+)" src_int\="(?<source_interface>[^\"]+)" dst_int\="(?<destination_interface>[^\"]+)") SN\=(?<SN>\S+) app\="(?<application>[^\"]+)" app_cat\="(?<application_category>[^\"]+)" user\="(?<user>[^\"]+)" group\="(?<group>[^\"]+)"( msg\="(?<description>[^\"]+)"|) carrier_ep\="(?<carrier_ep>[^\"]+)"( profilegroup\="(?<profilegroup>[^\"]+)"|))

#[extract_traffic]
#REGEX = date\=(?<date>\S+) time\=(?<time>\S+) devname\=(?<device_name>\S+) device_id\=(?<serial>\S+) log_id\=(?<log_id>\S+) type\=traffic subtype\=(?<subtype>\S+) pri\=(?<priority>\S+) status\=(?<action>\S+) vd\="(?<vdom>[^\"]+)" src\=(?<sourrce_ip>\S+) srcname\=(?<host_source>\S+) src_port\=(?<src_port>\S+) dst\=(?<destination_ip>\S+) dstname\=(?<host_destination>\S+) dst_country\="(?<destination_country>[^\"]+)" dst_port\=(?<destination_port>\S+) service\=(?<service>\S+) proto\=(?<session_type>\S+) app_type\=(?<application_type>\S+) duration\=(?<duration>\S+) rule\=(?<rule>\S+) policyid\=(?<policy_id>\S+) identidx\=(?<identidx>\S+) sent\=(?<bytes_sent>\S+) rcvd\=(?<bytes_received>\S+) shaper_drop_sent\=(?<shaper_drop_sent>\S+) shaper_drop_rcvd\=(?<shaper_drop_rcvd>\S+) perip_drop\=(?<perip_drop>\S+) shaper_sent_name\="(?<shaper_sent_name>[^\"]+)" shaper_rcvd_name\="(?<shaper_rcvd_name>[^\"]+)" perip_name\="(?<perip_name>[^\"]+)" vpn\="(?<vpn>[^\"]+)" vpn_type\=(?<vpn_type>\S+) vpn_tunnel\="(?<vpn_tunnel>[^\"]+)" src_int\="(?<source_interface>[^\"]+)" dst_int\="(?<destination_interface>[^\"]+)" SN\=(?<SN>\S+) app\="(?<application>[^\"]+)" app_cat\="(?<application_category>[^\"]+)" user\="(?<user>[^\"]+)" group\="(?<group>[^\"]+)" msg\="(?<description>[^\"]+)" carrier_ep\="(?<carrier_ep>[^\"]+)" profilegroup\="(?<profilegroup>[^\"]+)"

[extract_virus]
REGEX = (devname\=(?<device_name>\S+)|cluster_id\=(?<device_name>\S+)) device_id\=(?<serial>\S+) log_id\=(?<log_id>\S+) type\=virus subtype\=(?<subtype>\S+) pri\=(?<priority>\S+) (vd\=(?<vdom>\S+)|vd\="(?<vdom>[^\"]+)") msg\="(?<description>[^\"]+)" (status\=(?<action>\S+)|status\="(?<action>[^\"]+)") (service\=(?<service>\S+)|service\="(?<service>[^\"]+)") src\=(?<source_ip>\S+) dst\=(?<destination_ip>\S+) sport\=(?<sport>\S+) src_port\=(?<src_port>\S+) dport\=(?<dport>\S+) dst_port\=(?<destination_port>\S+) (src_int\=(?<source_interface>\S+)|src_int\="(?<source_interface>[^\"]+)") (dst_int\=(?<destination_interface>\S+)|dst_int\="(?<destination_interface>[^\"]+)") policyid\=(?<policyid>\S+) identidx\=(?<identidx>\S+) serial\=(?<serial>\S+) dir\=(?<dir>\S+) file\="(?<file>[^\"]+)" checksum="(?<checksum>[^\"]+)" quarskip\="(?<quarskip>[^\"]+)" virus\="(?<malware>[^\"]+)" dtype="(?<dtype>[^\"]+)" ref\="(?<ref>[^\"]+)" url="(?<url>[^\"]+)" carrier_ep\="(?<carrier_ep>[^\"]+)" profile\="(?<profile>[^\"]+)" profiletype\="(?<profile_type>[^\"]+)" profilegroup\="(?<profilegroup>[^\"]+)" user\="(?<user>[^\"]+)" group="(?<group>[^\"]+)" agent\="(?<agent>[^\"]+)" from\="(?<from>[^\"]+)" to\="(?<to>[^\"]+)"

[extract_ips]
REGEX = (devname\=(?<device_name>\S+)|cluster_id\=(?<device_name>\S+)) device_id\=(?<serial>\S+) log_id\=(?<log_id>\S+) type\=ips subtype\=(?<subtype>\S+) pri\=(?<priority>\S+) severity\=(?<severity>\S+) carrier_ep\="(?<carrier_ep>[^\"]+)" profilegroup\="(?<profilegroup>[^\"]+)" profiletype\="(?<profile_type>[^\"]+)" profile\="(?<profile>[^\"]+)" src\=(?<src_ip>\S+) dst\=(?<dst_ip>\S+) src_int\="(?<source_interface>[^\"]+)" dst_int\="(?<destination_interface>[^\"]+)" policyid\=(?<policyid>\S+) identidx\=(?<identidx>\S+) serial\=(?<serial>\S+) status\=(?<action>\S+) proto\=(?<proto_ip>\S+) service\=(?<service>\S+) vd\="(?<vdom>[^\"]+)" count\=(?<count>\S+) (attack_name\=(?<attack_name>\S+) |)src_port\=(?<src_port>\S+) dst_port\=(?<dst_port>\S+) attack_id\=(?<attack_id>\S+) sensor\="(?<sensor>[^\"]+)" ref\="(?<ref>[^\"]+)" user\="(?<user>[^\"]+)" group="(?<group>[^\"]+)" incident_serialno\=(?<incident_serialno>\S+) msg\="(?<description>[^\"]+)"

[extract_app-ctrl]
REGEX = (devname\=(?<device_name>\S+)|cluster_id\=(?<device_name>\S+)) device_id\=(?<serial>\S+) log_id\=(?<log_id>\S+) (type\=app-ctrl|subtype\=(?<subtype>\S+)) (subtype\=(?<subtype>\S+)|type\=app-ctrl) (timestamp=(?<timestamp>\S+) |)pri\=(?<priority>\S+) (user=(?<user>\S+) group=(?<group>\S+) profile=(?<profile>\S+) src\=(?<src_ip>\S+) src_port\=(?<src_port>\S+) src_int\=(?<src_interface>\S+) dst\=(?<dst_ip>\S+) dst_port\=(?<dst_port>\S+) dst_int\=(?<dst_interface>\S+) src_name=(?<src_name>\S+) dst_name\=(?<dst_name>\S+) proto\=(?<proto_ip>\S+) service\=(?<service>\S+) policyid\=(?<policyid>\S+) serial\=(?<serial>\S+) app_list\=(?<app_list>\S+) app_type\=(?<app_type>\S+) app=(?<app>\S+) action=(?<action>\S+) count=(?<count>\S+) filesize=(?<filesize>\S+) msg\="(?<description>[^\"]+)" vd=(?<vdom>\S+) attack_id=(?<attack_id>\S+) profiletype=(?<profiletype>\S+) profilegroup=(?<profilegroup>\S+) identidx\=(?<identidx>\S+) hostname\=(?<hostname>\S+) url\=(?<url>\S+)|vd\="(?<vdom>[^\"]+)" attack_id\=(?<attack_id>\S+) user\="(?<user>[^\"]+)" group="(?<group>[^\"]+)" src\=(?<src_ip>\S+) src_port\=(?<src_port>\S+) src_int\="(?<src_interface>[^\"]+)" dst\=(?<dst_ip>\S+) dst_port\=(?<dst_port>\S+) dst_int\="(?<dst_interface>[^\"]+)" src_name\="(?<src_name>[^\"]+)" dst_name\="(?<dst_name>[^\"]+)" profilegroup\="(?<profilegroup>[^\"]+)" profiletype\="(?<profile_type>[^\"]+)" profile\="(?<profile>[^\"]+)" proto\=(?<proto_ip>\S+) service\=(?<service>\S+) policyid\=(?<policyid>\S+) identidx\=(?<identidx>\S+) serial\=(?<serial>\S+) app_list\="(?<app_list>[^\"]+)" app_type\="(?<app_type>[^\"]+)" app\="(?<application>[^\"]+)" action\=(?<action>\S+) count\=(?<count>\S+) hostname\=(?<hostname>\S+) url\=(?<url>\S+) msg\="(?<description>[^\"]+)")

[extract_webfilter]
REGEX = (devname\=(?<device_name>\S+)|cluster_id\=(?<device_name>\S+)) (dstname\=(?<dstname>\S+) |)device_id\=(?<serial>\S+) log_id\=(?<log_id>\S+) (type\=webfilter subtype\=(?<subtype>\S+)|subtype\=(?<subtype>\S+) type\=webfilter) (timestamp=(?<timestamp>\S+) |)pri\=(?<priority>\S+) vd\=(?<vdom>\S+) policyid\=(?<policyid>\S+) (identidx\=(?<identidx>\S+) |)serial\=(?<serial>\S+) (user\=(?<user>\S+) group=(?<group>\S+) src\=(?<source_ip>\S+) sport\=(?<sport>\S+) src_int\=(?<source_interface>\S+) dst\=(?<destination_ip>\S+) dport\=(?<dport>\S+) dst_int\=(?<destination_interface>\S+) service\=(?<service>\S+) hostname\=(?<site>\S+) profile\=(?<profile>\S+) status\=(?<status>\S+) req_type\=(?<req_type>\S+) url\=(?<url>\S+) msg\="(?<description>[^\"]+)" method\=(?<method>\S+) class\=(?<class>\S+) class_desc\=(?<class_desc>\S+) cat\=(?<cat>\S+) cat_desc\="(?<categorization>[^\"]+)" ovrd_id\=(?<ovrd_id>\S+) count\=(?<count>\S+) src_port\=(?<src_port>\S+) dst_port\=(?<destination_port>\S+) urlfilter_idx\=(?<urlfilter_idx>\S+) quota_used\=(?<quota_used>\S+) quota_max\=(?<quota_max>\S+) profiletype\=(?<profiletype>\S+) profilegroup\=(?<profilegroup>\S+) identidx\=(?<identidx>\S+) sent\=(?<bytes_sent>\S+) rcvd\=(?<bytes_received>\S+)|user\="(?<user>[^\"]+)" group="(?<group>[^\"]+)" src\=(?<source_ip>\S+) sport\=(?<sport>\S+) src_port\=(?<src_port>\S+) src_int\="(?<source_interface>[^\"]+)" dst\=(?<destination_ip>\S+) dport\=(?<dport>\S+) dst_port\=(?<destination_port>\S+) dst_int\="(?<destination_interface>[^\"]+)" service\="(?<service>[^\"]+)" hostname\=(?<site>\S+) carrier_ep\="(?<carrier_ep>[^\"]+)" profiletype\="(?<profile_type>[^\"]+)" profilegroup\="(?<profilegroup>[^\"]+)" profile\="(?<profile>[^\"]+)" status\="(?<status>[^\"]+)" req_type\="(?<req_type>[^\"]+)" url\="(?<url>[^\"]+)" sent\=(?<bytes_sent>\S+) rcvd\=(?<bytes_received>\S+) msg\="(?<description>[^\"]+)" method\=(?<method>\S+) class\=(?<class>\S+) class_desc\="(?<class_desc>[^\"]+)" cat\=(?<cat>\S+) cat_desc\="(?<categorization>[^\"]+)"|(user\=(?<user>\S+)|user\="(?<user>[^\"]+)") (group=(?<group>\S+)|group\="(?<group>[^\"]+)") src\=(?<source_ip>\S+) sport\=(?<sport>\S+) (src_port\=(?<src_port>\S+) |)(src_int\=(?<source_interface>\S+)|src_int\="(?<source_interface>[^\"]+)") dst\=(?<destination_ip>\S+) dport\=(?<dport>\S+) (dst_port\=(?<dst_port>\S+) |)(dst_int\=(?<destination_interface>\S+)|dst_int\="(?<destination_interface>[^\"]+)") (service\=(?<service>\S+)|service\="(?<service>[^\"]+)") (hostname\=(?<site>\S+)|hostname\="(?<site>[^\"]+)") (profiletype\="(?<profiletype>[^\"]+)" |)(profilegroup\="(?<profilegroup>[^\"]+)" |)(profile\=(?<profile>\S+)|profile\="(?<profile>[^\"]+)") (status\=(?<status>\S+)|status\="(?<status>[^\"]+)") (req_type\=(?<req_type>\S+)|req_type\="(?<req_type>[^\"]+)") (url\=(?<url>\S+)|url\="(?<url>[^\"]+)") msg\="(?<description>[^\"]+)" method\=(?<method>\S+) class\=(?<class>\S+) (class_desc\=(?<class_desc>\S+)|class_desc\="(?<class_desc>[^\"]+)") cat\=(?<cat>\S+) cat_desc\="(?<categorization>[^\"]+)")

[extract_event_dhcp]
REGEX = (devname\=(?<device_name>\S+)|cluster_id\=(?<device_name>\S+)) device_id=(?<serial>\S+) log_id=(?<log_id>\S+) (type=event subtype=dhcp|subtype=dhcp type=event) (timestamp=(?<timestamp>\S+) |)pri\=(?<priority>\S+) vd=(?<vdom>\S+) (policyid=(?<policyid>\S+) msg\="(?<message>[^\"]+)" session_id=(?<session_id>\S+).*ip\=(?<client_ip>\S+).*mac\=(?<mac_address>\S+).*hostname\=(?<client_hostname>\S+).*dir\=(?<direction>\S+).*|dhcp_msg\="(?<dhcp_message>[^\"]+)" dir\=(?<direction>\S+) mac\=(?<mac_address>\S+) ip\=(?<client_ip>\S+) lease\=(?<lease>\S+) hostname\="(?<client_hostname>[^\"]+)" msg\="(?<message>[^\"]+)")

[extract_event_pattern]
REGEX = date=(?<date>\S+) time=(?<time>\S+) devname=(?<device_name>\S+) device_id=(?<serial>\S+) log_id=(?<log_id>\S+) type=event subtype=pattern pri=(?<priority>\S+) vd=(?<vdom>\S+) status\=(?<status>\S+) virdb\=(?<virdb>\S+) idsdb\=(?<idsdb>\S+) libav\=(?<libav>\S+) aven\=(?<aven>\S+) imap\=(?<imap>\S+) smtp\=(?<smtp>\S+) pop3\=(?<pop3>\S+) http\=(?<http>\S+) ftp\=(?<ftp>\S+) fcni\=(?<fcni>\S+) fdni\=(?<fdni>\S+) idsmn\=(?<idsmn>\S+) idssn\=(?<idssn>\S+) msg\="(?<message>[^\"]+)"

[extract_event_his-performance]
REGEX = (devname\=(?<device_name>\S+)|cluster_id\=(?<device_name>\S+)) device_id=(?<serial>\S+) log_id=(?<log_id>\S+) type=event subtype=(?<subtype>\S+) pri=(?<priority>\S+) vd="(?<vdom>[^\"]+)" action\=(?<action>\S+) cpu\=(?<cpu>\S+) mem\=(?<memory>\S+) total_session\=(?<simultaneous_sessions>\S+) msg\="(?<message>[^\"]+)"

[extract_auth_captive_portal]
REGEX = date=(?<date>\S+) time=(?<time>\S+) devname=(?<device_name>\S+) device_id=(?<serial>\S+) log_id=(?<log_id>\S+) type=event subtype=auth pri=(?<severity>\S+) vd="(?<vdom>[^\"]+)" src\=(?<source_ip>\S+) dst\=(?<destination_ip>\S+) policyid\=(?<policy_id>\S+) user\="(?<user>[^\"]+)" group\="(?<group>[^\"]+)" ui\="(?<ui>[^\"]+)" action\=(?<action>\S+) status\=(?<status>\S+) reason\="(?<reason>[^\"]+)" msg\="(?<message>[^\"]+)"

[extract_sslvpn]
REGEX = date=(?<date>\S+) time=(?<time>\S+) devname=(?<device_name>\S+) device_id=(?<serial>\S+) log_id=(?<log_id>\S+) type=event subtype\=(?<ssl_subtype>\S+) pri=(?<severity>\S+) action\=(?<action>\S+) tunnel_type\=(?<tunnel_type>\S+) vd\="(?<vdom>[^\"]+)" tunnel_id\=(?<tunnel_id>\S+) remote_ip\=(?<source_ip>\S+) tunnel_ip\=(?<tunnel_ip>\S+) user\="(?<user>[^\"]+)" group\="(?<group>[^\"]+)" dst_host\="(?<dst_host>[^\"]+)" reason\="(?<reason>[^\"]+)" (duration\=(?<duration>\S+) sent\=(?<bytes_sent>\S+) rcvd\=(?<bytes_received>\S+)|).*msg\="(?<message>[^\"]+)"

