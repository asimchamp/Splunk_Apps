Copyright (C) 2005-2012 Splunk Inc. All Rights Reserved.

Add-on:            Splunk app for RedHat CloudForms
Current Version:   1.0
Last Modified:     2012-06-20
Splunk Version:    4.3 and higher
Author:            Splunk, Inc. & RedHat, Inc. 

The Splunk app for RedHat Cloud Forms provides the reports, dashboards and field extractions necessary to monitor analyze and measure your CloudForm usage.


#################################################################
#
# Configuring Splunk to Recieve CloudForm Logs
#
#################################################################

1. Create a TCP Data Input and set the sourcetype to: Redhat:CloudForm:Events

http://docs.splunk.com/Documentation/Splunk/latest/Data/Monitornetworkports


#################################################################
#
# Configuring RedHat Cloud Forms Logging
#
#################################################################

Here are the instructions for setting up the CloudForms Cloud Engine Host.

This assumes that Splunk is accepting connections from the CloudForms Cloud Engine server on TCP port 514. If required, you can change this port by appending ":port" to the Splunk servers fully qualified domain name in step 2.

1. Backup the rsyslog.conf file.

   cp /etc/rsyslog.conf /etc/rsyslog.bak


2. Edit the rsyslog.conf file and configure forwarding of CloudForms messages to the Splunk Server.

   vi /etc/rsyslog.conf

3. Insert the following lines after the end of the current rules substituting the hostname of your splunk server for splunk.domain.com.

   #### CLOUUDFORMS RULES ####

   #Forward messages containing the string "deployment_id" via TCP to Splunk Server
   :msg, contains, "deployment_id"                         @@splunk.domain.com


3. Reload the rsyslog service

   service rsyslog reload

You can verify that messages are being forwarded properly without launching AppForms in CloudForms by executing the following and watching source="tcp:514" in the Splunk Search view.

logger testing deployment_id rules are working

If the rules are working properly you will see the message appear in Splunk. If you do not see the message appear, check to ensure iptables is not blocking the required ports and also verify the syslog rules.