<setup>

  <block title=""
         endpoint="estreamer/configuration" entity="estreamer">

    <text><![CDATA[<p/><h1 style="margin: 0px 0px 6px 0px; padding: 0;">eStreamer for Splunk: Settings</h1>]]></text>

    <text><![CDATA[<p/><legend style="margin: 15px 0px 6px 0px; padding: 0;">eStreamer Client</legend>]]></text>

    <input field="client_disabled">
      <label><![CDATA[<b>Disable eStreamer client</b>]]></label>
      <type>bool</type>
    </input>
    <text>The eStreamer client should remain disabled until configured. If running, it may take a
     minute or two for the eStreamer client to stop once disabled.</text>

    <text><![CDATA[<p/><legend style="margin: 15px 0px 6px 0px; padding: 0;">Defense Center Connection Details</legend>]]></text>

    <input field="server">
      <label>Defense Center hostname or IP address</label>
      <type>text</type>
    </input>

    <input field="ipv6">
      <label>Use IPv6 for communications (requires appropriate Perl modules)</label>
      <type>bool</type>
    </input>

    <input field="port">
      <label>eStreamer port (default: 8302)</label>
      <type>text</type>
    </input>

    <input field="pkcs12_file">
      <label>Certificate path and filename</label>
      <type>text</type>
    </input>

    <input field="pkcs12_password">
      <label>Certificate password (optional)</label>
      <type>password</type>
    </input>

    <text><![CDATA[<p/><legend style="margin: 15px 0px 6px 0px; padding: 0;">Logging Options</legend>]]></text>

    <input field="log_extra_data">
      <label>Log Extra Data</label>
      <type>bool</type>
    </input>
    <text>Extra data logs provide additional context, such as URLs, for intrusion events.</text>

    <input field="log_packets">
      <label>Log packets</label>
      <type>bool</type>
    </input>
    <text>Packet logs can be a huge consumer of disk space on the Splunk server.</text>

    <input field="log_flows">
      <label>Log flows</label>
      <type>bool</type>
    </input>
    <text>This is a high-volume option and may cause processing latency in the eStreamer client.</text>

    <input field="log_metadata">
      <label>Log metadata</label>
      <type>bool</type>
    </input>
    <text>Metadata logs are not event-driven, but can sometimes prove informative.</text>

    <text><![CDATA[<p/><legend style="margin: 15px 0px 6px 0px; padding: 0;">Advanced Options</legend>]]></text>

    <input field="watch">
      <label>eStreamer client lives and dies with Splunk</label>
      <type>bool</type>
    </input>
    <text>If unchecked, the eStreamer will continue to collect logs even after Splunk stops.</text>

    <input field="debug">
      <label>Verbose, debug-style logging</label>
      <type>bool</type>
    </input>
    <text>Verbose logging for the eStreamer client to file: $APP_PATH/bin/estreamer_debug.log</text>

  </block>

</setup>
