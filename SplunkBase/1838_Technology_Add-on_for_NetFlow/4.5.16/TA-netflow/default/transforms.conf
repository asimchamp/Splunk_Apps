#
# Copyright (C) 2015 NetFlow Logic
# All rights reserved.
#
# These coded instructions and statements contain unpublished trade
# secrets and proprietary information. They are protected by federal
# copyright law and by trade secret law, and may not be disclosed to
# third parties or used, copied, reverse engineered, decompiled, or
# duplicated in any form, in whole or in part, without the prior
# written consent of NetFlow Logic.
#

[SRCIP6Extraction]
REGEX = (?i) src_ip6=(?P<src_ip>[^ ]+)
WRITE_META = true
FORMAT = src_ip::$1

[DESTIP6Extraction]
REGEX = (?i) dest_ip6=(?P<dest_ip>[^ ]+)
WRITE_META = true
FORMAT = dest_ip::$1

[EXPIP6Extraction]
REGEX = (?i) exp_ip6=(?P<exp_ip>[^ ]+)
WRITE_META = true
FORMAT = exp_ip::$1

[ta_netflow_protocol_lookup]
filename = ta_netflow_protocols.csv

[nfc_lookup]
filename = nfc_id.csv
max_matches = 1
min_matches = 1
default_match = unknown

[protocol_ts]
REGEX = (?i) protocol=(?P<protocol_ts>[^ ]+)
WRITE_META = true
FORMAT = protocol_ts::$1

[nfc_id]
REGEX = (?i) nfc_id=(?P<nfc_id>[^ ]+)
WRITE_META = true
FORMAT = nfc_id::$1

[nfo_hostname]
REGEX = (?:(?:\w{3}\s+\d{1,2}\s\d{2}:\d{2}:\d{2})|(?:1?\s?\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}.{1}\d{2}:\d{2}))\s+(?P<nfo_hostname>[^ ]+)\s+(?:[^ ]+)?\s?(?:nfc_id|NFO)
WRITE_META = true
FORMAT = nfo_hostname::$1


[metric-schema:netflow_metrics]
METRIC-SCHEMA-MEASURES = _NUMS_EXCEPT_ nfc_id,src_port,src_asn,src_tos,src_vlan,dest_port,dest_asn,dest_tos,dest_vlan,protocol,input_snmp,output_snmp,ifIndex,ifName,ifType,ifDescr,row_num

[extract_all_fields]
REGEX = \"([^\"]+)"\:\s+\"([^\"]+)\"
FORMAT = $1::$2
REPEAT_MATCH = true
WRITE_META = true

[direction]
REGEX = (?i) direction\s?=\s?\"(?P<direction>[^\"]+)\"
WRITE_META = true
FORMAT = direction::$1

[threat_list_name]
REGEX = (?i) threat_list_name\s?=\s?\"(?P<threat_list_name>[^\"]+)\"
WRITE_META = true
FORMAT = threat_list_name::$1

[app_name]
REGEX = (?i) app_name\s?=\s?\"(?P<app_name>[^\"]+)\"
WRITE_META = true
FORMAT = app_name::$1

[username]
REGEX = (?i) username\s?=\s?\"(?P<username>[^\"]+)\"
WRITE_META = true
FORMAT = username::$1

[idp]
REGEX = (?i) idp\s?=\s?\"(?P<idp>[^\"]+)\"
WRITE_META = true
FORMAT = idp::$1

[action]
REGEX = (?i) action\s?=\s?\"(?P<action>[^\"]+)\"
WRITE_META = true
FORMAT = action::$1

[flow_type]
REGEX = (?i) flow_type\s?=\s?\"(?P<flow_type>[^\"]+)\"
WRITE_META = true
FORMAT = flow_type::$1

[reputation]
REGEX = (?i) reputation\s?=\s?\"(?P<reputation>[^\"]+)\"
WRITE_META = true
FORMAT = reputation::$1
