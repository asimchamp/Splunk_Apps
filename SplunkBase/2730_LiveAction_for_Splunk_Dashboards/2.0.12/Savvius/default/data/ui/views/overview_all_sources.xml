<form script="overview_all_sources.js" stylesheet="overview_all_sources.css">
  <label>Sources</label>
  <fieldset autorun="true" submitButton="false">
    <!-- Global timer. Not token is necessary -->
    <input type="time" searchWhenChanged="true">
      <label>Date &amp; Time</label>
      <default>
        <earliest>-1h@h</earliest>
        <latest>now</latest>
      </default>
    </input>
  </fieldset>
  <row depends="$version63$">
    <panel>
      <search>
        <query>index=_audit action=alert_fired
          | regex ss_name="^.*\[.*\]$"
          | appendpipe [stats count as no_event | where no_event==0 | eval ss_name="No Alerts" | eval triggered_alerts=0 | eval severity=0]
          | stats sum(triggered_alerts) as total_triggered_alerts max(severity) as max_severity by ss_name
          | eval iconname=case(max_severity&gt;=5, "icon-alert-circle", max_severity&gt;=3, "icon-alert", max_severity&lt;3, "icon-check-circle")
          | sort -max_severity, -total_triggered_alerts | head 1
          | rangemap field=max_severity low=0-2 elevated=3-4 severe=5-5 default=severe</query>
        <preview>
          <set token="alertname">$result.ss_name$</set>
          <set token="severityrange">$result.range$</set>
          <set token="iconname">$result.iconname$</set>
        </preview>
      </search>
      <html>
        <div class="custom-result-value">
          <i class="custom-result-value $iconname$ $severityrange$ highlighted" title="$severityrange$">$alertname$</i>
        </div>
      </html>
    </panel>
  </row>
  <row depends="$version62$">
    <single>
      <searchString>index=_audit action=alert_fired
          | regex ss_name="^.*\[.*\]$"
          | appendpipe [stats count as no_event | where no_event==0 | eval ss_name="No Alerts" | eval triggered_alerts=0 | eval severity=0]
          | stats sum(triggered_alerts) as total_triggered_alerts max(severity) as max_severity by ss_name
          | eval iconname=case(max_severity&gt;=5, "icon-alert-circle", max_severity&gt;=3, "icon-alert", max_severity&lt;3, "icon-check-circle")
          | sort -max_severity, -total_triggered_alerts | head 1
          | rangemap field=max_severity low=0-2 elevated=3-4 severe=5-5 default=severe</searchString>
      <option name="classField">range</option>
      <option name="field">ss_name</option>
    </single>
  </row>
  <row>
    <panel>
      <table id="table1">
        <title>Source List</title>
        <search>
          <query>| multisearch
            [search sourcetype=sv_summaries Statistic="Average Utilization (bits/s)" | eval mbps=(Bytes/1000000) | fields host, mbps | rename mbps as Utilization]
            [search sourcetype=sv_summaries Statistic="Total Packets" | fields host, Packets | rename Packets as "Received Packets"]
            [search sourcetype=sv_summaries Statistic="Dropped Packets" | regex source!="^.*/Splunk Expert (Auto){0,1} Capture/.*$" | fields host, Bytes | rename Bytes as "Unanalyzed Packets"]
            [search sourcetype=sv_summaries Statistic="Events - Severe" | fields host, Bytes | rename Bytes as Events]
            [search sourcetype=sv_summaries Statistic="TCP Too Many Retransmissions" | fields host, Bytes | rename Bytes as Retransmissions]
            [search sourcetype=sv_appresponse | fields host, "Avg Response Time" | rename "Avg Response Time" as "Average Application Response Time"]
            [search sourcetype=sv_flows | fields host, "Avg Response Time" | rename "Avg Response Time" as "Average Flow Response Time"]
            [search index=_audit action=alert_fired | rename host as host2 | rex field=ss_name "^.*\[(?P&lt;host&gt;.*)\]$" | fields host, severity]
            | eventstats sum("Received Packets") as totalReceivedPackets by host
            | eventstats sum("Unanalyzed Packets") as totalUnanalyzedPackets by host
            | eventstats max(severity) as max_severity by host
            | eval totalPackets=totalReceivedPackets+totalUnanalyzedPackets
            | eval percentPacketsUnanalyzed=round((totalUnanalyzedPackets/totalPackets)*100, 2)
            | eval percentPacketsUnanalyzed=percentPacketsUnanalyzed + "%"
            | fillnull value=0 max_severity
            | rex field="Average Application Response Time" "((?&lt;aarthour&gt;[0-9]{2}){1}:(?&lt;aartminute&gt;[0-9]{2}){1}:){0,1}(?&lt;aartsecond&gt;[0-9]{1,2}){1}\.(?&lt;aartmicrosecond&gt;[0-9]{6}){1}"
            | rex field="Average Flow Response Time" "((?&lt;afrthour&gt;[0-9]{2}){1}:(?&lt;afrtminute&gt;[0-9]{2}){1}:){0,1}(?&lt;afrtsecond&gt;[0-9]{1,2}){1}\.(?&lt;afrtmicrosecond&gt;[0-9]{6}){1}"
            | fillnull value=0 aarthour aartminute aartsecond aartmicrosecond afrthour afrtminute afrtsecond afrtmicrosecond
            | eval aart=if(isnull('Average Application Response Time') AND (aarthour==0) AND (aartminute==0) AND (aartsecond==0) AND (aartmicrosecond==0),null,(aarthour*3600)+(aartminute*60)+aartsecond+(aartmicrosecond/1000000))
            | eval afrt=if(isnull('Average Flow Response Time') AND (afrthour==0) AND (afrtminute==0) AND (afrtsecond==0) AND (afrtmicrosecond==0),null,(afrthour*3600)+(afrtminute*60)+afrtsecond+(afrtmicrosecond/1000000))
            | stats sparkline(avg(Utilization)) as "Average Network Utilization (Mb)" avg(Utilization) as "Average Mbps" sum("Received Packets") as "Received Packets" sum("Unanalyzed Packets") as "Unanalyzed Packets" values(percentPacketsUnanalyzed) as "% Packets Unanalyzed" sparkline(sum(Events)) as "Severe Expert Events Trend" sum(Events) as "Severe Expert Events" sum(Retransmissions) as "TCP Too Many Retransmissions" avg(aart) as "Average Application Response Time (Seconds)" avg(afrt) as "Average Flow Response Time (Seconds)" values(max_severity) as max_severity2 by host
            | rangemap field=max_severity2 low=0-2 elevated=3-4 severe=5-5 default=severe
            | fields - max_severity2
            | rename range as Alerts
            | rename host as Source
            | fieldformat "Average Mbps"=round('Average Mbps', 2)
            | fieldformat "Received Packets"=tostring('Received Packets', "commas")
            | fieldformat "Unanalyzed Packets"=tostring('Unanalyzed Packets', "commas")
            | fieldformat "Severe Expert Events"=tostring('Severe Expert Events', "commas")
            | fieldformat "TCP Too Many Retransmissions"=tostring('TCP Too Many Retransmissions', "commas")
            | fieldformat "Average Application Response Time (Seconds)"=round('Average Application Response Time (Seconds)', 2)
            | fieldformat "Average Flow Response Time (Seconds)"=round('Average Flow Response Time (Seconds)', 2)
            | sort -Alerts, +Source</query>
          <earliest>$earliest$</earliest>
          <latest>$latest$</latest>
        </search>
        <option name="wrap">true</option>
        <option name="rowNumbers">false</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">cell</option>
        <option name="count">50</option>
        <drilldown>
          <condition field="Source">
            <link>
              <![CDATA[
		  			overview_network?earliest=$earliest$&latest=$latest$&form.source=$click.value2$
	  			]]>
            </link>
          </condition>
          <condition field="Average Network Utilization (Mb)">
            <link>
              <![CDATA[
		  			overview_network?earliest=$earliest$&latest=$latest$&form.source=$click.value$
	  			]]>
            </link>
          </condition>
          <condition field="Average Mbps">
            <link>
              <![CDATA[
		  			overview_network?earliest=$earliest$&latest=$latest$&form.source=$click.value$
	  			]]>
            </link>
          </condition>
          <condition field="Received Packets">
            <link>
              <![CDATA[
		  			overview_network?earliest=$earliest$&latest=$latest$&form.source=$click.value$
	  			]]>
            </link>
          </condition>
          <condition field="Unanalyzed Packets">
            <link>
              <![CDATA[
		  			overview_network?earliest=$earliest$&latest=$latest$&form.source=$click.value$
	  			]]>
            </link>
          </condition>
          <condition field="Severe Expert Events">
            <link>
              <![CDATA[
		  			events_expert_events?earliest=$earliest$&latest=$latest$&form.source=$click.value$&form.severity=Severe
	  			]]>
            </link>
          </condition>
          <condition field="Severe Expert Events Trend">
            <link>
              <![CDATA[
		  			events_expert_events?earliest=$earliest$&latest=$latest$&form.source=$click.value$&form.severity=Severe
	  			]]>
            </link>
          </condition>
          <condition field="TCP Too Many Retransmissions">
            <link>
              <![CDATA[
		  			events_expert_events?earliest=$earliest$&latest=$latest$&form.source=$click.value$
	  			]]>
            </link>
          </condition>
          <condition field="Average Application Response Time (Seconds)">
            <link>
              <![CDATA[
		  			latency_application_response_times?earliest=$earliest$&latest=$latest$&form.source=$click.value$
	  			]]>
            </link>
          </condition>
          <condition field="Average Flow Response Time (Seconds)">
            <link>
              <![CDATA[
		  			latency_flow_response_times?earliest=$earliest$&latest=$latest$&form.source=$click.value$
	  			]]>
            </link>
          </condition>
        </drilldown>
      </table>
    </panel>
  </row>
</form>