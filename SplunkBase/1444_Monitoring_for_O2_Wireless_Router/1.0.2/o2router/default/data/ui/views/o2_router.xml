<?xml version='1.0' encoding='utf-8'?>
<dashboard refresh="900">
  <label>O2 Router Stats</label>
  <row>
    <chart>
      <searchString>"xDSL linestate up" | rex field=_raw "downstream: (?&lt;Down&gt;\d+) \S+ upstream: (?&lt;Up&gt;\d+)" | timechart span=1h avg(Down) min(Down) max(Down) avg(Up) min(Up) max(Up)</searchString>
      <title>DSL Sync Speed (Last 12 Days)</title>
      <earliestTime>-12d@h</earliestTime>
      <latestTime>now</latestTime>
      <option name="charting.axisTitleX.text">Date</option>
      <option name="charting.chart">line</option>
      <option name="charting.chart.nullValueMode">gaps</option>
      <option name="charting.chart.stackMode">default</option>
      <option name="charting.layout.splitSeries">false</option>
      <option name="charting.legend.placement">none</option>
      <option name="charting.primaryAxisTitle.text"/>
      <option name="charting.secondaryAxisTitle.text">kbit/s</option>
    </chart>
  </row>
  <row>
    <chart>
      <searchString>"xDSL linestate up" | rex field=_raw "snr Margin Down: (?&lt;Down&gt;\S+) dB, Up: (?&lt;Up&gt;\S+) dB" | timechart span=1h avg(Down) min(Down) max(Down) avg(Up) min(Up) max(Up)</searchString>
      <title>DSL SNR Margin (Last 12 Days)</title>
      <earliestTime>-12d@h</earliestTime>
      <latestTime>now</latestTime>
      <option name="charting.axisLabelsY.majorUnit"/>
      <option name="charting.axisTitleX.text">Date</option>
      <option name="charting.axisTitleY.text">dB</option>
      <option name="charting.axisY.maximumNumber"/>
      <option name="charting.axisY.minimumNumber"/>
      <option name="charting.axisY.scale">linear</option>
      <option name="charting.chart">line</option>
      <option name="charting.chart.nullValueMode">gaps</option>
      <option name="charting.legend.placement">bottom</option>
      <option name="charting.primaryAxisTitle.text"/>
      <option name="charting.secondaryAxis.maximumNumber"/>
      <option name="charting.secondaryAxis.minimumNumber"/>
      <option name="charting.secondaryAxis.scale">linear</option>
      <option name="charting.secondaryAxisTitle.text"/>
      <option name="count">10</option>
      <option name="displayRowNumbers">true</option>
    </chart>
  </row>
  <row>
    <chart>
      <searchString>"xDSL linestate up" | rex field=_raw "downstream: (?&lt;Down&gt;\d+) \S+ upstream: (?&lt;Up&gt;\d+)" | head 1  | stats values(Down) as Downstream </searchString>
      <title>Current Downstream DSL Sync Speed</title>
      <earliestTime>-1h@m</earliestTime>
      <latestTime>now</latestTime>
      <option name="charting.chart">radialGauge</option>
      <option name="charting.chart.rangeValues">[0,5000,8000,12000,20000]</option>
      <option name="charting.chart.style">shiny</option>
      <option name="charting.gaugeColors">[0xd13b3b,0xebe42d,0x324969,0x7e9f44]</option>
      <option name="count">10</option>
      <option name="displayRowNumbers">true</option>
    </chart>
    <chart>
      <searchString>"xDSL linestate up" | rex field=_raw "downstream: (?&lt;Down&gt;\d+) \S+ upstream: (?&lt;Up&gt;\d+)" | head 1  | stats values(Up) as Upstream </searchString>
      <title>Current Upstream DSL Sync Speed</title>
      <earliestTime>-1h@m</earliestTime>
      <latestTime>now</latestTime>
      <option name="charting.chart">radialGauge</option>
      <option name="charting.chart.rangeValues">[0,500,800,1300,2000]</option>
      <option name="charting.chart.style">shiny</option>
      <option name="charting.gaugeColors">[0xd13b3b,0xebe42d,0x324969,0x7e9f44]</option>
      <option name="count">10</option>
      <option name="displayRowNumbers">true</option>
    </chart>
  </row>
  <row>
    <table>
      <searchString>"xDSL linestate up" | rex field=_raw "downstream: (?&lt;Downstream&gt;\d+) \S+ upstream: (?&lt;Up&gt;\d+)" | bucket _time span=1d | eval date=strftime(_time,"%Y-%m-%d") | stats max(Downstream) min(Downstream) by date</searchString>
      <title>Max/Min DSL Sync Downstream (Last 7 Days)</title>
      <earliestTime>-7d@h</earliestTime>
      <latestTime>now</latestTime>
      <option name="count">50</option>
      <option name="dataOverlayMode">highlow</option>
      <option name="displayRowNumbers">false</option>
    </table>
    <table>
      <searchString>"xDSL linestate up" | rex field=_raw "downstream: (?&lt;Downstream&gt;\d+) \S+ upstream: (?&lt;Upstream&gt;\d+)" | bucket _time span=1d | eval date=strftime(_time,"%Y-%m-%d") | stats max(Upstream) min(Upstream) by date</searchString>
      <title>Max/Min DSL Sync Upstream (Last 7 Days)</title>
      <earliestTime>-7d@h</earliestTime>
      <latestTime>now</latestTime>
      <option name="count">50</option>
      <option name="dataOverlayMode">highlow</option>
      <option name="displayRowNumbers">false</option>
    </table>
  </row>
  <row>
    <table>
      <searchString>LOGIN OR LOGOUT| rex field=msg "(?&lt;action&gt;\S+) User (?&lt;username&gt;\S+) logged \w+ on \[?(?&lt;protocol&gt;\S+?)\]? \D+(?&lt;src_ip&gt;\d+\.\d+\.\d+\.\d+)" |transaction username src_ip maxpause=10m | eval date=strftime(_time,"%Y-%m-%d")| stats sparkline count values(action) as Actions values(duration) as Duration values(date) as Dates by username src_ip protocol</searchString>
      <title>Login Activity Details (Last 7 Days)</title>
      <earliestTime>-7d@h</earliestTime>
      <latestTime>now</latestTime>
      <option name="count">10</option>
      <option name="displayRowNumbers">false</option>
    </table>
  </row>
</dashboard>
