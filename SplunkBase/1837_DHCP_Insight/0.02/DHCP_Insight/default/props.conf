[dhcp]

# 2014-08-02 13:53:19.149204 ab:cd:ef:ab:cd:de > ff:ff:ff:ff:ff:ff, ethertype IPv4 (0x0800), length 342: (tos 0x0, ttl 64, id 1, offset 0, flags [none], proto UDP (17), length 328)
EXTRACT-dhcp-1 = ^\d\d\d\d\-\d\d\-\d\d \d\d:\d\d:\d\d\.\d\d\d\d+ (?<eth_src>[a-z0-9]{2}:[a-z0-9]{2}:[a-z0-9]{2}:[a-z0-9]{2}:[a-z0-9]{2}:[a-z0-9]{2}) > (?<eth_dst>[a-z0-9]{2}:[a-z0-9]{2}:[a-z0-9]{2}:[a-z0-9]{2}:[a-z0-9]{2}:[a-z0-9]{2}), .* proto UDP
#    0.0.0.0.68 > 255.255.255.255.67: BOOTP/DHCP, Request from ab:cd:ef:ab:cd:de, length 300, xid 0x3e9055, Flags [none]
#EXTRACT-dhcp-2 = ^\s+(?<ip_src>\d+\.\d+\.\d+\.\d+)\.(?<udp_srcport>\d+) > (?<ip_dst>\d+\.\d+\.\d+\.\d+)\.(?<udp_dstport>\d+): BOOTP/DHCP,  
EXTRACT-dhcp-2 = ^\s+(?<ip_src>\d+\.\d+\.\d+\.\d+)\.(?<udp_srcport>\d+) > (?<ip_dst>\d+\.\d+\.\d+\.\d+)\.(?<udp_dstport>\d+): BOOTP/DHCP,
#          Client-Ethernet-Address ab:cd:ef:ab:cd:de
EXTRACT-dhcp-3 = ^\s+ Client-Ethernet-Address (?<client_mac_addr>[a-z0-9]{2}:[a-z0-9]{2}:[a-z0-9]{2}:[a-z0-9]{2}:[a-z0-9]{2}:[a-z0-9]{2})
#          Vendor-rfc1048 Extensions
#            Magic Cookie 0x63825363
#            DHCP-Message Option 53, length 1: Request
EXTRACT-dhcp-53 = ^\s+ DHCP-Message Option 53, length 1: (?<dhcp_message>\w+)            
#            Vendor-Class Option 60, length 8: "MSFT 5.0"
#            Client-ID Option 61, length 7: ether ab:cd:ef:ab:cd:de
#            Requested-IP Option 50, length 4: 192.168.1.164
EXTRACT-dhcp-10 = ^\s+ Requested-IP Option 50, length \d+: (?P<requested_ip>\d+\.\d+\.\d+\.\d+)            
#            Hostname Option 12, length 5: "PC01"
EXTRACT-dhcp-11 = ^\s+ Hostname Option 12, length \d+: "(?P<hostname>[^"]+)"
#            Parameter-Request Option 55, length 9:
#              Domain-Name-Server, Default-Gateway, Subnet-Mask, Domain-Name
#              TFTP, BF, BS, Netbios-Name-Server
#              Hostname
EXTRACT-dhcp-12 = ^\s+ Parameter-Request Option 55, length \d+: (?P<requested_options>.*)


#2014-08-02 14:06:41.673351 ab:cd:ef:ab:cd:de > ab:cd:ef:ab:cd:de, ethertype IPv4 (0x0800), length 342: (tos 0x0, ttl 127, id 20196, offset 0, flags [none], proto UDP (17), length 328)
#    192.168.2.1.67 > 192.168.2.14.68: BOOTP/DHCP, Reply, length 300, xid 0x744e81fe, Flags [none]
#          Client-IP 192.168.2.1
EXTRACT-dhcp-ack-1 = ^\s+ Client-IP (?<ip_client>\d+\.\d+\.\d+\.\d+)          
#          Gateway-IP 192.168.2.254
EXTRACT-dhcp-ack-2 = ^\s+ Gateway-IP (?<ip_relay>\d+\.\d+\.\d+\.\d+)          
#          Client-Ethernet-Address ab:cd:ef:ab:cd:de
#          Vendor-rfc1048 Extensions
#            Magic Cookie 0x63825363
#            DHCP-Message Option 53, length 1: ACK
#            Server-ID Option 54, length 4: 192.168.2.10
EXTRACT-dhcp-o-54 = ^\s+ Server-ID Option 54, length 4: (?<server_id>\d+\.\d+\.\d+\.\d+)            
#            Subnet-Mask Option 1, length 4: 255.255.255.0
EXTRACT-dhcp-o-1  = ^\s+ Subnet-Mask Option 1, length 4: (?<subnet_mask>\d+\.\d+\.\d+\.\d+)            
#            Vendor-Option Option 43, length 11: x.x.x.x.x.x.x.x.x.x.x.x.x.x
#            Domain-Name Option 15, length 13: "local^@"
EXTRACT-dhcp-o-15 = ^\s+ Domain-Name Option 15, length \d+: "(?<domain_name>[^"]+)"            
#            Default-Gateway Option 3, length 4: 192.168.2.254
EXTRACT-dhcp-o-3  = ^\s+ Default-Gateway Option 3, length 4: (?<router>\d+\.\d+\.\d+\.\d+)            
#            Domain-Name-Server Option 6, length 8: 192.168.2.2,192.168.2.3
EXTRACT-dhcp-o-6  = ^\s+ Domain-Name-Server Option 6, length \d+: (?<domain_name_server>[\d\.,]+)            
#
