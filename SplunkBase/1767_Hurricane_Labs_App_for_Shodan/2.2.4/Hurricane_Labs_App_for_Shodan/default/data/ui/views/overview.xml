<form version="1.1" hideEdit="true" script="shodan.js" stylesheet="application.css">
  <label>Overview</label>
  <fieldset autoRun="true" submitButton="false">
    <input type="dropdown"  token="_ip" searchWhenChanged="true">
      <label>Select an IP Address:</label>
      <choice value="*">All</choice>
      <initialValue>*</initialValue>
      <fieldForLabel>ip_str</fieldForLabel>
      <fieldForValue>ip_str</fieldForValue>
      <search>
        <query> <![CDATA[| inputlookup shodan_output | dedup ip_str,port | stats count by ip_str]]></query>
        <earliest>-24h@h</earliest>
        <latest>now</latest>
      </search>
    </input>
  </fieldset>
  <row>
    <panel>
      <table depends="$loaded$">
        <title>Detailed View</title>
        <search base="baseSearch">
          <query>| table asn, cpe, data, domains, hostnames, ip, ip_str, isp, link, location, org, os, port, product, hostnames | fields - ip | rename asn AS ASN, cpe AS CPE, data AS Data, domains AS Domains, hostnames AS Hostnames, ip_str AS "IP Address", isp AS ISP, link AS Link, location AS Location, org AS Org, os AS OS, port AS Port, product AS Product, hostnames AS Hostnames</query>
        </search>
        <option name="wrap">true</option>
        <option name="rowNumbers">false</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">row</option>
        <option name="count">10</option>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <table depends="$loaded$">
        <title>Open Ports</title>
        <search base="baseSearch">
          <query>| table port, ip_str, hostnames | sort port | rename hostnames AS Hostnames, ip_str AS "IP Address", port AS Port</query>
        </search>
        <option name="wrap">true</option>
        <option name="rowNumbers">false</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">row</option>
        <option name="count">10</option>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <table depends="$loaded$">
        <title>Banners</title>
        <search base="baseSearch">
          <query>| table data, ip_str, hostnames | sort port | rename hostnames AS Hostnames, ip_str AS "IP Address", data AS Data</query>
        </search>
        <option name="wrap">true</option>
        <option name="rowNumbers">false</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">row</option>
        <option name="count">10</option>
      </table>
    </panel>
  </row>
</form>
