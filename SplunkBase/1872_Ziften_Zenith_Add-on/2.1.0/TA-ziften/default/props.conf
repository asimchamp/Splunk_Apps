[ziften:zenith:hec]
TRANSFORMS-SourceType = ActiveX, AgentCommandResponse, AgentMessage, AgentStatus, AppStartTime, AutoStarts, Binary, BootAnalysis, BootInfo, BootProfile, EventLogRecord, FileContents, InstalledPrograms, InterferingProcess, LogonFailure, LogonNotifications, NetworkConnect, NetworkConnectSecondary, ODBCDrivers, ProcessCreated, ProcessInventory, ProcessModuleLoad, ProcessTerminated, ResourceUsage, RunningProcessesSummary, Services, ShutdownProfile, SystemInventory, SystemInventoryDiskDrives, SystemInventoryLogicalDisks, SystemInventoryNetworkAdapters, UserAccounts, WindowsUpdateServers, WindowsUpdateSettings, WindowsUpdateAvailable

[ziften:zenith:activex]
SHOULD_LINEMERGE = false

[ziften:zenith:appstarttime]
FIELDALIAS-dest = agentguid AS dest
### Optional ALIAS statements ###
FIELDALIAS-user = accountname AS user
FIELDALIAS-process_id = process_id AS pid

[ziften:zenith:bootanalysis]
SHOULD_LINEMERGE = false

[ziften:zenith:systeminventory]
FIELDALIAS-dest = computername AS dest
FIELDALIAS-description = computermodel as description
FIELDALIAS-enabled = "true"
FIELDALIAS-family = computermanufacturer as product
FIELDALIAS-product = baseboardproduct as product
FIELDALIAS-vendor = computermanufacturer as vendor
### CPU
FIELDALIAS-cpu_cores = numberofcores AS cpu_cores
FIELDALIAS-cpu_count = numberoflogicalprocessors AS cpu_count
#EVAL-cpu_mhz = cpu_mhz/1000
FIELDALIAS-cpu_vendor = processorname 
#EVAL-resource_type = if(match("virtual", lower(computermodel)), "virtual", "physical")### Memory
FIELDALIAS-mem = totalvisiblememorysize AS mem#### OSEVAL-os = replace(osname, "\|.*","")
FIELDALIAS-version = osversion AS version
#### UserEVAL-interactive = "true"
FIELDALIAS-user = username as user
FIELDALIAS-user_id = username as user_id

[ziften:zenith:interferingprocess]
SHOULD_LINEMERGE = false
### Required Fields  ###########
EVAL-process = replace(imagefilepath, ".*\\\\","")
FIELDALIAS-dest = agentguid AS dest
### Optional ALIAS statements ###
FIELDALIAS-user = accountname AS user
FIELDALIAS-cpu_load_percent = avgcpuusage AS cpu_load_percent

[ziften:zenith:networkconnect]
SHOULD_LINEMERGE = false
FIELDALIAS-src_ip = ipsourceaddress AS src_ip
FIELDALIAS-dest_ip = sourceaddress AS dest_ip
FIELDALIAS-src_port = sourceport AS src_port 
FIELDALIAS-dest_port = port AS dest_port

FIELDALIAS-dest = sourceaddress AS dest
FIELDALIAS-user = accountname AS user

EVAL-direction = case(incoming=false,"outbound",incoming=true,"inbound", 1=1,"unknown")


[ziften:zenith:networkconnectsecondary]
SHOULD_LINEMERGE = false

[ziften:zenith:resourceusage]
SHOULD_LINEMERGE = false
EVAL-cpu_load_percent = (totalsystemprocessortime-totalsystemidletime)/totalsystemprocessortime*100
FIELDALIAS-cpu_time = totalprocessortime AS cpu_time
FIELDALIAS-mem = avgphysicalmemorytotal AS mem 
FIELDALIAS-mem_committed = avgworkingsetsize AS mem_committed
FIELDALIAS-mem_free = avgphysicalmemoryavailable AS mem_free
FIELDALIAS-mem_used = avgworkingsetsize AS mem_used
EVAL-mem_load_percent = (avgphysicalmemorytotal-avgphysicalmemoryavailable)/avgphysicalmemorytotal*100
EVAL-network_sent = (sentbytes+systemsentbytes)/(1024*1024)
EVAL-network_recieved = (receivedbytes+systemreceivedbytes)/(1024*1024)
EVAL-thruput = (receivedbytes+sentbytes)
### Required Fields  ###########
EVAL-process = replace(imagefilepath, ".*\\\\","")
FIELDALIAS-dest = agentguid AS dest
### Optional ALIAS statements ###
FIELDALIAS-user = accountname AS user
FIELDALIAS-process_id = process_id AS pid

[ziften:zenith:runningprocessessummary]
SHOULD_LINEMERGE = false

[ziften:zenith:services]
SHOULD_LINEMERGE = false
### Required Fields  ###########
EVAL-process = replace(imagefilepath, ".*\\\\","")
FIELDALIAS-dest = agentguid AS dest
FIELDALIAS-service = name AS service
### Optional statements ###
FIELDALIAS-service_id = servicetype AS service_id
EVAL-start_mode = case(starttype="4", "disabled", starttype="2", "auto", 1=1, "enabled")
