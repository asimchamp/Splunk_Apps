<form version="1.1">
  <label>Tanium Threat Response</label>
  <fieldset submitButton="false">
    <input type="time" token="field1" searchWhenChanged="true">
      <label>Time to Search</label>
      <default>
        <earliest>-30d@d</earliest>
        <latest>now</latest>
      </default>
    </input>
    <input type="dropdown" token="Type_Field">
      <label>Type</label>
      <choice value="*">All</choice>
      <choice value="tanium-signal">Signal</choice>
      <choice value="openioc">IOC</choice>
      <choice value="yara">Yara</choice>
      <fieldForLabel>Type_Field</fieldForLabel>
      <fieldForValue>Type_Field</fieldForValue>
      <default>*</default>
      <initialValue>*</initialValue>
    </input>
  </fieldset>
  <row>
    <panel>
      <title>Alert Activity</title>
      <chart>
        <title>Intel Name over Time</title>
        <search>
          <query>`tanium_index` (sourcetype::tanium:detect:signals OR sourcetype::tanium:detect:openioc OR sourcetype::tanium:detect:yara) | spath "Intel Type" | search "Intel Type"="$Type_Field$" | timechart count by "Intel Name" where max in top20 | bucket span=1d _time | sort -count</query>
          <earliest>$field1.earliest$</earliest>
          <latest>$field1.latest$</latest>
        </search>
        <option name="charting.axisLabelsX.majorLabelStyle.rotation">-45</option>
        <option name="charting.axisTitleX.text">Count</option>
        <option name="charting.axisTitleX.visibility">collapsed</option>
        <option name="charting.axisTitleY.text">Number of Alerts</option>
        <option name="charting.chart">area</option>
        <option name="charting.drilldown">all</option>
        <option name="refresh.display">progressbar</option>
      </chart>
    </panel>
  </row>
  <row>
    <panel>
      <title>MITRE Tactics</title>
      <single>
        <title>Initial Access</title>
        <search>
          <query> `tanium_index` sourcetype=tanium:detect:signals "Intel Labels"="*" | rex field="Intel Labels" "(?&lt;MITRE&gt;Initial Access)" | stats count(MITRE)</query>
          <earliest>$field1.earliest$</earliest>
          <latest>$field1.latest$</latest>
        </search>
        <option name="colorBy">value</option>
        <option name="colorMode">none</option>
        <option name="drilldown">all</option>
        <option name="height">125</option>
        <option name="rangeColors">["0x53a051","0x006d9c","0xf8be34","0xdc4e41"]</option>
        <option name="rangeValues">[0,30,60]</option>
        <option name="refresh.display">progressbar</option>
        <option name="useColors">1</option>
        <drilldown>
          <link target="_blank">search?q=%60tanium_index%60%20sourcetype=tanium:detect:signals%20%22Intel%20Labels%22=%22*%22%20%7C%20rex%20field=%22Intel%20Labels%22%20%22(%3F%3CMITRE%3EInitial%20Access)%22%20%7C%20search%20MITRE=%22Initial%20Access%22%20%7C%20table%20%22Alert%20Id%22%20%22Intel%20Name%22%20%22Computer%20Name%22%20%22Match%20Details.match.properties.user%22%20Timestamp&amp;earliest=$field1.earliest$&amp;latest=$field1.latest$</link>
        </drilldown>
      </single>
    </panel>
    <panel>
      <single>
        <title>Execution</title>
        <search>
          <query> `tanium_index` sourcetype=tanium:detect:signals "Intel Labels"="*" | rex field="Intel Labels" "(?&lt;MITRE&gt;Execution)" | stats count(MITRE)</query>
          <earliest>$field1.earliest$</earliest>
          <latest>$field1.latest$</latest>
        </search>
        <option name="colorBy">value</option>
        <option name="colorMode">none</option>
        <option name="drilldown">all</option>
        <option name="height">125</option>
        <option name="rangeColors">["0x53a051","0x006d9c","0xf8be34","0xdc4e41"]</option>
        <option name="rangeValues">[0,30,60]</option>
        <option name="refresh.display">progressbar</option>
        <option name="useColors">1</option>
        <drilldown>
          <link target="_blank">search?q=%60tanium_index%60%20sourcetype=tanium:detect:signals%20%22Intel%20Labels%22=%22*%22%20%7C%20rex%20field=%22Intel%20Labels%22%20%22(%3F%3CMITRE%3EExecution)%22%20%7C%20search%20MITRE=%22Execution%22%20%7C%20table%20%22Alert%20Id%22%20%22Intel%20Name%22%20%22Computer%20Name%22%20%22Match%20Details.match.properties.user%22%20Timestamp&amp;earliest=$field1.earliest$&amp;latest=$field1.latest$</link>
        </drilldown>
      </single>
    </panel>
    <panel>
      <single>
        <title>Persistance</title>
        <search>
          <query> `tanium_index` sourcetype=tanium:detect:signals "Intel Labels"="*" | rex field="Intel Labels" "(?&lt;MITRE&gt;Persistence)" | stats count(MITRE)</query>
          <earliest>$field1.earliest$</earliest>
          <latest>$field1.latest$</latest>
        </search>
        <option name="colorBy">value</option>
        <option name="colorMode">none</option>
        <option name="drilldown">all</option>
        <option name="height">125</option>
        <option name="rangeColors">["0x53a051","0x006d9c","0xf8be34","0xdc4e41"]</option>
        <option name="rangeValues">[0,30,60]</option>
        <option name="refresh.display">progressbar</option>
        <option name="useColors">1</option>
        <drilldown>
          <link target="_blank">search?q=%60tanium_index%60%20sourcetype=tanium:detect:signals%20%22Intel%20Labels%22=%22*%22%20%7C%20rex%20field=%22Intel%20Labels%22%20%22(%3F%3CMITRE%3EPersistence)%22%20%7C%20search%20MITRE=%22Persistence%22%20%7C%20table%20%22Alert%20Id%22%20%22Intel%20Name%22%20%22Computer%20Name%22%20%22Match%20Details.match.properties.user%22%20Timestamp&amp;earliest=$field1.earliest$&amp;latest=$field1.latest$</link>
        </drilldown>
      </single>
    </panel>
    <panel>
      <single>
        <title>Privilege Escalation</title>
        <search>
          <query> `tanium_index` sourcetype=tanium:detect:signals "Intel Labels"="*" | rex field="Intel Labels" "(?&lt;MITRE&gt;Privilege Escalation)" | stats count(MITRE)</query>
          <earliest>$field1.earliest$</earliest>
          <latest>$field1.latest$</latest>
        </search>
        <option name="colorBy">value</option>
        <option name="colorMode">none</option>
        <option name="drilldown">all</option>
        <option name="height">125</option>
        <option name="rangeColors">["0x53a051","0x006d9c","0xf8be34","0xdc4e41"]</option>
        <option name="rangeValues">[0,30,60]</option>
        <option name="refresh.display">progressbar</option>
        <option name="useColors">1</option>
        <drilldown>
          <link target="_blank">search?q=%60tanium_index%60%20sourcetype=tanium:detect:signals%20%22Intel%20Labels%22=%22*%22%20%7C%20rex%20field=%22Intel%20Labels%22%20%22(%3F%3CMITRE%3EPrivilege%20Escalation)%22%20%7C%20search%20MITRE=%22Privilege%20Escalation%22%20%7C%20table%20%22Alert%20Id%22%20%22Intel%20Name%22%20%22Computer%20Name%22%20%22Match%20Details.match.properties.user%22%20Timestamp&amp;earliest=$field1.earliest$&amp;latest=$field1.latest$</link>
        </drilldown>
      </single>
    </panel>
    <panel>
      <single>
        <title>Discovery</title>
        <search>
          <query> `tanium_index` sourcetype=tanium:detect:signals "Intel Labels"="*" | rex field="Intel Labels" "(?&lt;MITRE&gt;Discovery)" | stats count(MITRE)</query>
          <earliest>$field1.earliest$</earliest>
          <latest>$field1.latest$</latest>
        </search>
        <option name="colorBy">value</option>
        <option name="colorMode">none</option>
        <option name="drilldown">all</option>
        <option name="height">125</option>
        <option name="rangeColors">["0x53a051","0x006d9c","0xf8be34","0xdc4e41"]</option>
        <option name="rangeValues">[0,30,60]</option>
        <option name="refresh.display">progressbar</option>
        <option name="useColors">1</option>
        <drilldown>
          <link target="_blank">search?q=%60tanium_index%60%20sourcetype=tanium:detect:signals%20%22Intel%20Labels%22=%22*%22%20%7C%20rex%20field=%22Intel%20Labels%22%20%22(%3F%3CMITRE%3EDiscovery)%22%20%7C%20search%20MITRE=%22Discovery%22%20%7C%20table%20%22Alert%20Id%22%20%22Intel%20Name%22%20%22Computer%20Name%22%20%22Match%20Details.match.properties.user%22%20Timestamp&amp;earliest=$field1.earliest$&amp;latest=$field1.latest$</link>
        </drilldown>
      </single>
    </panel>
    <panel>
      <single>
        <title>Defense Evasion</title>
        <search>
          <query>`tanium_index` sourcetype=tanium:detect:signals "Intel Labels"="*" | rex field="Intel Labels" "(?&lt;MITRE&gt;Defense Evasion)" | stats count(MITRE)</query>
          <earliest>$field1.earliest$</earliest>
          <latest>$field1.latest$</latest>
        </search>
        <option name="colorBy">value</option>
        <option name="colorMode">none</option>
        <option name="drilldown">all</option>
        <option name="height">125</option>
        <option name="rangeColors">["0x53a051","0x006d9c","0xf8be34","0xdc4e41"]</option>
        <option name="rangeValues">[0,30,60]</option>
        <option name="refresh.display">progressbar</option>
        <option name="useColors">1</option>
        <drilldown>
          <link target="_blank">search?q=%60tanium_index%60%20sourcetype=tanium:detect:signals%20%22Intel%20Labels%22=%22*%22%20%7C%20rex%20field=%22Intel%20Labels%22%20%22(%3F%3CMITRE%3EDefense%20Evasion)%22%20%7C%20search%20MITRE=%22Defense%20Evasion%22%20%7C%20table%20%22Alert%20Id%22%20%22Intel%20Name%22%20%22Computer%20Name%22%20%22Match%20Details.match.properties.user%22%20Timestamp&amp;earliest=$field1.earliest$&amp;latest=$field1.latest$</link>
        </drilldown>
      </single>
    </panel>
  </row>
  <row>
    <panel>
      <single>
        <title>Credential Access</title>
        <search>
          <query> `tanium_index` sourcetype=tanium:detect:signals "Intel Labels"="*" | rex field="Intel Labels" "(?&lt;MITRE&gt;Credential Access)" | stats count(MITRE)</query>
          <earliest>$field1.earliest$</earliest>
          <latest>$field1.latest$</latest>
        </search>
        <option name="colorBy">value</option>
        <option name="colorMode">none</option>
        <option name="drilldown">all</option>
        <option name="height">125</option>
        <option name="rangeColors">["0x53a051","0x006d9c","0xf8be34","0xdc4e41"]</option>
        <option name="rangeValues">[0,30,60]</option>
        <option name="refresh.display">progressbar</option>
        <option name="useColors">1</option>
        <drilldown>
          <link target="_blank">search?q=%60tanium_index%60%20sourcetype=tanium:detect:signals%20%22Intel%20Labels%22=%22*%22%20%7C%20rex%20field=%22Intel%20Labels%22%20%22(%3F%3CMITRE%3ECredential%20Access)%22%20%7C%20search%20MITRE=%22Credential%20Access%22%20%7C%20table%20%22Alert%20Id%22%20%22Intel%20Name%22%20%22Computer%20Name%22%20%22Match%20Details.match.properties.user%22%20Timestamp&amp;earliest=$field1.earliest$&amp;latest=$field1.latest$</link>
        </drilldown>
      </single>
    </panel>
    <panel>
      <single>
        <title>Lateral Movement</title>
        <search>
          <query> `tanium_index` sourcetype=tanium:detect:signals "Intel Labels"="*" | rex field="Intel Labels" "(?&lt;MITRE&gt;Lateral Movement)" | stats count(MITRE)</query>
          <earliest>$field1.earliest$</earliest>
          <latest>$field1.latest$</latest>
        </search>
        <option name="colorBy">value</option>
        <option name="colorMode">none</option>
        <option name="drilldown">all</option>
        <option name="height">125</option>
        <option name="rangeColors">["0x53a051","0x006d9c","0xf8be34","0xdc4e41"]</option>
        <option name="rangeValues">[0,30,60]</option>
        <option name="refresh.display">progressbar</option>
        <option name="useColors">1</option>
        <drilldown>
          <link target="_blank">search?q=%60tanium_index%60%20sourcetype=tanium:detect:signals%20%22Intel%20Labels%22=%22*%22%20%7C%20rex%20field=%22Intel%20Labels%22%20%22(%3F%3CMITRE%3ELateral%20Movement)%22%20%7C%20search%20MITRE=%22Lateral%20Movement%22%20%7C%20table%20%22Alert%20Id%22%20%22Intel%20Name%22%20%22Computer%20Name%22%20%22Match%20Details.match.properties.user%22%20Timestamp&amp;earliest=$field1.earliest$&amp;latest=$field1.latest$</link>
        </drilldown>
      </single>
    </panel>
    <panel>
      <single>
        <title>Collection</title>
        <search>
          <query> `tanium_index` sourcetype=tanium:detect:signals "Intel Labels"="*" | rex field="Intel Labels" "(?&lt;MITRE&gt;Collection)" | stats count(MITRE)</query>
          <earliest>$field1.earliest$</earliest>
          <latest>$field1.latest$</latest>
        </search>
        <option name="colorBy">value</option>
        <option name="colorMode">none</option>
        <option name="drilldown">all</option>
        <option name="height">125</option>
        <option name="rangeColors">["0x53a051","0x006d9c","0xf8be34","0xdc4e41"]</option>
        <option name="rangeValues">[0,30,60]</option>
        <option name="refresh.display">progressbar</option>
        <option name="useColors">1</option>
        <drilldown>
          <link target="_blank">search?q=%60tanium_index%60%20sourcetype=tanium:detect:signals%20%22Intel%20Labels%22=%22*%22%20%7C%20rex%20field=%22Intel%20Labels%22%20%22(%3F%3CMITRE%3ECollection)%22%20%7C%20search%20MITRE=%22Collection%22%20%7C%20table%20%22Alert%20Id%22%20%22Intel%20Name%22%20%22Computer%20Name%22%20%22Match%20Details.match.properties.user%22%20Timestamp&amp;earliest=$field1.earliest$&amp;latest=$field1.latest$</link>
        </drilldown>
      </single>
    </panel>
    <panel>
      <single>
        <title>Command &amp; Control</title>
        <search>
          <query> `tanium_index` sourcetype=tanium:detect:signals "Intel Labels"="*" | rex field="Intel Labels" "(?&lt;MITRE&gt;Command and Control)" | stats count(MITRE)</query>
          <earliest>$field1.earliest$</earliest>
          <latest>$field1.latest$</latest>
        </search>
        <option name="colorBy">value</option>
        <option name="colorMode">none</option>
        <option name="drilldown">all</option>
        <option name="height">125</option>
        <option name="rangeColors">["0x53a051","0x006d9c","0xf8be34","0xdc4e41"]</option>
        <option name="rangeValues">[0,30,60]</option>
        <option name="refresh.display">progressbar</option>
        <option name="useColors">1</option>
        <drilldown>
          <link target="_blank">search?q=%60tanium_index%60%20sourcetype=tanium:detect:signals%20%22Intel%20Labels%22=%22*%22%20%7C%20rex%20field=%22Intel%20Labels%22%20%22(%3F%3CMITRE%3ECommand%20and%20Control)%22%20%7C%20search%20MITRE=%22Command%20and%20Control%22%20%7C%20table%20%22Alert%20Id%22%20%22Intel%20Name%22%20%22Computer%20Name%22%20%22Match%20Details.match.properties.user%22%20Timestamp&amp;earliest=$field1.earliest$&amp;latest=$field1.latest$</link>
        </drilldown>
      </single>
    </panel>
    <panel>
      <single>
        <title>Exfiltration</title>
        <search>
          <query> `tanium_index` sourcetype=tanium:detect:signals "Intel Labels"="*" | rex field="Intel Labels" "(?&lt;MITRE&gt;Exfiltration)" | stats count(MITRE)</query>
          <earliest>$field1.earliest$</earliest>
          <latest>$field1.latest$</latest>
        </search>
        <option name="colorBy">value</option>
        <option name="colorMode">none</option>
        <option name="drilldown">all</option>
        <option name="height">125</option>
        <option name="rangeColors">["0x53a051","0x006d9c","0xf8be34","0xdc4e41"]</option>
        <option name="rangeValues">[0,30,60]</option>
        <option name="refresh.display">progressbar</option>
        <option name="useColors">1</option>
        <drilldown>
          <link target="_blank">search?q=%60tanium_index%60%20sourcetype=tanium:detect:signals%20%22Intel%20Labels%22=%22*%22%20%7C%20rex%20field=%22Intel%20Labels%22%20%22(%3F%3CMITRE%3EExfiltration)%22%20%7C%20search%20MITRE=%22Exfiltration%22%20%7C%20table%20%22Alert%20Id%22%20%22Intel%20Name%22%20%22Computer%20Name%22%20%22Match%20Details.match.properties.user%22%20Timestamp&amp;earliest=$field1.earliest$&amp;latest=$field1.latest$</link>
        </drilldown>
      </single>
    </panel>
    <panel>
      <single>
        <title>Impact</title>
        <search>
          <query> `tanium_index` sourcetype=tanium:detect:signals "Intel Labels"="*" | rex field="Intel Labels" "(?&lt;MITRE&gt;Impact)" | stats count(MITRE)</query>
          <earliest>$field1.earliest$</earliest>
          <latest>$field1.latest$</latest>
        </search>
        <option name="colorBy">value</option>
        <option name="colorMode">none</option>
        <option name="drilldown">all</option>
        <option name="height">125</option>
        <option name="rangeColors">["0x53a051","0x006d9c","0xf8be34","0xdc4e41"]</option>
        <option name="rangeValues">[0,30,60]</option>
        <option name="refresh.display">progressbar</option>
        <option name="unitPosition">after</option>
        <option name="useColors">1</option>
        <drilldown>
          <link target="_blank">search?q=%60tanium_index%60%20sourcetype=tanium:detect:signals%20%22Intel%20Labels%22=%22*%22%20%7C%20rex%20field=%22Intel%20Labels%22%20%22(%3F%3CMITRE%3EImpact)%22%20%7C%20search%20MITRE=%22Impact%22%20%7C%20table%20%22Alert%20Id%22%20%22Intel%20Name%22%20%22Computer%20Name%22%20%22Match%20Details.match.properties.user%22%20Timestamp&amp;earliest=$field1.earliest$&amp;latest=$field1.latest$</link>
        </drilldown>
      </single>
    </panel>
  </row>
  <row>
    <panel>
      <title>All Alerts by Computer Name (with Asset Drill-down)</title>
      <table>
        <search>
          <query>`tanium_index` (sourcetype::tanium:detect:signals OR sourcetype::tanium:detect:openioc OR sourcetype::tanium:detect:yara) | stats sparkline as Trend dc(Alert Id) as Alerts by "Computer Name" "Intel Name" | sort -Alerts | head 20</query>
          <earliest>$field1.earliest$</earliest>
          <latest>$field1.latest$</latest>
        </search>
        <option name="count">20</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">cell</option>
        <option name="percentagesRow">false</option>
        <option name="refresh.display">progressbar</option>
        <option name="rowNumbers">false</option>
        <option name="totalsRow">false</option>
        <option name="wrap">false</option>
        <format field="Trend" type="sparkline">
          <option name="maxSpotColor">#EC2222</option>
          <option name="spotRadius">3</option>
          <option name="fillColor">#f989d7</option>
        </format>
        <drilldown>
          <set token="selected_computer">$click.value$</set>
        </drilldown>
      </table>
    </panel>
    <panel depends="$panel_show$">
      <table>
        <title>Drill-down details: $selected_computer$</title>
        <search>
          <progress>
            <condition match="'job.resultCount' == 0">
              <unset token="panel_show"></unset>
            </condition>
            <condition match="'job.resultCount' &gt;= 1">
              <set token="panel_show">true</set>
            </condition>
          </progress>
          <query>`tanium_index` Question="Splunk-Basic-Asset" Computer_Name="$selected_computer$" | stats dc(Computer_Name) as Count by Computer_Name Last_Logged_In_User Chassis_Type Operating_System</query>
          <earliest>$field1.earliest$</earliest>
          <latest>$field1.latest$</latest>
        </search>
        <option name="count">10</option>
        <option name="drilldown">none</option>
        <option name="refresh.display">progressbar</option>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <title>Signal Alert by User (with Asset Drill-down)</title>
      <table>
        <search>
          <query>`tanium_index` sourcetype::tanium:detect:signals | stats sparkline as Trend dc(Alert Id) as Alerts by "Match Details.match.properties.user" "Intel Name" "Computer Name" | sort -Alerts | head 20</query>
          <earliest>$field1.earliest$</earliest>
          <latest>$field1.latest$</latest>
        </search>
        <option name="count">10</option>
        <option name="drilldown">cell</option>
        <option name="refresh.display">progressbar</option>
        <format field="Trend" type="sparkline">
          <option name="maxSpotColor">#EC2222</option>
          <option name="spotRadius">3</option>
          <option name="fillColor">#f989d7</option>
        </format>
        <drilldown>
          <set token="selected_user2">$row.Computer Name$</set>
        </drilldown>
      </table>
    </panel>
    <panel depends="$panel_show2$">
      <table>
        <title>Drill-down details: $selected_user2$</title>
        <search>
          <progress>
            <condition match="'job.resultCount' == 0">
              <unset token="panel_show2"></unset>
            </condition>
            <condition match="'job.resultCount' &gt;= 1">
              <set token="panel_show2">true</set>
            </condition>
          </progress>
          <query>`tanium_index` Question="Splunk-Basic-Asset" Computer_Name="$selected_user2$" | stats dc(Computer_Name) as Count by Computer_Name Last_Logged_In_User Chassis_Type Operating_System</query>
          <earliest>$field1.earliest$</earliest>
          <latest>$field1.latest$</latest>
        </search>
        <option name="count">10</option>
        <option name="drilldown">none</option>
        <option name="refresh.display">progressbar</option>
      </table>
    </panel>
  </row>
</form>