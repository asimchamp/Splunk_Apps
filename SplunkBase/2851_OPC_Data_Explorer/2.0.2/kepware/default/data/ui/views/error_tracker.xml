<form>
  <label>Error Tracker</label>
  <row>
    <panel>
      <html tokens="true">
        <h2>Errors in Kepware usually originate from 2 sources, mainly from Connectivity and Configurations.This dashboard uses the _error system tags, the _noerror system tags and the quality of the tags to indicate when an errors as occured. This is useful in exploring correlation of breakdowns and see if there is a certain pattern in the error flow.</h2>
          </html>
    </panel>
  </row>
  <row>
    <panel>
      <title>List of Device Names</title>
      <input type="time" token="Time1" searchWhenChanged="true">
        <label></label>
        <default>
          <earliest>-60m@m</earliest>
          <latest>now</latest>
        </default>
      </input>
      <table>
        <search>
          <query>sourcetype=opc Tag="*_Error*" | dedup 1 Device | table Device , Value</query>
          <earliest>$Time1.earliest$</earliest>
          <latest>$Time1.latest$</latest>
        </search>
        <option name="wrap">true</option>
        <option name="rowNumbers">false</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">cell</option>
        <option name="count">10</option>
      </table>
    </panel>
    <panel>
      <input type="text" token="TagClick">
        <label>Details</label>
        <default>$TagClick$</default>
      </input>
      <chart id="detail" depends="$TagClick$">
        <title>Average Values of Selected Tag</title>
        <search>
          <query>TagName="$TagClick$" | timechart  Avg(Value) as Average</query>
          <earliest>$Time1.earliest$</earliest>
          <latest>$Time1.latest$</latest>
        </search>
        <option name="charting.axisLabelsX.majorLabelStyle.overflowMode">ellipsisNone</option>
        <option name="charting.axisLabelsX.majorLabelStyle.rotation">0</option>
        <option name="charting.axisTitleX.visibility">visible</option>
        <option name="charting.axisTitleY.visibility">visible</option>
        <option name="charting.axisTitleY2.visibility">visible</option>
        <option name="charting.axisX.scale">linear</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.axisY2.enabled">0</option>
        <option name="charting.axisY2.scale">inherit</option>
        <option name="charting.chart">line</option>
        <option name="charting.chart.bubbleMaximumSize">50</option>
        <option name="charting.chart.bubbleMinimumSize">10</option>
        <option name="charting.chart.bubbleSizeBy">area</option>
        <option name="charting.chart.nullValueMode">connect</option>
        <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
        <option name="charting.chart.stackMode">default</option>
        <option name="charting.chart.style">shiny</option>
        <option name="charting.drilldown">all</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
        <option name="charting.legend.placement">none</option>
        <option name="charting.chart.showDataLabels">none</option>
        <option name="charting.layout.splitSeries.allowIndependentYRanges">0</option>
      </chart>
    </panel>
  </row>
  <row>
    <panel>
      <title>Bad Tag and Unknown Tags</title>
      <single>
        <title>Bad and unknown Quality Tags</title>
        <search>
          <query>Quality="bad" OR Quality="Unknown"  | stats count(Quality)</query>
          <earliest>$Time1.earliest$</earliest>
          <latest>$Time1.latest$</latest>
        </search>
        <option name="underLabel">Tags</option>
        <option name="linkView">search</option>
        <option name="drilldown">none</option>
      </single>
      <table>
        <title>Tag Information</title>
        <search>
          <query>Quality="bad" OR "Unknown" | stats count(Quality) As "Number of Bad or Unknown Tag" by TagName</query>
          <earliest>$Time1.earliest$</earliest>
          <latest>$Time1.latest$</latest>
        </search>
        <option name="wrap">true</option>
        <option name="rowNumbers">false</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">row</option>
        <drilldown>
          <set token="TagClick">$row.TagName$</set>
          <set token="form.TagClick">$row.TagName$</set>
        </drilldown>
        <option name="count">10</option>
      </table>
    </panel>
    <panel>
      <chart depends="$TagClick$">
        <title>No. of Errors</title>
        <search>
          <query>TagName="$TagClick$" | timechart  count(Value) by Quality</query>
          <earliest>$Time1.earliest$</earliest>
          <latest>$Time1.latest$</latest>
        </search>
        <option name="charting.axisLabelsX.majorLabelStyle.overflowMode">ellipsisNone</option>
        <option name="charting.axisLabelsX.majorLabelStyle.rotation">0</option>
        <option name="charting.axisTitleX.visibility">visible</option>
        <option name="charting.axisTitleY.visibility">visible</option>
        <option name="charting.axisTitleY2.visibility">visible</option>
        <option name="charting.axisX.scale">linear</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.axisY2.enabled">0</option>
        <option name="charting.axisY2.scale">inherit</option>
        <option name="charting.chart">area</option>
        <option name="charting.chart.bubbleMaximumSize">50</option>
        <option name="charting.chart.bubbleMinimumSize">10</option>
        <option name="charting.chart.bubbleSizeBy">area</option>
        <option name="charting.chart.nullValueMode">connect</option>
        <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
        <option name="charting.chart.stackMode">default</option>
        <option name="charting.chart.style">shiny</option>
        <option name="charting.drilldown">all</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
        <option name="charting.legend.placement">right</option>
        <option name="charting.chart.showDataLabels">none</option>
        <option name="charting.layout.splitSeries.allowIndependentYRanges">0</option>
      </chart>
    </panel>
    <panel>
      <title>Device Up and Down Tracker</title>
      <input type="time" token="downtimeTrack">
        <label>Time Selection</label>
        <default>
          <earliest>rt-5m</earliest>
          <latest>rt</latest>
        </default>
      </input>
      <input type="dropdown" token="errorDevice" searchWhenChanged="true">
        <label>Device</label>
        <search>
          <query>*_Error | dedup 1 Device | Table Device</query>
          <earliest>-15m</earliest>
          <latest>now</latest>
        </search>
        <fieldForLabel>Device</fieldForLabel>
        <fieldForValue>Device</fieldForValue>
        <choice value="*">default</choice>
        <default>*</default>
      </input>
      <chart>
        <search>
          <query>*_Error Device="$errorDevice$" | eval errorState=if(Value=1,1,0) | eval normalState=if(Value=0,1,0)| timechart avg(errorState) as Error,avg(normalState) as Normal by Device</query>
          <earliest>$downtimeTrack.earliest$</earliest>
          <latest>$downtimeTrack.latest$</latest>
        </search>
        <option name="charting.axisLabelsX.majorLabelStyle.overflowMode">ellipsisNone</option>
        <option name="charting.axisLabelsX.majorLabelStyle.rotation">0</option>
        <option name="charting.axisTitleX.visibility">collapsed</option>
        <option name="charting.axisTitleY.visibility">visible</option>
        <option name="charting.axisTitleY2.visibility">visible</option>
        <option name="charting.axisX.scale">linear</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.axisY2.enabled">0</option>
        <option name="charting.axisY2.scale">inherit</option>
        <option name="charting.chart">column</option>
        <option name="charting.chart.bubbleMaximumSize">50</option>
        <option name="charting.chart.bubbleMinimumSize">10</option>
        <option name="charting.chart.bubbleSizeBy">area</option>
        <option name="charting.chart.nullValueMode">connect</option>
        <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
        <option name="charting.chart.stackMode">default</option>
        <option name="charting.chart.style">shiny</option>
        <option name="charting.drilldown">all</option>
        <option name="charting.layout.splitSeries">1</option>
        <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
        <option name="charting.legend.placement">right</option>
        <option name="charting.chart.showDataLabels">none</option>
        <option name="charting.layout.splitSeries.allowIndependentYRanges">0</option>
      </chart>
    </panel>
  </row>
</form>