<form>
  <label>Data Exporter</label>
  <fieldset submitButton="false" autoRun="true">
    <input type="time" token="field1" searchWhenChanged="true">
      <label>Time Selector</label>
      <default>
        <earliest>@d</earliest>
        <latest>now</latest>
      </default>
    </input>
    <input type="dropdown" token="tagName" searchWhenChanged="true">
      <label>TagName Selector</label>
      <search>
        <query>sourcetype=opc | stats values(TagName) as TagName | mvexpand TagName</query>
        <earliest>@w0</earliest>
        <latest>now</latest>
      </search>
      <fieldForLabel>TagName</fieldForLabel>
      <fieldForValue>TagName</fieldForValue>
    </input>
  </fieldset>
  <row>
    <panel>
      <title>Misc Statistics</title>
      <table>
        <search>
          <query>sourcetype=opc TagName="$tagName$" |  stats earliest(_time) as earliest, latest(_time) as latest, max(Value) as Max, min(Value) as min, Avg(Value) as Average by TagName | eval earliest = strftime(earliest, "%m/%d/%Y:%H:%M:%S") | rename earliest as "Earliest Data" | eval latest = strftime(latest, "%m/%d/%Y:%H:%M:%S")   | rename latest as "Latest Data"</query>
          <earliest>$field1.earliest$</earliest>
          <latest>$field1.latest$</latest>
        </search>
        <option name="wrap">true</option>
        <option name="rowNumbers">false</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">none</option>
        <option name="count">10</option>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <title>List of Values</title>
      <input type="text" token="samplingRate" searchWhenChanged="true">
        <label>Sampling Rate (s)</label>
        <default>1</default>
      </input>
      <input type="text" token="upperLimit" searchWhenChanged="true">
        <label>Upper Limit</label>
        <default>9999999</default>
      </input>
      <input type="text" token="lowerLimit" searchWhenChanged="true">
        <label>Lower Limit</label>
        <default>*</default>
      </input>
      <input type="dropdown" token="quality">
        <label>Quality</label>
        <choice value="192">good</choice>
        <choice value="0">bad</choice>
        <default>192</default>
      </input>
      <table>
        <search>
          <query>sourcetype=opc TagName="$tagName$" QualityNum=$quality$ Value&gt;$lowerLimit$ Value&lt;$upperLimit$ earliest=[search sourcetype=opc TagName="$tagName$" | stats earliest(_time) as search | eval search=strftime(search, "%m/%d/%Y:%H:%M:%S")] |  timechart span=$samplingRate$ avg(QualityNum) as QualityNumeric, avg(Value) as Value by TagName | filldown</query>
          <earliest>$field1.earliest$</earliest>
          <latest>$field1.latest$</latest>
        </search>
        <option name="wrap">true</option>
        <option name="rowNumbers">true</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">none</option>
        <option name="count">20</option>
      </table>
    </panel>
  </row>
</form>