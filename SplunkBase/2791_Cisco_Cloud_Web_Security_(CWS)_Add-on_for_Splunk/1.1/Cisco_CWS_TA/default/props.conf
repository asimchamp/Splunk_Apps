[ciscocws]
KV_MODE = none
EXTRACT_fields = GMT\t(?<c_ip>.*?)\t(?<cs_X_Forwarded_For>.*?)\t(?<cs_username>.*?)\t(?<cs_method>.*?)\t(?<cs_uri_scheme>.*?)\t(?<cs_host>.*?)\t(?<cs_uri_port>.*?)\t(?<cs_uri_path>.*?)\t(?<cs_uri_query>.*?)\t(?<cs_user_agent>.*?)\t(?<cs_content_type>.*?)\t(?<cs_bytes>.*?)\t(?<sc_bytes>.*?)\t(?<sc_status>.*?)\t(?<sc_content_type>.*?)\t(?<s_ip>.*?)\t(?<x_ss_category>.*?)\t(?<x_ss_last_rule_name>.*?)\t(?<x_ss_last_rule_action>.*?)\t(?<x_ss_block_type>.*?)\t(?<x_ss_block_value>.*?)\t(?<x_ss_external_ip>.*?)\t(?<x_ss_referer_host>.*)
FIELDALIAS-cim = c_ip as src sc_status as http_status cs_method as http_method cs_username as user cs_uri_path as uri_path cs_uri_query as uri_query  cs_host as dest cs_user_agent as http_user_agent cs_content_type as http_content_type cs_bytes as bytes_in sc_bytes as bytes_out s_ip as src x_ss_category as category x_ss_referer_host as http_referrer
FIELDALIAS-wsa = cs_uri_port as s_port cs_content_type as cs_mime_type sc_status as sc_http_status x_ss_category as x_webcat_code_abbr cs_username as user_id c_ip as dvc_ip
EXTRACT_fields_dest_domain = (?<dest_domain>((\d{1,3}\.){3}\d{1,3})|(\w+\.\w+)|(\w+\.\w+\.\w{2}))(?:($|\n|\t)) in cs_host
EVAL-app = "CWS"
EVAL-url = cs_uri_scheme + "://" + cs_host + cs_uri_path + "?" + cs_uri_query
EVAL-dest_url = cs_uri_scheme + "://" + cs_host
EVAL-url_length = len(cs_uri_scheme) + 3 + len(cs_host) + len(cs_uri_path) + 1 + len(cs_uri_query)
EVAL-http_user_agent_length = len(http_user_agent)
EVAL-bytes = bytes_in + bytes_out
EVAL-x_wbrs_threat_type=if(x_ss_block_type=="webrep", x_ss_block_value,"-")
EVAL-x_sophos_virus_name=if(x_ss_block_type=="virus", x_ss_block_value,"-")
EVAL-x_resp_dvs_threat_name=if(x_ss_block_type=="virus" OR x_ss_block_type=="adware" OR x_ss_block_type=="amp_malware" OR x_ss_block_type=="phishing" OR x_ss_block_type=="spyware", x_ss_block_type,"-")
EVAL-x_user_type = "remote"
EVAL-x_wbrs_score = if(x_ss_block_type=="webrep", "na","ns")
EVAL-x_resp_dvs_verdictname = "unknown"
EVAL-x_avc_app = "Uncategorized"
EVAL-x_avc_type = "Uncategorized"
EVAL-x_avc_behavior = "unknown"
EVAL-x_bw_throttled = 0
EVAL-mime_type = if(len(sc_content_type)>0,sc_content_type,"_")
EVAL-x_webcat_code_abbr = mvindex(split(x_ss_category,":"),1)
EVAL-action = upper(x_ss_last_rule_action)
EVAL-cause=if(x_ss_last_rule_action=="block",if(x_ss_block_type=="virus" OR x_ss_block_type=="adware" OR x_ss_block_type=="amp_malware" OR x_ss_block_type=="phishing" OR x_ss_block_type=="spyware","AMW",if(x_ss_block_type=="webrep","WBRS", if(x_ss_block_type=="category","WEBCAT",upper(x_ss_block_type)))),upper(x_ss_last_rule_name))
EVAL-duration = 0
LOOKUP-departments = cisco_wsa_departments user_id as username OUTPUT department displayName
LOOKUP-department = cisco_wsa_departments user_id as host OUTPUT department displayName
LOOKUP-categories = cisco_wsa_url_categories x_webcat_code_abbr OUTPUT x_webcat_code_full, usage, severity

