<form script="Syncsort_Ironstream_MQ_Monitor_Help.js" stylesheet="Syncsort_Ironstream_MQ_Monitor_Help.css">
  <label>MQ Monitor</label>
  <description>Powered by Syncsort IronstreamÂ®</description>
  <fieldset submitButton="true">
    <input type="dropdown" token="connectionname" searchWhenChanged="false">
      <label>Connection Name</label>
      <search>
        <query>index=IRONSTREAM_SMF_INDEX_NAME 
          MFSOURCETYPE=SMF116 
          AND SMF116STF=1             
          | rex "WTIDCCN[-_]\d\d\d\d\":\"(?P&lt;conname&gt;([A-Z0-9#$%.]{0,42}))\"" max_match=1    
          | fields + conname
          | dedup conname
          | sort conname</query>
      </search>
      <fieldForLabel>conname</fieldForLabel>
      <fieldForValue>conname</fieldForValue>
      <choice value="All Connections">All Connections</choice>
      <change>
        <set token="baseqname">All Base Queues</set>
        <set token="queuename">All Queue Names</set>
      </change>
      <default>All Connections</default>
    </input>
    <input type="dropdown" token="baseqname" searchWhenChanged="true">
      <label>Base Queue Name</label>
      <search>
        <query>index=IRONSTREAM_SMF_INDEX_NAME MFSOURCETYPE=SMF116 AND SMF116STF=1      
          | rex "WTIDCCN[-_]\d\d\d\d\":\"(?P&lt;conname&gt;([A-Z0-9#$$%.]{0,42}))\"" max_match=1     
          | where (("$connectionname$"=="All Connections") OR (conname=="$connectionname$" ))       
          | rex "BASENAME[-_]\d\d\d\d\":\"(?P&lt;bname&gt;([A-Z0-9#$$%.]{0,42}))\"" max_match=10      
          | fields + bname                   
          | mvexpand bname                   
          | rex field=bname "(?&lt;xbname&gt;.*)"            
          | dedup xbname               
          | table xbname         		         
          | sort xbname</query>
        <earliest>0</earliest>
      </search>
      <!-- <fieldForLabel>xbname</fieldForLabel>  -->
      <fieldForLabel>$baseqname$</fieldForLabel>
      <fieldForValue>xbname</fieldForValue>
      <choice value="All Base Queues">All Base Queues</choice>
      <change>
        <set token="queuename">All Queue Names</set>
      </change>
      <default>All Base Queues</default>
    </input>
    <input type="dropdown" token="queuename" searchWhenChanged="true">
      <label>Queue Name</label>
      <search>
        <query>index=IRONSTREAM_SMF_INDEX_NAME MFSOURCETYPE=SMF116 AND SMF116STF=1                          
          | rex "WTIDCCN[-_]\d\d\d\d\":\"(?P&lt;conname&gt;([A-Z0-9#$$%.]{0,42}))\"" max_match=1                  
          | where (("$connectionname$"=="All Connections") OR (conname=="$connectionname$" ))                
          | rex "OBJNAME[-_]\d\d\d\d\":\"(?P&lt;qname&gt;([A-Z0-9#$$%.]{0,42}))\"" max_match=10                    
          | rex "BASENAME[-_]\d\d\d\d\":\"(?P&lt;bname&gt;([A-Z0-9#$$%.]{0,42}))\"" max_match=10                     
          | eval combo = mvzip(bname,qname)  
          | fields + combo
          | mvexpand combo  
          | rex field=combo "(?&lt;xbqname&gt;.*),(?&lt;xqname&gt;.*)"  
          | where (("$baseqname$"=="All Base Queues") OR (xbqname=="$baseqname$"))                         
          | dedup xqname                       
          | sort xqname</query>
        <earliest>0</earliest>
      </search>
      <fieldForLabel>xqname</fieldForLabel>
      <fieldForValue>xqname</fieldForValue>
      <choice value="All Queue Names">All Queue Names</choice>
      <default>All Queue Names</default>
    </input>
    <input type="radio" token="displayby" searchWhenChanged="false">
      <label>Display Data By</label>
      <choice value="Displayed by Connection">Connection</choice>
      <choice value="Displayed By Base Queue">Base Queue</choice>
      <choice value="Displayed by Queue">Queue</choice>
      <default>Displayed by Connection</default>
    </input>
    <input type="time" token="timetoken" searchWhenChanged="false">
      <label>Time Range</label>
      <default>
        <earliest>0</earliest>
        <latest></latest>
        <set token="tokStart">$timetoken.earliest$</set>
        <set token="tokEnd">$timetoken.latest$</set>
      </default>
      <change>
        <set token="tokStart">$timetoken.earliest$</set>
        <set token="tokEnd">$timetoken.latest$</set>
      </change>
    </input>
  </fieldset>
  <search id="mainsearch">
    <query>index=IRONSTREAM_SMF_INDEX_NAME MFSOURCETYPE=SMF116 AND SMF116STF=1                                             
            | rex "WTIDCCN[-_]\d\d\d\d\":\"(?P&lt;conname&gt;([A-Z0-9#$%.]{0,42}))\"" max_match=1              
            | rex "BASENAME[-_]\d\d\d\d\":\"(?P&lt;bname&gt;([A-Z0-9#$%.]{0,42}))\"" max_match=10       
            | rex "OBJNAME[-_]\d\d\d\d\":\"(?P&lt;qname&gt;([A-Z0-9#$%.]{0,42}))\"" max_match=10               
            | rex "OPENTIME[-_]\d{4}\":\"(?P&lt;qoptime&gt;(\d{4}-\d\d-\d\d\s\d\d:\d\d:\d\d.\d\d))\"" max_match=10  
            | rex "CLOSTIME[-_]\d{4}\":\"(?P&lt;qcltime&gt;(\d{4}-\d\d-\d\d\s\d\d:\d\d:\d\d.\d\d))\"" max_match=10  
            | rex "GETCT[-_]\d{4}\":\"\d\d:\d\d:(?P&lt;getcpu&gt;(\d\d.\d{6}))\"" max_match=10
            | rex "GETET[-_]\d{4}\":\"\d\d:\d\d:(?P&lt;getelap&gt;(\d\d.\d{6}))\"" max_match=10
            | rex "GETN[-_]\d{4}\":\"(?P&lt;getcnt&gt;(\d+))\"" max_match=10
            | rex "PUTET[-_]\d{4}\":\"\d\d:\d\d:(?P&lt;putelap&gt;(\d\d.\d{6}))\"" max_match=10   
            | rex "PUTCT[-_]\d{4}\":\"\d\d:\d\d:(?P&lt;putcpu&gt;(\d\d.\d{6}))\"" max_match=10   
            | rex "PUTN[-_]\d{4}\":\"(?P&lt;putcnt&gt;(\d+))\"" max_match=10
            | rex "MAXQDPTH[-_]\d{4}\":\"(?P&lt;maxqdepth&gt;(\d+))\"" max_match=10             
            | eval combo = mvzip(mvzip(mvzip(mvzip(mvzip(mvzip(mvzip(mvzip(mvzip(mvzip(qname,bname),qoptime),qcltime),getcpu),getelap),getcnt),putcpu),putelap),putcnt),maxqdepth)    
            | fields + DATETIME,combo,conname             
            | mvexpand combo                                                   
            | rex field=combo "(?&lt;qname&gt;.*),(?&lt;bname&gt;.*),(?&lt;qoptime&gt;.*),(?&lt;qcltime&gt;.*),(?&lt;getcpu&gt;.*),(?&lt;getelap&gt;.*),(?&lt;getcnt&gt;.*),(?&lt;putcpu&gt;.*),(?&lt;putelap&gt;.*),(?&lt;putcnt&gt;.*),(?&lt;maxqdepth&gt;.*)"    
            | where (("$connectionname$"=="All Connections") OR (conname=="$connectionname$" )) AND   
                    (("$baseqname$"=="All Base Queues") OR (bname=="$baseqname$")) AND                                
                    (("$queuename$"=="All Queue Names") OR (qname=="$queuename$"))
            |  eval putcnt = if(putcnt==0,1,putcnt) | eval getcnt = if(getcnt==0,1,getcnt)
            | eval byfield = if("$displayby$"=="Displayed by Connection",conname,if("$displayby$"=="Displayed By Base Queue",bname,qname))</query>
    <earliest>$timetoken.earliest$</earliest>
    <latest>$timetoken.latest$</latest>
  </search>
  <row>
    <panel>
      <chart>
        <title>Queue Response Time in Seconds for Connection : $connectionname$, Base Queue: $baseqname$, Queue: $queuename$  $displayby$</title>
        <search base="mainsearch">
          <query>| eval stoptime        = strptime(qcltime, "%Y-%m-%d %H:%M:%S.%N")                                 | eval starttime       = strptime(qoptime, "%Y-%m-%d %H:%M:%S.%N")                       | eval response_time    = stoptime-starttime                                                 | eval rtime=tostring(response_time, "duration")                                       | timechart span=5s sum(response_time) by byfield useother=f limit=30</query>
        </search>
        <option name="charting.chart">line</option>
        <option name="charting.axisY2.enabled">0</option>
        <option name="charting.axisLabelsX.majorLabelStyle.overflowMode">ellipsisNone</option>
        <option name="charting.axisLabelsX.majorLabelStyle.rotation">0</option>
        <option name="charting.axisTitleX.visibility">visible</option>
        <option name="charting.axisTitleY.visibility">visible</option>
        <option name="charting.axisTitleY2.visibility">visible</option>
        <option name="charting.axisX.scale">linear</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.axisY2.scale">inherit</option>
        <option name="charting.chart.bubbleMaximumSize">50</option>
        <option name="charting.chart.bubbleMinimumSize">10</option>
        <option name="charting.chart.bubbleSizeBy">area</option>
        <option name="charting.chart.nullValueMode">zero</option>
        <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
        <option name="charting.chart.stackMode">default</option>
        <option name="charting.chart.style">shiny</option>
        <option name="charting.drilldown">all</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
        <option name="charting.legend.placement">right</option>
        <selection>
          <set token="tokStart">$start$</set>
          <set token="tokEnd">$end$</set>
        </selection>
      </chart>
    </panel>
  </row>
  <row>
    <panel>
      <chart>
        <title>GET and PUT CPU Time in Seconds for Connection : $connectionname$, Base Queue: $baseqname$, Queue: $queuename$   $displayby$</title>
        <search base="mainsearch">
          <query>| convert mstime(putcpu) as putdur | convert mstime(getcpu) as getdur       
            | timechart sum(putdur) as "PUT CPUs" sum(getdur) as "GET CPUs" by byfield useother=f limit=60</query>
        </search>
        <option name="charting.chart">line</option>
        <option name="charting.axisY2.enabled">false</option>
        <option name="charting.axisLabelsX.majorLabelStyle.overflowMode">ellipsisNone</option>
        <option name="charting.axisLabelsX.majorLabelStyle.rotation">0</option>
        <option name="charting.axisTitleX.visibility">visible</option>
        <option name="charting.axisTitleY.visibility">visible</option>
        <option name="charting.axisTitleY2.visibility">visible</option>
        <option name="charting.axisX.scale">linear</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.axisY2.scale">inherit</option>
        <option name="charting.chart.bubbleMaximumSize">50</option>
        <option name="charting.chart.bubbleMinimumSize">10</option>
        <option name="charting.chart.bubbleSizeBy">area</option>
        <option name="charting.chart.nullValueMode">zero</option>
        <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
        <option name="charting.chart.stackMode">default</option>
        <option name="charting.chart.style">shiny</option>
        <option name="charting.drilldown">all</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
        <option name="charting.legend.placement">right</option>
      </chart>
    </panel>
  </row>
  <row>
    <panel>
      <chart>
        <title>GET and PUT counts for Connection : $connectionname$, Base Queue: $baseqname$, Queue: $queuename$   $displayby$</title>
        <search base="mainsearch">
          <query>| timechart sum(putcnt) as "#PUT" sum(getcnt) as "#GET" by byfield useother=f limit=60</query>
        </search>
        <option name="charting.chart">line</option>
        <option name="charting.axisY2.enabled">0</option>
        <option name="charting.axisLabelsX.majorLabelStyle.overflowMode">ellipsisNone</option>
        <option name="charting.axisLabelsX.majorLabelStyle.rotation">0</option>
        <option name="charting.axisTitleX.visibility">visible</option>
        <option name="charting.axisTitleY.visibility">visible</option>
        <option name="charting.axisTitleY2.visibility">visible</option>
        <option name="charting.axisX.scale">linear</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.axisY2.scale">inherit</option>
        <option name="charting.chart.bubbleMaximumSize">50</option>
        <option name="charting.chart.bubbleMinimumSize">10</option>
        <option name="charting.chart.bubbleSizeBy">area</option>
        <option name="charting.chart.nullValueMode">zero</option>
        <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
        <option name="charting.chart.stackMode">default</option>
        <option name="charting.chart.style">shiny</option>
        <option name="charting.drilldown">all</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
        <option name="charting.legend.placement">right</option>
      </chart>
    </panel>
  </row>
  <row>
    <panel>
      <chart>
        <title>Elapsed Time in Seconds for Connection : $connectionname$, Base Queue: $baseqname$, Queue: $queuename$   $displayby$</title>
        <search base="mainsearch">
          <query>| convert mstime(putelap) as putdur 
            | convert mstime(getelap) as getdur              
            | timechart sum(putdur) as "PUT time" sum(getdur) as "GET time" by byfield useother=f limit=60</query>
        </search>
        <option name="charting.chart">line</option>
        <option name="charting.axisY2.enabled">0</option>
        <option name="charting.axisLabelsX.majorLabelStyle.overflowMode">ellipsisNone</option>
        <option name="charting.axisLabelsX.majorLabelStyle.rotation">0</option>
        <option name="charting.axisTitleX.visibility">visible</option>
        <option name="charting.axisTitleY.visibility">visible</option>
        <option name="charting.axisTitleY2.visibility">visible</option>
        <option name="charting.axisX.scale">linear</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.axisY2.scale">inherit</option>
        <option name="charting.chart.bubbleMaximumSize">50</option>
        <option name="charting.chart.bubbleMinimumSize">10</option>
        <option name="charting.chart.bubbleSizeBy">area</option>
        <option name="charting.chart.nullValueMode">zero</option>
        <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
        <option name="charting.chart.stackMode">default</option>
        <option name="charting.chart.style">shiny</option>
        <option name="charting.drilldown">all</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
        <option name="charting.legend.placement">right</option>
      </chart>
    </panel>
  </row>
  <row>
    <panel>
      <chart>
        <title>Max Queue Depth for Connection : $connectionname$, Base Queue: $baseqname$, Queue: $queuename$</title>
        <search base="mainsearch">
          <query>| timechart sum(maxqdepth) by byfield</query>
        </search>
        <option name="charting.chart">line</option>
        <option name="charting.axisY2.enabled">0</option>
        <option name="charting.axisLabelsX.majorLabelStyle.overflowMode">ellipsisNone</option>
        <option name="charting.axisLabelsX.majorLabelStyle.rotation">0</option>
        <option name="charting.axisTitleX.visibility">visible</option>
        <option name="charting.axisTitleY.visibility">visible</option>
        <option name="charting.axisTitleY2.visibility">visible</option>
        <option name="charting.axisX.scale">linear</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.axisY2.scale">inherit</option>
        <option name="charting.chart.bubbleMaximumSize">50</option>
        <option name="charting.chart.bubbleMinimumSize">10</option>
        <option name="charting.chart.bubbleSizeBy">area</option>
        <option name="charting.chart.nullValueMode">zero</option>
        <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
        <option name="charting.chart.stackMode">default</option>
        <option name="charting.chart.style">shiny</option>
        <option name="charting.drilldown">all</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
        <option name="charting.legend.placement">right</option>
      </chart>
    </panel>
  </row>
</form>