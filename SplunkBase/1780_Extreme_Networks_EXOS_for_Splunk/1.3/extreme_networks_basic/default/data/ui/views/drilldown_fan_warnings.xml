<form>
  <label>Drilldown: Fan Warnings</label>
  <description/>
  <fieldset autoRun="true" submitButton="false">
    <input type="time" searchWhenChanged="true">
      <default>Last 30 days</default>
    </input>
  </fieldset>
  <row>
    <table>
      <title>Fan Warnings for $form.devSN$</title>
      <searchString>index=extnet sourcetype=log fan failed  | rex max_match=0 "\s&lt;Warn:DM\.Warning&gt;(\s:\s|\s)Switch,\sCode\s5:\sFan\stray\s(?&lt;fanTray&gt;\d+),\sfan\s#(?&lt;fanNum&gt;\d+),\shas\sfailed\.\sRPM\s\((?&lt;fanRPM&gt;\d+)\)\sis\sout\sof\soperating\srange\swhich\sis\sat\sor\sabove\s(?&lt;fanOpRng&gt;\d+)\.\s\((?&lt;devModel&gt;\S+),\sP\/N:\s(?&lt;devNum&gt;\S+),\sS\/N:\s(?&lt;devSN&gt;\S+),\s(?&lt;revNum&gt;Rev:\s\d+\.\d+)\)" | eval eventTime=strftime(_time,"%Y-%m-%d %H:%M:%S") | search devSN=$form.devSN$ | dedup _time,host,fanTray,fanNum |  table eventTime,host,fanTray,fanNum,fanRPM,fanOpRng,devModel,devNum,devSN,revNum | sort -eventTime | rename fanTray as "Fan Tray" fanNum as "Fan Number" fanRPM as "Fan RPM" fanOpRng as "Fan Operating Range" devModel as "Device Model" devNum as "Device Type" devSN as "Device Serial Number" revNum as "Revision" eventTime as "Event Time" host as "Host"</searchString>
      <earliestTime>$earliest$</earliestTime>
      <latestTime>$latest$</latestTime>
      <option name="wrap">true</option>
      <option name="rowNumbers">false</option>
      <option name="dataOverlayMode">none</option>
      <option name="drilldown">row</option>
      <option name="count">10</option>
    </table>
  </row>
</form>