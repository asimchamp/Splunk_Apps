<dashboard>
  <label>Drilldown: Features</label>
  <description></description>
  <row>
    <table>
      <title>Systems with $form.feature$ Enabled</title>
      <search>
        <query>index=extnet sourcetype=config | rex max_match=0 "enable\s+(?&lt;feature&gt;acl|lldp|oam|poe|vlan|fdb|avb|dcbx|xnv|pbn|trill|ipv4|ipv6|msdp|cna|bfd|cfm|vpls|vpws|mlag|stp|l3vpn|elrp|esrp|vrrpv3|sharing|mirroring|qos|vman|snmp|bgp|epm|erps|eaps|esrp|mpls|isis|ospf|ospfv3|rip|ripng|pim|vrrp|tech-support\scollector)"|  mvexpand feature | dedup host,feature | search feature="$form.feature$" | stats count by host | rename host as "Host"</query>
        <earliest>@y</earliest>
        <latest>now</latest>
      </search>
      <option name="wrap">true</option>
      <option name="rowNumbers">false</option>
      <option name="dataOverlayMode">none</option>
      <option name="drilldown">row</option>
      <option name="count">10</option>
    </table>
  </row>
  <row>
    <table>
      <title>Unlicensed Features</title>
      <searchString>index=extnet sourcetype=process | dedup host | rex max_match=0 "((MM-|Slot-|MSM-)(?&lt;slotNum&gt;\w+)\s+|)(?&lt;procName&gt;\w+)\s+((?&lt;verNum&gt;\d+.\d+.\d+&gt;\d+)|Not\sStarted)\s+\d+\s+(?&lt;status&gt;No\slicense)\s+(?&lt;started&gt;(Not\sStarted|Ready))" | eval fields=mvzip(procName,status) | eval fields=mvzip(fields,started) | eval fields=if(isnotnull(slotNum),mvzip(fields,slotNum),fields) | mvexpand fields | rex field=fields "(?&lt;pName&gt;\w+),(?&lt;pStatus&gt;(No\slicense|NotStarted)),(?&lt;pStart&gt;(Not\sStarted)|Ready)(,(?&lt;pSlot&gt;\w+)|)" | table host pSlot pName pStatus pStart | rename host as "IP Address" pSlot as "Slot" pName as "Process" pStatus as "License Status" pStart as "Process Status"</searchString>
      <earliestTime>-30d@d</earliestTime>
      <latestTime>now</latestTime>
      <option name="wrap">true</option>
      <option name="rowNumbers">false</option>
      <option name="dataOverlayMode">none</option>
      <option name="drilldown">cell</option>
      <option name="count">10</option>
    </table>
    <table>
      <title>Licensed but Not Started</title>
      <searchString>index=extnet sourcetype=process | dedup host | rex max_match=0 "((MM-|Slot-|MSM-)(?&lt;slotNum&gt;\w+)\s+|)(?&lt;procName&gt;\w+)\s+(?&lt;verNum&gt;Not\sStarted)\s+\d+\s+(?&lt;status&gt;NotStarted)\s+(?&lt;started&gt;Not\sStarted)" | eval fields=if(isnotnull(status),mvzip(procName,status),fields) | eval fields=if(isnotnull(started),mvzip(fields,started),fields) | eval fields=if(isnotnull(slotNum),mvzip(fields,slotNum),fields) | mvexpand fields | rex field=fields "(?&lt;pName&gt;\w+),(?&lt;pStatus&gt;NotStarted),(?&lt;pStart&gt;Not\sStarted)(,(?&lt;pSlot&gt;\w+)|)" | where pStatus="NotStarted" | table host pSlot pName pStart | rename host as "IP Address" pSlot as "Slot" pName as "Process"  pStart as "Process Status"</searchString>
      <earliestTime>-30d@d</earliestTime>
      <latestTime>now</latestTime>
      <option name="wrap">true</option>
      <option name="rowNumbers">false</option>
      <option name="dataOverlayMode">none</option>
      <option name="drilldown">row</option>
      <option name="count">10</option>
    </table>
  </row>
</dashboard>