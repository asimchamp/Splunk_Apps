<form>
  <label>Drilldown: Memory Usage</label>
  <description/>
  <fieldset autoRun="true" submitButton="false">
    <input type="time" searchWhenChanged="true">
      <default>Last 30 days</default>
    </input>
  </fieldset>
  <row>
    <chart>
      <title>Memory Usage over Time</title>
      <searchString>index=extnet sourcetype=memory | rex max_match=0 "(MSM-(?&lt;slotMSM&gt;\w+)\s+|MM-(?&lt;slotMM&gt;\w+)\s+|Slot-(?&lt;slotNum&gt;\w+)\s+|)Total(\sDRAM\s|\s+)\(KB\):\s+(?&lt;totalDRAM&gt;\d+)"   | rex max_match=0 "(MSM-\w+\s+|MM-\w+|Slot-\w+\s+|)System\s+\(KB\):\s+(?&lt;sysDRAM&gt;\d+)"   | rex max_match=0 "(MSM-\w+\s+|MM-\w+|Slot-\w+\s+|Slot-\w+\s+|)User\s+\(KB\):\s+(?&lt;userDRAM&gt;\d+)"   | rex max_match=0 "(MSM-\w+\s+|MM-\w+|Slot-\w+\s+|Slot-\w+\s+|)Free\s+\(KB\):\s+(?&lt;freeDRAM&gt;\d+)"  | eval memSlot=if(isnotnull(slotMSM),slotMSM,memSlot) | eval memSlot=if(isnotnull(slotNum),slotNum,memSlot) | eval memSlot=if(isnotnull(slotMM),slotMM,memSlot) | eval fields=mvzip(totalDRAM,freeDRAM) | eval fields=if(isnotnull(memSlot),mvzip(fields,memSlot),fields) | mvexpand fields | rex field=fields "(?&lt;fieldTotal&gt;\w+),(?&lt;fieldFree&gt;\d+)(,(?&lt;fieldSlot&gt;\d+)|)" | eval fieldSlot=if(isnull(fieldSlot),"Solo",fieldSlot) | eval pctFree=(fieldFree/fieldTotal)*100 | search host=$form.host$ | sort _time | timechart values(pctFree) by fieldSlot</searchString>
      <earliestTime>$earliest$</earliestTime>
      <latestTime>$latest$</latestTime>
      <option name="charting.axisTitleX.visibility">visible</option>
      <option name="charting.axisTitleY.visibility">visible</option>
      <option name="charting.axisX.scale">linear</option>
      <option name="charting.axisY.scale">linear</option>
      <option name="charting.chart">line</option>
      <option name="charting.chart.nullValueMode">connect</option>
      <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
      <option name="charting.chart.stackMode">default</option>
      <option name="charting.chart.style">shiny</option>
      <option name="charting.drilldown">all</option>
      <option name="charting.layout.splitSeries">0</option>
      <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
      <option name="charting.legend.placement">right</option>
      <option name="wrap">true</option>
      <option name="rowNumbers">false</option>
      <option name="dataOverlayMode">none</option>
      <option name="drilldown">cell</option>
      <option name="charting.axisY.maximumNumber">100</option>
      <option name="charting.axisY.minimumNumber">0</option>
      <option name="charting.axisLabelsY.majorUnit">25</option>
    </chart>
  </row>
  <row>
    <table>
      <title>Processes</title>
      <searchString>index=extnet sourcetype=memory host=$form.host$ | dedup host |  rex max_match=0 "(MSM-\w+\s+(?&lt;slotMSM&gt;\w+)\s+|MM-\w+\s+(?&lt;slotMM&gt;\w+)\s+|Slot-\d+\s+(?&lt;slotNum&gt;\d+)\s+|)(?&lt;procName&gt;\w+)\s+(?&lt;procDRAM&gt;\d+)\s+" | eval procSlot=if(isnotnull(slotMSM),slotMSM,procSlot) | eval procSlot=if(isnotnull(slotNum),slotNum,procSlot) | eval procSlot=if(isnotnull(slotMM),slotMM,procSlot)| eval procFields=mvzip(procName,procDRAM) | eval procFields=if(isnotnull(procSlot),(mvzip(procFields,procSlot)),procFields) | mvexpand procFields | rex field=procFields "(?&lt;pName&gt;\w+),(?&lt;pDRAM&gt;\d+)(,(?&lt;pSlot&gt;\w+)|)" | where pDRAM&gt;4000 | eval pDRAM=round(pDRAM/1024,2) | table pSlot,pName,pDRAM | sort -pDRAM | rename pSlot as "Slot" pName as "Process" pDRAM as "Process DRAM (MB)"</searchString>
      <earliestTime>$earliest$</earliestTime>
      <latestTime>$latest$</latestTime>
      <option name="wrap">true</option>
      <option name="rowNumbers">false</option>
      <option name="dataOverlayMode">none</option>
      <option name="drilldown">row</option>
      <option name="count">10</option>
      <option name="charting.axisTitleX.visibility">visible</option>
      <option name="charting.axisTitleY.visibility">visible</option>
      <option name="charting.axisX.scale">linear</option>
      <option name="charting.axisY.scale">linear</option>
      <option name="charting.chart">line</option>
      <option name="charting.chart.nullValueMode">gaps</option>
      <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
      <option name="charting.chart.stackMode">default</option>
      <option name="charting.chart.style">shiny</option>
      <option name="charting.drilldown">all</option>
      <option name="charting.layout.splitSeries">0</option>
      <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
      <option name="charting.legend.placement">right</option>
    </table>
  </row>
</form>