<?xml version="1.0"?>
<view autoCancelInterval="90" isVisible="true" objectMode="SimpleDashboard" onunloadCancelJobs="False" refresh="-1" template="dashboard.html">
  <label>Map</label>
  <module name="AccountBar" layoutPanel="appHeader"/>
  <module name="AppBar" layoutPanel="navigationHeader"/>
  <module name="Message" layoutPanel="messaging">
    <param name="filter">*</param>
    <param name="clearOnJobDispatch">False</param>
    <param name="maxSize">1</param>
  </module>
  <module name="DashboardTitleBar" layoutPanel="viewHeader"/>
  <module name="Message" layoutPanel="navigationHeader">
    <param name="filter">splunk.search.job</param>
    <param name="clearOnJobDispatch">True</param>
    <param name="maxSize">1</param>
    <param name="level">warn</param>
  </module>

  <module name="HiddenSearch" layoutPanel="panel_row2_col1" autoRun="true">
    <param name="search">
      `smspasscode-index` sourcetype="WinEventLog:SmsCL" (AuthResult="Authentication failure" OR AuthResult="Authentication success") | stats values(AuthResult) AS AuthVals by End_user_IP, LoginAccount | where (AuthVals="Authentication failure" AND NOT AuthVals="Authentication success") | geoip End_user_IP 
    </param>
    <param name="earliest">-30d@d</param>
    <param name="latest">now</param>

    <module name="GoogleMaps" group="Alerts - last 30 days">
      <param name="height">600px</param>
      <param name="mapType">roadmap</param>
      <param name="scrollwheel">off</param>
    </module>
    
    <module name="HiddenPostProcess" layoutPanel="panel_row3_col1" group="Details">
      <param name="search">
	`smspasscode-index` geoip End_user_IP | where End_user_IP_country_name != "" | fields End_user_IP, LoginAccount, End_user_IP_country_name, End_user_IP_city | rename End_user_IP AS "Enduser IP", LoginAccount AS "Username", End_user_IP_country_name AS "Enduser country", End_user_IP_city AS "Enduser city"
      </param>
      <module name="SimpleResultsTable">
 <param name="drilldown">all</param>
 <param name="entityName">results</param>
 <param name="allowTransformedFieldSelect">True</param>
 <module name="Gimp"/>
 <module name="SimpleDrilldown">
   <param name="links">
     <param name="Component">
       /app/SCADA_OG/bearing_details?form.bearing_id=$row.Component$
     </param>
   </param>
 </module>
      </module>
    </module>
  </module>
  <!-- End Map Portion -->

</view>