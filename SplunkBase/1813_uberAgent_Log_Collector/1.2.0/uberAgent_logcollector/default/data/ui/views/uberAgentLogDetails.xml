<?xml version='1.0' encoding='utf-8'?>
<form script="main.js" stylesheet="main.css">

   <label>uberAgent log file details</label>
   <description>Entire uberAgent log file with filtering options</description>
   
   <init>
    <set token="LogDataTableHint">true</set>
    <unset token="LogDataTableShow"/>
   </init>

   <fieldset autoRun="false" submitButton="true">
      <input type="time" id="TimeRange1" searchWhenChanged="true">
         <label>Time range:</label>
         <default>
            <earliest>-1h</earliest>
            <latest>now</latest>
         </default>
         <change>
            <eval token="TimeRangePickerSpan">relative_time(now(), latest) - relative_time(now(), earliest)</eval>
            <eval token="PivotPeriodAutoSolo">case('TimeRangePickerSpan' &lt; 350000, "auto", 'TimeRangePickerSpan' &lt; 610000, "hour", 1=1, "auto")</eval>
            <eval token="PivotPeriodAutoTimechart">case('TimeRangePickerSpan' &lt; 1200, "second", 'TimeRangePickerSpan' &lt; 300000, "minute", 'TimeRangePickerSpan' &lt; 700000, "hour", 1=1, "day")</eval>
         </change>
      </input>
      <input type="dropdown" token="FilterField" id="Input_FilterField">
         <label>Filter field:</label>
      </input>
      <input type="dropdown" token="FilterOperator" id="Input_FilterOperator">
         <label>Filter operator:</label>
      </input>
      <input type="text" token="FilterExpression" id="Input_FilterExpression">
         <label>Filter expression:</label>
         <default>*</default>
      </input>
      <input type="dropdown" token="FilterField2" id="Input_FilterField2" depends="$FilterLevel2$">
      </input>
      <input type="dropdown" token="FilterOperator2" id="Input_FilterOperator2" depends="$FilterLevel2$">
      </input>
      <input type="text" token="FilterExpression2" id="Input_FilterExpression2" depends="$FilterLevel2$">
      </input>
      <input type="dropdown" token="FilterField3" id="Input_FilterField3" depends="$FilterLevel3$">
      </input>
      <input type="dropdown" token="FilterOperator3" id="Input_FilterOperator3" depends="$FilterLevel3$">
      </input>
      <input type="text" token="FilterExpression3" id="Input_FilterExpression3" depends="$FilterLevel3$">
      </input>
      <input type="dropdown" token="FilterField4" id="Input_FilterField4" depends="$FilterLevel4$">
      </input>
      <input type="dropdown" token="FilterOperator4" id="Input_FilterOperator4" depends="$FilterLevel4$">
      </input>
      <input type="text" token="FilterExpression4" id="Input_FilterExpression4" depends="$FilterLevel4$">
      </input>
      <input type="dropdown" token="FilterField5" id="Input_FilterField5" depends="$FilterLevel5$">
      </input>
      <input type="dropdown" token="FilterOperator5" id="Input_FilterOperator5" depends="$FilterLevel5$">
      </input>
      <input type="text" token="FilterExpression5" id="Input_FilterExpression5" depends="$FilterLevel5$">
      </input>
      <input type="dropdown" token="FilterField6" id="Input_FilterField6" depends="$FilterLevel6$">
      </input>
      <input type="dropdown" token="FilterOperator6" id="Input_FilterOperator6" depends="$FilterLevel6$">
      </input>
      <input type="text" token="FilterExpression6" id="Input_FilterExpression6" depends="$FilterLevel6$">
      </input>
      <input type="text" token="FilterLevels" id="Input_FilterLevels" depends="$FilterLevels_Hidden$">
      </input>
      <input type="text" token="FilterDatamodel" id="Input_FilterDatamodel" depends="$FilterDatamodel_Hidden$">
         <default>Meta_uberAgentLog</default>
      </input>
   </fieldset>

   <!-- Row 1 -->
   <row>
      <panel>
         <title>Log file to display:</title>
         <input type="dropdown" token="Dataset" searchWhenChanged="true">
            <label></label>
            <default>Meta_uberAgentLog</default>
            <choice value="Meta_uberAgentLog">uberAgent.log</choice>
            <choice value="Meta_uAInSessionHelperLog">uAInSessionHelper.log</choice>
            <choice value="Meta_uAIEExtensionLog">uberAgentIEExtension.log</choice>
            <choice value="Meta_uASandboxLog">uberAgentSandbox.log</choice>
        </input>
      </panel>
      <panel>
         <title>Severities to display:</title>
         <input type="multiselect" token="FieldFilter" id="Input_Panel31FieldFilter" searchWhenChanged="true">
            <choice value='"ERROR"'>Error</choice>
            <choice value='"WARN"'>Warning</choice>
            <choice value='"INFO"'>Information</choice>
            <choice value='"DEBUG"'>Debug</choice>
            <default>
               Warning,
               Error
            </default>
            <label></label>
            <prefix>filter Severity in (</prefix>
            <suffix>)</suffix>
            <valuePrefix></valuePrefix>
            <valueSuffix></valueSuffix>
            <delimiter>,</delimiter>
         </input>
      </panel>      
   </row>

   <!-- Row 2 -->
   <row>
      <panel depends="$LogDataTableHint$">
        <html>
        <p>Hit the Submit button to show log details</p>
        </html>
      </panel>
      <panel depends="$LogDataTableShow$">
         <table>
         <title>Log data</title>
            <search>
               <query>
                  | pivot uberAgentMeta $Dataset$
                     latest(Severity) as Severity
                     latest(ThreadId) as ThreadId
                     latest(ThreadOwner) as ThreadOwner
                     latest(Category) as Category
                     latest(Domain) as Domain
                     splitrow
                        Message
                     splitrow
                        _time
                     $SearchFilter$
                     $FieldFilter$
                  | sort - _time
                  | fields _time Severity Domain ThreadOwner ThreadId Category Message
               </query>
            </search>
            <option name="count">50</option>
         </table>
      </panel>
   </row>   

</form>