##################################
#
# xenserver
#
##################################
[hypervisor:xenserver:pool]
FIELDALIAS-Pool = name_label AS hyp_clust_name pool_uuid AS hyp_clust_id

[hypervisor:xenserver:host]
FIELDALIAS-Host = host_uuid AS host_id name_label AS hyp_hostname memory_total AS hyp_memory
EXTRACT-cpu_count = (?i)'cpu_count': '(?P<cpu_count>[^']+)

[hypervisor:xenserver:vm]
FIELDALIAS-VM = name_label AS vm_name vm_uuid AS vm_id resident_on_hostname AS vm_host power_state AS vm_power_state pv_drivers_version AS vm_toolstack_version vcpus_at_startup AS vm_cpu_count
EXTRACT-guestOS = (?i)'name': '(?P<guestOS>[^'|\|]+)
#LOOKUP-hv_type = hv_type_lookup sourcetype AS sourcetype OUTPUTNEW hv_type AS hv_type

[hypervisor:performance:xenserver:host]
FIELDALIAS-HostPerf = memory_total_kib AS mem_total memory_free_kib AS mem_free hostname AS hyp_hostname

[hypervisor:performance:xenserver:vm]
FIELDALIAS-VM = name_label AS vm_name vm_uuid AS vm_id hostname AS vm_host cpu_sum AS cpu_percent_sum memory_target AS mem_total memory_internal_free AS mem_free memory_internal_free AS "Available Bytes"

[hypervisor:xenserver:message]
FIELDALIAS-Message = body AS msg_body message_uuid AS msg_id cls AS msg_sourcetype priority AS msg_type name_label AS msg_source
LOOKUP-xs_msg_subject = xs_msg_subject_lookup message_name AS name OUTPUTNEW message_subject AS msg_subject
LOOKUP-xs_message_object = xs_object_id_lookup obj_uuid AS obj_uuid OUTPUTNEW name_label AS msg_source

[hypervisor:xenserver:sr]
FIELDALIAS-SR = pool_uuid AS hyp_clust_id sr_uuid as sr_id name_label AS sr_name name_description AS sr_desc physical_size AS sr_size physical_utilisation AS sr_util shared AS sr_shared

[hypervisor:xenserver:vdisk]
FIELDALIAS-VDisk = pool_uuid AS hyp_clust_id sr_uuid AS sr_id

##################################
#
# Hyper-V
#
##################################
[hypervisor:hyperv:host]
FIELDALIAS-Host = Hostname AS hyp_hostname Product AS product TotalPhysicalMemory AS hyp_memory NumberOfLogicalProcessors AS cpu_count

[hypervisor:hyperv:vm]
FIELDALIAS-VM = Name AS vm_id ElementName as vm_name host AS vm_host OSName AS guestOS EnabledState AS vm_power_state IntegrationServicesVersion AS vm_toolstack_version NumberOfProcessors AS vm_cpu_count
#LOOKUP-hv_type = hv_type_lookup sourcetype AS sourcetype OUTPUTNEW hv_type AS hv_type
#KV_MODE = multi_delimiterTSV
#LINE_BREAKER = ([\r\n]{2,})
#TIME_PREFIX = ^. timeCollected:
#TIME_FORMAT = %Y-%m-%dT%H:%M:%S.%6N
#MAX_TIMESTAMP_LOOKAHEAD = 40
#SHOULD_LINEMERGE = true

[Perfmon:HyperV_Network]
REPORT-vm_name = network_extract_vm_name

[Perfmon:HyperV_Virtual_Processor]
REPORT-vm_name = proc_extract_vm_name

[Perfmon:CPULoad]
FIELDALIAS-Host = host AS hyp_hostname

[Perfmon:AvailableMemory]
FIELDALIAS-Host = host AS hyp_hostname

[Perfmon:NetworkInterface]
FIELDALIAS-Host = host AS hyp_hostname

[(?::){0}WinEventLog:*]
FIELDALIAS-Message = Message AS msg_body RecordNumber AS msg_id SourceName AS msg_sourcetype Type as msg_type ComputerName as msg_source
EXTRACT-msg_subject = (?i)Message=(?P<msg_subject>.[^\n]+)

[hypervisor:hyperv:vm:disk]
FIELDALIAS-Disk = cluster_id as hyp_clust_id vdisk_utilization AS vdisk_util

[hypervisor:hyperv:host:clusterstorage]
FIELDALIAS-SR = cluster_id as hyp_clust_id description AS sr_desc name AS sr_name shared AS sr_shared physical_size AS sr_size physical_utilisation AS sr_util

[Perfmon:HyperV_Virtual_Storage_Device]
FIELDALIAS-DiskPerf = instance AS vm_name

##################################
#
# Multikv Extractions
#
##################################


#[hypervisor:hyperv:vm:disk]
#KV_MODE = multi_delimiterTSV
#LINE_BREAKER = ([\r\n]{2,})
#TIME_PREFIX = ^. timeCollected:
#TIME_FORMAT = %Y-%m-%dT%H:%M:%S.%6N
#MAX_TIMESTAMP_LOOKAHEAD = 40
#SHOULD_LINEMERGE = true