<?xml version="1.0" encoding="UTF-8"?>
<view autoCancelInterval="90" isPersistable="true" isSticky="true" isVisible="true" objectMode="viewconf" onunloadCancelJobs="true" stylesheet="alerts.css" template="dashboard.html">
    <label>System Alerts</label>
    <module name="AccountBar" layoutPanel="appHeader"/>
    <module name="AppBar" layoutPanel="navigationHeader"/>
    <module name="Message" layoutPanel="messaging">
        <param name="filter">*</param>
        <param name="clearOnJobDispatch">False</param>
        <param name="maxSize">1</param>
    </module>
    <module name="TitleBar" layoutPanel="viewHeader">
        <param name="actionsMenuFilter">dashboard</param>
    </module>
    
    <module name="GenericHeader" layoutPanel="panel_row1_col1">
        <param name="label">Alerts</param>
    </module>
    
    <module name="StaticContentSample" layoutPanel="panel_row1_col1">
        <param name="text">
            This dashboard displays the Alerts that have been found.
            These alerts have been configured to monitor the overall environment health by measuring thresholds of different aspects of the hypervisor infrastructure and virtual machines.
            Examples include "High CPU utilization", "High vCPU to pCPU Ratio", "Low available memory", etc.
            
            <![CDATA[<br /><br />]]>
            
            Alerts are simply saved searches.  These saved searches can be found <![CDATA[<a href="/manager/SplunkAppForServerVirt/saved/searches">here</a>]]>.
            
            <![CDATA[<br /><br />]]>
            
            The values that trigger alerts are stored as macros.  These values can be found <![CDATA[<a href="/manager/SplunkAppForServerVirt/admin/macros">here</a>]]>.
            
        </param>
    </module>
    
    <module name="StaticSelect" layoutPanel="panel_row1_col2">
        <param name="settingToCreate">alert_type</param>
        <param name="staticFieldsToDisplay">
            <list>
                <param name="value">*</param>
                <param name="label">--- ANY ---</param>
            </list>
            <list>
                <param name="value">Critical</param>
                <param name="label">Critical</param>
            </list>
            <list>
                <param name="value">Warning</param>
                <param name="label">Warning</param>
            </list>
        </param>
        <param name="selected">*</param>
        <param name="label">Severity</param>
        
        <module name="ConvertToIntention">
            <param name="intention">
                <param name="name">addterm</param>
                <param name="arg">
                    <param name="severity">$alert_type$</param>
                </param>
            </param>
            
            <module name="TimeRangePicker" layoutPanel="panel_row1_col2" autoRun="True">
                <param name="searchWhenChanged">True</param>
                <param name="selected">Last 24 Hours</param>

                    <module name="HiddenSearch" layoutPanel="panel_row1_col1" autoRun="True">
                        <param name="search">
                            index=servervirt_alerts | stats count by _time obj_name obj_type alert_name value severity
                        </param>
                        <module name="ViewRedirectorLink" layoutPanel="panel_row1_col1">
                            <param name="viewTarget">flashtimeline</param>
                            <param name="label">View Full Report</param>
                        </module>
                        <module name="JobProgressIndicator"/>
                        
                        <module name="HiddenPostProcess" layoutPanel="panel_row3_col1" group="Alerts by Severity" autoRun="True">
                            <param name="search"> | timechart count by severity</param>
                            <param name="groupLabel">Alerts by Severity</param>
                            <module name="HiddenChartFormatter">
                                <param name="legend.placement">bottom</param>
                                <param name="chart.stackMode">stacked</param>
                                <param name="charting.axisTitleX.text"> </param>
                                <param name="chart">column</param>
                                <module name="JSChart"/>
                            </module>
                        </module>
                        
                        <module name="HiddenPostProcess" layoutPanel="panel_row3_col2" group="Top Affected Objects" autoRun="True">
                            <param name="search">
                                | stats sum(count) as count by obj_name | head 15
                            </param>
                            <param name="groupLabel">Top Affected Objects</param>
                            <module name="HiddenChartFormatter">
                                <param name="chart">pie</param>
                                <param name="charting.axisTitleX.text"> </param>
                                <module name="JSChart">
                                    <param name="height">200px</param>
                                    
                                </module>
                            </module>
                        </module>
                                    
                        <module name="HiddenPostProcess" layoutPanel="panel_row4_col1" group="Alert Detail" autoRun="True">
                            <param name="search">
                                | eval Time=strftime(_time, "%Y-%m-%d %H:%M:%S") |
                                table Time alert_name obj_name obj_type value severity |
                                rename alert_name AS "Alert Name" obj_name AS "Object Name" obj_type AS "Object Type" value AS Value severity AS Severity
                            </param>
                            <module name="SimpleResultsTable">
                                <param name="drilldown">row</param>
                                <param name="displayRowNumbers">False</param>
                                <module name="NullModule" />
                            </module>
                            <module name="ViewRedirectorLink">
                                <param name="viewTarget">flashtimeline</param>
                            </module>
                        </module>
                      
                    </module> <!-- HiddenSearch -->

            </module> <!-- TimeRangePicker -->
        </module> <!-- ConvertToIntention -->
    </module>
</view>
