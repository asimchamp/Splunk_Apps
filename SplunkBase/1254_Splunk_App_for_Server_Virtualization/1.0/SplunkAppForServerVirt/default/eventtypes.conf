##################################
#
# Message eventtypes
#
##################################
[servervirt:message:xenserver]
search = index=servervirt sourcetype=Hypervisor:XenServer:Message

[servervirt:message:hyperv]
search = index=servervirt sourcetype=WinEventLog:*

##################################
#
# Host eventtypes
#
##################################

[servervirt:host]
search = index=servervirt sourcetype=hypervisor:*:host sourcetype != hypervisor:performance:*:host

[servervirt:host:xenserver]
search = index=servervirt sourcetype=hypervisor:xenserver:host sourcetype != hypervisor:performance:xenserver:host

[servervirt:host:hyperv]
search = index=servervirt sourcetype=hypervisor:hyperv:host sourcetype != hypervisor:performance:hyperv:host

# Network
[servervirt:performance:hyperv:host:network]
search = index=servervirt sourcetype=Perfmon:NetworkInterface

[servervirt:performance:xenserver:host:network]
search = index=servervirt sourcetype=hypervisor:performance:xenserver:host object="Network Interface"

# Processor
[servervirt:performance:xenserver:host:processor]
search = index=servervirt sourcetype=hypervisor:performance:xenserver:host object="Processor"

[servervirt:performance:hyperv:host:processor]
search = index=servervirt sourcetype=Perfmon:CPULoad object="Processor" hyp_hostname="*"

# Memory
[servervirt:performance:xenserver:host:memory]
search = index=servervirt sourcetype=hypervisor:performance:xenserver:host object="Memory"

[servervirt:performance:hyperv:host:memory]
search = index=servervirt sourcetype=Perfmon:AvailableMemory object="Memory" hyp_hostname="*"

# Disk
[servervirt:performance:xenserver:host:disk]
search = index=servervirt sourcetype=hypervisor:performance:xenserver:host object="LogicalDisk"

[servervirt:performance:hyperv:host:disk]
search = index=servervirt sourcetype=PERFMON:LogicalDisk hyp_hostname="*"

##################################
#
# VM eventtypes
#
##################################

[servervirt:vm]
search = index=servervirt sourcetype=hypervisor:*:vm sourcetype != hypervisor:performance:*:vm

[servervirt:vm:xenserver]
search = index=servervirt sourcetype=hypervisor:xenserver:vm sourcetype != hypervisor:performance:xenserver:vm

[servervirt:vm:hyperv]
search = index=servervirt sourcetype=hypervisor:hyperv:vm sourcetype != hypervisor:performance:hyperv:vm

# Network
[servervirt:performance:hyperv:vm:network]
search = index=servervirt sourcetype=Perfmon:HyperV_Network vm_name="*"

[servervirt:performance:xenserver:vm:network]
search = index=servervirt sourcetype=hypervisor:performance:xenserver:vm object="Network Interface"

# Processor
[servervirt:performance:xenserver:vm:processor]
search = index=servervirt sourcetype=hypervisor:performance:xenserver:vm object="Processor"

[servervirt:performance:hyperv:vm:processor]
search = index=servervirt sourcetype=Perfmon:HyperV_Virtual_Processor

# Memory
[servervirt:performance:xenserver:vm:memory]
search = index=servervirt sourcetype=hypervisor:performance:xenserver:vm object="Memory"

# Disk
[servervirt:performance:xenserver:vm:disk]
search = index=servervirt sourcetype=hypervisor:performance:xenserver:vm object="Virtual Storage Device"

[servervirt:performance:hyperv:vm:disk]
search = index=servervirt sourcetype=PERFMON:HyperV_Virtual_Storage_Device (counter="Write Bytes/sec" OR counter="Read Bytes/sec")

##################################
#
# Storage eventtypes
#
##################################
[servervirt:xenserver:vdisk]
search = index=servervirt sourcetype=hypervisor:xenserver:vdisk

[servervirt:hyperv:vdisk]
search = index=servervirt sourcetype=hypervisor:hyperv:vm:disk

[servervirt:xenserver:sr]
search = index=servervirt sourcetype=hypervisor:xenserver:sr

[servervirt:hyperv:sr]
search = index=servervirt sourcetype=hypervisor:hyperv:host:clusterstorage

##################################
#
# Cluster eventtypes
#
##################################
[servervirt:xenserver:cluster]
search = index=servervirt sourcetype=hypervisor:xenserver:pool

[servervirt:hyperv:cluster]
search = index=servervirt sourcetype=hypervisor:hyperv:host:clusterdetail