<!-- Idea contributed by Larry Collicott @lycollicott -->
<panel>
  <title>Your Data Access by Role</title>
  <table>
    <search>
      <query>| rest splunk_server=local /services/authentication/current-context 
| fields roles 
| mvexpand roles 
| join type=left roles 
    [ rest /services/authorization/roles 
    | fields title srchIndexesAllowed 
    | rename title AS roles ] 
| makemv tokenizer=(\S+) srchIndexesAllowed
| mvexpand srchIndexesAllowed 
| stats values(*) AS * BY roles
| rename roles as "Your Role(s)", srchIndexesAllowed as "Index(es) You Can Search"</query>
      <sampleRatio>1</sampleRatio>
    </search>
    <option name="count">20</option>
    <option name="dataOverlayMode">none</option>
    <drilldown>
      <condition field="Index(es) You Can Search">
        <link>search?q=index=$click.value2|u$</link>
      </condition>
      <condition field="Your Role(s)">
        <link>search?q=| rest splunk_server=local /services/authentication/users
 | search NOT [ | rest /services/authentication/current-context | fields username | rename username AS title ]
 | search title!="$env:user$"
 | makemv tokenizer=(\S%2B) roles
 | mvexpand roles
 | search roles="$click.value|u$"
 | eval name = if( email!="" , email , title )
 | fields realname, name
 | rename realname AS "Other members of role '$click.value|u$'", name AS "Username"</link>
      </condition>
    </drilldown>
  </table>
</panel>