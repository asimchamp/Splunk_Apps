<form version="1.1" script="timerange.js">
  <label>Performance - Volume Group/Pool by Volume Multiselect (ver 6.1+)</label>
  <fieldset>
    <input type="dropdown" token="arrayId" searchWhenChanged="true">
      <label>Array</label>
      <search fieldForLabel="arrayName" fieldForValue="arrayId">| inputlookup nesa_volume_groups | stats count by arrayId, arrayName</search>
    </input>
    <input type="dropdown" token="controllerLabel" searchWhenChanged="true">
      <label>Controller</label>
      <choice value="*">Any</choice>
      <search fieldForLabel="controllerLabel" fieldForValue="controllerLabel">| inputlookup nesa_controllers | search arrayId="$arrayId$" | dedup controllerLabel</search>
    </input>
    <input type="dropdown" token="volumeGroup" searchWhenChanged="true">
      <label>Volume Groups/Pools</label>
<!--      <choice value="*">Any</choice> -->
      <search fieldForLabel="volumeGroup" fieldForValue="volumeGroup">| inputlookup nesa_volume_groups | search
[| inputlookup nesa_volumes | search
[| inputlookup nesa_controllers | search arrayId="$arrayId$" controllerLabel="$controllerLabel$" | fields arrayId, controllerRef] | fields arrayId, volumeGroupRef ]
| fields volumeGroup</search>
    </input>
    <input type="multiselect" token="volume" searchWhenChanged="true">
      <label>Volume</label>
      <choice value="*">Any</choice>
      <prefix>(</prefix>
      <suffix>)</suffix>
      <valuePrefix>volumeName="</valuePrefix>
      <valueSuffix>"</valueSuffix>
      <delimiter> OR </delimiter>
      <search fieldForLabel="volumeName" fieldForValue="volumeName">
| inputlookup nesa_volumes | search [| inputlookup nesa_controllers | search arrayId="$arrayId$" controllerLabel="$controllerLabel$" | fields arrayId, controllerRef] | search [| inputlookup nesa_volume_groups | search arrayId="$arrayId$" volumeGroup="$volumeGroup$" | fields volumeGroupRef ]
      </search>
    </input>
    <input type="time" searchWhenChanged="true" id="timerange">
      <label>Time</label>
      <default>
        <earliest>-24h</earliest>
        <latest>now</latest>
      </default>
    </input>
  </fieldset>
  <row>
    <panel>
      <chart>
        <title>Read IOPS by Volume</title>
        <search>`get_nesa_index` sourcetype=eseries:volume-stats host="$arrayId$" $volume$
| search volumeGroup="$volumeGroup$" controllerLabel="$controllerLabel$"
| timechart useother=f limit=50 per_second(readIOps) AS reads by volumeName</search>
        <option name="charting.axisY.minimumNumber">0</option>
        <option name="charting.chart">line</option>
        <option name="charting.chart.nullValueMode">connect</option>
        <option name="charting.legend.placement">right</option>
        <option name="charting.axisTitleX.text">Time</option>
        <option name="charting.axisTitleY.text">IOps</option>
        <drilldown>
          <link><![CDATA[
/app/netapp_app_eseries_perf/perf_drives?form.arrayId=$form.arrayId$&form.controllerLabel=$form.controllerLabel$&form.volumeGroup=$form.volumeGroup$]]>
	  </link>
	</drilldown>
      </chart>
    </panel>
    <panel>
      <chart>
        <title>Write IOPS by Volume</title>
        <search>`get_nesa_index` sourcetype=eseries:volume-stats host="$arrayId$" $volume$
| search volumeGroup="$volumeGroup$" controllerLabel="$controllerLabel$"
| timechart useother=f limit=50 per_second(writeIOps) AS writes by volumeName</search>
        <option name="charting.axisY.minimumNumber">0</option>
        <option name="charting.chart">line</option>
        <option name="charting.chart.nullValueMode">connect</option>
        <option name="charting.legend.placement">right</option>
        <option name="charting.axisTitleX.text">Time</option>
        <option name="charting.axisTitleY.text">IOps</option>
        <drilldown>
          <link><![CDATA[
/app/netapp_app_eseries_perf/perf_drives?form.arrayId=$form.arrayId$&form.controllerLabel=$form.controllerLabel$&form.volumeGroup=$form.volumeGroup$]]>
	  </link>
	</drilldown>
      </chart>
    </panel>
  </row>

  <row>
    <panel>
      <chart>
        <title>Read Latency by Volume</title>
        <search>`get_nesa_index` sourcetype=eseries:volume-stats host="$arrayId$" $volume$
| search volumeGroup="$volumeGroup$" controllerLabel="$controllerLabel$"
| timechart useother=f limit=50 mean(readResponseTime) AS read_latency by volumeName</search>
        <option name="charting.axisY.minimumNumber">0</option>
        <option name="charting.chart">line</option>
        <option name="charting.chart.nullValueMode">connect</option>
        <option name="charting.legend.placement">right</option>
        <option name="charting.axisTitleX.text">Time</option>
        <option name="charting.axisTitleY.text">Milliseconds</option>
        <drilldown>
          <link><![CDATA[
/app/netapp_app_eseries_perf/perf_drives?form.arrayId=$form.arrayId$&form.controllerLabel=$form.controllerLabel$&form.volumeGroup=$form.volumeGroup$]]>
	  </link>
	</drilldown>
      </chart>
    </panel>
    <panel>
      <chart>
        <title>Write Latency by Volume</title>
        <search>`get_nesa_index` sourcetype=eseries:volume-stats host="$arrayId$" $volume$
| search volumeGroup="$volumeGroup$" controllerLabel="$controllerLabel$"
| timechart useother=f limit=50 mean(writeResponseTime) AS write_latency by volumeName</search>
        <option name="charting.axisY.minimumNumber">0</option>
        <option name="charting.chart">line</option>
        <option name="charting.chart.nullValueMode">connect</option>
        <option name="charting.legend.placement">right</option>
        <option name="charting.axisTitleX.text">Time</option>
        <option name="charting.axisTitleY.text">Milliseconds</option>
        <drilldown>
          <link><![CDATA[
/app/netapp_app_eseries_perf/perf_drives?form.arrayId=$form.arrayId$&form.controllerLabel=$form.controllerLabel$&form.volumeGroup=$form.volumeGroup$]]>
	  </link>
	</drilldown>
      </chart>
    </panel>
  </row>

  <row>
    <panel>
      <chart>
        <title>Read Throughput by Volume</title>
        <search>`get_nesa_index` sourcetype=eseries:volume-stats host="$arrayId$" $volume$
| search volumeGroup="$volumeGroup$" controllerLabel="$controllerLabel$"
| timechart useother=f limit=50 avg(readThroughput) AS read_thru by volumeName</search>
        <option name="charting.axisY.minimumNumber">0</option>
        <option name="charting.chart">line</option>
        <option name="charting.chart.nullValueMode">connect</option>
        <option name="charting.legend.placement">right</option>
        <option name="charting.axisTitleX.text">Time</option>
        <option name="charting.axisTitleY.text">MBytes</option>
        <drilldown>
          <link><![CDATA[
/app/netapp_app_eseries_perf/perf_drives?form.arrayId=$form.arrayId$&form.controllerLabel=$form.controllerLabel$&form.volumeGroup=$form.volumeGroup$]]>
	  </link>
	</drilldown>
      </chart>
    </panel>
    <panel>
      <chart>
        <title>Write Throughput by Volume</title>
        <search>`get_nesa_index` sourcetype=eseries:volume-stats host="$arrayId$" $volume$
| search volumeGroup="$volumeGroup$" controllerLabel="$controllerLabel$"
| timechart useother=f limit=50 avg(writeThroughput) AS write_thru by volumeName</search>
        <option name="charting.axisY.minimumNumber">0</option>
        <option name="charting.chart">line</option>
        <option name="charting.chart.nullValueMode">connect</option>
        <option name="charting.legend.placement">right</option>
        <option name="charting.axisTitleX.text">Time</option>
        <option name="charting.axisTitleY.text">MBytes</option>
        <drilldown>
          <link><![CDATA[
/app/netapp_app_eseries_perf/perf_drives?form.arrayId=$form.arrayId$&form.controllerLabel=$form.controllerLabel$&form.volumeGroup=$form.volumeGroup$]]>
	  </link>
	</drilldown>
      </chart>
    </panel>
  </row>

  <row>
    <panel>
      <chart>
        <title>Physical Reads by Volume</title>
        <search>`get_nesa_index` sourcetype=eseries:volume-stats host="$arrayId$" $volume$
| search volumeGroup="$volumeGroup$" controllerLabel="$controllerLabel$"
| timechart useother=f limit=50 avg(readPhysicalIOps) AS read_phys by volumeName</search>
        <option name="charting.axisY.minimumNumber">0</option>
        <option name="charting.chart">line</option>
        <option name="charting.chart.nullValueMode">connect</option>
        <option name="charting.legend.placement">right</option>
        <option name="charting.axisTitleX.text">Time</option>
        <option name="charting.axisTitleY.text">IOps</option>
        <drilldown>
          <link><![CDATA[
/app/netapp_app_eseries_perf/perf_drives?form.arrayId=$form.arrayId$&form.controllerLabel=$form.controllerLabel$&form.volumeGroup=$form.volumeGroup$]]>
	  </link>
	</drilldown>
      </chart>
    </panel>
    <panel>
      <chart>
        <title>Physical Writes by Volume</title>
        <search>`get_nesa_index` sourcetype=eseries:volume-stats host="$arrayId$" $volume$
| search volumeGroup="$volumeGroup$" controllerLabel="$controllerLabel$"
| timechart useother=f limit=50 avg(writePhysicalIOps) AS write_phys by volumeName</search>
        <option name="charting.axisY.minimumNumber">0</option>
        <option name="charting.chart">line</option>
        <option name="charting.chart.nullValueMode">connect</option>
        <option name="charting.legend.placement">right</option>
        <option name="charting.axisTitleX.text">Time</option>
        <option name="charting.axisTitleY.text">IOps</option>
        <drilldown>
          <link><![CDATA[
/app/netapp_app_eseries_perf/perf_drives?form.arrayId=$form.arrayId$&form.controllerLabel=$form.controllerLabel$&form.volumeGroup=$form.volumeGroup$]]>
	  </link>
	</drilldown>
      </chart>
    </panel>
  </row>
</form>
