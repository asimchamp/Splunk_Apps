<form version="1.1" stylesheet="application.css,tool-tip.css" script="timerange.js">
  <label>Performance â€“ Array by Drive Channel</label>
  <fieldset submitButton="true" autoRun="true">
    <input type="time" searchWhenChanged="true" id="timerange">
      <label>Time</label>
      <default>	
        <earliest>-24h</earliest>
        <latest>now</latest>
      </default>
    </input>
    <input type="multiselect" token="arrayId" searchWhenChanged="false">
      <label>Array</label>
      <search>
        <query>| inputlookup nesa_volume_groups | stats count by arrayId, arrayName</query>
      </search>
      <fieldForLabel>arrayName</fieldForLabel>
      <fieldForValue>arrayId</fieldForValue>
      <delimiter> OR </delimiter>
      <valuePrefix>host="</valuePrefix>
      <valueSuffix>"</valueSuffix>
      <prefix>(</prefix>
      <suffix>)</suffix>
    </input>
  </fieldset>
  <search id="baseSearch">
    <query>
      `get_nesa_index` sourcetype="eseries:interface-stats" $arrayId$ channelType="driveside" | lookup nesa_controllers arrayId as host OUTPUT arrayName | eval controllerName=if(substr(interfaceId, 4, 1) == "1", "A", "B") | eval arrayName=mvdedup(arrayName) | eval label='arrayName'." ".'controllerName'." - ".'channelNumber' | fields _time label readIOps writeIOps readResponseTime writeResponseTime readThroughput writeThroughput
    </query>
    <earliest>$earliest$</earliest>
    <latest>$latest$</latest>
  </search>
  <row>
    <panel>
      <chart>
        <title>Read IOPS by Drive Channel</title>
        <search base="baseSearch">
          <query>timechart useother=f limit=0 span=5m mean(readIOps) AS reads by label</query>
        </search>
        <option name="charting.axisTitleX.text">Time</option>
        <option name="charting.axisTitleY.text">IOps</option>
        <option name="charting.axisY.minimumNumber">0</option>
        <option name="charting.chart">line</option>
        <option name="charting.chart.nullValueMode">connect</option>
        <option name="charting.drilldown">all</option>
        <option name="charting.legend.placement">right</option>
        <option name="refresh.display">progressbar</option>
      </chart>
    </panel>
    <panel>
      <chart id="writeIOps">
        <title>Write IOPS by Drive Channel</title>
        <search base="baseSearch">
          <query>timechart useother=f limit=0 span=5m mean(writeIOps) AS writes by label</query>
        </search>
        <option name="charting.axisTitleX.text">Time</option>
        <option name="charting.axisTitleY.text">IOps</option>
        <option name="charting.axisY.minimumNumber">0</option>
        <option name="charting.chart">line</option>
        <option name="charting.chart.nullValueMode">connect</option>
        <option name="charting.drilldown">all</option>
        <option name="charting.legend.placement">right</option>
        <option name="refresh.display">progressbar</option>
      </chart>
    </panel>
  </row>
  <row>
    <panel>
      <chart>
        <title>Read Latency by Drive Channel</title>
        <search base="baseSearch">
          <query>timechart useother=f limit=0 span=5m mean(readResponseTime) AS read_latency by label</query>
        </search>
        <option name="charting.axisTitleX.text">Time</option>
        <option name="charting.axisTitleY.text">Milliseconds</option>
        <option name="charting.axisY.minimumNumber">0</option>
        <option name="charting.chart">line</option>
        <option name="charting.chart.nullValueMode">connect</option>
        <option name="charting.drilldown">all</option>
        <option name="charting.legend.placement">right</option>
        <option name="refresh.display">progressbar</option>
      </chart>
    </panel>
    <panel>
      <chart>
        <title>Write Latency by Drive Channel</title>
        <search base="baseSearch">
          <query>timechart useother=f limit=0 span=5m mean(writeResponseTime) AS write_latency by label</query>
        </search>
        <option name="charting.axisTitleX.text">Time</option>
        <option name="charting.axisTitleY.text">Milliseconds</option>
        <option name="charting.axisY.minimumNumber">0</option>
        <option name="charting.chart">line</option>
        <option name="charting.chart.nullValueMode">connect</option>
        <option name="charting.drilldown">all</option>
        <option name="charting.legend.placement">right</option>
        <option name="refresh.display">progressbar</option>
      </chart>
    </panel>
  </row>
  <row>
    <panel>
      <chart>
        <title>Read Throughput by Drive Channel</title>
        <search base="baseSearch">
          <query>timechart useother=f limit=0 span=5m mean(readThroughput) AS read_thru by label</query>
        </search>
        <option name="charting.axisTitleX.text">Time</option>
        <option name="charting.axisTitleY.text">MBytes</option>
        <option name="charting.axisY.minimumNumber">0</option>
        <option name="charting.chart">line</option>
        <option name="charting.chart.nullValueMode">connect</option>
        <option name="charting.drilldown">all</option>
        <option name="charting.legend.placement">right</option>
        <option name="refresh.display">progressbar</option>
      </chart>
    </panel>
    <panel>
      <chart>
        <title>Write Throughput by Drive Channel</title>
        <search base="baseSearch">
          <query>timechart useother=f limit=0 span=5m mean(writeThroughput) AS write_thru by label</query>
        </search>
        <option name="charting.axisTitleX.text">Time</option>
        <option name="charting.axisTitleY.text">MBytes</option>
        <option name="charting.axisY.minimumNumber">0</option>
        <option name="charting.chart">line</option>
        <option name="charting.chart.nullValueMode">connect</option>
        <option name="charting.drilldown">all</option>
        <option name="charting.legend.placement">right</option>
        <option name="refresh.display">progressbar</option>
      </chart>
    </panel>
  </row>
</form>