<form>
  <label>Threat Traffic</label>
  <fieldset submitButton="true" autoRun="true">
    <input type="time">
      <label>Time Range</label>
      <default>
        <earliest>-24h@h</earliest>
        <latest>now</latest>
      </default>
    </input>
    <input type="dropdown" token="top" searchWhenChanged="false">
      <label>Top</label>
      <choice value="10">10</choice>
      <choice value="25">25</choice>
      <choice value="50">50</choice>
      <default>10</default>
      <initialValue>10</initialValue>
    </input>
  </fieldset>
  <row>
    <panel>
      <title>Threat Types</title>
      <viz type="ixflow_app.c3donut">
        <search>
          <query>| tstats `svalue` count from datamodel=Ixia where Ixia_Flow.threat_type!="" by Ixia_Flow.threat_type | sort 0 - count | head $top$</query>
          <earliest>$earliest$</earliest>
          <latest>$latest$</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="ixflow_app.c3donut.expand">true</option>
        <option name="ixflow_app.c3donut.label_format">%</option>
        <option name="ixflow_app.c3donut.label_show">0</option>
        <option name="ixflow_app.c3donut.label_threshold">.05</option>
        <option name="ixflow_app.c3donut.label_value">ratio</option>
        <option name="ixflow_app.c3donut.legend_position">bottom</option>
        <option name="ixflow_app.c3donut.legend_show">1</option>
        <option name="ixflow_app.c3donut.tooltip_format">%</option>
        <option name="ixflow_app.c3donut.tooltip_show">true</option>
        <option name="ixflow_app.c3donut.tooltip_value">default</option>
      </viz>
    </panel>
  </row>
  <row>
    <panel>
      <title>Latest Threat Details</title>
      <table>
        <search>
          <query>| tstats `svalue` count as Counts, latest(Ixia_Flow.flow_end_time_milli) as time,  from datamodel=Ixia where Ixia_Flow.threat_type!="" by Ixia_Flow.threat_type, Ixia_Flow.threat_ip | rename Ixia_Flow.threat_type as "Threat Type", Ixia_Flow.threat_ip as "IPv4/IPv6 Address" | eval time = time/1000 | eval "Last Reported" = strftime(time, "%Y-%M-%d %H:%M:%S %Z") | sort 0 - Counts | table "IPv4/IPv6 Address", "Threat Type", Counts , "Last Reported" | head $top$</query>
          <earliest>$earliest$</earliest>
          <latest>$latest$</latest>
        </search>
        <option name="count">10</option>
        <option name="drilldown">row</option>
        <drilldown>
          <link target="_blank">search?q=sourcetype="stream:netflow" threat_type="$row.Threat Type$" threat_ip="$row.IPv4/IPv6 Address$"&amp;earliest=$earliest$&amp;latest=$latest$</link>
        </drilldown>
      </table>
    </panel>
  </row>
</form>