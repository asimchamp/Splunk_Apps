<form>
  <label>Web/SSL Traffic</label>
  <fieldset submitButton="true" autoRun="true">
    <input type="time">
      <label>Time Range</label>
      <default>
        <earliest>-24h@h</earliest>
        <latest>now</latest>
      </default>
    </input>
    <input type="dropdown" token="top_limit">
      <label>Top</label>
      <choice value="10">10</choice>
      <choice value="25">25</choice>
      <choice value="50">50</choice>
      <default>10</default>
      <initialValue>10</initialValue>
    </input>
  </fieldset>
  <row>
    <panel>
      <title>% Share of Encrypted Traffic</title>
      <viz type="ixflow_app.c3donut">
        <search>
          <query>| tstats `svalue` count(Ixia_Flow.connection_encryption_type) as Count from datamodel=Ixia where (Ixia_Flow.connection_encryption_type!="") by Ixia_Flow.connection_encryption_type | sort 0 -Count | head limit=$top_limit$</query>
          <earliest>$earliest$</earliest>
          <latest>$latest$</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="ixflow_app.c3donut.expand">true</option>
        <option name="ixflow_app.c3donut.label_format">%</option>
        <option name="ixflow_app.c3donut.label_show">0</option>
        <option name="ixflow_app.c3donut.label_threshold">0.05</option>
        <option name="ixflow_app.c3donut.label_value">ratio</option>
        <option name="ixflow_app.c3donut.legend_position">bottom</option>
        <option name="ixflow_app.c3donut.legend_show">1</option>
        <option name="ixflow_app.c3donut.tooltip_format">%</option>
        <option name="ixflow_app.c3donut.tooltip_show">true</option>
        <option name="ixflow_app.c3donut.tooltip_value">default</option>
      </viz>
    </panel>
  </row>
  <row>
    <panel>
      <title>Overall SSL Traffic Details</title>
      <table>
        <search>
          <query>| tstats `svalue` count(Ixia_Flow.connection_encryption_type) as Count , max(Ixia_Flow.flow_end_time_milli) as time from datamodel=Ixia where (Ixia_Flow.connection_encryption_type!="" AND Ixia_Flow.encryption_cipher_suite!="") by Ixia_Flow.connection_encryption_type,Ixia_Flow.encryption_cipher_suite,Ixia_Flow.encryption_key_length | sort -Count | head limit=$top_limit$  | rename Ixia_Flow.connection_encryption_type as "Encryption Type" ,  Ixia_Flow.encryption_cipher_suite as "Cipher Name" ,  Ixia_Flow.encryption_key_length as  "Key Length"  | eval insec=time/1000 | eval "Last Reported"=strftime(insec,"%Y-%m-%d %H:%M:%S.%Q") | table "Encryption Type",Count,"Cipher Name","Key Length","Last Reported"</query>
          <earliest>$earliest$</earliest>
          <latest>$latest$</latest>
        </search>
        <option name="count">10</option>
        <option name="drilldown">row</option>
        <drilldown>
          <link target="_blank">search?q=sourcetype="stream:netflow" connection_encryption_type="$row.Encryption Type$" encryption_cipher_suite="$row.Cipher Name$" encryption_key_length="$row.Key Length$"&amp;earliest=$earliest$&amp;latest=$latest$</link>
        </drilldown>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <title>Most Requested URIs</title>
      <table>
        <search>
          <query>|tstats `svalue` count(Ixia_Flow.http_uri) as Counts , max(Ixia_Flow.flow_end_time_milli) as time from datamodel=Ixia where (Ixia_Flow.http_uri!="") by Ixia_Flow.http_uri | sort -Counts | head limit=$top_limit$  | rename Ixia_Flow.http_uri as URI | eval insec=time/1000 | eval "Last Reported"=strftime(insec,"%Y-%m-%d %H:%M:%S.%Q") | table URI,Counts,"Last Reported"</query>
          <earliest>$earliest$</earliest>
          <latest>$latest$</latest>
        </search>
        <option name="count">10</option>
        <option name="drilldown">row</option>
        <drilldown>
          <link target="_blank">search?q=sourcetype="stream:netflow" http_uri="$row.URI$"&amp;earliest=$earliest$&amp;latest=$latest$</link>
        </drilldown>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <title>Most Requested Hostnames</title>
      <table>
        <search>
          <query>|tstats `svalue` count(Ixia_Flow.host_name) as Counts , max(Ixia_Flow.flow_end_time_milli) as time from datamodel=Ixia where (Ixia_Flow.host_name!="") by Ixia_Flow.host_name | sort -Counts | head limit=$top_limit$ | rename Ixia_Flow.host_name as Hostname | eval insec=time/1000 | eval "Last Reported"=strftime(insec,"%Y-%m-%d %H:%M:%S.%Q") |table Hostname,Counts,"Last Reported"</query>
          <earliest>$earliest$</earliest>
          <latest>$latest$</latest>
        </search>
        <option name="count">10</option>
        <option name="drilldown">row</option>
        <drilldown>
          <link target="_blank">search?q=sourcetype="stream:netflow" host_name="$row.Hostname$"&amp;earliest=$earliest$&amp;latest=$latest$</link>
        </drilldown>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <title>Most Requested UserAgents</title>
      <table>
        <search>
          <query>|tstats `svalue` count(Ixia_Flow.http_request_user_agent) as Counts , max(Ixia_Flow.flow_end_time_milli) as time from datamodel=Ixia where (Ixia_Flow.http_request_user_agent!="") by Ixia_Flow.http_request_user_agent  | sort -Counts | head limit=$top_limit$ |rename Ixia_Flow.http_request_user_agent as UserAgent |   eval insec=time/1000 | eval "Last Reported"=strftime(insec,"%Y-%m-%d %H:%M:%S.%Q")|table UserAgent,Counts,"Last Reported"</query>
          <earliest>$earliest$</earliest>
          <latest>$latest$</latest>
        </search>
        <option name="count">10</option>
        <option name="drilldown">row</option>
        <drilldown>
          <link target="_blank">search?q=sourcetype="stream:netflow" http_request_user_agent="$row.UserAgent$"&amp;earliest=$earliest$&amp;latest=$latest$</link>
        </drilldown>
      </table>
    </panel>
  </row>
</form>