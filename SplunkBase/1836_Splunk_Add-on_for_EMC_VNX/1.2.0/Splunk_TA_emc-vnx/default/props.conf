[source::vnx]
SHOULD_LINEMERGE = false
MAX_TIMESTAMP_LOOKAHEAD = 1
EVAL-controller_mode = case(sourcetype LIKE "%vnx:block:%", "VNX Block", sourcetype LIKE "%vnx:file:%", "VNX File")
EVAL-array_type = case(sourcetype LIKE "%vnx:block:%", "SAN", sourcetype LIKE "%vnx:file:%", "NAS")
EVAL-array_id = case(sourcetype LIKE "%vnx:block:%", "SAN:".'array_serial_no', sourcetype LIKE "%vnx:file:%", "NAS:".'nas_frame')

#### Perf ####

[vnx:block:spPerf]
FIELDALIAS-cpu_load_percent = prct_busy as cpu_load_percent
FIELDALIAS-read_ops = total_reads as read_ops
FIELDALIAS-write_ops = total_writes as write_ops
FIELDALIAS-read_blocks = blocks_read as read_blocks
FIELDALIAS-write_blocks = blocks_written as write_blocks
EVAL-storage_read_throughput = blocks_read/2
EVAL-storage_write_throughput = blocks_written/2
EVAL-avg_busy_queue_length = abs(sum_queue_lengths_by_arrivals - (arrivals_to_non_zero_queue / 2))/(read_ops + write_ops)
EVAL-avg_busy_queue_width = abs((sum_queue_lengths_by_arrivals - (arrivals_to_non_zero_queue / 2)))/(read_blocks + write_blocks)
EVAL-service_time = (1000 * controller_busy_ticks/(controller_busy_ticks + controller_idle_ticks))/(read_ops + write_ops)
EVAL-response_time = (1000 * (abs(sum_queue_lengths_by_arrivals - (arrivals_to_non_zero_queue / 2))/(read_ops + write_ops)) * (controller_busy_ticks/(controller_busy_ticks + controller_idle_ticks))) / (read_ops + write_ops)
EVAL-dest = array_serial_no + ":" + sp_id
EVAL-io_ops = total_reads + total_writes

[vnx:block:drivePerf]
EVAL-cpu_load_percent = (busy_ticks*100.0)/(busy_ticks + idle_ticks)
FIELDALIAS-read_ops = number_reads as read_ops
FIELDALIAS-write_ops = number_writes as write_ops
FIELDALIAS-storage_read_throughput = kbytes_read as storage_read_throughput
FIELDALIAS-storage_write_throughput = kbytes_written as storage_write_throughput
EVAL-read_blocks = kbytes_read * 2
EVAL-write_blocks = kbytes_written * 2
EVAL-dest = array_serial_no + ":" + drive_id
EVAL-disk_id = "SAN:" + array_serial_no + ":disk:" + drive_id
EVAL-io_ops = number_reads + number_writes

[vnx:block:devicePerf]
EVAL-cpu_load_percent = (busy_ticks*100.0)/(busy_ticks + idle_ticks)
FIELDALIAS-read_blocks = blocks_read as read_blocks
FIELDALIAS-write_blocks = blocks_written as write_blocks
FIELDALIAS-read_ops = read_requests as read_ops
FIELDALIAS-write_ops = write_requests as write_ops
EVAL-io_ops = read_requests + write_requests
EVAL-storage_read_throughput = blocks_read/2
EVAL-storage_write_throughput = blocks_written/2
EVAL-dest = array_serial_no + ":" + device_name
EVAL-lun_id = "SAN:" + array_serial_no + ":lun:" + device_id

[vnx:file:systemNetDevicePerf]
FIELDALIAS-read_ops = network_in_pkts as read_ops
FIELDALIAS-write_ops = network_out_pkts as write_ops
EVAL-read_blocks = network_in_kb * 2
EVAL-write_blocks = network_out_kb * 2
EVAL-dest = nas_frame + ":" + dev_name

[vnx:file:diskVolumePerf]
EVAL-read_blocks = read_kb * 2
EVAL-write_blocks = write_kb * 2
FIELDALIAS-storage_used_percent = util as storage_used_percent
FIELDALIAS-storage_read_throughput = read_kb as storage_read_throughput
FIELDALIAS-storage_write_throughput = write_kb as storage_write_throughput
EVAL-dest = nas_frame + ":" + disk_name
EVAL-disk_id = "NAS:" + nas_frame + ":disk:" + disk_name
EVAL-io_ops = read_ops + write_ops

[vnx:file:metaVolumePerf]
FIELDALIAS-storage_read_throughput = read_kb  as storage_read_throughput
FIELDALIAS-storage_write_throughput = write_kb  as storage_write_throughput
EVAL-read_blocks = read_kb * 2
EVAL-write_blocks = write_kb * 2
EVAL-dest = nas_frame + ":" + filesystem
EVAL-volume_id = "NAS:" + nas_frame + ":volume:" + filesystem
EVAL-io_ops = read_ops + write_ops

[vnx:file:nfsClientPerf]
FIELDALIAS-read_ops = nfs_read_ops as read_ops
FIELDALIAS-write_ops = nfs_write_ops as write_ops
EVAL-read_blocks = nfs_read_kb * 2
EVAL-write_blocks = nfs_write_kb * 2
EVAL-dest = nas_frame + ":" + server_name + ":" + nfs_client

[vnx:file:cifsClientPerf]
FIELDALIAS-read_ops = cifs_read_ops as read_ops
FIELDALIAS-write_ops = cifs_write_ops as write_ops
EVAL-read_blocks = cifs_read_kb * 2
EVAL-write_blocks = cifs_write_kb * 2
EVAL-dest = nas_frame + ":" + server_name + ":" + cifs_client

[vnx:file:nfsGroupPerf]
FIELDALIAS-read_ops = nfs_read_ops as read_ops
FIELDALIAS-write_ops = nfs_write_ops as write_ops
EVAL-read_blocks = nfs_read_kb * 2
EVAL-write_blocks = nfs_write_kb * 2
EVAL-dest = nas_frame + ":" + server_name + ":" + nfs_group

[vnx:file:nfsUserPerf]
FIELDALIAS-read_ops = nfs_read_ops as read_ops
FIELDALIAS-write_ops = nfs_write_ops as write_ops
EVAL-read_blocks = nfs_read_kb * 2
EVAL-write_blocks = nfs_write_kb * 2
EVAL-dest = nas_frame + ":" + server_name + ":" + nfs_user

[vnx:file:cifsUserPerf]
FIELDALIAS-read_ops = cifs_read_ops as read_ops
FIELDALIAS-write_ops = cifs_write_ops as write_ops
EVAL-read_blocks = cifs_read_kb * 2
EVAL-write_blocks = cifs_write_kb * 2
EVAL-dest = nas_frame + ":" + server_name + ":" + cifs_user

[vnx:file:nfsExportPerf]
FIELDALIAS-read_ops = nfs_read_ops as read_ops
FIELDALIAS-write_ops = nfs_write_ops as write_ops
EVAL-read_blocks = nfs_read_kb * 2
EVAL-write_blocks = nfs_write_kb * 2
EVAL-dest = nas_frame + ":" + server_name + ":" + nfs_export

[vnx:file:cifsServerPerf]
FIELDALIAS-read_ops = cifs_read_ops as read_ops
FIELDALIAS-write_ops = cifs_write_ops as write_ops
EVAL-read_blocks = cifs_read_kb * 2
EVAL-write_blocks = cifs_write_kb * 2
EVAL-dest = nas_frame + ":" + server_name + ":" + cifs_export

[vnx:file:systemNfsPerf]
FIELDALIAS-read_ops = nfs_read_ops as read_ops
FIELDALIAS-write_ops = nfs_write_ops as write_ops
FIELDALIAS-storage_read_throughput = nfs_read_kb as storage_read_throughput
FIELDALIAS-storage_write_throughput = nfs_write_kb  as storage_write_throughput
EVAL-read_blocks = nfs_read_kb * 2
EVAL-write_blocks = nfs_write_kb * 2
EVAL-dest = nas_frame + ":" + server_name
EVAL-io_ops = nfs_read_ops + nfs_write_ops

[vnx:file:systemCifsPerf]
FIELDALIAS-read_ops = cifs_read_ops as read_ops
FIELDALIAS-write_ops = cifs_write_ops as write_ops
FIELDALIAS-storage_read_throughput = cifs_read_kb as storage_read_throughput
FIELDALIAS-storage_write_throughput = cifs_write_kb  as storage_write_throughput
EVAL-read_blocks = cifs_read_kb * 2
EVAL-write_blocks = cifs_write_kb * 2
EVAL-dest = nas_frame + ":" + server_name
EVAL-io_ops = cifs_read_ops + cifs_write_ops

[vnx:file:systemBasicPerf]
FIELDALIAS-cpu_load_percent = cpu_util as cpu_load_percent
FIELDALIAS-network_usage_in = network_in_kb as  network_usage_in
FIELDALIAS-network_usage_out = network_out_kb as network_usage_out

#### Storage ####

[vnx:block:drive]
FIELDALIAS-storage = capacity as storage
FIELDALIAS-disk_name = id as disk_name
FIELDALIAS-disk_type = drive_type as disk_type
EVAL-disk_id = "SAN:" + array_serial_no + ":disk:" + id
# Storage Capacity in Bytes
EVAL-storage_capacity = capacity*1024*1024
EVAL-vendor_product = vendor + "_" + drive_type

[vnx:block:driveState]
EVAL-disk_id = "SAN:" + array_serial_no + ":disk:" + drive_id

[vnx:block:device]
FIELDALIAS-storage = capacity as storage
FIELDALIAS-lun_name = name as lun_name
FIELDALIAS-serial = uid as serial
# Storage Capacity in Bytes
EVAL-storage_capacity = capacity*1024*1024
EVAL-lun_id = "SAN:" + array_serial_no + ":lun:" + id
EVAL-accessible = case(is_private=="False","true",is_private=="True","false")

[vnx:block:storagePool]
FIELDALIAS-storage = raw_cap as storage
FIELDALIAS-pool_name = name as pool_name
EVAL-storage_used_percent = (used_cap*100.0)/user_cap
EVAL-dest = array_serial_no + ":" + name
EVAL-pool_id = "SAN:" + array_serial_no + ":pool:" + id
# Storage Capacity in bytes
EVAL-storage_capacity = user_cap*1024*1024
# Storage Used in Bytes
EVAL-storage_used = used_cap*1024*1024
# Storage Free in Bytes
EVAL-storage_free = free_cap*1024*1024

[vnx:block:raidGroup]
FIELDALIAS-storage = raw_cap as storage
#Storage Free in Bytes
EVAL-storage_free = free_cap*1024*1024
# Storage Used in Bytes
EVAL-storage_used = (raw_cap - free_cap) * 1024*1024
EVAL-storage_used_percent = ((raw_cap - free_cap)*100.0)/storage
EVAL-dest = array_serial_no + ":" + id

[vnx:block:agent]
EVAL-cpu_count = 1
EVAL-mem = sp_memory
EVAL-vendor = "EMC"
EVAL-os = "VNX operating environment for Block"
EVAL-mem_capacity = sp_memory*1024*1024
FIELDALIAS-dest = array_serial_no as dest
FIELDALIAS-serial = array_serial_no as serial
FIELDALIAS-version = revision as version
FIELDALIAS-array_name = array_serial_no as array_name
FIELDALIAS-vendor_product = model as vendor_product

[vnx:file:fileSystem]
FIELDALIAS-storage = raw_capacity as storage
FIELDALIAS-volume_name = name as volume_name
# Storage Free in Bytes
EVAL-storage_free = (raw_capacity - used_capacity)*1024*1024
# Storage Used in Bytes
EVAL-storage_used = (case(logical_capacity = 0, used_capacity, logical_capacity > 0, used_capacity + (raw_capacity - logical_capacity))) * 1024*1024
# Storage Capacity in Bytes
EVAL-storage_capacity = raw_capacity*1024*1024
EVAL-storage_used_percent = case(logical_capacity = 0, (used_capacity*100.0)/raw_capacity, logical_capacity > 0, ((used_capacity + (raw_capacity - logical_capacity))*100.0)/raw_capacity)
EVAL-dest = nas_frame + ":" + name
EVAL-volume_id = "NAS:" + nas_frame + ":volume:" + name

[vnx:file:checkpoint]
FIELDALIAS-size = capacity as size
FIELDALIAS-snapshot = name as snapshot
FIELDALIAS-storage = capacity as storage
# Storage Free in Bytes
EVAL-storage_free = (capacity - used_savvol_mb)*1024*1024
# Storage Used in Bytes
EVAL-storage_used = used_savvol_mb*1024*1024
EVAL-storage_used_percent = used_pct
EVAL-dest = nas_frame + ":" + name

[vnx:file:vpfs]
FIELDALIAS-storage = capacity as storage
EVAL-dest = nas_frame + ":" + name

[vnx:file:storagePool]
FIELDALIAS-storage = capacity as storage
FIELDALIAS-pool_name = name as pool_name
EVAL-storage_used_percent = (used_capacity*100.0)/capacity
EVAL-dest = nas_frame + ":" + name
EVAL-pool_id = "NAS:" + nas_frame + ":pool:" + id
# Storage Free in Bytes
EVAL-storage_free = free_capacity*1024*1024
# Storage Capacity in Bytes
EVAL-storage_capacity = capacity*1024*1024
# Storage Used in Bytes
EVAL-storage_used = used_capacity*1024*1024

[vnx:file:disk]
FIELDALIAS-storage = capacity as storage
FIELDALIAS-disk_name = name as disk_name
EVAL-dest = nas_frame + ":" + name
EVAL-disk_id = "NAS:" + nas_frame + ":disk:" + name
EVAL-storage_capacity = capacity*1024*1024

[vnx:file:userQuota]
FIELDALIAS-storage = block_hard_limit as storage
# Storage Used in Bytes
EVAL-storage_used = block_usage*1024/2
EVAL-storage_free = (case(block_hard_limit = 0, 0, block_hard_limit > 0, block_hard_limit - block_usage))*1024*1024
EVAL-storage_used_percent = case(block_hard_limit = 0, 0, block_hard_limit > 0, (block_usage*100.0)/block_hard_limit)
EVAL-dest = nas_frame + ":" + filesystem + ":" + id

[vnx:file:groupQuota]
FIELDALIAS-storage = block_hard_limit as storage
# Storage Used in Bytes
EVAL-storage_used = block_usage*1024/2
# Storage Free in Bytes
EVAL-storage_free = (case(block_hard_limit = 0, 0, block_hard_limit > 0, block_hard_limit - block_usage))*1024*1024
EVAL-storage_used_percent = case(block_hard_limit = 0, 0, block_hard_limit > 0, (block_usage*100.0)/block_hard_limit)
EVAL-dest = nas_frame + ":" + filesystem + ":" + id

[vnx:file:treeQuota]
FIELDALIAS-storage = block_hard_limit as storage
# Storage Used in Bytes
EVAL-storage_used = block_usage*1024/2
# Storage Free in Bytes
EVAL-storage_free = (case(block_hard_limit = 0, 0, block_hard_limit > 0, block_hard_limit - block_usage))*1024*1024
EVAL-storage_used_percent = case(block_hard_limit = 0, 0, block_hard_limit > 0, (block_usage*100.0)/block_hard_limit)
EVAL-dest = nas_frame + ":" + filesystem + ":" + path

[vnx:file:interface]
FIELDALIAS-interface = name as interface
FIELDALIAS-ip = address as ip

[vnx:file:nasframe]
FIELDALIAS-array_name = array_serial_no as array_name
FIELDALIAS-vendor_product = model as vendor_product
EVAL-vendor = "EMC"
EVAL-os = "VNX operating environment for File"