<form>
  <label>ESG_Services Usage Overview</label>
  <description/>
  <fieldset autoRun="true" submitButton="false">
    <input type="time" searchWhenChanged="true">
      <default>
        <earliestTime>-100m</earliestTime>
        <latestTime>now</latestTime>
      </default>
    </input>
  </fieldset>
  <row>
    <chart>
      <title>Calls by Status Code</title>
      <searchString>sourcetype=ESG_ServicesLogs | eval ESG_AppId=upper(ESG_AppId) | eval URL=lower(URL) | eval Operation=Verb+" "+URL | lookup apps_details ESG_AppId OUTPUT ApplicationName | timechart count by HTTPResultCode</searchString>
      <earliestTime>-3h</earliestTime>
      <latestTime>now</latestTime>
      <option name="charting.axisTitleX.text">Time</option>
      <option name="charting.axisTitleX.visibility">visible</option>
      <option name="charting.axisTitleY.text">Calls</option>
      <option name="charting.axisTitleY.visibility">visible</option>
      <option name="charting.axisX.scale">linear</option>
      <option name="charting.axisY.scale">linear</option>
      <option name="charting.chart">column</option>
      <option name="charting.chart.nullValueMode">gaps</option>
      <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
      <option name="charting.chart.stackMode">stacked</option>
      <option name="charting.chart.style">shiny</option>
      <option name="charting.drilldown">all</option>
      <option name="charting.layout.splitSeries">0</option>
      <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
      <option name="charting.legend.placement">bottom</option>
    </chart>
    <chart>
      <title>Avg Processing Time by Operation</title>
      <searchString>sourcetype=ESG_ServicesLogs | eval ESG_AppId=upper(ESG_AppId) | eval URL=lower(URL)  | eval Operation=Verb+" "+URL | lookup apps_details ESG_AppId OUTPUT ApplicationName | timechart span=30s avg(ProcessingTime) by Operation</searchString>
      <earliestTime>$earliest$</earliestTime>
      <latestTime>$latest$</latestTime>
      <option name="charting.axisTitleX.text">Time</option>
      <option name="charting.axisTitleX.visibility">visible</option>
      <option name="charting.axisTitleY.text">Seconds</option>
      <option name="charting.axisTitleY.visibility">visible</option>
      <option name="charting.axisX.scale">linear</option>
      <option name="charting.axisY.scale">linear</option>
      <option name="charting.chart">column</option>
      <option name="charting.chart.nullValueMode">gaps</option>
      <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
      <option name="charting.chart.stackMode">default</option>
      <option name="charting.chart.style">shiny</option>
      <option name="charting.drilldown">all</option>
      <option name="charting.layout.splitSeries">0</option>
      <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
      <option name="charting.legend.placement">bottom</option>
    </chart>
  </row>
  <row>
    <chart>
      <title>Call Ventilation by Application</title>
      <searchString>sourcetype=ESG_ServicesLogs | eval ESG_AppId=upper(ESG_AppId) | eval URL=lower(URL) | eval Operation=Verb+" "+URL | lookup apps_details ESG_AppId OUTPUT ApplicationName | chart count by ApplicationName</searchString>
      <earliestTime>$earliest$</earliestTime>
      <latestTime>$latest$</latestTime>
      <option name="charting.axisTitleX.visibility">visible</option>
      <option name="charting.axisTitleY.visibility">visible</option>
      <option name="charting.axisX.scale">linear</option>
      <option name="charting.axisY.scale">linear</option>
      <option name="charting.chart">pie</option>
      <option name="charting.chart.nullValueMode">gaps</option>
      <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
      <option name="charting.chart.stackMode">default</option>
      <option name="charting.chart.style">shiny</option>
      <option name="charting.drilldown">all</option>
      <option name="charting.layout.splitSeries">0</option>
      <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
      <option name="charting.legend.placement">right</option>
      <drilldown target="Title Usage Overview">
        <!-- 
      <link>
        /app/ESG_Services/title_usage_overview?form.ApplicationNameFilter==$row.ApplicationName$
       </link>
-->
      </drilldown>
    </chart>
    <chart>
      <title>Call Ventilation by Operation</title>
      <searchString>sourcetype=ESG_ServicesLogs | eval ESG_AppId=upper(ESG_AppId) | eval URL=lower(URL) | eval Operation=Verb+" "+URL | lookup apps_details ESG_AppId OUTPUT ApplicationName | chart count by Operation</searchString>
      <earliestTime>$earliest$</earliestTime>
      <latestTime>$latest$</latestTime>
      <option name="charting.axisTitleX.visibility">visible</option>
      <option name="charting.axisTitleY.visibility">visible</option>
      <option name="charting.axisX.scale">linear</option>
      <option name="charting.axisY.scale">linear</option>
      <option name="charting.chart">pie</option>
      <option name="charting.chart.nullValueMode">gaps</option>
      <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
      <option name="charting.chart.stackMode">default</option>
      <option name="charting.chart.style">shiny</option>
      <option name="charting.drilldown">all</option>
      <option name="charting.layout.splitSeries">0</option>
      <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
      <option name="charting.legend.placement">right</option>
    </chart>
  </row>
  <row>
    <chart>
      <title>Processing Time by Operation</title>
      <searchString>sourcetype=ESG_ServicesLogs | eval ESG_AppId=upper(ESG_AppId) | eval URL=lower(URL) | eval Operation=Verb+" "+URL | lookup apps_details ESG_AppId OUTPUT ApplicationName | rex field=Operation mode=sed "s/policies\/.*/policies/g" | chart min(ProcessingTime) as Min, median(ProcessingTime) as Med, max(ProcessingTime) as Max by Operation</searchString>
      <earliestTime>$earliest$</earliestTime>
      <latestTime>$latest$</latestTime>
      <option name="height">750px</option>
      <option name="charting.axisTitleX.text">Time</option>
      <option name="charting.axisTitleX.visibility">visible</option>
      <option name="charting.axisTitleY.text">Processing Time</option>
      <option name="charting.axisTitleY.visibility">visible</option>
      <option name="charting.axisX.scale">linear</option>
      <option name="charting.axisY.scale">linear</option>
      <option name="charting.chart">bar</option>
      <option name="charting.chart.nullValueMode">gaps</option>
      <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
      <option name="charting.chart.stackMode">default</option>
      <option name="charting.chart.style">shiny</option>
      <option name="charting.drilldown">all</option>
      <option name="charting.layout.splitSeries">0</option>
      <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
      <option name="charting.legend.placement">bottom</option>
    </chart>
  </row>
  <row>
    <chart>
      <title>Calls by Operation per Application</title>
      <searchString>sourcetype=ESG_ServicesLogs | eval ESG_AppId=upper(ESG_AppId) | eval URL=lower(URL)  |  eval Operation=Verb+" "+URL | rex field=Operation mode=sed "s/policies\/.*/policies/g" | lookup apps_details ESG_AppId OUTPUT ApplicationName | chart count by Operation, ApplicationName</searchString>
      <earliestTime>$earliest$</earliestTime>
      <latestTime>$latest$</latestTime>
      <option name="height">500px</option>
      <option name="charting.axisTitleX.text">Operation</option>
      <option name="charting.axisTitleX.visibility">visible</option>
      <option name="charting.axisTitleY.text">Calls</option>
      <option name="charting.axisTitleY.visibility">visible</option>
      <option name="charting.axisX.scale">linear</option>
      <option name="charting.axisY.scale">linear</option>
      <option name="charting.chart">bar</option>
      <option name="charting.chart.nullValueMode">gaps</option>
      <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
      <option name="charting.chart.stackMode">stacked</option>
      <option name="charting.chart.style">shiny</option>
      <option name="charting.drilldown">all</option>
      <option name="charting.layout.splitSeries">0</option>
      <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
      <option name="charting.legend.placement">bottom</option>
    </chart>
    <chart>
      <title>Total Request Size by Operation per Application</title>
      <searchString>sourcetype=ESG_ServicesLogs | eval ESG_AppId=upper(ESG_AppId) | eval URL=lower(URL) |  eval Operation=Verb+" "+URL | lookup apps_details ESG_AppId OUTPUT ApplicationName | rex field=Operation mode=sed "s/policies\/.*/policies/g" | chart sum(RequestSize) by Operation, ApplicationName</searchString>
      <earliestTime>$earliest$</earliestTime>
      <latestTime>$latest$</latestTime>
      <option name="height">500px</option>
      <option name="charting.axisTitleX.text">Operation</option>
      <option name="charting.axisTitleX.visibility">visible</option>
      <option name="charting.axisTitleY.text">Sum of Request Size</option>
      <option name="charting.axisTitleY.visibility">visible</option>
      <option name="charting.axisX.scale">linear</option>
      <option name="charting.axisY.scale">linear</option>
      <option name="charting.chart">bar</option>
      <option name="charting.chart.nullValueMode">gaps</option>
      <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
      <option name="charting.chart.stackMode">stacked</option>
      <option name="charting.chart.style">shiny</option>
      <option name="charting.drilldown">all</option>
      <option name="charting.layout.splitSeries">0</option>
      <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
      <option name="charting.legend.placement">bottom</option>
    </chart>
  </row>
  <row>
    <chart>
      <title>Non-Successful Results by Operation (Result Code Not 200)</title>
      <searchString>sourcetype=ESG_ServicesLogs | eval ESG_AppId=upper(ESG_AppId) | eval URL=lower(URL) | eval Operation=Verb+" "+URL | lookup apps_details ESG_AppId OUTPUT ApplicationName |  rex field=Operation mode=sed "s/policies\/.*/policies/g" | search HTTPResultCode!=200 | chart count by Operation, HTTPResultCode</searchString>
      <earliestTime>$earliest$</earliestTime>
      <latestTime>$latest$</latestTime>
      <option name="height">500px</option>
      <option name="charting.axisTitleX.visibility">visible</option>
      <option name="charting.axisTitleY.visibility">visible</option>
      <option name="charting.axisX.scale">linear</option>
      <option name="charting.axisY.scale">linear</option>
      <option name="charting.chart">bar</option>
      <option name="charting.chart.nullValueMode">gaps</option>
      <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
      <option name="charting.chart.stackMode">default</option>
      <option name="charting.chart.style">shiny</option>
      <option name="charting.drilldown">all</option>
      <option name="charting.layout.splitSeries">0</option>
      <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
      <option name="charting.legend.placement">bottom</option>
    </chart>
  </row>
  <row>
    <chart>
      <title>Non-Successful Results by Application (Result Code Not 200)</title>
      <searchString>sourcetype=ESG_ServicesLogs | eval ESG_AppId=upper(ESG_AppId) | eval URL=lower(URL) | eval Operation=Verb+" "+URL | lookup apps_details ESG_AppId OUTPUT ApplicationName | search HTTPResultCode!=200 | chart count by ApplicationName, HTTPResultCode</searchString>
      <earliestTime>$earliest$</earliestTime>
      <latestTime>$latest$</latestTime>
      <option name="height">500px</option>
      <option name="charting.axisTitleX.visibility">visible</option>
      <option name="charting.axisTitleY.visibility">visible</option>
      <option name="charting.axisX.scale">linear</option>
      <option name="charting.axisY.scale">linear</option>
      <option name="charting.chart">bar</option>
      <option name="charting.chart.nullValueMode">gaps</option>
      <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
      <option name="charting.chart.stackMode">default</option>
      <option name="charting.chart.style">shiny</option>
      <option name="charting.drilldown">all</option>
      <option name="charting.layout.splitSeries">0</option>
      <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
      <option name="charting.legend.placement">bottom</option>
      <option name="charting.axisTitleX.text">Result Code</option>
    </chart>
  </row>
  <row>
    <chart>
      <title>Average Calls Per Minutes Per Clients</title>
      <searchString>sourcetype=ESG_ServicesLogs | eval ESG_AppId=upper(ESG_AppId) | eval URL=lower(URL) | rex field=URL mode=sed "s/........-....-....-....-............/{id}/g" | eval Operation=Verb+" "+URL | lookup apps_details ESG_AppId OUTPUT ApplicationName | bucket _time span=1m | stats count as CallsPerIPPerMinute by _time,IP | chart avg(CallsPerIPPerMinute)</searchString>
      <earliestTime>$earliest$</earliestTime>
      <latestTime>$latest$</latestTime>
      <option name="charting.axisTitleX.visibility">visible</option>
      <option name="charting.axisTitleY.visibility">visible</option>
      <option name="charting.axisX.scale">linear</option>
      <option name="charting.axisY.scale">linear</option>
      <option name="charting.chart">radialGauge</option>
      <option name="charting.chart.nullValueMode">gaps</option>
      <option name="charting.chart.rangeValues">["0","5","10","15"]</option>
      <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
      <option name="charting.chart.stackMode">stacked</option>
      <option name="charting.chart.style">shiny</option>
      <option name="charting.drilldown">all</option>
      <option name="charting.gaugeColors">[0x84E900,0xFFE800,0xBF3030]</option>
      <option name="charting.layout.splitSeries">0</option>
      <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
      <option name="charting.legend.placement">right</option>
    </chart>
    <chart>
      <title>Calls per Country</title>
      <searchString>sourcetype=ESG_ServicesLogs | eval ESG_AppId=upper(ESG_AppId) | eval URL=lower(URL) | rex field=URL mode=sed "s/........-....-....-....-............/{id}/g" | eval Operation=Verb+" "+URL | lookup apps_details ESG_AppId OUTPUT ApplicationName | iplocation IP | chart count by Country</searchString>
      <earliestTime>$earliest$</earliestTime>
      <latestTime>$latest$</latestTime>
      <option name="charting.axisTitleX.visibility">visible</option>
      <option name="charting.axisTitleY.visibility">visible</option>
      <option name="charting.axisX.scale">linear</option>
      <option name="charting.axisY.scale">linear</option>
      <option name="charting.chart">pie</option>
      <option name="charting.chart.nullValueMode">gaps</option>
      <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
      <option name="charting.chart.stackMode">default</option>
      <option name="charting.chart.style">shiny</option>
      <option name="charting.drilldown">all</option>
      <option name="charting.layout.splitSeries">0</option>
      <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
      <option name="charting.legend.placement">right</option>
    </chart>
  </row>
</form>