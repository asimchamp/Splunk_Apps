[cefevents]
NO_BINARY_CHECK = 1
SHOULD_LINEMERGE = false
pulldown_type = 1
REPORT-cefevents = cefHeaders,cefKeys,cefCustom
FIELDALIAS-cefevents = cef_vendor AS vendor cef_product AS product cef_version AS product_version
TIME_PREFIX = \s*(end|rt)\=
TIME_FORMAT = %b %d %Y %H:%M:%S %Z
MAX_TIMESTAMP_LOOKAHEAD = 180
KV_MODE = none
ANNOTATE_PUNCT = false
TRANSFORMS-changesourcetype = tmef-100100_malware, tmef-100101_web_threat, tmef-100118_malware_outbreak, tmef-100119_security_risk, tmef-100120_disruptive_application, tmef-100127_suspicious_behaviour, tmef-100130_email_detection, tmef-100131_attachment_detection, tmef-100132_url_detection, tmef-200119_file_analyzed, tmef-200119_file_analyzed_ddan, tmef-200120_denylist_change, tmef-200120_denylist_change_ddan, tmef-200126_url_analyzed, tmef-200126_url_analyzed_ddan, tmef-200127_notable_chars, tmef-200127_notable_chars_ddan, tmef-200128_submission_analyzed_ddan, tmef-ddi_email_detection

[tmef-100100_malware]
NO_BINARY_CHECK = 1
SHOULD_LINEMERGE = false
pulldown_type = 1
REPORT-cefevents = cefHeaders,cefKeys,cefCustom
FIELDALIAS-tmef-100100 = malType AS category rt AS date dst AS dest fileHash AS file_hash fname AS file_name filePath AS file_path malName AS signature duser AS user cef_vendor AS vendor cef_product AS product cef_version AS product_version
LOOKUP-action = cim_action_lookup act OUTPUT action
LOOKUP-ids_type = cim_ids_type_lookup ptype OUTPUT ids_type
LOOKUP-severity = cim_severity_lookup cef_severity OUTPUT severity
TIME_PREFIX = \s*(end|rt)\=
TIME_FORMAT = %b %d %Y %H:%M:%S %Z
MAX_TIMESTAMP_LOOKAHEAD = 180
KV_MODE = none
ANNOTATE_PUNCT = false

[tmef-100101_web_threat]
NO_BINARY_CHECK = 1
SHOULD_LINEMERGE = false
pulldown_type = 1
REPORT-cefevents = cefHeaders,cefKeys,cefCustom
FIELDALIAS-tmef-100101 = rt AS date urlCat AS category dst AS dest msg AS signature request AS url duser AS user cef_vendor AS vendor cef_product AS product cef_version AS product_version
LOOKUP-100101_action = cim_100101_action_lookup cef_signature OUTPUT action
LOOKUP-ids_type = cim_ids_type_lookup ptype OUTPUT ids_type
LOOKUP-severity = cim_severity_lookup cef_severity OUTPUT severity
TIME_PREFIX = \s*(end|rt)\=
TIME_FORMAT = %b %d %Y %H:%M:%S %Z
MAX_TIMESTAMP_LOOKAHEAD = 180
KV_MODE = none
ANNOTATE_PUNCT = false

[tmef-100118_malware_outbreak]
NO_BINARY_CHECK = 1
SHOULD_LINEMERGE = false
pulldown_type = 1
REPORT-cefevents = cefHeaders,cefKeys,cefCustom
FIELDALIAS-tmef-100100 = rt AS date dst AS dest malType AS category malName AS signature cef_vendor AS vendor cef_product AS product cef_version AS product_version
LOOKUP-action = cim_action_lookup act OUTPUT action
LOOKUP-ids_type = cim_ids_type_lookup ptype OUTPUT ids_type
LOOKUP-severity = cim_severity_lookup cef_severity OUTPUT severity
TIME_PREFIX = \s*(end|rt)\=
TIME_FORMAT = %b %d %Y %H:%M:%S %Z
MAX_TIMESTAMP_LOOKAHEAD = 180
KV_MODE = none
ANNOTATE_PUNCT = false

[tmef-100119_security_risk]
NO_BINARY_CHECK = 1
SHOULD_LINEMERGE = false
pulldown_type = 1
REPORT-cefevents = cefHeaders,cefKeys,cefCustom
FIELDALIAS-tmef-100119 = rt AS date malType AS category dst AS dest ruleName AS signature duser AS user cef_vendor AS vendor cef_product AS product cef_version AS product_version
LOOKUP-action = cim_action_lookup act OUTPUT action
LOOKUP-ids_type = cim_ids_type_lookup ptype OUTPUT ids_type
LOOKUP-severity = cim_severity_lookup cef_severity OUTPUT severity
TIME_PREFIX = \s*(end|rt)\=
TIME_FORMAT = %b %d %Y %H:%M:%S %Z
MAX_TIMESTAMP_LOOKAHEAD = 180
KV_MODE = none
ANNOTATE_PUNCT = false

[tmef-ddi_email_detection]
NO_BINARY_CHECK = 1
SHOULD_LINEMERGE = false
pulldown_type = 1
REPORT-cefevents = cefHeaders,cefKeys,cefCustom
FIELDALIAS-tmef-100119-email = rt AS date dst AS dest suser AS src_user duser AS recipient fileHash as file_hash fname as file_name malType AS category ruleName AS signature mailMsgSubject as subject messageId as message_id cef_vendor AS vendor cef_product AS product cef_version AS product_version
LOOKUP-action = cim_action_lookup act OUTPUT action
LOOKUP-ids_type = cim_ids_type_lookup ptype OUTPUT ids_type
LOOKUP-severity = cim_severity_lookup cef_severity OUTPUT severity
TIME_PREFIX = \s*(end|rt)\=
TIME_FORMAT = %b %d %Y %H:%M:%S %Z
MAX_TIMESTAMP_LOOKAHEAD = 180
KV_MODE = none
ANNOTATE_PUNCT = false

[tmef-100120_disruptive_application]
NO_BINARY_CHECK = 1
SHOULD_LINEMERGE = false
pulldown_type = 1
REPORT-cefevents = cefHeaders,cefKeys,cefCustom
LOOKUP-severity = cim_severity_lookup cef_severity OUTPUT severity
TIME_PREFIX = \s*(end|rt)\=
TIME_FORMAT = %b %d %Y %H:%M:%S %Z
MAX_TIMESTAMP_LOOKAHEAD = 180
KV_MODE = none
ANNOTATE_PUNCT = false

[tmef-100127_suspicious_behaviour]
NO_BINARY_CHECK = 1
SHOULD_LINEMERGE = false
pulldown_type = 1
REPORT-cefevents = cefHeaders,cefKeys,cefCustom

[tmef-100130_email_detection]
NO_BINARY_CHECK = 1
SHOULD_LINEMERGE = false
pulldown_type = 1
REPORT-cefevents = cefHeaders,cefKeys,cefCustom
FIELDALIAS-tmef-100130 = rt AS date dst AS dest cs1 AS internal_message_id cs2 AS message_id duser AS recipient cn1 AS size suser AS src_user mailMsgSubject AS subject cef_vendor AS vendor cef_product AS product cef_version AS product_version
LOOKUP-email-action = cim_email_action_lookup act OUTPUT action
LOOKUP-severity = cim_severity_lookup cef_severity OUTPUT severity
TIME_PREFIX = \s*(end|rt)\=
TIME_FORMAT = %b %d %Y %H:%M:%S %Z
MAX_TIMESTAMP_LOOKAHEAD = 180
KV_MODE = none
ANNOTATE_PUNCT = false

[tmef-100131_attachment_detection]
NO_BINARY_CHECK = 1
SHOULD_LINEMERGE = false
pulldown_type = 1
REPORT-cefevents = cefHeaders,cefKeys,cefCustom
FIELDALIAS-tmef-100131 = rt AS date dst AS dest cs1Label AS category cs1 AS signature fileHash AS file_hash fname AS file_name cn2 AS size cs3 AS message_id duser AS recipient mailMsgSubject as subject suser as src_user cef_vendor AS vendor cef_product AS product cef_version AS product_version
LOOKUP-action = cim_action_lookup act OUTPUT action
LOOKUP-ids_type = cim_ids_type_lookup ptype OUTPUT ids_type
LOOKUP-severity = cim_severity_lookup cef_severity OUTPUT severity
TIME_PREFIX = \s*(end|rt)\=
TIME_FORMAT = %b %d %Y %H:%M:%S %Z
MAX_TIMESTAMP_LOOKAHEAD = 180
KV_MODE = none
ANNOTATE_PUNCT = false

[tmef-100132_url_detection]
NO_BINARY_CHECK = 1
SHOULD_LINEMERGE = false
pulldown_type = 1
REPORT-cefevents = cefHeaders,cefKeys,cefCustom
FIELDALIAS-tmef-100132 = rt AS date cs1Label AS category cs1 AS signature duser AS user cef_product AS product cef_vendor AS vendor cef_version AS product_version
LOOKUP-action = cim_action_lookup act OUTPUT action
LOOKUP-ids_type = cim_ids_type_lookup ptype OUTPUT ids_type
LOOKUP-severity = cim_severity_lookup cef_severity OUTPUT severity
TIME_PREFIX = \s*(end|rt)\=
TIME_FORMAT = %b %d %Y %H:%M:%S %Z
MAX_TIMESTAMP_LOOKAHEAD = 180
KV_MODE = none
ANNOTATE_PUNCT = false

[tmef-200119_file_analyzed]
NO_BINARY_CHECK = 1
SHOULD_LINEMERGE = false
pulldown_type = 1
REPORT-cefevents = cefHeaders,cefKeys,cefCustom
FIELDALIAS-200119 = cef_vendor AS vendor cef_product AS product cef_version AS product_version
LOOKUP-va-name = va_name_lookup cef_signature OUTPUT va_name
LOOKUP-severity = cim_severity_lookup cef_severity OUTPUT severity
LOOKUP-rozseverity = rozrating_severity_lookup cn2 OUTPUT cn2_severity
TIME_PREFIX = \s*(end|rt)\=
TIME_FORMAT = %b %d %Y %H:%M:%S %Z
MAX_TIMESTAMP_LOOKAHEAD = 180
KV_MODE = none
ANNOTATE_PUNCT = false

[tmef-200119_file_analyzed_ddan]
NO_BINARY_CHECK = 1
SHOULD_LINEMERGE = false
pulldown_type = 1
REPORT-cefevents = cefHeaders,cefKeys,cefCustom
FIELDALIAS-200119_ddan = dvcmac as deviceMacAddress, deviceExternalId as deviceGUID, cs1 as deviceOSName, cs2 as malName, cs3 as deviceProcessHash cef_vendor AS vendor cef_product AS product cef_version AS product_version
LOOKUP-va-name = va_name_lookup cef_signature OUTPUT va_name
LOOKUP-pcomp = ddan_pcomp_lookup cef_product OUTPUT pComp
LOOKUP-severity = cim_severity_lookup cef_severity OUTPUT severity
LOOKUP-rozseverity = rozrating_severity_lookup cn2 OUTPUT cn2_severity
TIME_PREFIX = \s*(end|rt)\=
TIME_FORMAT = %b %d %Y %H:%M:%S %Z
MAX_TIMESTAMP_LOOKAHEAD = 180
KV_MODE = none
ANNOTATE_PUNCT = false

[tmef-200120_denylist_change]
NO_BINARY_CHECK = 1
SHOULD_LINEMERGE = false
pulldown_type = 1
REPORT-cefevents = cefHeaders,cefKeys,cefCustom
FIELDALIAS-200120 = cef_vendor AS vendor cef_product AS product cef_version AS product_version
LOOKUP-va-name = va_name_lookup cef_signature OUTPUT va_name

[tmef-200120_denylist_change_ddan]
NO_BINARY_CHECK = 1
SHOULD_LINEMERGE = false
pulldown_type = 1
REPORT-cefevents = cefHeaders,cefKeys,cefCustom
FIELDALIAS-200120_ddan = dvcmac as deviceMacAddress, deviceExternalId as deviceGUID, cs2 as deviceExternalRiskType cef_vendor AS vendor cef_product AS product cef_version AS product_version
LOOKUP-va-name = va_name_lookup cef_signature OUTPUT va_name
LOOKUP-pcomp = ddan_pcomp_lookup cef_product OUTPUT pComp
TIME_PREFIX = \s*(end|rt)\=
TIME_FORMAT = %b %d %Y %H:%M:%S %Z
MAX_TIMESTAMP_LOOKAHEAD = 180
KV_MODE = none
ANNOTATE_PUNCT = false

[tmef-200126_url_analyzed]
NO_BINARY_CHECK = 1
SHOULD_LINEMERGE = false
pulldown_type = 1
REPORT-cefevents = cefHeaders,cefKeys,cefCustom
FIELDALIAS-200126 = cef_vendor AS vendor cef_product AS product cef_version AS product_version
LOOKUP-va-name = va_name_lookup cef_signature OUTPUT va_name

[tmef-200126_url_analyzed_ddan]
NO_BINARY_CHECK = 1
SHOULD_LINEMERGE = false
pulldown_type = 1
REPORT-cefevents = cefHeaders,cefKeys,cefCustom
FIELDALIAS-200126_ddan = dvcmac as deviceMacAddress, deviceExternalId as deviceGUID, cs1 as deviceOSName, cs3 as deviceProcessHash cef_vendor AS vendor cef_product AS product cef_version AS product_version
LOOKUP-va-name = va_name_lookup cef_signature OUTPUT va_name
LOOKUP-pcomp = ddan_pcomp_lookup cef_product OUTPUT pComp
TIME_PREFIX = \s*(end|rt)\=
TIME_FORMAT = %b %d %Y %H:%M:%S %Z
MAX_TIMESTAMP_LOOKAHEAD = 180
KV_MODE = none
ANNOTATE_PUNCT = false
FIELDALIAS-rozrating = dvcmac as deviceMacAddress, deviceExternalId as deviceGUID, cs2 as deviceExternalRiskType

[tmef-200127_notable_chars]
NO_BINARY_CHECK = 1
SHOULD_LINEMERGE = false
pulldown_type = 1
REPORT-cefevents = cefHeaders,cefKeys,cefCustom
FIELDALIAS-200127 = cef_vendor AS vendor cef_product AS product cef_version AS product_version
LOOKUP-va-name = va_name_lookup cef_signature OUTPUT va_name
LOOKUP-severity = cim_severity_lookup cef_severity OUTPUT severity
TIME_PREFIX = \s*(end|rt)\=
TIME_FORMAT = %b %d %Y %H:%M:%S %Z
MAX_TIMESTAMP_LOOKAHEAD = 180
KV_MODE = none
ANNOTATE_PUNCT = false

[tmef-200127_notable_chars_ddan]
NO_BINARY_CHECK = 1
SHOULD_LINEMERGE = false
pulldown_type = 1
REPORT-cefevents = cefHeaders,cefKeys,cefCustom
FIELDALIAS-200127_ddan = dvcmac as deviceMacAddress, deviceExternalId as deviceGUID, cs1 as ruleCategory, cs2 as ruleName cef_vendor AS vendor cef_product AS product cef_version AS product_version
LOOKUP-va-name = va_name_lookup cef_signature OUTPUT va_name
LOOKUP-pcomp = ddan_pcomp_lookup cef_product OUTPUT pComp
LOOKUP-severity = cim_severity_lookup cef_severity OUTPUT severity
TIME_PREFIX = \s*(end|rt)\=
TIME_FORMAT = %b %d %Y %H:%M:%S %Z
MAX_TIMESTAMP_LOOKAHEAD = 180
KV_MODE = none
ANNOTATE_PUNCT = false

[tmef-200128_submission_analyzed_ddan]
NO_BINARY_CHECK = 1
SHOULD_LINEMERGE = false
pulldown_type = 1
REPORT-cefevents = cefHeaders,cefKeys,cefCustom
FIELDALIAS-200128 = cef_vendor AS vendor cef_product AS product cef_version AS product_version
LOOKUP-va-name = va_name_lookup cef_signature OUTPUT va_name
LOOKUP-pcomp = ddan_pcomp_lookup cef_product OUTPUT pComp
LOOKUP-severity = cim_severity_lookup cef_severity OUTPUT severity
TIME_PREFIX = \s*(end|rt)\=
TIME_FORMAT = %b %d %Y %H:%M:%S %Z
MAX_TIMESTAMP_LOOKAHEAD = 180
KV_MODE = none
ANNOTATE_PUNCT = false

[squid]
EXTRACT-src = (?i)^\d+\t\d+\t(?P<src>[^\t]+)
EXTRACT-dest = (?i)\thttp://(?P<dest>[^/]+)
