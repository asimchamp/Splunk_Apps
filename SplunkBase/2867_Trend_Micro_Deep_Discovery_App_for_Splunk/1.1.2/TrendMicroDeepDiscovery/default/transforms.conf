[cefHeaders]
REGEX = CEF:\s?(?<cef_cefVersion>\d+)\|(?<cef_vendor>[^|]*)\|(?<cef_product>[^|]*)\|(?<cef_version>[^|]*)\|(?<cef_signature>[^|]*)\|(?<cef_name>[^|]*)\|(?<cef_severity>[^|]*)

[cefKeys]
REGEX = (?:_+)?(?<_KEY_1>[\w.:\[\]]+)=(?<_VAL_1>.*?(?=(?:\s[\w.:\[\]]+=|$)))
REPEAT_MATCH = True
CLEAN_KEYS = 1

[cefCustom]
REGEX = (\S+)=([^=]*)\s+(?:\1Label)=([^=]+)(?:(?:\s\w+=)|$)
FORMAT = $3::$2
KEEP_EMPTY_VALS = True

[tmef-100100_malware]
REGEX = \|100100\|MALWARE_DETECTION
FORMAT = sourcetype::tmef-100100_malware
DEST_KEY = MetaData:Sourcetype

[tmef-100101_web_threat]
REGEX = \|100101\|WEB_THREAT_DETECTION
FORMAT = sourcetype::tmef-100101_web_threat
DEST_KEY = MetaData:Sourcetype

[tmef-100118_malware_outbreak]
REGEX = \|100118\|MALWARE_OUTBREAK_DETECTION
FORMAT = sourcetype::tmef-100118_malware_outbreak
DEST_KEY = MetaData:Sourcetype

[tmef-100119_security_risk]
REGEX = \|100119\|SECURITY_RISK_DETECTION
FORMAT = sourcetype::tmef-100119_security_risk
DEST_KEY = MetaData:Sourcetype

[tmef-ddi_email_detection]
REGEX = \|100(100|119)\|(\S+)_DETECTION.*appGroup=(SMTP|POP3|IMAP|WEBMAIL)
FORMAT = sourcetype::tmef-ddi_email_detection
DEST_KEY = MetaData:Sourcetype

[tmef-100120_disruptive_application]
REGEX = \|100120\|DISRUPTIVE_APPLICATION_DETECTION
FORMAT = sourcetype::tmef-100120_disruptive_application
DEST_KEY = MetaData:Sourcetype

[tmef-100127_suspicious_behaviour]
REGEX = \|100127\|SUSPICIOUS_BEHAVIOUR_DETECTION
FORMAT = sourcetype::tmef-100127_suspicious_behaviour
DEST_KEY = MetaData:Sourcetype

[tmef-100130_email_detection]
REGEX = \|100130\|EMAIL_DETECTION
FORMAT = sourcetype::tmef-100130_email_detection
DEST_KEY = MetaData:Sourcetype

[tmef-100131_attachment_detection]
REGEX = \|100131\|ATTACHMENT_DETECTION
FORMAT = sourcetype::tmef-100131_attachment_detection
DEST_KEY = MetaData:Sourcetype

[tmef-100132_url_detection]
REGEX = \|100132\|URL_DETECTION
FORMAT = sourcetype::tmef-100132_url_detection
DEST_KEY = MetaData:Sourcetype

[tmef-100133_retroscan_report]
REGEX = \|100133\|RETROSCAN_REPORT
FORMAT = sourcetype::tmef-100133_retroscan_report
DEST_KEY = MetaData:Sourcetype

[tmef-100134_retroscan_detection]
REGEX = \|100134\|RETROSCAN_DETECTION
FORMAT = sourcetype::tmef-100134_retroscan_detection
DEST_KEY = MetaData:Sourcetype

[tmef-200119_file_analyzed]
REGEX = \|200119\|FILE_ANALYZED
FORMAT = sourcetype::tmef-200119_file_analyzed
DEST_KEY = MetaData:Sourcetype

[tmef-200119_file_analyzed_ddan]
REGEX = \|200119\|Sample file sandbox analysis is finished
FORMAT = sourcetype::tmef-200119_file_analyzed_ddan
DEST_KEY = MetaData:Sourcetype

[tmef-200120_denylist_change]
REGEX = \|200120\|DENYLIST_CHANGE
FORMAT = sourcetype::tmef-200120_denylist_change
DEST_KEY = MetaData:Sourcetype

[tmef-200120_denylist_change_ddan]
REGEX = \|200120\|Deny List updated
FORMAT = sourcetype::tmef-200120_denylist_change_ddan
DEST_KEY = MetaData:Sourcetype

[tmef-200126_url_analyzed]
REGEX = \|200126\|URL_ANALYZED
FORMAT = sourcetype::tmef-200126_url_analyzed
DEST_KEY = MetaData:Sourcetype

[tmef-200126_url_analyzed_ddan]
REGEX = \|200126\|URL sandbox analysis is finished
FORMAT = sourcetype::tmef-200126_url_analyzed_ddan
DEST_KEY = MetaData:Sourcetype

[tmef-200127_notable_chars]
REGEX = \|200127\|NOTABLE_CHARACTERISTICS
FORMAT = sourcetype::tmef-200127_notable_chars
DEST_KEY = MetaData:Sourcetype

[tmef-200127_notable_chars_ddan]
REGEX = \|200127\|Notable Characteristics of the analyzed sample
FORMAT = sourcetype::tmef-200127_notable_chars_ddan
DEST_KEY = MetaData:Sourcetype

[tmef-200128_submission_analyzed_ddan]
REGEX = \|200128\|SUBMISSION_ANALYZED
FORMAT = sourcetype::tmef-200128_submission_analyzed_ddan
DEST_KEY = MetaData:Sourcetype

[cim_severity_lookup]
filename = CIM_severity.csv
default_match = "unknown"

[cim_direction_lookup]
filename = CIM_direction.csv
default_match = "unknown"

[rozrating_severity_lookup]
filename = ROZRating_severity_map.csv
default_match = "unknown"

[cim_ids_type_lookup]
default_match = "unknown"
filename = CIM_ids_type.csv
max_matches = 1

[cim_action_lookup]
default_match = "allowed"
filename = CIM_action.csv
max_matches = 1

[cim_100101_action_lookup]
default_match = "allowed"
filename = CIM_100101_action.csv
max_matches = 1

[ddan_pcomp_lookup]
default_match = "Sandbox"
filename = DDAN_pcomp.csv
max_matches = 1

[va_name_lookup]
default_match = "unknown"
filename = va_name.csv
max_matches = 1

[cim_email_action_lookup]
default_match = "allowed"
filename = CIM_email_action.csv
max_matches = 1
