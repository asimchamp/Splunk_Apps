[Rpt_cass_kpi_cpumax4hrs]
action.email.reportServerEnabled = 0
action.email.useNSSubject = 1
alert.digest_mode = True
alert.suppress = 0
alert.track = 0
auto_summarize.dispatch.earliest_time = -1d@h
description = CPU Maximum Usage in last 4 hrs
display.general.type = statistics
display.visualizations.show = 0
request.ui_dispatch_app = NOSQL_KPI
request.ui_dispatch_view = search
search = earliest=-4h@s index="cassandra_cpu" | sort 0 inetaddr, -tstamp | rex field=host "(?<server_name>[^.|\s]*)" | streamstats max(tstamp) AS MAX_TSTAMP by server_name | table server_name, tstamp, MAX_TSTAMP, idle, system, user | where tstamp=MAX_TSTAMP | stats max(MAX_TSTAMP) AS LATEST_TIME, min(idle) AS IDLE, max(system) AS SYSTEM, max(user) AS USER by server_name

[Rpt_cass_maxread_latency]
action.email.reportServerEnabled = 0
action.email.useNSSubject = 1
alert.digest_mode = True
alert.suppress = 0
alert.track = 0
auto_summarize.dispatch.earliest_time = -1d@h
display.general.type = statistics
display.visualizations.show = 0
request.ui_dispatch_app = NOSQL_KPI
request.ui_dispatch_view = search
search = index="cassandra_readwrite" | sort 0 inetaddr, -tstamp | rex field=host "(?<Server>[^.|\s]*)" | streamstats max(Read_Latency_ms) AS MAXREADLATENCY by Server | table Server, tstamp, Keyspace, Read_Latency_ms, MAXREADLATENCY |  where Read_Latency_ms > 0 AND Read_Latency_ms=MAXREADLATENCY | stats max(MAXREADLATENCY) AS MAX_READ_LATENCY, min(tstamp) AS AS_OF by Server, Keyspace | eval MAX_READ_LATENCY=MAX_READ_LATENCY/1.0

[Rpt_cass_kpi_rwlatency]
action.email.reportServerEnabled = 0
action.email.useNSSubject = 1
alert.digest_mode = True
alert.suppress = 0
alert.track = 0
auto_summarize.dispatch.earliest_time = -1d@h
display.general.type = statistics
display.visualizations.show = 0
request.ui_dispatch_app = NOSQL_KPI
request.ui_dispatch_view = search
search = index="cassandra_readwrite" | sort 0 inetaddr, -tstamp, keyspace | rex field=host "(?<Server>[^.|\s]*)" | streamstats max(tstamp) AS LATEST_TIME  by Server | table inetaddr, Server, tstamp, LATEST_TIME, Keyspace, Read_Count, Read_Latency_ms, Write_Count, Write_Latency_ms, Pending_Tasks | where tstamp=LATEST_TIME | stats max(LATEST_TIME) AS LATEST_TIME, values(Read_Count) AS READCOUNT, values(Read_Latency_ms) AS READLATENCY, values(Write_Count) AS WRITECOUNT, values(Write_Latency_ms) AS WRITELATENCY, values(Pending_Tasks) AS TASKPENDING by Server, Keyspace | where READLATENCY > 0 OR WRITELATENCY > 0 | eval WRITELATENCY=(WRITELATENCY/1.0) | eval READLATENCY=(READLATENCY/1.0)

[alert_cass_cpu_reach_90]
action.email.reportServerEnabled = 0
action.script = 1
action.script.filename = nodeadd.sh
alert.digest_mode = True
alert.expires = 6h
alert.severity = 4
alert.suppress = 1
alert.suppress.period = 4m
alert.track = 1
alert_condition = search AVG_USED_CPU_PERCENT > 10
auto_summarize.dispatch.earliest_time = 0
counttype = custom
cron_schedule = */5 * * * *
description = Check CPU Cumulative Used Percent
enableSched = 1
search = index="cassandra_cpu" | rex field=host "(?<server_name>[^.|\s]*)" | streamstats max(tstamp) AS LATEST_TIME by server_name | table server_name,tstamp,LATEST_TIME, idle | where tstamp=LATEST_TIME | eval USED_PERCENT=(100-idle) | stats avg(USED_PERCENT) AS AVG_USED_CPU_PERCENT

[Rpt_cass_kpi_netstat_pend_complete]
action.email.reportServerEnabled = 0
action.email.useNSSubject = 1
alert.digest_mode = True
alert.suppress = 0
alert.track = 0
auto_summarize.dispatch.earliest_time = -1d@h
display.general.type = statistics
display.visualizations.show = 0
request.ui_dispatch_app = NOSQL_KPI
request.ui_dispatch_view = search
search = index="cassandra_netstat" | sort 0 inetaddr, -tstamp | rex field=host "(?<Server>[^.|\s]*)" | streamstats max(tstamp) AS LATEST_TIME by Server | where tstamp=LATEST_TIME | stats max(tstamp) AS TIMESTAMP, values(Active) AS ACTIVE, values(Pending) AS PENDING, values(Completed) AS COMPLETED by Server, Pool_Name

[CPU_IDLE_TIME_NODE4]
action.email.reportServerEnabled = 0
action.email.useNSSubject = 1
alert.digest_mode = True
alert.suppress = 0
alert.track = 0
auto_summarize.dispatch.earliest_time = -1d@h
display.general.type = visualizations
display.visualizations.charting.chart = radialGauge
display.visualizations.show = 0
request.ui_dispatch_app = NOSQL_KPI
request.ui_dispatch_view = search
search = index="cassandra_cpu" | rename HOSTADDR AS server_name | streamstats max(tstamp) AS LATEST_TIME by server_name | table server_name,tstamp,LATEST_TIME, idle | where tstamp=LATEST_TIME | eval USED_PERCENT=(100-idle) | stats avg(USED_PERCENT) AS AVG_USED_CPU_PERCENT by tstamp | gauge AVG_USED_CPU_PERCENT

[KPI_MemStats_MB_Total_by_IP]
action.email.reportServerEnabled = 0
action.email.useNSSubject = 1
alert.digest_mode = True
alert.suppress = 0
alert.track = 0
auto_summarize.dispatch.earliest_time = -1d@h
display.general.type = statistics
display.visualizations.show = 0
request.ui_dispatch_app = NOSQL_KPI
request.ui_dispatch_view = search
search = index="cassandra_memory"  | sort 0 inetaddr, -tstamp |rename HOSTADDR AS Server | streamstats max(tstamp) AS MAX_TSTAMP by Server,Type | table Server, tstamp, MAX_TSTAMP, Type, used, total | where tstamp=max(MAX_TSTAMP)  | stats max(MAX_TSTAMP), max(used) AS TOTAL_MEM_USED by Server

[KPI_MemStats_MB_Mem_by_IP]
action.email.reportServerEnabled = 0
action.email.useNSSubject = 1
alert.digest_mode = True
alert.suppress = 0
alert.track = 0
auto_summarize.dispatch.earliest_time = -1d@h
description = Max Memory used by Host
display.general.type = statistics
display.visualizations.show = 0
request.ui_dispatch_app = NOSQL_KPI
request.ui_dispatch_view = search
search = index="cassandra_memory" Type="Memory"  | sort 0 inetaddr, -tstamp | rename HOSTADDR AS Server | streamstats max(tstamp) AS MAX_TSTAMP by Server | table Server, tstamp, MAX_TSTAMP, Type, used | where tstamp=max(MAX_TSTAMP) | stats max(MAX_TSTAMP), values(Type) AS MEMORY_TYPE, max(used) AS MAX_USED by Server

[Rpt_cass_kpi_poolpendingcount_by_host]
action.email.reportServerEnabled = 0
alert.digest_mode = True
alert.suppress = 0
alert.track = 0
auto_summarize.dispatch.earliest_time = -1d@h
cron_schedule = 0 0 * * *
description = Pending Task Count by Host
display.general.type = statistics
display.visualizations.show = 0
request.ui_dispatch_view = search
search = index="cassandara_process" | sort inetaddr, -tstamp | rename HOSTADDR AS Server | streamstats max(tstamp) AS LATEST_TIME by Server | table inetaddr, Server, tstamp, LATEST_TIME, Active, Pending, Blocked, Completed | where tstamp=LATEST_TIME | eval non_completed=Active+Pending+Blocked | stats values(LATEST_TIME) AS "AS_OF", sum(Active) as Total_Active, sum(Pending) as Total_Pending, sum(Blocked) as Total_Blocked,  sum(Completed) as Total_Completed by Server

[Rpt_cass_kpi_curr_pendprocess_host_poolwise]
action.email.reportServerEnabled = 0
action.email.useNSSubject = 1
alert.digest_mode = True
alert.suppress = 0
alert.track = 0
auto_summarize.dispatch.earliest_time = -1d@h
description = Pending Process Host / Pool Wise
display.general.type = statistics
display.visualizations.show = 0
request.ui_dispatch_app = NOSQL_KPI
request.ui_dispatch_view = search
search = index="cassandara_process" | rename HOSTADDR AS Server | eval non_completed=Active+Pending+Blocked | where non_completed > 0 | stats sum(Active) as Total_Active, sum(Pending) as Total_Pending, sum(Blocked) as Total_Blocked, sum(Completed) as Total_Completed by Server, tstamp, Pool_Name | table Server, tstamp, Pool_Name, Total_Active, Total_Pending, Total_Blocked, Total_Completed | sort 0 Server, -tstamp | streamstats max(tstamp) AS LATEST_TIME by Server | table Server, tstamp, LATEST_TIME, Pool_Name, Total_Active, Total_Pending, Total_Blocked, Total_Completed | where tstamp=LATEST_TIME
