<form>
  <label>Indicator Search</label>
  <description>This form allows you to search currently saved indicators (click on returned result to see IOC.) When searching for IP addresses the regular expression will not match within IP indicator ranges or CIDR blocks.</description>
  <fieldset submitButton="true">
    <input type="text" token="indicator_val_tok">
      <label>Indicator (regular expression - PCRE)</label>
      <default>.*</default>
    </input>
    <input type="dropdown" token="ignore_case_tok">
      <label>Ignore case?</label>
      <choice value="true">Yes</choice>
      <choice value="false">No</choice>
      <default>Yes</default>
    </input>
    <input type="dropdown" token="display_disabled_indicators_tok">
      <label>Display disabled indicators?</label>
      <choice value="true">Yes</choice>
      <choice value="false">No</choice>
      <default>No</default>
    </input>
  </fieldset>
  <row>
    <panel>
      <table>
        <searchString>| iocfilter regex="$indicator_val_tok$"  ignorecase=$ignore_case_tok$ displaydisabled=$display_disabled_indicators_tok$ | table value, value_type, indicator_id, ioc_id,indicator_raw_id, raw_id |rename value as "Indicator", value_type as "Type", indicator_id as "Indicator ID", ioc_id as "IOC ID" indicator_raw_id as "(splice indicator id)" raw_id as "(splice ioc id)"</searchString>
        <earliestTime>0</earliestTime>
        <latestTime/>
        <drilldown>
          <link>
            <![CDATA[
        /app/SA-Splice/ioc_viewer?form.indicator_id_tok=$row.Indicator ID$&form.ioc_id_tok=$row.IOC ID$&form.ioc_raw_id_tok=$row.(splice ioc id)$
        ]]>
          </link>
        </drilldown>
        <option name="wrap">true</option>
        <option name="rowNumbers">false</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">row</option>
        <option name="count">20</option>
      </table>
    </panel>
  </row>
</form>
