<dashboard>
  <label>IOC Consumption</label>
  <description>Splunk Indicators of Compromise Engine</description>
  <row>
    <table>
      <title>Number of Indicators</title>
      <searchString>| iocstats stat=number_of_indicators_per_type | table value_type,count | sort -count</searchString>
      <earliestTime>-1m</earliestTime>
      <latestTime>now</latestTime>
      <option name="linkView">search</option>
      <option name="wrap">true</option>
      <option name="rowNumbers">false</option>
      <option name="dataOverlayMode">none</option>
      <option name="drilldown">none</option>
      <option name="count">20</option>
    </table>
    <single>
      <title>Number of IOCs</title>
      <searchString>| iocstats stat=number_of_iocs | stats values</searchString>
      <earliestTime>-1m</earliestTime>
      <latestTime>now</latestTime>
      <option name="linkView">search</option>
      <option name="underLabel">IOCs are stored</option>
    </single>
    <chart>
      <title>Ingestion Statistics (last 7 days)</title>
      <searchString>index=_internal source="*/splunkd.log" splice event_type=* | timechart span=1h count by event_type</searchString>
      <earliestTime>-7d@h</earliestTime>
      <latestTime>now</latestTime>
      <option name="charting.axisTitleX.visibility">visible</option>
      <option name="charting.axisTitleY.visibility">visible</option>
      <option name="charting.axisX.scale">linear</option>
      <option name="charting.axisY.scale">linear</option>
      <option name="charting.chart">column</option>
      <option name="charting.chart.nullValueMode">gaps</option>
      <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
      <option name="charting.chart.stackMode">default</option>
      <option name="charting.chart.style">shiny</option>
      <option name="charting.drilldown">all</option>
      <option name="charting.layout.splitSeries">0</option>
      <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
      <option name="charting.legend.placement">bottom</option>
    </chart>
  </row>
  <row>
    <chart>
      <title>Splice System Events (last 7 days)</title>
      <searchString>index=_internal source="*/splunkd.log" splice | timechart span=1h count(message) by log_level</searchString>
      <earliestTime>-7d@h</earliestTime>
      <latestTime>now</latestTime>
      <option name="charting.axisTitleX.visibility">visible</option>
      <option name="charting.axisTitleY.visibility">visible</option>
      <option name="charting.axisX.scale">linear</option>
      <option name="charting.axisY.scale">linear</option>
      <option name="charting.chart">line</option>
      <option name="charting.chart.nullValueMode">gaps</option>
      <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
      <option name="charting.chart.stackMode">default</option>
      <option name="charting.chart.style">shiny</option>
      <option name="charting.drilldown">all</option>
      <option name="charting.layout.splitSeries">0</option>
      <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
      <option name="charting.legend.placement">bottom</option>
    </chart>
    <chart>
      <title>Unsupported Indicators (last 7 days)</title>
      <searchString>index=_internal source=*/splunkd.log splice "parser not found:" | rex field=_raw "splice\.parsers\.(?&lt;parser_name&gt;\S+)" | timechart span=8h count by parser_name</searchString>
      <earliestTime>-7d@h</earliestTime>
      <latestTime>now</latestTime>
      <option name="charting.axisTitleX.visibility">visible</option>
      <option name="charting.axisTitleY.visibility">visible</option>
      <option name="charting.axisX.scale">linear</option>
      <option name="charting.axisY.scale">linear</option>
      <option name="charting.chart">column</option>
      <option name="charting.chart.nullValueMode">gaps</option>
      <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
      <option name="charting.chart.stackMode">default</option>
      <option name="charting.chart.style">shiny</option>
      <option name="charting.drilldown">all</option>
      <option name="charting.layout.splitSeries">0</option>
      <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
      <option name="charting.legend.placement">bottom</option>
    </chart>
  </row>
  <row>
    <event>
      <title>Splice System Logs (WARN, ERROR)</title>
      <searchString>index="_internal" sourcetype="splunkd" splice log_level!="INFO" | head 100</searchString>
      <earliestTime>-7d@h</earliestTime>
      <latestTime>now</latestTime>
      <option name="list.drilldown">full</option>
      <option name="list.wrap">1</option>
      <option name="maxLines">10</option>
      <option name="raw.drilldown">full</option>
      <option name="rowNumbers">0</option>
      <option name="table.drilldown">1</option>
      <option name="table.wrap">1</option>
      <option name="type">raw</option>
      <option name="count">10</option>
      <fields>["host","source","sourcetype"]</fields>
    </event>
  </row>
</dashboard>
