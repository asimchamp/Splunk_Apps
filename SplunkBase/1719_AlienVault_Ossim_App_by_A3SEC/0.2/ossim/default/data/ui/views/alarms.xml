<dashboard>
  <label>Alarms of the Day</label>
  <description>by Paty Chavez</description>
  <row>
    <chart>
      <title>Last 10 Alarms in 4 Hours</title>
      <searchString>| pivot AlarmasOssim ossimevent count(ossimevent) AS "# de Alarmas" SPLITROW alarm AS "Alarma" TOP 10 count(ossimevent)</searchString>
      <earliestTime>-4h@m</earliestTime>
      <latestTime>now</latestTime>
      <option name="charting.axisY.scale">linear</option>
      <option name="charting.axisX.scale">linear</option>
      <option name="charting.legend.placement">right</option>
      <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
      <option name="charting.chart.stackMode">default</option>
      <option name="charting.chart.nullValueMode">gaps</option>
      <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
      <option name="charting.chart.rangeValues">["0","30","70","100"]</option>
      <option name="charting.chart.style">shiny</option>
      <option name="charting.gaugeColors">[0x84E900,0xFFE800,0xBF3030]</option>
      <option name="charting.axisTitleX.visibility">visible</option>
      <option name="charting.axisTitleY.visibility">visible</option>
      <option name="charting.chart">pie</option>
      <option name="charting.drilldown">all</option>
      <option name="charting.layout.splitSeries">0</option>
    </chart>
    <single>
      <title>#Alarms Last 15 Mins</title>
      <searchString>| pivot AlarmasOssim AlarmasOssim count(AlarmasOssim) AS "Count of AlarmasOssim"</searchString>
      <earliestTime>-15m</earliestTime>
      <latestTime>now</latestTime>
      <option name="afterLabel">Alarms</option>
      <option name="beforeLabel">You Have</option>
      <option name="underLabel">In the Last 15 Minutes</option>
      <option name="linkView">search</option>
    </single>
  </row>
  <row>
    <map>
      <title>Origin of the Attacks Last 4Hrs</title>
      <searchString>sourcetype=ossim_syslog | iplocation src_ip  | geostats globallimit=0 count by alarm</searchString>
      <earliestTime>-4h@m</earliestTime>
      <latestTime>$latest$</latestTime>
      <option name="wrap">true</option>
      <option name="rowNumbers">false</option>
      <option name="dataOverlayMode">none</option>
      <option name="drilldown">row</option>
      <option name="count">10</option>
    </map>
  </row>
  <row>
    <chart>
      <title>Origin of the Alarms in the last 4 Hrs</title>
      <searchString>| pivot AlarmasOssim ossimevent count(ossimevent) AS "Count of ossim-event" SPLITROW _time AS "_time" PERIOD minute SPLITCOL src_ip SORT 0 _time NUMCOLS 100</searchString>
      <earliestTime>-4h@m</earliestTime>
      <latestTime>now</latestTime>
      <option name="charting.axisY.scale">linear</option>
      <option name="charting.axisX.scale">linear</option>
      <option name="charting.axisTitleY.text">Count of ossim-event</option>
      <option name="charting.legend.placement">right</option>
      <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
      <option name="charting.chart.stackMode">default</option>
      <option name="charting.chart.nullValueMode">gaps</option>
      <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
      <option name="charting.chart.rangeValues">["0","30","70","100"]</option>
      <option name="charting.chart.style">shiny</option>
      <option name="charting.gaugeColors">[0x84E900,0xFFE800,0xBF3030]</option>
      <option name="charting.axisTitleX.visibility">visible</option>
      <option name="charting.axisTitleY.visibility">visible</option>
      <option name="charting.chart">line</option>
      <option name="charting.drilldown">all</option>
      <option name="charting.layout.splitSeries">0</option>
    </chart>
    <chart>
      <title>Alarms of the Day</title>
      <searchString>| pivot AlarmasOssim ossimevent count(ossimevent) AS "Número de Alarmas del día" SPLITROW alarm AS "Alarmas" SPLITCOL dst_ip TOP 10 count(ossimevent) NUMCOLS 50</searchString>
      <earliestTime>@d</earliestTime>
      <latestTime>now</latestTime>
      <option name="charting.axisY.scale">linear</option>
      <option name="charting.axisX.scale">linear</option>
      <option name="charting.axisTitleY.text">Número de Alarmas del día</option>
      <option name="charting.legend.placement">right</option>
      <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
      <option name="charting.chart.stackMode">stacked</option>
      <option name="charting.chart.nullValueMode">gaps</option>
      <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
      <option name="charting.chart.style">shiny</option>
      <option name="charting.axisTitleX.visibility">visible</option>
      <option name="charting.axisTitleY.visibility">visible</option>
      <option name="charting.chart">bar</option>
      <option name="charting.drilldown">all</option>
      <option name="charting.layout.splitSeries">0</option>
    </chart>
  </row>
  <row>
    <table>
      <title>Matrix of Origins and Destinations of Alarms las 24Hrs</title>
      <searchString>| pivot AlarmasOssim ossimevent count(ossimevent) AS "#Alarmas" SPLITROW src_ip AS "src_ip" SPLITCOL dst_ip SORT 10 src_ip NUMCOLS 10</searchString>
      <earliestTime>-24h@h</earliestTime>
      <latestTime>$latest$</latestTime>
      <option name="wrap">true</option>
      <option name="rowNumbers">false</option>
      <option name="dataOverlayMode">none</option>
      <option name="drilldown">row</option>
      <option name="count">10</option>
    </table>
  </row>
  <row>
    <chart>
      <title>Alarms by Origin of the Day</title>
      <searchString>| pivot AlarmasOssim ossimevent count(ossimevent) AS "Número de Alarmas del día" SPLITROW alarm AS "alarm" SPLITCOL src_ip TOP 10 count(ossimevent) SHOWOTHER false NUMCOLS 100</searchString>
      <earliestTime>-24h@m</earliestTime>
      <latestTime>now</latestTime>
      <option name="charting.axisY.scale">linear</option>
      <option name="charting.axisX.scale">linear</option>
      <option name="charting.axisTitleY.text">Número de Alarmas del día</option>
      <option name="charting.legend.placement">right</option>
      <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
      <option name="charting.chart.stackMode">stacked</option>
      <option name="charting.chart.nullValueMode">gaps</option>
      <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
      <option name="charting.chart.style">shiny</option>
      <option name="charting.axisTitleX.visibility">visible</option>
      <option name="charting.axisTitleY.visibility">visible</option>
      <option name="charting.chart">column</option>
      <option name="charting.drilldown">all</option>
      <option name="charting.layout.splitSeries">0</option>
    </chart>
  </row>
  <row>
    <chart>
      <title>Events by Plugin and Plugin_Sid of the Day</title>
      <searchString>| pivot AlarmasOssim ossimevent count(ossimevent) AS "Events" SPLITROW pluginid AS "Pluguin ID" SPLITCOL pluginsid SORT 0 pluginid</searchString>
      <earliestTime>-24h@m</earliestTime>
      <latestTime>$latest$</latestTime>
      <option name="charting.axisY.scale">linear</option>
      <option name="charting.axisX.scale">linear</option>
      <option name="charting.axisTitleY.text">Events</option>
      <option name="charting.legend.placement">right</option>
      <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
      <option name="charting.chart.stackMode">stacked</option>
      <option name="charting.chart.nullValueMode">gaps</option>
      <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
      <option name="charting.chart.style">shiny</option>
      <option name="charting.axisTitleX.visibility">visible</option>
      <option name="charting.axisTitleY.visibility">visible</option>
      <option name="charting.chart">column</option>
      <option name="charting.drilldown">all</option>
      <option name="charting.layout.splitSeries">0</option>
    </chart>
  </row>
</dashboard>