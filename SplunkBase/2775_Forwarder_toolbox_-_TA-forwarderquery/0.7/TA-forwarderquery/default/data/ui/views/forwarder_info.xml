<form>
  <label>Forwarder Info</label>
  <fieldset submitButton="false"></fieldset>
  <row>
    <panel>
      <title>Apps on selected box</title>
      <input type="dropdown" token="host" searchWhenChanged="true">
        <label>choose forwarder host to inspect:</label>
        <search>
          <query>| metadata type=hosts index=_internal</query>
          <earliest>-24h@h</earliest>
          <latest>now</latest>
        </search>
        <fieldForLabel>host</fieldForLabel>
        <fieldForValue>host</fieldForValue>
      </input>
      <input type="dropdown" token="stanza">
        <label>Password set</label>
        <fieldForLabel>title</fieldForLabel>
        <fieldForValue>title</fieldForValue>
        <search>
          <query>| rest splunk_server=local /servicesNS/nobody/TA-forwarderquery/properties/forwarderquery/  | search title!=mystanza</query>
        </search>
        <initialValue>default</initialValue>
      </input>
      <single>
        <title>Version</title>
        <search>
          <query>|forwarderquery server=$host$   api="/services/server/info" stanza="default" contenttype="json" | spath path="entry{}" output=entry | fields - _raw | mvexpand entry | spath input=entry | rename content.version as version | fields version</query>
          <earliest>0</earliest>
          <latest></latest>
        </search>
        <option name="drilldown">none</option>
        <drilldown>
          <!-- Use set to specify the new token to be created.
                     Use any token from the page or from the click event to produce the value needed. -->
          <set token="app">$row.title$</set>
        </drilldown>
        <option name="colorBy">value</option>
        <option name="colorMode">none</option>
        <option name="numberPrecision">0</option>
        <option name="showSparkline">1</option>
        <option name="showTrendIndicator">1</option>
        <option name="trendColorInterpretation">standard</option>
        <option name="trendDisplayMode">absolute</option>
        <option name="unitPosition">after</option>
        <option name="useColors">0</option>
        <option name="useThousandSeparators">1</option>
      </single>
      <table>
        <title>messages</title>
        <search>
          <query>|forwarderquery server="$host$" api="/services/messages/" contenttype="json" stanza="$stanza$"
| spath path="entry{}" output=entry | fields - _raw | mvexpand entry | spath input=entry | rename content.* AS * | table message,severity,timeCreated_iso | append [| gentimes start=-1 | eval message="" |table message,severity,timeCreated_iso ]</query>
          <earliest>0</earliest>
          <latest></latest>
        </search>
        <option name="count">3</option>
      </table>
      <table>
        <title>configured output host</title>
        <search>
          <query>|forwarderquery server="$host$"   api="/services/data/outputs/tcp/server" stanza="$stanza$" contenttype="json" | spath path="entry{}" output=entry | fields - _raw | mvexpand entry | spath input=entry | rename content.* AS * | rename acl.* AS * | table app,name,method,status</query>
          <earliest>0</earliest>
          <latest></latest>
        </search>
        <option name="count">10</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">row</option>
        <option name="rowNumbers">false</option>
        <option name="wrap">true</option>
        <drilldown>
          <!-- Use set to specify the new token to be created.
                     Use any token from the page or from the click event to produce the value needed. -->
          <set token="app">$row.title$</set>
        </drilldown>
      </table>
      <table>
        <title>configured deploy-poll host</title>
        <search>
          <query>|forwarderquery server="$host$"  api="/services/deployment/client" stanza="$stanza$" contenttype="json" | spath path="entry{}" output=entry | fields - _raw | mvexpand entry | spath input=entry | rename content.* AS * | rename acl.* AS *
| table clientname,disabled,name,targetUri,updated</query>
          <earliest>0</earliest>
          <latest></latest>
        </search>
        <option name="count">10</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">row</option>
        <option name="rowNumbers">false</option>
        <option name="wrap">true</option>
        <drilldown>
          <!-- Use set to specify the new token to be created.
                     Use any token from the page or from the click event to produce the value needed. -->
          <set token="app">$row.title$</set>
        </drilldown>
      </table>
      <table>
        <title>click on app title in list to inspect what files are monitored by a definition in the app context</title>
        <search>
          <query>|forwarderquery server="$host$" api="/servicesNS/nobody" stanza="$stanza$" contenttype="json" | spath path="entry{}" output=entry | fields - _raw | mvexpand entry | spath input=entry | rename content.* AS * | rename acl.* AS * | rename name AS app | table app</query>
          <earliest>0</earliest>
          <latest></latest>
        </search>
        <option name="count">10</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">row</option>
        <option name="rowNumbers">false</option>
        <option name="wrap">true</option>
        <drilldown>
          <!-- Use set to specify the new token to be created.
                     Use any token from the page or from the click event to produce the value needed. -->
          <set token="app">$row.app$</set>
        </drilldown>
      </table>
    </panel>
    <panel>
      <input type="dropdown" token="func">
        <label>Function</label>
        <choice value="median">Median</choice>
        <choice value="avg">Average</choice>
        <choice value="max">Max</choice>
        <choice value="perc90">90th Perc</choice>
        <default>avg</default>
        <initialValue>avg</initialValue>
      </input>
      <input type="dropdown" token="series">
        <label>Series</label>
        <choice value="data.pct_cpu">CPU</choice>
        <choice value="data.mem_used">Memory</choice>
        <default>data.pct_cpu</default>
        <initialValue>data.pct_cpu</initialValue>
      </input>
      <chart>
        <title>Splunk CPU Usage % of one core</title>
        <search>
          <query>index=_introspection host="$host$" component=PerProcess "data.args"="-p 8089 start" OR "data.args"="-p 8089 restart" | timechart $func$($series$) as cpu</query>
          <earliest>-7d@h</earliest>
          <latest>now</latest>
        </search>
        <option name="charting.chart">line</option>
      </chart>
      <table>
        <title>Monitored files in selected App</title>
        <search>
          <query>| forwarderquery server="$host$" api="/servicesNS/nobody/$app$/data/inputs/monitor/"   
  stanza="$stanza$" contenttype="json" | spath path="entry{}" output=entry | fields - _raw | mvexpand entry | spath input=entry | rename content.* AS * | rename acl.* AS * | search app=$app$ | rename name AS file
| search id="*$app$*" | table file</query>
          <earliest>0</earliest>
        </search>
        <option name="count">20</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">cell</option>
        <option name="rowNumbers">false</option>
        <option name="wrap">true</option>
      </table>
      <table>
        <title>Scripted inputs in selected App</title>
        <search>
          <query>| forwarderquery server="$host$" api="/servicesNS/nobody/$app$/data/inputs/script/"   
  stanza="$stanza$" contenttype="json" | spath path="entry{}" output=entry | fields - _raw | mvexpand entry | spath input=entry | rename content.* AS * | rename acl.* AS * | search app=$app$ | rename name AS file
| search id="*$app$*" | table file</query>
          <earliest>0</earliest>
        </search>
        <option name="count">15</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">cell</option>
        <option name="rowNumbers">false</option>
        <option name="wrap">true</option>
      </table>
      <table>
        <title>WinEventLog inputs in selected App</title>
        <search>
          <query>| forwarderquery server="$host$" api="/servicesNS/nobody/$app$/data/inputs/WinEventLog/"   
  stanza="$stanza$" contenttype="json" | spath path="entry{}" output=entry | fields - _raw | mvexpand entry | spath input=entry | rename content.* AS * | rename acl.* AS * | search app=$app$ | rename name AS file
| search id="*$app$*" | table file
| append [| gentimes start=-1 | eval file="" |table file]</query>
          <earliest>0</earliest>
        </search>
        <option name="count">15</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">cell</option>
        <option name="rowNumbers">false</option>
        <option name="wrap">true</option>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <title>Forwarder logs from selected host</title>
      <event>
        <title>Forwarder logs</title>
        <search>
          <query>splunk_server=* index="_internal" host="$host$"</query>
          <earliest>-15m</earliest>
          <latest>now</latest>
        </search>
      </event>
    </panel>
  </row>
</form>