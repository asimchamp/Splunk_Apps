[default]
disabled = 0

[Alarms and Warnings]
action.email.reportServerEnabled = 0
alert.track = 0
display.visualizations.chartHeight = 233
display.visualizations.show = 0
request.ui_dispatch_app = thor
search = level=Alarm OR level=Alert OR level=Warning

[Most Relevant Systems]
action.email.reportServerEnabled = 0
alert.track = 0
dispatch.earliest_time = 0
display.general.type = statistics
display.page.pivot.dataModel = /servicesNS/admin/thor/datamodel/model/Thor_Event
display.visualizations.show = 0
request.ui_dispatch_app = thor
search = | pivot Thor_Event THOR_Event count(THOR_Event) AS "Count of THOR Event" SPLITROW system AS "system" SPLITCOL level FILTER level isNot Info FILTER level isNot Debug FILTER level isNot Error FILTER level isNot Notice TOP 100 count(THOR_Event) COLSUMMARY true NUMCOLS 10

[Base Event Search]
action.email.reportServerEnabled = 0
alert.track = 0
description = Basic search to build useful search statements upon
dispatch.earliest_time = -30d@d
dispatch.latest_time = now
display.events.fields = ["system","level","mainreason","duration","source","sourcetype","host","session_id","eventtype","score","module","matching_strings","message"]
display.visualizations.chartHeight = 233
display.visualizations.show = 0
request.ui_dispatch_app = thor
search = eventtype=thor_events NOT tag=false_positive ( level=Alarm OR level=Alert OR level=Warning )

[Base Analysis]
dispatch.earliest_time = -30d@d
dispatch.latest_time = now
action.email.reportServerEnabled = 0
action.email.useNSSubject = 1
alert.track = 0
description = Basic search to build useful search statements upon
dispatch.earliest_time = 0
display.events.fields = ["system","level","mainreason","duration","source","sourcetype","host","session_id","eventtype","score","module","matching_strings","message"]
display.general.type = statistics
display.page.search.tab = statistics
display.visualizations.chartHeight = 233
display.visualizations.show = 0
request.ui_dispatch_app = thor
request.ui_dispatch_view = search
search = eventtype=thor_events NOT tag=false_positive ( level=Alarm OR level=Alert OR level=Warning ) | table system,module,score,mainreason,file,_raw

[Fast File View]
dispatch.earliest_time = -30d@d
dispatch.latest_time = now
display.events.fields = ["hostname","affected","affect","score","sourcetype","source","file","host","module","message","level","PRIV"]
display.events.list.drilldown = none
display.events.raw.drilldown = none
display.general.type = statistics
display.statistics.drilldown = none
display.visualizations.charting.chart = line
display.visualizations.show = 0
request.ui_dispatch_app = thor
search = eventtype=thor_events (level=Warning OR level=Alarm OR level=Alert) module=FileScan NOT tag=false_positive NOT sysmain.sdb NOT mem.exe NOT "REASON_1: Suspicious Time Stamp" NOT X\x00T\x00R\x00E\x00M\x00E NOT Z0000454 NOT lrc NOT "Android\\android-studio\\sdk" NOT "PHP\\pear\\tests" NOT "nemesis_api.jar" NOT "Android\\android-sdk" NOT "incognito_mode_start_page" NOT "YahLover Worm" NOT "WinDirStat" NOT "resx" NOT "REASON_1: Alternate data stream (ADS)" NOT "saperion" NOT "\\Snare\\psexec.exe" NOT "location Value: ^(?!.*System32|.*winsxs|.*SysWOW64).*\\\\csrss\\.exe$" NOT "90307d4a224d8448e1341e1384def54b" NOT "CheckPoint\\SmartConsole" NOT "apps\\bin\\grep.exe" NOT "ACMS25" NOT "IrfanView" NOT "sysinternal" NOT "iview*" NOT "Enabled, accept hashed Passwords" NOT gen_anti_sandbox_hostnames_1 NOT jrat_remote_access_trojan NOT 4305f483da2421b20ee7e488c13d2084 NOT Psexec | eval length=len(file) | search length<40 | table score,mainreason,file, md5

[DNS Analysis]
dispatch.earliest_time = -30d@d
dispatch.latest_time = now
display.events.fields = ["hostname","affected","affect","score","sourcetype","source","file","host","module","message","level","PRIV"]
display.events.list.drilldown = none
display.events.raw.drilldown = none
display.general.type = statistics
display.statistics.drilldown = none
display.statistics.rowNumbers = 1
display.visualizations.charting.chart = bar
display.visualizations.show = 0
request.ui_dispatch_app = thor
search = eventtype=thor_events module=DNS* NOT tag=false_positive | rex field=_raw "Entry: (?<entry>.*)" | search entry="*.*" | stats count,values(source) by entry

[SHIMCache Analysis]
dispatch.earliest_time = -30d@d
dispatch.latest_time = now
display.events.fields = ["hostname","affected","affect","score","sourcetype","source","file","host","module","message","level","PRIV"]
display.events.list.drilldown = none
display.events.raw.drilldown = none
display.general.type = statistics
display.statistics.drilldown = none
display.statistics.rowNumbers = 1
display.visualizations.charting.chart = bar
display.visualizations.show = 0
request.ui_dispatch_app = thor
search = eventtype=thor_events ( level=Alarm OR level=Alert OR level=Warning ) module=SHIMCache NOT tag=false_positive NOT Winpcap NOT Wireshark NOT PSexec NOT PSEXESVC NOT sethc.exe NOT utilman.exe NOT ShellRunas.exe NOT SysInternals* NOT PSTools*  | eval ENTRY=if(FILE!="",FILE,ENTRY) | table system,ENTRY,DESC,DATE,PATTERN

[File Events with Short Name]
dispatch.earliest_time = -30d@d
dispatch.latest_time = now
display.general.type = statistics
display.statistics.drilldown = row
display.visualizations.show = 0
search = eventtype=thor_events ( level=Alarm OR level=Alert OR level=Warning ) NOT tag=false_positive module=Filescan | eval filelength=len(file)  | search filelength<30 | table system,file,md5,mainreason

[Eventlog Analysis]
dispatch.earliest_time = -30d@d
dispatch.latest_time = now
display.events.fields = ["hostname","affected","affect","score","sourcetype","source","file","host","module","message","level","PRIV"]
display.events.list.drilldown = none
display.events.raw.drilldown = none
display.general.type = statistics
display.statistics.drilldown = none
display.statistics.rowNumbers = 1
display.visualizations.charting.chart = bar
display.visualizations.show = 0
request.ui_dispatch_app = thor
search = eventtype=thor_events module=Eventlog NOT tag=false_positive Warning NOT "Specified user account" NOT "Possible source of evil user" NOT "Logon of evil user" NOT "New User-Account created" NOT "d\\.rar" NOT "can't be identified" NOT "Recovery Manager" NOT "RTYP_LOGFILE" NOT "BINARY_INTEGER" NOT "1\\.rar" NOT "is very low. Only" | table system,LOG,MESSAGE,MALWARE,KEYWORD,_raw

[Process Analysis]
dispatch.earliest_time = -30d@d
dispatch.latest_time = now
display.events.fields = ["hostname","affected","affect","score","sourcetype","source","file","host","module","message","level","PRIV"]
display.events.list.drilldown = none
display.events.raw.drilldown = none
display.statistics.drilldown = none
display.statistics.rowNumbers = 1
display.visualizations.charting.chart = bar
display.visualizations.show = 0
request.ui_dispatch_app = thor
search = eventtype=thor_events module=ProcessCheck NOT tag=false_positive ( level=Warning OR level=Alarm OR level=Alert ) NOT psexec NOT wireshark NOT Winpcap NOT C:\\IBM\\Rational NOT D:\\IBM\\HTTPServer NOT \\HP NOT java NOT Eventlog NOT APT_Thoper_sa | table system,PID,CMD,RULE,KEYWORD,_raw

[Service Analysis]
dispatch.earliest_time = -30d@d
dispatch.latest_time = now
display.events.fields = ["hostname","affected","affect","score","sourcetype","source","file","host","module","message","level","PRIV"]
display.events.list.drilldown = none
display.events.raw.drilldown = none
display.statistics.drilldown = none
display.statistics.rowNumbers = 1
display.visualizations.charting.chart = bar
display.visualizations.show = 0
request.ui_dispatch_app = thor
search = eventtype=thor_events ( level=Alarm OR level=Alert OR level=Warning ) NOT tag=false_positive module=ServiceCheck NOT WInpcap NOT Wireshark NOT PSEXEC NOT PSEXESVC NOT "Error Control for Service has an invalid value" NOT Combination NOT IBM NOT Cpuz NOT SiwIo.sys NOT HP NOT cdfdrvin NOT ad_driver.sys NOT hpsum_service_x64.exe NOT "sendmail" | table MESSAGE,NAME,KEYWORD,_raw

[Command String Analysis]
dispatch.earliest_time = -30d@d
display.events.fields = ["hostname","affected","affect","score","sourcetype","source","file","host","module","message","level","PRIV"]
display.events.list.drilldown = outer
display.events.raw.drilldown = outer
display.general.type = statistics
display.statistics.drilldown = none
display.statistics.rowNumbers = 1
display.visualizations.charting.chart = bar
display.visualizations.show = 0
request.ui_dispatch_app = thor
search = eventtype=thor_events NOT tag=false_positive "Command String" | table CMD, STRING, system

[Malicious Mutex Report]
dispatch.earliest_time = -30d@d
dispatch.latest_time = now
display.events.fields = ["hostname","affected","affect","score","sourcetype","source","file","host","module","message","level","PRIV"]
display.events.list.drilldown = outer
display.events.raw.drilldown = outer
display.statistics.drilldown = none
display.statistics.rowNumbers = 1
display.visualizations.charting.chart = bar
display.visualizations.show = 0
request.ui_dispatch_app = thor
search = eventtype=thor_events ( level=Alarm OR level=Alert OR level=Warning ) NOT tag=false_positive module=Mutex NOT "_SHuassist.mtx"  NOT __DDrawExclMode__ NOT DDrawWindowListMutex NOT DDrawDriverObjectListMutex  NOT 746bbf3569adEncrypt

[Registry Analysis]
dispatch.earliest_time = -30d@d
dispatch.latest_time = now
display.events.fields = ["hostname","affected","affect","score","sourcetype","source","file","host","module","message","level","PRIV"]
display.events.list.drilldown = outer
display.events.raw.drilldown = outer
display.general.type = statistics
display.statistics.drilldown = none
display.statistics.rowNumbers = 1
display.visualizations.charting.chart = bar
display.visualizations.show = 0
request.ui_dispatch_app = thor
search = eventtype=thor_events ( level=Alarm OR level=Alert OR level=Warning ) NOT tag=false_positive module=Registry NOT "\\.pst"  NOT "Update\\\\\\\\GoogleUpdate.exe"  NOT "\\\\lc\\.exe" NOT Chinese_Keyboard_Layout_RDP_Preload NOT "Many Shellbag accesses" | table NAME, STRING, KEYWORD, DESCRIPTION, _raw

[Command Analysis]
dispatch.earliest_time = -30d@d
dispatch.latest_time = now
display.events.fields = ["hostname","affected","affect","score","sourcetype","source","file","host","module","message","level","PRIV"]
display.events.list.drilldown = outer
display.events.raw.drilldown = outer
display.general.type = statistics
display.statistics.drilldown = none
display.statistics.rowNumbers = 1
display.visualizations.charting.chart = bar
display.visualizations.show = 0
request.ui_dispatch_app = thor
search = eventtype=thor_events ( level=Alarm OR level=Alert OR level=Warning ) NOT tag=false_positive module=CommandCheck NOT Atiptaxx.exe NOT \\bin\\ NOT userin32.exe NOT vssadmin.exe | table system,MESSAGE,PATH,CMD,STRING,_raw

[WER Analysis]
dispatch.earliest_time = -30d@d
dispatch.latest_time = now
display.events.fields = ["hostname","affected","affect","score","sourcetype","source","file","host","module","message","level","PRIV"]
display.events.list.drilldown = outer
display.events.raw.drilldown = outer
display.statistics.drilldown = none
display.statistics.rowNumbers = 1
display.visualizations.charting.chart = bar
display.visualizations.show = 0
request.ui_dispatch_app = thor
search = eventtype=thor_events NOT tag=false_positive module=WER ( level=Warning OR level=Alarm OR level=Alert ) | table system,MESSAGE,STRING,EXE,DATE,APPPATH,_raw

[Miscellaneous Module Warnings and Alarms]
display.events.fields = ["hostname","affected","affect","score","sourcetype","source","file","host","module","message","level","PRIV"]
display.events.list.drilldown = outer
display.events.raw.drilldown = outer
display.statistics.drilldown = none
display.statistics.rowNumbers = 1
display.visualizations.charting.chart = bar
display.visualizations.show = 0
request.ui_dispatch_app = thor
search = eventtype=thor_events NOT tag=false_positive ( level=Warning OR level=Alarm OR level=Alert ) NOT module=Registry NOT module=Filescan NOT module=Eventlog NOT module=SHIMCache NOT module=ServiceCheck NOT module=ProcessCheck NOT module=CommandCheck NOT module=Mutex NOT module=ResourceCheck NOT "Recently logged in" NOT "No Hotfixes installed" NOT message="Suspicious user name" | table module,message,_raw

[MD5 List of Suspicious Files]
action.email.reportServerEnabled = 0
action.email.useNSSubject = 1
alert.track = 0
description = Basic search to build useful search statements upon
dispatch.earliest_time = -30d@d
dispatch.latest_time = now
display.events.fields = ["system","level","mainreason","duration","source","sourcetype","host","session_id","eventtype","score","module","matching_strings","message"]
display.general.type = statistics
display.visualizations.chartHeight = 233
display.visualizations.show = 0
request.ui_dispatch_app = thor
search = eventtype=thor_events NOT tag=false_positive ( level=Alarm OR level=Alert OR level=Warning OR level=Notice ) md5=* | stats values(file) by md5,score

[Hard Client APT Indicators]
action.email.reportServerEnabled = 0
action.email.useNSSubject = 1
alert.track = 0
description = Report that lists all hard indicator matches from Client APT Cases
dispatch.earliest_time = -30d@d
dispatch.latest_time = now
display.events.fields = ["system","level","mainreason","duration","source","sourcetype","host","session_id","level","score","module","matching_strings","message"]
display.general.type = statistics
display.visualizations.chartHeight = 233
display.visualizations.show = 0
request.ui_dispatch_app = thor
search = eventtype=thor_events NOT tag=false_positive ( level=Alarm OR level=Alert OR level=Warning OR level=Notice ) | regex _raw=" Client[A-Z]?[0-9]+" | table system,module,file,event

[Rare Warnings and Alarms]
action.email.reportServerEnabled = 0
action.email.useNSSubject = 1
alert.track = 0
description = Shows rare Warnings and Alarms and doesn't show findings that appear more than 10 times
display.events.fields = ["system","level","mainreason","duration","source","sourcetype","host","session_id","score","module","matching_strings","message"]
display.general.type = statistics
display.page.search.mode = fast
display.statistics.drilldown = row
display.visualizations.chartHeight = 233
display.visualizations.charting.chart = pie
display.visualizations.show = 0
request.ui_dispatch_app = thor
search = eventtype=thor_events NOT tag=false_positive ( level=Alarm OR level=Alert OR level=Warning ) | stats count(_raw) AS count,values(file),values(system) by mainreason | search count < 10 | sort +count

[System Inventory]
action.email.reportServerEnabled = 0
action.email.useNSSubject = 1
alert.track = 0
description = Basic search to build useful search statements upon
dispatch.earliest_time = -30d@d
dispatch.latest_time = now
display.events.fields = ["system","level","mainreason","duration","source","sourcetype","host","session_id","eventtype","score","module","matching_strings","message"]
display.general.type = statistics
display.page.search.tab = statistics
display.visualizations.chartHeight = 233
display.visualizations.show = 0
request.ui_dispatch_app = thor
request.ui_dispatch_view = search
search = eventtype=thor_events module=Startup NOT "finished" | transaction system maxspan=10 maxpause=10 | search eventcount > 1 | dedup system | rex field=_raw "Platform: (?<Platform>.*?) PROC:" | rex field=_raw "System Uptime: (?<Uptime>[0-9\.]+)" | rex field=_raw "Memory in Megabyte: (?<RAM>[0-9]+)" | rex field=_raw "CPU Count: (?<CPU_Count>[0-9]+)" | rex field=_raw "System Type: (?<Type>[^\s]+)" | rex field=_raw "Start Time: (?<Scan_Start>[^\s]+)" | rex field=_raw "Signature Database: (?<Signature_Date>[^\s]+)" | table system,system_ip,Scan_Start,Type,ARCH,Signature_Date,Platform,CPU_Count,RAM,Uptime | rename system as System,system_ip as IP,ARCH as Architecture,Scan_Start as Last_Scan_Date
