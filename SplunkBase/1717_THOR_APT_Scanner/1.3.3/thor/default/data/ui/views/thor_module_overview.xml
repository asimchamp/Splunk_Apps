<form>
  <label>THOR Module Specific Events</label>
  <description/>
  <fieldset autoRun="true" submitButton="false">
    <input type="time" searchWhenChanged="true">
      <default>Last 30 days</default>
    </input>
  </fieldset>
  <row>
    <table>
      <title>FileScan: Top Scoring</title>
      <searchString>eventtype=thor_events NOT tag=false_positive ( level=Alert OR level=Alarm OR level=Warning ) module=FileScan | dedup system,file | table system,file,score,mainreason | sort -score</searchString>
      <earliestTime>$earliest$</earliestTime>
      <latestTime>$latest$</latestTime>
      <option name="wrap">true</option>
      <option name="rowNumbers">false</option>
      <option name="dataOverlayMode">none</option>
      <option name="drilldown">cell</option>
      <option name="count">10</option>
    </table>
  </row>
  <row>
    <table>
      <title>SHIMCache: All Findings</title>
      <searchString>eventtype=thor_events NOT tag=false_positive ( level=Alert OR level=Alarm OR level=Warning ) module=SHIMCache | dedup system,file | table _time,system,type,file,pattern,_raw</searchString>
      <earliestTime>$earliest$</earliestTime>
      <latestTime>$latest$</latestTime>
      <option name="wrap">true</option>
      <option name="rowNumbers">false</option>
      <option name="dataOverlayMode">none</option>
      <option name="drilldown">row</option>
      <option name="count">10</option>
    </table>
  </row>
  <row>
    <table>
      <title>Eventlog: All Findings</title>
      <searchString>eventtype=thor_events NOT tag=false_positive ( level=Alert OR level=Alarm OR level=Warning ) module=Eventlog | dedup system,entry |  table _time,type,date,system,user,malware,message,entry | rename date as event_date</searchString>
      <earliestTime>$earliest$</earliestTime>
      <latestTime>$latest$</latestTime>
      <option name="wrap">true</option>
      <option name="rowNumbers">false</option>
      <option name="dataOverlayMode">none</option>
      <option name="drilldown">row</option>
      <option name="count">10</option>
    </table>
  </row>
  <row>
    <table>
      <title>ShellBags: All Findings</title>
      <searchString>eventtype=thor_events NOT tag=false_positive ( level=Alert OR level=Alarm OR level=Warning ) "Shellbag Entry" NOT "Microsoft.NET" NOT "Fonts" NOT "msohtmlclip" NOT "CCM" NOT "Insight" NOT "ccmsetup" NOT "SysWOW64" NOT "Snare" NOT "TAPI" NOT "Migration" NOT "VMware" NOT "dataflowprobe" NOT "sapcluster" NOT "msicache" | dedup system,ENTRY | table system,ENTRY,DATE_ACCESS</searchString>
      <earliestTime>$earliest$</earliestTime>
      <latestTime>$latest$</latestTime>
      <option name="wrap">true</option>
      <option name="rowNumbers">false</option>
      <option name="dataOverlayMode">none</option>
      <option name="drilldown">row</option>
      <option name="count">10</option>
    </table>
  </row>
  <row>
    <table>
      <title>DeepDive: All Findings</title>
      <searchString>eventtype=thor_events NOT tag=false_positive module=DeepDive ( level=Alert OR level=Alarm OR level=Warning ) | dedup system,matching_strings | table _time,system,name,description,score,matching_strings</searchString>
      <earliestTime>$earliest$</earliestTime>
      <latestTime>$latest$</latestTime>
      <option name="wrap">true</option>
      <option name="rowNumbers">false</option>
      <option name="dataOverlayMode">none</option>
      <option name="drilldown">row</option>
      <option name="count">10</option>
    </table>
  </row>
  <row>
    <table>
      <title>Registry: All Findings</title>
      <searchString>eventtype=thor_events NOT tag=false_positive module=Registry ( level=Alert OR level=Alarm OR level=Warning ) | table system,message,key,description,_raw</searchString>
      <earliestTime>$earliest$</earliestTime>
      <latestTime>$latest$</latestTime>
      <option name="wrap">true</option>
      <option name="rowNumbers">false</option>
      <option name="dataOverlayMode">none</option>
      <option name="drilldown">row</option>
      <option name="count">10</option>
    </table>
  </row>
  <row>
    <table>
      <title>Other Modules: All Findings</title>
      <searchString>eventtype=thor_events NOT tag=false_positive NOT module=DeepDive NOT module=FileScan NOT module=Eventlog NOT module=Registry NOT module=SHIMCache NOT module=HotfixCheck NOT module=ShellBags ( level=Alert OR level=Alarm OR level=Warning ) | table system,module,message,_raw</searchString>
      <earliestTime>$earliest$</earliestTime>
      <latestTime>$latest$</latestTime>
      <option name="wrap">true</option>
      <option name="rowNumbers">false</option>
      <option name="dataOverlayMode">none</option>
      <option name="drilldown">row</option>
      <option name="count">10</option>
    </table>
  </row>
  <row>
    <table>
      <title>FileScan Addon (Testing): Rare Alarms and Warnings</title>
      <searchString>eventtype=thor_events NOT tag=false_positive ( level=Alert OR level=Alarm OR level=Warning ) | dedup system,file | table system,file,score | rare 20 file</searchString>
      <earliestTime>$earliest$</earliestTime>
      <latestTime>$latest$</latestTime>
      <option name="wrap">true</option>
      <option name="rowNumbers">false</option>
      <option name="dataOverlayMode">highlow</option>
      <option name="drilldown">row</option>
      <option name="count">10</option>
    </table>
  </row>
</form>