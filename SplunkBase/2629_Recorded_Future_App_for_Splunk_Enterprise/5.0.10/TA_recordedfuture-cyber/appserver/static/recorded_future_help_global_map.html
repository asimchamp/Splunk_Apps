<html><body><div><h1>Customizing the Global Map</h1>

<p>The Global Map shows the geolocation of all matching IP Addresses when 
correlating firewall logs with a Recorded Future Risk List.</p>

<h2>Adapting to Local Source Types</h2>

<p>It is possible to change the source type as long as the field name in the 
search statement is modified at the same time. </p>

<pre>
    sourcetype=netscreen:firewall earliest=-24h
    | eval Name=dst
    | eval Time=start_time
    | lookup default_ip_risklist.csv Name OUTPUT Risk, RiskString, EvidenceDetails
    | search Risk != ""
    | eval RiskScore = Risk
    | eval Rule = spath(EvidenceDetails,"EvidenceDetails{}.Rule")
    | eval EvidenceString = spath(EvidenceDetails,"EvidenceDetails{}.EvidenceString")
    | search Risk != ""
    | iplocation Name
    | fields + Name, Risk, lat, lon, City, Country
    | geostats count latfield=lat longfield=lon
</pre>

<p>The search can be adapted to suit the local setup. The most typical changes 
are involve the first 4 rows of the search: </p>

<ul>
<li>The value <span class="rf-field">netscreen:firewall</span> should match the 
source type of your firewall logs.</li>
<li>The <span class="rf-field"><a href="https://docs.splunk.com/Documentation/Splunk/latest/SearchReference/Eval">eval</a> 
Name=dst</span> statement should match the field name of the destination IP 
Address in your firewall logs</li>
<li>The <a href="https://docs.splunk.com/Documentation/Splunk/latest/SearchReference/Lookup">lookup</a> 
<span class="rf-field">default_ip_risklist.csv</span> should match the name of the
risk list you want to correlate the firewall logs with</li>
</ul>

<h2>Customize with a Different Map Widget</h2>

<p>The style of the map can be changed by installing additional Splunk Apps 
containing visualisations, such as leaflet_maps_app. Click 
<span class="rf-field">Edit</span> on the dashboard:</p>

<p><img src="/static/app/TA_recordedfuture-cyber/img/recorded_future_edit_button.png" alt="Edit button"></p>

<p>Choose the new theme of the map by clicking on the <span class="rf-field">
Select visualization</span>:</p>

<p><img src="/static/app/TA_recordedfuture-cyber/img/recorded_future_map_vis.png" alt="Select visualization"></p>

<p>This is what the map looks like within the leaflet theme:</p>

<p><img src="/static/app/TA_recordedfuture-cyber/img/recorded_future_map_vis_2.png" alt="Global Map with Leaflet theme applied"></p>

<p>This is the standard Splunk map:</p>

<p><img src="/static/app/TA_recordedfuture-cyber/img/recorded_future_map_vis_3.png" alt="Global Map with the default Splunk theme"></p>

<h2>Active Threats</h2>

<p>The first row shows the current size of each of category of the default Risk 
Lists which are the following:</p>

<ul>
<li>IP</li>
<li>Domain</li>
<li>Hash</li>
<li>Vulnerability</li>
<li>URL</li>
</ul>

<p>The map collates the IP addresses in the Risk List based on location and 
displays top ten countries in a pie chart as well as the top ten risk rules per
entity that have been triggered the most by the correlated events.</p>

<h1>Further Help</h1>

<p>"Recorded Future App for Splunk" has been developed by Recorded Future.  </p>

<p>Further information and support can be found on our Support web site:
<a href="https://support.recordedfuture.com/hc/en-us/articles/360003588753">support.recordedfuture.com</a> </p>
</div></body></html>
