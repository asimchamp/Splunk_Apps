[Latest Updates of All Risk Lists]
action.email.useNSSubject = 1
alert.track = 0
description = List all Risk Lists configured in the app and when they were last updated.
dispatch.earliest_time = -24h
dispatch.latest_time = now
display.general.enablePreview = 0
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.tab = statistics
display.visualizations.show = 0
request.ui_dispatch_app = TA_recordedfuture-cyber
request.ui_dispatch_view = search
search = | inputlookup checkpoints | eval Time=strftime(updated,"%a %b %d, %Y at %I:%M:%S:%p") | eval split_history=split(history,",") | eval time_history=strftime(split_history,"%a %b %d, %Y at %I:%M:%S:%p") | rename name TO "Risk List Name" | rename Time TO "Last Updated" | rename time_history TO "Last 5 Updates" | search "Risk List Name" != "" | fields "Risk List Name", "Last Updated", "Last 5 Updates"

[All logs from the App]
action.email.useNSSubject = 1
alert.track = 0
description = Displays all the logs produced by the app.
dispatch.earliest_time = -24h@h
dispatch.latest_time = now
display.general.enablePreview = 0
display.visualizations.show = 0
request.ui_dispatch_app = TA_recordedfuture-cyber
request.ui_dispatch_view = search
search = index=_* sourcetype="tarecordedfuture:cyber:log"

[Validate App Deployment]
action.email.useNSSubject = 1
alert.track = 0
description = Perform a number of tests on the app environment and configuration.
dispatch.earliest_time = -24h@h
dispatch.latest_time = now
dispatchAs = user
display.general.enablePreview = 0
display.general.type = statistics
display.page.search.tab = statistics
display.visualizations.show = 0
request.ui_dispatch_app = TA_recordedfuture-cyber
request.ui_dispatch_view = search
search = | rest splunk_server=local /services/TA_recordedfuture-cyber/validate | eval Step=substr(step, 6) | sort Step | rename result.Status TO Status | rename result.information TO Information | eval Name='result.Verification step' | eval Suggestion='result.Suggested action' | eval Information='result.Information'  | table Step, Name, Status, Information, Suggestion

[Recorded Future - Download Risk Lists]
description = Check if any configured Risk Lists should be downloaded and download them.
cron_schedule = */5 * * * *
enableSched = 1
search = | rest splunk_server=local /services/TA_recordedfuture-cyber/scheduler
disabled = 0
max_concurrent = 1
dispatch.earliest_time = -24h@h
dispatch.latest_time = now
alert.track = false
alert.suppress = 0
alert.digest_mode = True
request.ui_dispatch_app = search
request.ui_dispatch_view = search
display.general.type = statistics
display.page.search.tab = statistics
display.visualizations.show = 0

[Latest Updates of All Risk Lists Server Side]
action.email.useNSSubject = 1
alert.track = 0
description = List the latest update time for all configured Risk Lists on the API server.
dispatch.earliest_time = -24h
dispatch.latest_time = now
display.general.enablePreview = 0
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.tab = statistics
display.visualizations.show = 0
request.ui_dispatch_app = TA_recordedfuture-cyber
request.ui_dispatch_view = search
search = | rest /services/TA_recordedfuture-cyber/head_risklists | eval "Last Updated" = strftime(strptime(updated,"%Y-%m-%dT%H:%M:%S.%6N"),"%Y-%m-%d %H:%M:%S") | rename risk_list AS "Risk List" | fields "Risk List", "Last Updated"
