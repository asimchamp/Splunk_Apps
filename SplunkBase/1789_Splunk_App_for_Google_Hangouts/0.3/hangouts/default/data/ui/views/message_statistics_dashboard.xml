<dashboard script="autodiscover.js">
  <label>Message Statistics Dashboard</label>
  <row>
    <panel>
      <chart>
        <title>Messages Sent vs. Received</title>
        <searchString>`googlehangouts` | search user_name_receiver=* | eval direction=case(user_name_sender=user_name_conversation,"Sent count",user_name_sender!=user_name_conversation,"Received count" ) |  table user_name_conversation direction user_name_sender user_name_receiver user_name_self text | chart count over user_name_conversation by direction | rename user_name_conversation AS User</searchString>
        <earliestTime/>
        <latestTime/>
        <option name="charting.axisLabelsX.majorLabelStyle.overflowMode">ellipsisNone</option>
        <option name="charting.axisLabelsX.majorLabelStyle.rotation">-45</option>
        <option name="charting.axisTitleX.visibility">visible</option>
        <option name="charting.axisTitleY.visibility">visible</option>
        <option name="charting.axisTitleY2.visibility">visible</option>
        <option name="charting.axisX.scale">linear</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.axisY2.enabled">false</option>
        <option name="charting.axisY2.scale">inherit</option>
        <option name="charting.chart">column</option>
        <option name="charting.chart.nullValueMode">gaps</option>
        <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
        <option name="charting.chart.stackMode">stacked100</option>
        <option name="charting.chart.style">shiny</option>
        <option name="charting.drilldown">all</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
        <option name="charting.legend.placement">bottom</option>
        <option name="height">400px</option>
      </chart>
    </panel>
    <panel>
      <chart>
        <title>Average Reply Time</title>
        <searchString>`googlehangouts` | search user_name_receiver=* | streamstats current=f window=1 global=f first(user_name_sender) AS last_sender| eval lastmessage=case(last_sender=user_name_sender,0,last_sender!=user_name_sender,1) |  transaction user_name_sender endswith="lastmessage=1" maxspan=1h | delta _time AS replytime | eval replytime=(replytime*-1) | eval direction=case(user_name_sender=user_name_conversation,"Received reply - avg(s)",user_name_sender!=user_name_conversation,"Gave reply - avg(s)" ) |  table _time replytime user_name_conversation direction user_name_sender user_name_receiver user_name_self text | sort user_name_conversation _time timestamp | where replytime&lt;1200 | chart avg(replytime) over user_name_conversation by direction | rename user_name_conversation AS Conversation</searchString>
        <earliestTime/>
        <latestTime/>
        <option name="charting.axisLabelsX.majorLabelStyle.overflowMode">ellipsisNone</option>
        <option name="charting.axisLabelsX.majorLabelStyle.rotation">-45</option>
        <option name="charting.axisTitleX.visibility">visible</option>
        <option name="charting.axisTitleY.visibility">visible</option>
        <option name="charting.axisTitleY2.visibility">visible</option>
        <option name="charting.axisX.scale">linear</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.axisY2.enabled">false</option>
        <option name="charting.axisY2.scale">inherit</option>
        <option name="charting.chart">column</option>
        <option name="charting.chart.nullValueMode">gaps</option>
        <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
        <option name="charting.chart.stackMode">stacked100</option>
        <option name="charting.chart.style">shiny</option>
        <option name="charting.drilldown">all</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
        <option name="charting.legend.placement">bottom</option>
        <option name="height">400px</option>
      </chart>
    </panel>
  </row>
  <row>
    <panel>
      <html>
      <h2>Message distribution flow</h2>
      <hr/>
      <div id="3nodesankey-search" class="splunk-manager splunk-searchmanager" data-require="splunkjs/mvc/searchmanager" data-options="{                              &quot;app&quot;: &quot;hangouts&quot;,                           &quot;search&quot;:  {&quot;type&quot;: &quot;token_safe&quot;, &quot;value&quot;: &quot;`googlehangouts` | search user_name_receiver=* | eval direction=case(user_name_sender=user_name_conversation,\&quot;Sent\&quot;,user_name_sender!=user_name_conversation,\&quot;Received\&quot; ) |  table user_name_conversation direction user_name_sender user_name_receiver user_name_self text | chart count over user_name_conversation by direction | rename user_name_conversation AS User | eval User2=User | join [search `googlehangouts` | fields user_name_self | dedup user_name_self | rename user_name_self AS You] | table User You User2 Received Sent&quot; }   }"/>
      <div id="3nodesankey" class="splunk-view" data-require="app/hangouts/components/sankeychart/3nodesankey" data-options="{        &quot;managerid&quot;: &quot;3nodesankey-search&quot;,     &quot;pageField&quot;: &quot;You&quot;,           &quot;prev_pageField&quot;: &quot;User&quot;,           &quot;next_pageField&quot;: &quot;User2&quot;,     &quot;count1Field&quot;: &quot;Sent&quot;,           &quot;count2Field&quot;: &quot;Received&quot;,     &quot;height&quot;: 400   }"/>
	<hr/>
    </html>
    </panel>
    <panel>
      <html>
      <h2>Message distribution</h2>
        <div id="bubbleSearch" class="splunk-manager" data-require="splunkjs/mvc/searchmanager" data-options="{               &quot;search&quot;: &quot;`googlehangouts`  | stats count by user_name_conversation&quot;,               &quot;earliest_time&quot;: &quot;&quot;,               &quot;status_buckets&quot;: 0,               &quot;cancelOnUnload&quot;: true,               &quot;auto_cancel&quot;: 90,               &quot;preview&quot;: true               }">
        </div>
        <div id="bubbleChart" class="splunk-view" data-require="app/hangouts/components/bubblechart/bubblechart" data-options="{               &quot;managerid&quot;: &quot;bubbleSearch&quot;,               &quot;nameField&quot;: &quot;user_name_conversation&quot;,               &quot;categoryField&quot;: &quot;user_name_conversation&quot;,               &quot;valueField&quot;: &quot;count&quot;,               &quot;height&quot;: 450               }">
        </div>
    </html>
    </panel>
  </row>
  <row>
    <panel>
      <chart>
        <title>Messages per user over time</title>
        <searchString>`googlehangouts`  | timechart count by user_name_conversation usenull=f useother=f</searchString>
        <earliestTime>0</earliestTime>
        <latestTime/>
        <option name="charting.axisLabelsX.majorLabelStyle.overflowMode">ellipsisNone</option>
        <option name="charting.axisLabelsX.majorLabelStyle.rotation">0</option>
        <option name="charting.axisTitleX.visibility">visible</option>
        <option name="charting.axisTitleY.visibility">visible</option>
        <option name="charting.axisTitleY2.visibility">visible</option>
        <option name="charting.axisX.scale">linear</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.axisY2.enabled">false</option>
        <option name="charting.axisY2.scale">inherit</option>
        <option name="charting.chart">area</option>
        <option name="charting.chart.nullValueMode">gaps</option>
        <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
        <option name="charting.chart.stackMode">stacked</option>
        <option name="charting.chart.style">shiny</option>
        <option name="charting.drilldown">all</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
        <option name="charting.legend.placement">right</option>
      </chart>
    </panel>
    <panel>
      <chart>
        <title>Messages per user per hour</title>
        <searchString>`googlehangouts` | eval _time=date_hour  | timechart count by user_name_conversation | convert ctime(_time) as hour timeformat="%S" | fields - _time | table hour *</searchString>
        <earliestTime>0</earliestTime>
        <latestTime/>
        <option name="charting.axisLabelsX.majorLabelStyle.overflowMode">ellipsisNone</option>
        <option name="charting.axisLabelsX.majorLabelStyle.rotation">0</option>
        <option name="charting.axisTitleX.visibility">visible</option>
        <option name="charting.axisTitleY.visibility">visible</option>
        <option name="charting.axisTitleY2.visibility">visible</option>
        <option name="charting.axisX.scale">linear</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.axisY2.enabled">false</option>
        <option name="charting.axisY2.scale">inherit</option>
        <option name="charting.chart">area</option>
        <option name="charting.chart.nullValueMode">gaps</option>
        <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
        <option name="charting.chart.stackMode">stacked</option>
        <option name="charting.chart.style">shiny</option>
        <option name="charting.drilldown">all</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
        <option name="charting.legend.placement">right</option>
      </chart>
    </panel>
  </row>
</dashboard>