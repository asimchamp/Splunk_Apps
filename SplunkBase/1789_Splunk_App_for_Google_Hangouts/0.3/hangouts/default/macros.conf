[getconversations]
definition = `googlehangouts` | rename conversation.participant_data{}.fallback_name AS fallback_name, conversation.participant_data{}.id.gaia_id AS gaia_id, conversation_id.id AS conversation_id | eval mvfield=mvzip(fallback_name,mvzip(gaia_id,conversation_id))| search mvfield=* | mvexpand mvfield | makemv mvfield delim="," | eval fallback_name=mvindex(mvfield,0) | eval gaia_id=mvindex(mvfield,1) | eval conversation_id=mvindex(mvfield,2) | dedup gaia_id | table conversation_id, gaia_id, fallback_name \

iseval = 0

[getparticipants]
definition = `googlehangouts` | rename conversation.participant_data{}.fallback_name AS fallback_name, conversation.participant_data{}.id.gaia_id AS gaia_id, conversation_id.id AS conversation_id | eval mvfield=mvzip(fallback_name,gaia_id) | search mvfield=* | mvexpand mvfield | makemv mvfield delim="," | eval fallback_name=mvindex(mvfield,0) | eval gaia_id=mvindex(mvfield,1) | dedup gaia_id | table gaia_id, fallback_name \

iseval = 0

[googlehangouts]
definition = index="googlehangouts" | strcat "{" _raw _raw | spath | rename chat_message.message_content.segment{}.text AS text, conversation.participant_data{}.fallback_name AS fallback_name,sender_id.gaia_id AS sender_gaia_id, conversation_id.id AS conversation_id | rename chat_message.message_content.segment{}.link_data.display_url as hyperlink | lookup participants conversation_id AS conversation_id OUTPUTNEW user_name AS user_name_conversation | lookup participants user_id AS sender_gaia_id OUTPUTNEW user_name AS user_name_sender | lookup participants user_id AS self_event_state.user_id.gaia_id OUTPUTNEW user_name AS user_name_self | eval user_name_receiver=case(user_name_sender=user_name_conversation, user_name_self, user_name_sender=user_name_self, user_name_conversation)
iseval = 0

[getuserlist]
definition = index="googlehangouts" | strcat "{" _raw _raw | spath | rename chat_message.message_content.segment{}.text AS text, conversation.participant_data{}.fallback_name AS fallback_name,sender_id.gaia_id AS sender_gaia_id, conversation_id.id AS conversation_id | rename chat_message.message_content.segment{}.link_data.display_url as hyperlink| rename conversation.participant_data{}.fallback_name AS fallback_name, conversation.participant_data{}.id.gaia_id AS gaia_id, conversation_id.id AS conversation_id | eval mvfield=mvzip(fallback_name,gaia_id) | search mvfield=* | mvexpand mvfield | makemv mvfield delim="," | eval fallback_name=mvindex(mvfield,0) | eval gaia_id=mvindex(mvfield,1) | dedup gaia_id | table gaia_id, fallback_name  | join gaia_id type=left [search index="googlehangouts" | strcat "{" _raw _raw | spath | rename chat_message.message_content.segment{}.text AS text, conversation.participant_data{}.fallback_name AS fallback_name,sender_id.gaia_id AS sender_gaia_id, conversation_id.id AS conversation_id | rename chat_message.message_content.segment{}.link_data.display_url as hyperlink | rename conversation.participant_data{}.fallback_name AS fallback_name, conversation.participant_data{}.id.gaia_id AS gaia_id, conversation_id.id AS conversation_id | eval mvfield=mvzip(fallback_name,mvzip(gaia_id,conversation_id))| search mvfield=* | mvexpand mvfield | makemv mvfield delim="," | eval fallback_name=mvindex(mvfield,0) | eval gaia_id=mvindex(mvfield,1) | eval conversation_id=mvindex(mvfield,2) | dedup gaia_id | table conversation_id, gaia_id, fallback_name]
iseval = 0
