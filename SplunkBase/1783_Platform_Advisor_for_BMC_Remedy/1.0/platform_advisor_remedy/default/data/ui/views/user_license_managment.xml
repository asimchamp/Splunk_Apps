<form>
  <label>User License Managment</label>
  <description/>
  <fieldset autoRun="true" submitButton="false">
     <input type="dropdown" token="host" searchWhenChanged="true">
      <label>Select a Host:</label>
      <default>*</default>
      <choice value="*">all hosts</choice>
      <populatingSearch earliest="$earliest$" latest="$latest$" fieldForLabel="host" fieldForValue="host">index=main | stats count by host</populatingSearch>
    </input>
    <input type="time" searchWhenChanged="true">
      <default/>
    </input>
  </fieldset>
  <row>
    <single>
      <title>Total Logins</title>
      <searchString>sourcetype=remedy_user "FIXED  GRANT WRITE" OR "FLOAT  GRANT WRITE" OR "GRANT READ" | dedup user | chart sum(linecount) AS lcount | rangemap field=lcount low=0-50 elevated=51-100 default=severe</searchString>
      <earliestTime>$earliest$</earliestTime>
      <latestTime>$latest$</latestTime>
      <option name="linkView">search</option>
    </single>
    <single>
      <title>Fixed Licenses</title>
      <searchString>sourcetype=remedy_user "FIXED  GRANT WRITE" | dedup user | chart sum(linecount) as lcount | rangemap field=lcount low=0-50 elevated=51-100 default=severe</searchString>
      <earliestTime>$earliest$</earliestTime>
      <latestTime>$latest$</latestTime>
      <option name="linkView">search</option>
    </single>
    <single>
      <title>Floating Licenses</title>
      <searchString>sourcetype=remedy_user "FLOAT  GRANT WRITE" | dedup user | chart sum(linecount) as lcount | rangemap field=lcount low=0-50 elevated=51-100 default=severe</searchString>
      <earliestTime>$earliest$</earliestTime>
      <latestTime>$latest$</latestTime>
      <option name="linkView">search</option>
    </single>
    <single>
      <title>Read Licenses</title>
      <searchString>sourcetype=remedy_user "GRANT READ " | dedup user | chart sum(linecount) as lcount | rangemap field=lcount low=0-50 elevated=51-100 default=severe</searchString>
      <earliestTime>$earliest$</earliestTime>
      <latestTime>$latest$</latestTime>
      <option name="linkView">search</option>
    </single>
  </row>
  <row>
    <table>
      <title>No Floating License Available</title>
      <searchString>sourcetype=remedy_user "FLOAT  NO WRITE FREE" | dedup user | stats count AS Count by user | rename user AS User</searchString>
      <earliestTime>$earliest$</earliestTime>
      <latestTime>$latest$</latestTime>
    </table>
  </row>
</form>