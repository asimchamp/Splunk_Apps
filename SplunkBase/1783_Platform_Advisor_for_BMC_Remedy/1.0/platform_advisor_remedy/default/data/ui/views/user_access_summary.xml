<form>
  <label>User Access Summary</label>
  <description/>
  <fieldset autoRun="true" submitButton="false">
    <input type="dropdown" token="host" searchWhenChanged="true">
      <label>Select a Host:</label>
      <default>*</default>
      <choice value="*">all hosts</choice>
      <populatingSearch earliest="$earliest$" latest="$latest$" fieldForLabel="host" fieldForValue="host">index=main | stats count BY host</populatingSearch>
    </input>
    <input type="time" searchWhenChanged="true">
      <label/>
      <default>
        <earliestTime>0</earliestTime>
        <latestTime/>
      </default>
    </input>
  </fieldset>
  <row>
    <panel>
      <single>
        <title>Total Users Logins</title>
        <searchString>sourcetype=remedy_user "FIXED  GRANT WRITE" OR "FLOAT  GRANT WRITE" OR "GRANT READ" host=$host$  | dedup user | chart sum(linecount) AS lcount | rangemap field=lcount low=0-50 elevated=51-100 default=severe</searchString>
        <earliestTime>$earliest$</earliestTime>
        <latestTime>$latest$</latestTime>
        <option name="linkView">search</option>
        <option name="drilldown">none</option>
      </single>
    </panel>
    <panel>
      <single>
        <title>Fixed Licenses</title>
        <searchString>sourcetype=remedy_user "FIXED  GRANT WRITE"  host=$host$ | dedup user | chart sum(linecount) as lcount | rangemap field=lcount low=0-50 elevated=51-100 default=severe</searchString>
        <earliestTime>$earliest$</earliestTime>
        <latestTime>$latest$</latestTime>
        <option name="linkView">search</option>
        <option name="drilldown">none</option>
      </single>
    </panel>
    <panel>
      <single>
        <title>Floating Licenses</title>
        <searchString>sourcetype=remedy_user "FLOAT  GRANT WRITE" | dedup user | chart sum(linecount) as lcount | rangemap field=lcount low=0-50 elevated=51-100 default=severe</searchString>
        <earliestTime>$earliest$</earliestTime>
        <latestTime>$latest$</latestTime>
        <option name="linkView">search</option>
      </single>
    </panel>
    <panel>
      <single>
        <title>Read Licenses</title>
        <searchString>sourcetype=remedy_user "GRANT READ " | dedup user | chart sum(linecount) as lcount | rangemap field=lcount low=0-50 elevated=51-100 default=severe</searchString>
        <earliestTime>$earliest$</earliestTime>
        <latestTime>$latest$</latestTime>
        <option name="linkView">search</option>
      </single>
    </panel>
  </row>
  <row>
    <panel>
      <chart>
        <title>Failed Logins</title>
        <searchString>sourcetype="remedy_user" "LOGIN FAILED" host=$host$ | dedup _time | stats count AS Count BY user | rename user AS User</searchString>
        <earliestTime>$earliest$</earliestTime>
        <latestTime>$latest$</latestTime>
        <option name="charting.axisTitleX.visibility">visible</option>
        <option name="charting.axisTitleY.visibility">visible</option>
        <option name="charting.axisX.scale">linear</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.chart">pie</option>
        <option name="charting.chart.nullValueMode">gaps</option>
        <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
        <option name="charting.chart.stackMode">default</option>
        <option name="charting.chart.style">shiny</option>
        <option name="charting.drilldown">all</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
        <option name="charting.legend.placement">right</option>
      </chart>
    </panel>
    <panel>
      <chart>
        <title>Login Failed (Invalid Password)</title>
        <searchString>sourcetype="remedy_user" host=$host$ "LOGIN FAILED" password | dedup _time | stats count AS Count BY user | sort -Count | rename user AS User</searchString>
        <earliestTime>$earliest$</earliestTime>
        <latestTime>$latest$</latestTime>
        <option name="charting.axisTitleX.visibility">visible</option>
        <option name="charting.axisTitleY.visibility">visible</option>
        <option name="charting.axisX.scale">linear</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.chart">pie</option>
        <option name="charting.chart.nullValueMode">gaps</option>
        <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
        <option name="charting.chart.stackMode">default</option>
        <option name="charting.chart.style">shiny</option>
        <option name="charting.drilldown">all</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
        <option name="charting.legend.placement">right</option>
        <option name="charting.axisLabelsX.majorLabelStyle.overflowMode">ellipsisNone</option>
        <option name="charting.axisLabelsX.majorLabelStyle.rotation">0</option>
        <option name="charting.axisTitleY2.visibility">visible</option>
        <option name="charting.axisY2.enabled">false</option>
        <option name="charting.axisY2.scale">inherit</option>
      </chart>
    </panel>
    <panel>
      <chart>
        <title>Login Failed (Invalid User)</title>
        <searchString>sourcetype="remedy_user" host=$host$ "LOGIN FAILED" "(user)" | dedup _time | stats count AS Count BY user | sort -Count | rename user AS User</searchString>
        <earliestTime>$earliest$</earliestTime>
        <latestTime>$latest$</latestTime>
        <option name="charting.axisTitleX.visibility">visible</option>
        <option name="charting.axisTitleY.visibility">visible</option>
        <option name="charting.axisX.scale">linear</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.chart">pie</option>
        <option name="charting.chart.nullValueMode">gaps</option>
        <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
        <option name="charting.chart.stackMode">default</option>
        <option name="charting.chart.style">shiny</option>
        <option name="charting.drilldown">all</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
        <option name="charting.legend.placement">right</option>
      </chart>
    </panel>
  </row>
  <row>
    <panel>
      <chart>
        <title>User Login Activity</title>
        <searchString>sourcetype="remedy_user" host=* LOGIN  | dedup _time | timechart count BY user limit=25 | rename count AS Count user AS User percent AS Percent</searchString>
        <earliestTime>$earliest$</earliestTime>
        <latestTime>$latest$</latestTime>
        <option name="wrap">true</option>
        <option name="rowNumbers">false</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">cell</option>
        <option name="count">10</option>
        <option name="charting.axisTitleX.visibility">visible</option>
        <option name="charting.axisTitleY.visibility">visible</option>
        <option name="charting.axisX.scale">linear</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.chart">line</option>
        <option name="charting.chart.nullValueMode">gaps</option>
        <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
        <option name="charting.chart.stackMode">default</option>
        <option name="charting.chart.style">shiny</option>
        <option name="charting.drilldown">all</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
        <option name="charting.legend.placement">right</option>
      </chart>
    </panel>
    <panel>
      <table>
        <title>Top User Search Activity</title>
        <searchString>sourcetype=remedy_api host=$host$ | transaction tid startswith="\*/+GLEWF" endswith="\*/\-GLEWF" unifyends=true | top limit=20 user | rename user AS User count AS Count percent AS Percent</searchString>
        <earliestTime>$earliest$</earliestTime>
        <latestTime>$latest$</latestTime>
        <option name="wrap">true</option>
        <option name="rowNumbers">false</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">cell</option>
      </table>
    </panel>
  </row>
</form>