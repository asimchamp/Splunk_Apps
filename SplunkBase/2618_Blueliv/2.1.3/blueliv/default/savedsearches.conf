#BOTIPS SEARCHES

[updatedbbotip]
max_concurrent = 1
enableSched = 1
cron_schedule = */10 * * * *
description = Download updates from Blueliv big data
search = | updatedbbotip | inputlookup append=t botips_lookup | dedup _key | outputlookup botips_lookup

[updatedbattackip]
max_concurrent = 1
enableSched = 1
cron_schedule = */30 * * * *
description = Download updates from Blueliv big data
search = | updatedbattackip | inputlookup append=t attackips_lookup | dedup _key | outputlookup attackips_lookup

[updatedbmalwares]
max_concurrent = 1
enableSched = 1
cron_schedule = */10 * * * *
description = Download updates from Blueliv big data
search = | updatedbmalware | inputlookup append=t malwares_lookup | dedup _key | outputlookup malwares_lookup

[cleanoldbotip]
max_concurrent = 1
enableSched = 1
cron_schedule = 3 6 * * *
description = Clean old botips data
search = | inputlookup botips_lookup | eval _time=strptime(createdAt,"%Y-%m-%dT%H:%M:%S+%z") | sort 0 _time desc | head 100000 | fields - _time | outputlookup botips_lookup


[cleanoldattackip]
max_concurrent = 1
enableSched = 1
cron_schedule = 3 6 * * *
description = Clean old botips data
search = | inputlookup attackips_lookup | eval _time=strptime(createdAt,"%Y-%m-%dT%H:%M:%S+%z") | sort 0 _time desc | head 100000 | fields - _time | outputlookup attackips_lookup


[updatebotsip]
max_concurrent = 1
enableSched = 1
cron_schedule = */15 * * * *
description = Updates botsips ip lookups
search = | inputlookup botips_lookup | eval _time=strptime(createdAt,"%Y-%m-%dT%H:%M:%S+%z") | sort 0 _time desc | stats count by botip | fields botip count | outputlookup bl_bot_ip_lookup

[updateattacksip]
max_concurrent = 1
enableSched = 1
cron_schedule = */15 * * * *
description = Updates attackips ip lookups
search = | inputlookup attackips_lookup | eval _time=strptime(createdAt,"%Y-%m-%dT%H:%M:%S+%z") | sort 0 _time desc | stats count by sourceip | fields sourceip count | outputlookup bl_attack_ip_lookup


[updatemalwaretypes]
max_concurrent = 1
enableSched = 1
cron_schedule = */15 * * * *
description = Updates malware types lookups
search = | inputlookup malwares_lookup | eval _time=strptime(analyzedAt,"%Y-%m-%dT%H:%M:%S+%z") | sort 0 _time desc | stats count by malwareType | fields malwareType count | outputlookup bl_malware_types_lookup


[updatemalwareconfidence]
max_concurrent = 1
enableSched = 1
cron_schedule = */15 * * * *
description = Updates malware confidence lookups
search = | inputlookup malwares_lookup | eval _time=strptime(analyzedAt,"%Y-%m-%dT%H:%M:%S+%z") | sort 0 _time desc | stats count by confidence | fields confidence count | outputlookup bl_malware_confidence_lookup


[updatemalwarecontenttype]
max_concurrent = 1
enableSched = 1
cron_schedule = */15 * * * *
description = Updates malware confidence lookups
search = | inputlookup malwares_lookup | eval _time=strptime(analyzedAt,"%Y-%m-%dT%H:%M:%S+%z") | sort 0 _time desc | stats count by contentType | fields contentType count | outputlookup bl_malware_contentType_lookup


[updateattackstypes]
max_concurrent = 1
enableSched = 1
cron_schedule = */15 * * * *
description = Updates attackips types lookups
search = | inputlookup attackips_lookup | eval _time=strptime(createdAt,"%Y-%m-%dT%H:%M:%S+%z") | sort 0 _time desc | stats count by attackType | fields attackType count | outputlookup bl_attack_ip_types_lookup


[updateattacksmap]
max_concurrent = 1
enableSched = 1
cron_schedule = */16 * * * *
description = Updates botsips map lookups
search = | inputlookup attackips_lookup | eval _time=strptime(createdAt,"%Y-%m-%dT%H:%M:%S+%z") | sort _time desc | fields - _time | fields sourcelatitude, sourcelongitude, attackType | outputlookup bl_attack_map_lookup


[updatebotsbotnetip]
max_concurrent = 1
enableSched = 1
cron_schedule = */15 * * * *
description = Updates botnetsip lookups
search = | inputlookup botips_lookup | stats count by botnetip | fields botnetip count | outputlookup bl_bot_botnetip_lookup

[updatebotsoperatingsystem]
max_concurrent = 1
enableSched = 1
cron_schedule = */15 * * * *
description = Updates botsips operatingsystem lookups
search = | inputlookup botips_lookup | stats count by operatingsystem | fields operatingsystem count | sort 0 count desc | outputlookup bl_bot_operatingsystem_lookup

[updatebotsportaldomain]
max_concurrent = 1
enableSched = 1
cron_schedule = */15 * * * *
description = Updates botsips portaldomain lookups
search = | inputlookup botips_lookup | stats count by portaldomain | fields portaldomain count | sort 0 count desc | outputlookup bl_bot_portaldomain_lookup

[updatebotsmap]
max_concurrent = 1
enableSched = 1
cron_schedule = */16 * * * *
description = Updates botsips map lookups
search = | inputlookup botips_lookup | eval _time=strptime(createdAt,"%Y-%m-%dT%H:%M:%S+%z") | sort _time desc | fields - _time | fields lat, lon, type | outputlookup bl_bot_map_lookup

[updatebotstype]
max_concurrent = 1
enableSched = 1
cron_schedule = */15 * * * *
description = Updates botsips type lookups
search = | inputlookup botips_lookup | stats count by type | fields type count | sort 0 count desc | outputlookup bl_bot_type_lookup

[updatebotscountry]
max_concurrent = 1
enableSched = 1
cron_schedule = */15 * * * *
description = Updates botsips type lookups
search = | inputlookup botips_lookup | stats count by country | fields country count | sort 0 count desc | outputlookup bl_bot_country_lookup

#CRIMESERVERS SEARCHES

[updatedbcs]
max_concurrent = 1
enableSched = 1
cron_schedule = */15 * * * *
description = Download updates from Blueliv big data
search = | updatedb | inputlookup append=t crimeservers_lookup | dedup _key |  outputlookup crimeservers_lookup

[cleandata]
max_concurrent = 1
enableSched = 1
cron_schedule = 3 5 * * *
description = Clean old crimeservers data
search = | inputlookup crimeservers_lookup | search status="ONLINE" | outputlookup crimeservers_lookup

[updatestatus]
max_concurrent = 1
enableSched = 1
cron_schedule = */15 * * * *
description = Updates status lookups
search = | inputlookup crimeservers_lookup | stats count by status | outputlookup bl_status_lookup

[updateip]
max_concurrent = 1
enableSched = 1
cron_schedule = */15 * * * *
description = Updates ip lookups
search = | inputlookup crimeservers_lookup | stats count by ip | fields ip count | outputlookup bl_ip_lookup

[updatedomain]
max_concurrent = 1
enableSched = 1
cron_schedule = */16 * * * *
description = Updates domain lookups
search = | inputlookup crimeservers_lookup | stats count by domain | fields domain count | outputlookup bl_domain_lookup

[updatehost]
max_concurrent = 1
enableSched = 1
cron_schedule = */17 * * * *
description = Updates host lookups
search = | inputlookup crimeservers_lookup | stats count by host | fields host count | outputlookup bl_host_lookup

[updateasn]
max_concurrent = 1
enableSched = 1
cron_schedule = */18 * * * *
description = Updates asn lookups
search = | inputlookup crimeservers_lookup | stats count by asn | fields asn count | outputlookup bl_asn_lookup

[updatecountry]
max_concurrent = 1
enableSched = 1
cron_schedule = */19 * * * *
description = Updates country lookups
search = | inputlookup crimeservers_lookup | stats count by country | fields country count | outputlookup bl_country_lookup

[updatetype]
max_concurrent = 1
enableSched = 1
cron_schedule = */20 * * * *
description = Updates type lookups
search = | inputlookup crimeservers_lookup | stats count by type | fields type count | outputlookup bl_type_lookup

[updatesubtype]
max_concurrent = 1
enableSched = 1
cron_schedule = */21 * * * *
description = Updates subtype lookups
search = | inputlookup crimeservers_lookup | stats count by subtype | fields subtype count | outputlookup bl_subtype_lookup

[updatemap]
max_concurrent = 1
enableSched = 1
cron_schedule = */22 * * * *
description = Updates map lookups
search = | inputlookup crimeservers_lookup | search status="ONLINE" | fields lat lon type | outputlookup bl_map_lookup