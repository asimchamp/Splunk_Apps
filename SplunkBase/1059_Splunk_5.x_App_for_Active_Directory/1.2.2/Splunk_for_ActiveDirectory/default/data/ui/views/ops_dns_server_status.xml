<?xml version="1.0" encoding="UTF-8"?>
<view onUnloadCancelJob="True" template="dashboard.html">
	<label>DNS Server Status</label>
	<module name="AccountBar" layoutPanel="appHeader" />
	<module name="AppBar" layoutPanel="appHeader" />
	<module name="SideviewUtils" layoutPanel="appHeader" />

	<module name="Message" layoutPanel="messaging">
		<param name="filter">*</param>
		<param name="clearOnJobDispatch">False</param>
		<param name="maxSize">1</param>
	</module>

	<module name="TitleBar" layoutPanel="viewHeader"/>

	<module name="GenericHeader" layoutPanel="panel_row1_col1_grp1"><param name="label">DNS Server Status</param></module>

	<module name="URLLoader" layoutPanel="panel_row1_col1" autoRun="true">
	
		<module name="TimeRangePicker" layoutPanel="panel_row1_col1_grp2">
			<param name="default">Last 60 minutes</param>
			<param name="searchWhenChanged">true</param>
		
			<module name="Search">
				<param name="search"><![CDATA[eventtype=msad-dns-health|stats count by host|table host|sort host]]></param>
				<module name="Pulldown" layoutPanel="panel_row1_col1_grp3">
					<param name="name">host</param>
					<param name="size">1</param>
					<param name="width">300px</param>
					<param name="staticFieldsToDisplay"></param>
					<param name="label">DNS Server:</param>
					<param name="searchFieldsToDisplay"><list><param name="label">host</param><param name="value">host</param></list></param>

					<module name="Search" layoutPanel="panel_row2_col1">
						<param name="search"><![CDATA[index=msad sourcetype="MSAD:*:DNS-Health" host="$host$" | search source=Powershell |tail 1|fields *]]></param>
						<module name="DNSServerStatus"></module>
					</module> <!-- Search -->
					
					<module name="GenericHeader" layoutPanel="panel_row2_col2">
						<param name="label">Query Performance</param>
						<module name="Search">
							<param name="search"><![CDATA[eventtype=perfmon-dns host="$host$" `dns-query-perfmon-list`|stats sparkline(avg(Value),1m) as "Average", avg(Value) as "Average Value" by counter|sort counter|rename counter as "Performance Counter"]]></param>
							<module name="SimpleResultsTable">
								<param name="drilldown">row</param>
								<module name="Redirector">
									<param name="url">performance</param>
									<param name="arg.autoRun">True</param>
									<param name="arg.object">DNS</param>
									<param name="arg.counter">$click.cell0.value$</param>
									<param name="arg.host">$host$</param>
									<param name="arg.earliest">$search.timeRange.earliest$</param>
									<param name="arg.latest">$search.timeRange.latest$</param>
								</module> <!-- Redirector#Drill Down -->
							</module> <!-- SimpleResultsTable -->
						</module> <!-- Search -->
					</module> <!-- GenericHeader -->

					<module name="GenericHeader" layoutPanel="panel_row2_col2">
						<param name="label">Recursion Performance</param>
						<module name="Search">
							<param name="search"><![CDATA[eventtype=perfmon-dns host="$host$" `dns-recursion-perfmon-list`|stats sparkline(avg(Value),1m) as "Average", avg(Value) as "Average Value" by counter|sort counter|rename counter as "Performance Counter"]]></param>
							<module name="SimpleResultsTable">
								<param name="drilldown">row</param>
								<module name="Redirector">
									<param name="url">performance</param>
									<param name="arg.autoRun">True</param>
									<param name="arg.object">DNS</param>
									<param name="arg.counter">$click.cell0.value$</param>
									<param name="arg.host">$host$</param>
									<param name="arg.earliest">$search.timeRange.earliest$</param>
									<param name="arg.latest">$search.timeRange.latest$</param>
								</module> <!-- Redirector#Drill Down -->
							</module> <!-- SimpleResultsTable -->
						</module> <!-- Search -->
					</module> <!-- GenericHeader -->
					
					<module name="GenericHeader" layoutPanel="panel_row3_col1">
						<param name="label">Anomalous Events</param>
						<module name="Search">
							<param name="search"><![CDATA[eventtype=msad-dns-events host="$host$"|lookup EventCodes EventCode,LogName OUTPUTNEW desc|eval desc=if(isnull(desc),"Unknown EventCode",desc)|stats count by Type,EventCode,LogName,desc]]></param>
							<module name="Pager">
								<param name="entityName">results</param>
								<module name="SimpleResultsTable">
									<param name="drilldown">row</param>
									<module name="Redirector">
										<param name="url">flashtimeline</param>
										<param name="arg.autoRun">True</param>
										<param name="arg.q"><![CDATA[eventtype=msad-dns-events host="$host$" Type="$click.cell0.value$" EventCode="$click.cell1.value$" LogName="$click.cell2.value$"]]></param>
										<param name="arg.earliest">$search.timeRange.earliest$</param>
										<param name="arg.latest">$search.timeRange.latest$</param>
									</module>
								</module>
							</module>	
						</module> <!-- Search -->
					</module> <!-- GenericHeader -->
				
				</module> <!-- Pulldown#host -->
			</module> <!-- Search#host Pulldown -->
		</module> <!-- TimeRangePicker -->
	</module> <!-- URLLoader -->
</view>
