###
### Windows Event Logs
###
###		Application, System and Security logs are handled
###		by Splunk_TA_windows and should be compatible with
###		what we need
###

#
# Application and Services Logs - Directory Service
#
[WinEventLog://Directory Service]
disabled=0
sourcetype="WinEventLog:Directory Service"
index=winevents
queue=parsingQueue

[WinEventLog://File Replication Service]
disabled=0
sourcetype="WinEventLog:File Replication Service"
index=winevents
queue=parsingQueue

####### OS Logs (Splunk 5.x only) ######
# If you are running Splunk 5.x remove the above OS log stanzas and uncomment these
##[WinEventLog:Directory Service]
##disabled=0
##sourcetype="WinEventLog:Directory Service"
##index=winevents
##queue=parsingQueue
#
##[WinEventLog:File Replication Service]
##disabled=0
##sourcetype="WinEventLog:File Replication Service"
##index=winevents
##queue=parsingQueue

#
# Collect Replication Information
#
[script://.\bin\runpowershell.cmd ad-repl-stat.ps1]
source=Powershell
sourcetype=MSAD:NT5:Replication
index=msad
interval=300
disabled=false

#
# Collect Health and Topology Information
#
[script://.\bin\runpowershell.cmd ad-health.ps1]
source=Powershell
sourcetype=MSAD:NT5:Health
index=msad
interval=300
disabled=false

#
# Collect Site, Site Link and Subnet Information
#
[script://.\bin\runpowershell.cmd siteinfo.ps1]
source=Powershell
sourcetype=MSAD:NT5:SiteInfo
index=msad
interval=3600
disabled=false
#
# Perfmon Collection
[perfmon://Processor]
object = Processor
counters = *
instances = *
interval = 10
disabled = 0
index=perfmon

[perfmon://Memory]
object = Memory
counters = *
interval = 10
disabled = 0
index=perfmon

[perfmon://Network_Interface]
object = Network Interface
counters = *
instances = *
interval = 10
disabled = 0
index=perfmon

[perfmon://FileReplicaSet]
object = FileReplicaSet
counters = *
instances = *
interval = 30
disabled = 0
index=perfmon

[perfmon://NTDS]
object = NTDS
counters = *
interval = 10
disabled = 0
index=perfmon

[admon://NearestDC]
monitorSubtree = 1
interval=3600
disabled=false
index=msad

# ADMon Collection for Splunk v5
#[script://$SPLUNK_HOME\bin\scripts\splunk-admon.path]
#interval=3600
#disabled=false
#index=msad

# Subnet Affinity Log
#
[monitor://C:\Windows\debug\netlogon.log]
sourcetype=MSAD:NT5:Netlogon
disabled=false
index=msad
