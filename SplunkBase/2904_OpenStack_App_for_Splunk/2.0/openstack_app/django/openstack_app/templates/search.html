{% extends "splunkdj:base_with_app_bar.html" %}

{% load splunkmvc %}
{% block title %}Search Logs{% endblock title %}

{% block title %}{% endblock title %}

{% block css %}
    <style>
        .main-area {
            padding: 30px;
        }
    </style>
{% endblock css %}

{% block content %}
<div>
    <div class="main-area">
        <p></p>
    </div>
    {% searchbar id="searchbar1" managerid="search1" %}
    {% searchcontrols id="searchcontrols1" managerid="search1" %}
    {% timeline id="timeline1" managerid="search1" %}
    {% table id="table1" managerid="search1" %}
</div>
{% endblock content %}

{% block managers %}
    {% searchmanager id="search1" 
        search="openstack::* | head 100"
        preview=True 
        required_field_list="*" status_buckets=300
    %}
{% endblock managers %}

{% block js %}
<script>
    var deps = [
        "splunkjs/ready!"
    ];
    require(deps, function(mvc) {
        var mytimeline = splunkjs.mvc.Components.getInstance("timeline1");
        var mysearchbar = splunkjs.mvc.Components.getInstance("searchbar1");
        var mysearch = splunkjs.mvc.Components.getInstance("search1");


        mytimeline.on("change", function() {
            mysearch.settings.set(mytimeline.val());
        });


        mysearchbar.on("change", function() {
            mysearch.settings.unset("search");
            mysearch.settings.set("search", mysearchbar.val());
        });


        mysearchbar.timerange.on("change", function() {
            mysearch.settings.set(mysearchbar.timerange.val()); 
        });
    });
</script>
{% endblock js %}