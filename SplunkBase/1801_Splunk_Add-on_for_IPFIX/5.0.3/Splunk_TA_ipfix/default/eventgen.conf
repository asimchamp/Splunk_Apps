[appflow.raw]
disabled = false

mode = sample
count = 1
maxIntervalsBeforeFlush = 1
sampletype = raw
breaker = [\r\n]+[\r\n\s]+
bundlelines = true

outputMode = splunkstream
host=ns.acme
sourcetype = ipfix

token.0.token = exportTime=(\d{10})
token.0.replacementType = timestamp
token.0.replacement = %s

token.1.token = (\{appId\})
token.1.replacementType = mvfile
token.1.replacement = $SPLUNK_HOME/etc/apps/Splunk_TA_ipfix/samples/appflowId.csv:1

token.2.token = (\{netscalerAppName\})
token.2.replacementType = mvfile
token.2.replacement = $SPLUNK_HOME/etc/apps/Splunk_TA_ipfix/samples/appflowId.csv:2

token.3.token = (\{flowId\})
token.3.replacementType = random
token.3.replacement = integer[10000:99999]

token.4.token = (\{netscalerTransactionId\})
token.4.replacementType = random
token.4.replacement = integer[1000:99999]

token.5.token = (\{srcIp\})
token.5.replacementType = file
token.5.replacement = $SPLUNK_HOME/etc/apps/Splunk_TA_ipfix/samples/externalIP.txt

token.6.token = (\{destIp\})
token.6.replacementType = file
token.6.replacement = $SPLUNK_HOME/etc/apps/Splunk_TA_ipfix/samples/internalIP.txt

token.7.token = (\{srcPort\})
token.7.replacementType = random
token.7.replacement = integer[1:65535]

token.8.token = (\{destPort\})
token.8.replacementType = file
token.8.replacement = $SPLUNK_HOME/etc/apps/Splunk_TA_ipfix/samples/httpPorts.txt

token.9.token = (\{packetDelta\})
token.9.replacementType = random
token.9.replacement = integer[1:99]

token.10.token = (\{octetDelta\})
token.10.replacementType = random
token.10.replacement = integer[1000:2000]

token.11.token = Seconds=(\d{16})
token.11.replacementType = timestamp
token.11.replacement = %s

token.12.token = TimeTo.*Byte=(\d{16})
token.12.replacementType = timestamp
token.12.replacement = %s

token.13.token = (\{roundTrip\})
token.13.replacementType = random
token.13.replacement = integer[1:99]

token.14.token = (\{responseLength\})
token.14.replacementType = random
token.14.replacement = integer[10000:99999]

token.15.token = (\{netscalerConnectionId\})
token.15.replacementType = random
token.15.replacement = integer[1000000:9999999]

token.16.token = (\{requestHost\})
token.16.replacementType = file
token.16.replacement = $SPLUNK_HOME/etc/apps/Splunk_TA_ipfix/samples/requestHost.txt

token.17.token = (\{requestUrl\})
token.17.replacementType = file
token.17.replacement = $SPLUNK_HOME/etc/apps/Splunk_TA_ipfix/samples/requestUrl.txt

token.18.token = (\{requestMethod\})
token.18.replacementType = file
token.18.replacement = $SPLUNK_HOME/etc/apps/Splunk_TA_ipfix/samples/requestMethod.txt

token.19.token = (\{requestReferrer\})
token.19.replacementType = file
token.19.replacement = $SPLUNK_HOME/etc/apps/Splunk_TA_ipfix/samples/requestReferrer.txt

token.20.token = (\{userAgent\})
token.20.replacementType = file
token.20.replacement = $SPLUNK_HOME/etc/apps/Splunk_TA_ipfix/samples/userAgent.txt

token.21.token = (\{httpStatus\})
token.21.replacementType = file
token.21.replacement = $SPLUNK_HOME/etc/apps/Splunk_TA_ipfix/samples/httpStatus.txt
