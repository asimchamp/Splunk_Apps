[User Disabled Alert]
action.email = 1
action.email.priority = 2
action.email.reportServerEnabled = 0
action.email.to = test@example.com
action.email.useNSSubject = 1
alert.digest_mode = 0
alert.severity = 4
alert.suppress = 0
alert.track = 1
cron_schedule = * * * * *
description = Send an alert when a user is disabled due to too many authentication failures
dispatch.earliest_time = rt
dispatch.latest_time = rt
action.email.message.alert = $result.UserID$: $result.status$
action.email.subject.alert = Splunk Alert: SecurEnvoy $name$
disabled = 1
enableSched = 1
request.ui_dispatch_app = Splunk_SecurEnvoy
request.ui_dispatch_view = search
search = sourcetype=2fa:securenvoy      | rex field=_raw "^\d+\s+[A-Z][a-z]+\s+\d+:\d+:\d+\s+(?<source_server>(\w|-)+)\s(?<facility>.*)\sUserID=(?<userid>.*)@(?<domain>(\w|\.)+)\s(?<status>.*)Client(\s)?IP=(?<clientip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\sRemoteID=(?<remoteid>[^\s]*)(?<extended_info>.*)"      | search facility=Radius      | rex field=status mode=sed "s/From//g"      | eval failure_reason2 = status."".extended_info | search status="Too Many Failed Authentications User Disabled*"
